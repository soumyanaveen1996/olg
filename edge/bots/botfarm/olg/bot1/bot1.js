(function(){
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (function() { // webpackBootstrap
/******/ 	// runtime can't be in strict mode because a global variable is assign and maybe created.
/******/ 	var __webpack_modules__ = ({

/***/ "../../frontmjs/core/ALLConstants.js":
/*!*******************************************!*\
  !*** ../../frontmjs/core/ALLConstants.js ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALL_CONSTANTS: function() { return /* binding */ ALL_CONSTANTS; },\n/* harmony export */   DEVICE_ORIENTATION: function() { return /* binding */ DEVICE_ORIENTATION; },\n/* harmony export */   LLM_SERVICE: function() { return /* binding */ LLM_SERVICE; },\n/* harmony export */   OPEN_AI_ROLES: function() { return /* binding */ OPEN_AI_ROLES; },\n/* harmony export */   PREFIXES: function() { return /* binding */ PREFIXES; },\n/* harmony export */   SYSTEM_INTENTS: function() { return /* binding */ SYSTEM_INTENTS; }\n/* harmony export */ });\nvar ALL_CONSTANTS = {\n  PERSISTED_FIELD_PREFIX: 'PERSISTED_FIELD_',\n  AUTO_SAVE_BUFFER_FIELD: 'AUTO_SAVE_BUFFER_',\n  PERSISTED_STORAGE: 'PERSISTENT_STORAGE_',\n  TO_SYNC_WITH_BACKEND: 'toSyncWithBackend',\n  AUTO_SAVE_INTENT_EDGE: 'autoSaveIntentEdge',\n  AUTO_SAVE_INTENT_CLOUD: 'autoSaveIntentCloud',\n  ACTIVITY_COLLECTION: '_activity',\n  TABLES: {\n    CHANGE_ACTION: 'change',\n    APPEND_ACTION: 'append',\n    CHANGE_FILTER_ACTION: 'changeFilter',\n    //This is to respond to an edit filter request\n    RESULTS_FILTER_ACTION: 'resultsFilter',\n    VALIDATION_FILTER_ACTION: 'validationFilter',\n    CHANGE_FILTER_FORM_ACTION: 'changeFilterForm',\n    //This is to automatically change fields within the filter form\n    RENAME_FILTER_ACTION: 'renameFilter',\n    MULTIPLE_SELECTION_ACTION: 'multipleSelection',\n    CLEAR_FILTER_ACTION: 'clearFilter',\n    CLEAR_SEARCH_ACTION: 'clearSearch'\n  },\n  CALENDAR: {\n    MONTHLY_VIEW: 0,\n    WEEKLY_VIEW: 1,\n    DAILY_VIEW: 2\n  },\n  /**\n   * @deprecated since beta 2. Import PREFIXES directly\n   */\n  PREFIXES: {\n    AUDIT: 'audit',\n    INDEX: 'index',\n    FIELD_BUFFER_PREFIX: 'AUTOSAVED_FIELD_',\n    FIELD_LOOKUP_PREFIX: 'LOOKUP_FIELD_',\n    FILTER_PREFIX: 'filter_prefix_',\n    ALL_FILTERS: 'filter_prefix_all_filters'\n  },\n  DB_OPERATIONS: {\n    INSERT: 'insert',\n    UPDATE: 'update',\n    UPSERT: 'upsert',\n    DELETE: 'delete',\n    QUERY: 'query'\n  },\n  RESPONSES: {\n    FORM_RESPONSE: 'form_response',\n    TABLE_RESPONSE: 'table_response',\n    CONTAINER_RESPONSE: 'container_response',\n    VIDEO_CALL: 'videoCall',\n    TIMELINE_RESPONSE: \"timelineResponse\",\n    SURVEY_RESPONSE: 'surveyResponse',\n    AICC_RESPONSE: 'aiccResponse'\n  },\n  ACTIONS: {\n    ACTION: 'action',\n    SEARCH: 'search',\n    ON_ACTION: 'onAction',\n    ON_SEARCH: 'onSearch',\n    ON_REFRESH: 'onRefresh',\n    ON_ERROR: 'onError',\n    ERROR: 'error',\n    DISCARD: 'onDiscard',\n    MOVE: 'move',\n    CLICK: 'click',\n    COMPLETION: 'completion',\n    CONFIRM: 'confirm',\n    ON_CONFIRM: 'onConfirm',\n    CANCEL: 'cancel',\n    CLOSE: 'close',\n    RESULTS: 'results',\n    MAP_RESULTS: 'map_results',\n    CHANGE: 'change',\n    DELETE_ROW: 'deleteRow',\n    ADD_ROW: 'append',\n    CHANGE_COLUMN_TEMPLATE: 'changeColumnTemplate',\n    VALIDATION: 'validation',\n    QUICK_ACTION: \"quickAction\",\n    ON_FIELD_ACTION: 'onFieldAction',\n    ON_SELECTION: 'onSelection',\n    ON_MENU_ACTION: 'onMenuAction',\n    ON_DOWNLOAD: 'onDownload',\n    ON_DELETE: 'onDelete',\n    ON_SAVE: 'onSave',\n    ON_PREVIOUS_PAGE: 'previousPage',\n    ON_NEXT_PAGE: 'nextPage',\n    ON_FILTER_ACTION: 'filter',\n    ON_EDIT_FILTER_ACTION: 'editFilter',\n    ON_FILTER_DELETE_ACTION: 'filterDelete',\n    ON_CREATE_OVERLAY: 'createOverlay',\n    ON_EDIT_OVERLAY: 'editOverlay',\n    ON_DELETE_OVERLAY: 'deleteOverlay',\n    ON_TOP_MENU_ACTION: 'topMenu',\n    ON_SHOW_AREAS: 'showAreas',\n    SURVEY_RUN: 'runSurvey',\n    SURVEY_START: 'start',\n    SURVEY_ADD_QUESTION: 'addQuestion',\n    SURVEY_NEXT_QUESTION: 'nextQuestion',\n    SURVEY_END: 'end',\n    SURVEY_SHOW_CLOSE_PAGE: 'showClosePage',\n    SURVEY_PREVIOUS_QUESTION: 'previousQuestion'\n  },\n  CALL_ACTIONS: {\n    CALL: 'call',\n    HAND_UP: 'hangUp',\n    RING_START: 'ringStart',\n    CALL_START: 'callEnd',\n    CALL_END: 'callEnd'\n  },\n  MESSAGE_TYPES: {\n    VOICE_CALL_RESPONSE: 'voice_call_response',\n    HTML_RESPONSE: 'html_response',\n    OBJECT: \"object\"\n  },\n  COLLECTION_TYPES: {\n    CALENDAR: 'calendar',\n    TABLE: 'table',\n    MAP: 'map'\n  },\n  POINT_TYPE: {\n    MARKER: 'marker',\n    ROUTE: 'route',\n    PLANE_ROUTE: 'planeRoute'\n  },\n  MARKER_ICON_TYPE: {\n    VESSEL: 'arrow',\n    AIRCRAFT: 'aircraft',\n    CIRCLE: 'circle',\n    POI: 'poi'\n  },\n  FILE_SCOPE: {\n    CONVERSATION: 'conversation',\n    BOT: 'bot',\n    DOMAIN: 'domain'\n  },\n  SYSTEM_DB: 'frontmai',\n  COMMON_FIELDS: {\n    LAST_MAIN_TIMESTAMP: 'lastMainTimeStamp'\n  },\n  SYSTEM_TABLES: {\n    COUNTRIES: '_countries'\n  },\n  SYSTEM_FIELDS: {\n    COUNTRIES: '_countries',\n    COUNTRY_NAMES: '_countriesNames',\n    MESSAGE_PROCESSING_START: \"_messageProcessingStart\"\n  },\n  CLIENTS: {\n    MOBILECLIENT: 'mobile',\n    WEBCLIENT: 'web',\n    EDGE_WEBCLIENT: 'web2'\n  },\n  LOCATIONS: {\n    EDGE: 'Edge',\n    CLOUD: 'Cloud'\n  },\n  INTENTS: {\n    NO_INTENT: 'input.unknown'\n  },\n  TYPES: {\n    COLLECTION: \"collection\",\n    DOC: \"doc\",\n    FIELD: \"field\",\n    CONTAINER: \"container\"\n  },\n  NLP: {\n    ENGINES: {\n      OPEN_AI: \"openAI\",\n      LEX: \"lex\",\n      DIALOGFLOW: \"dialogflow\"\n    },\n    FIELDS: {\n      EMMA_PROMPT_KEY: \"emmaPrompt\",\n      DEFAULT_PROMPT_KEY: \"defaultPrompt\",\n      DEFAULT_CHAT_PROMPT_KEY: \"defaultChatPrompt\",\n      EMMA_NLP_KEY: \"emmaNLP\",\n      DEFAULT_NLP_KEY: \"defaultNLP\",\n      DEFAULT_CHAT_NLP_KEY: \"defaultChatNLP\",\n      WEB_BROWSER_COMMON_PROMPT: \"webBrowserCommonPrompt\"\n    }\n  },\n  VIDEO_CALL_ACTIONS: {\n    CREATE_MEETING: \"createMeeting\",\n    JOIN_MEETING: \"joinMeeting\"\n  },\n  TIMELINES: {\n    BOOKMARK: \"bookmark\",\n    VIEW: \"view\",\n    LOAD_MORE: \"loadMore\",\n    REFRESH: \"refresh\",\n    CLOSE: \"close\",\n    SURVEY: \"survey\",\n    ACTIONS: {\n      PUBLISH: 'publish',\n      DELETE: 'delete',\n      SEND_PUSH_NOTIFICATION: 'sendPushNotification'\n    }\n  },\n  SURVEY_STATUS: {\n    PENDING: 'pending',\n    IN_PROGRESS: 'inProgress',\n    DONE: 'done'\n  }\n};\nvar PREFIXES = {\n  AUDIT: 'audit',\n  INDEX: 'index',\n  FIELD_BUFFER_PREFIX: 'AUTOSAVED_FIELD_',\n  FIELD_LOOKUP_PREFIX: 'LOOKUP_FIELD_',\n  FILTER_PREFIX: 'filter_prefix_',\n  ALL_FILTERS: 'filter_prefix_all_filters',\n  LLM_CONTEXT: \"LLM_CONTEXT_\"\n};\nvar DEVICE_ORIENTATION = {\n  AUTO_ROTATE: 'auto-rotate',\n  FORCE_PORTRAIT: 'force-portrait',\n  FORCE_LANDSCAPE: 'force-landscape'\n};\nvar LLM_SERVICE = {\n  COMPLETION: \"COMPLETION\",\n  CHAT: \"CHAT\",\n  RELEVANT_QUESTIONS: \"RELEVANT_QUESTIONS\"\n};\nvar SYSTEM_INTENTS = {\n  GET_RELEVANT_QUESTIONS: \"_getRelevantQuestions\",\n  MAIN: \"main\"\n};\nvar OPEN_AI_ROLES = {\n  SYSTEM: \"system\",\n  USER: \"user\",\n  ASSISTANT: \"assistant\"\n};\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/ALLConstants.js?");

/***/ }),

/***/ "../../frontmjs/core/API.js":
/*!**********************************!*\
  !*** ../../frontmjs/core/API.js ***!
  \**********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   API: function() { return /* binding */ API; }\n/* harmony export */ });\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar API = /*#__PURE__*/function () {\n  function API(state) {\n    _classCallCheck(this, API);\n    this['_state'] = state;\n    this['_'] = state._;\n  }\n  _createClass(API, [{\n    key: \"loadServicesForMyDomains\",\n    value: function loadServicesForMyDomains() {\n      var tableName = 'APIParameters';\n      var query = [{\n        operand: 'userDomain',\n        value: this._state.currentUserDomain,\n        operator: 'eq'\n      }];\n      return this._state.db.getData(tableName, query);\n    }\n  }, {\n    key: \"createNewService\",\n    value: function () {\n      var _createNewService = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(service) {\n        var tableName, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              tableName = 'APIParameters';\n              _context.next = 3;\n              return this._state.db.writeData(tableName, service);\n            case 3:\n              response = _context.sent;\n              if (this._.get(response, \"errorMessage\")) {\n                this._state.addSystemErrorToStack(36);\n              }\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function createNewService(_x) {\n        return _createNewService.apply(this, arguments);\n      }\n      return createNewService;\n    }()\n  }, {\n    key: \"callService\",\n    value: function callService(service, options) {\n      var _this = this;\n      var params = {\n        capability: 'GetDataFromAPI',\n        capabilityFileName: 'getDataFromApi',\n        userDomain: this._state.conversation.userDomain,\n        serviceName: service,\n        queryParams: this._.get(options, 'queryParams'),\n        pathParams: this._.get(options, 'pathParams'),\n        header: this._.get(options, 'header'),\n        body: this._.get(options, 'body'),\n        sync: true,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation\n      };\n      try {\n        return this._state.callCapability(params).then(function (response) {\n          _this._state.developer.info({\n            message: 'Returned from service successfully',\n            data: _this._state.R.toString(response)\n          });\n          if (_this._.get(response, 'error')) {\n            _this._state.addSystemErrorToStack(37, response.error, response);\n          }\n          return response;\n        })[\"catch\"](function (error) {\n          _this._state.addSystemErrorToStack(37, error.message, params);\n          return error;\n        });\n      } catch (err) {\n        this._state.addSystemErrorToStack(37, err.message, params);\n      }\n    }\n  }, {\n    key: \"createUser\",\n    value: function createUser(userDetailsArray, emailTemplateName, delayRequired) {\n      var _this2 = this;\n      var params = {\n        users: userDetailsArray,\n        domain: this._state.currentUserDomain,\n        delayRequired: _typeof(delayRequired) === undefined ? true : delayRequired,\n        emailTemplateName: emailTemplateName\n      };\n      var invocationType = \"RequestResponse\";\n      if (this._state.messageTypeFromUser === \"payload\") {\n        invocationType = \"Event\";\n      }\n      return this._state.callLambda(\"CreateUserLambda\", params, invocationType).then(function (response) {\n        _this2._state.developer.info({\n          message: 'Returned from service create user',\n          data: response\n        });\n        var payload = JSON.parse(_this2._state._.get(response, \"Payload\"));\n        if (_this2._.get(payload, 'error')) {\n          _this2._state.addSystemErrorToStack(7, payload.error);\n        }\n        return payload;\n      })[\"catch\"](function (error) {\n        _this2._state.addSystemErrorToStack(7, error.message);\n        _this2._state.developer.log({\n          message: 'Returned with error',\n          data: error\n        });\n        return error;\n      });\n    }\n  }, {\n    key: \"userExistenceCheck\",\n    value: function () {\n      var _userExistenceCheck = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref) {\n        var loginUserName, emailAddress, appType, params, response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              loginUserName = _ref.loginUserName, emailAddress = _ref.emailAddress, appType = _ref.appType;\n              _context2.prev = 1;\n              params = {\n                capability: \"CheckUserExists\",\n                capabilityFileName: \"checkUserExists\",\n                appType: appType,\n                loginUserName: loginUserName,\n                emailAddress: emailAddress\n              };\n              _context2.next = 5;\n              return this._state.callCapability(params);\n            case 5:\n              response = _context2.sent;\n              this._state.developer.info({\n                message: 'Returned from service create user',\n                data: response\n              });\n              return _context2.abrupt(\"return\", response);\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](1);\n              this._state.addSystemErrorToStack(7, _context2.t0.message);\n              this._state.developer.log({\n                message: 'Returned with error',\n                data: _context2.t0\n              });\n              return _context2.abrupt(\"return\", _context2.t0);\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[1, 10]]);\n      }));\n      function userExistenceCheck(_x2) {\n        return _userExistenceCheck.apply(this, arguments);\n      }\n      return userExistenceCheck;\n    }()\n  }, {\n    key: \"deleteUser\",\n    value: function () {\n      var _deleteUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(userIds) {\n        var _this3 = this;\n        var params;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              params = {\n                capability: \"DeleteUser\",\n                capabilityFileName: \"deleteUser\",\n                appType: this._state.currentUserDomain\n              };\n              if (!Array.isArray(userIds)) {\n                _context3.next = 4;\n                break;\n              }\n              if (userIds.length === 1) {\n                params.action = \"deleteUser\";\n                params.userId = userIds[0];\n              } else {\n                params.action = \"deleteMultipleUsers\";\n                params.userIdsToDelete = userIds;\n              }\n              return _context3.abrupt(\"return\", this._state.callCapability(params).then(function (response) {\n                _this3._state.developer.info({\n                  message: 'DeleteUser response',\n                  data: response\n                });\n                if (_this3._.get(response, 'error')) {\n                  _this3._state.addSystemErrorToStack(7, response.error);\n                }\n                return response;\n              })[\"catch\"](function (error) {\n                _this3._state.addSystemErrorToStack(7, error.message);\n                _this3._state.developer.log({\n                  message: 'DeleteUser Returned with error',\n                  data: error\n                });\n                return error;\n              }));\n            case 4:\n              return _context3.abrupt(\"return\", false);\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function deleteUser(_x3) {\n        return _deleteUser.apply(this, arguments);\n      }\n      return deleteUser;\n    }()\n  }, {\n    key: \"authenticateUser\",\n    value: function () {\n      var _authenticateUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref2) {\n        var _this4 = this;\n        var _ref2$appType, appType, userEmail, password, otpToken, params;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _ref2$appType = _ref2.appType, appType = _ref2$appType === void 0 ? 'frontmai' : _ref2$appType, userEmail = _ref2.userEmail, password = _ref2.password, otpToken = _ref2.otpToken;\n              params = {\n                capability: \"AuthCapability\",\n                capabilityFileName: \"authCapability\",\n                appType: appType,\n                userEmail: userEmail,\n                password: password,\n                action: \"AuthenticateUser\",\n                otpToken: otpToken // this is the only not mandatory field. However, if the user has setup 2fa, this is a required input\n              };\n              return _context4.abrupt(\"return\", this._state.callCapability(params).then(function (response) {\n                return _this4._.get(response, 'success');\n              })[\"catch\"](function (error) {\n                _this4._state.developer.log({\n                  message: 'Authenticate user returned with error',\n                  data: error\n                });\n                return _this4._.get(error, 'success');\n              }));\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function authenticateUser(_x4) {\n        return _authenticateUser.apply(this, arguments);\n      }\n      return authenticateUser;\n    }()\n  }, {\n    key: \"encodeFile\",\n    value: function () {\n      var _encodeFile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(fileName) {\n        var params;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              params = {\n                capability: 'ConversationFilesCapability',\n                capabilityFileName: 'conversationFilesCapability',\n                targetConversationId: this._state.conversationId,\n                targetFileName: fileName,\n                conversation: this._state.conversation,\n                sync: true,\n                email: this._state.user.userEmail,\n                userId: this._state.user.userId\n              };\n              _context5.next = 3;\n              return this._state.callCapability(params);\n            case 3:\n              return _context5.abrupt(\"return\", _context5.sent);\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function encodeFile(_x5) {\n        return _encodeFile.apply(this, arguments);\n      }\n      return encodeFile;\n    }()\n  }, {\n    key: \"sendResponse\",\n    value: function () {\n      var _sendResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(_ref3) {\n        var _ref3$code, code, _ref3$response, response, finalResponse;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              _ref3$code = _ref3.code, code = _ref3$code === void 0 ? 200 : _ref3$code, _ref3$response = _ref3.response, response = _ref3$response === void 0 ? {} : _ref3$response;\n              finalResponse = _objectSpread({\n                code: code\n              }, response);\n              this._state.apiResponse = true;\n              this._state.addResponse(\"payload_response\", finalResponse);\n            case 4:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function sendResponse(_x6) {\n        return _sendResponse.apply(this, arguments);\n      }\n      return sendResponse;\n    }()\n  }]);\n  return API;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/API.js?");

/***/ }),

/***/ "../../frontmjs/core/Accounts.js":
/*!***************************************!*\
  !*** ../../frontmjs/core/Accounts.js ***!
  \***************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Accounts: function() { return /* binding */ Accounts; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Accounts = /*#__PURE__*/function () {\n  function Accounts(state) {\n    _classCallCheck(this, Accounts);\n    this['_state'] = state;\n    this['context'] = state.context;\n    this['userId'] = state.user.userId;\n    this['conversation'] = state.conversation;\n    this['location'] = state.location;\n  }\n  _createClass(Accounts, [{\n    key: \"getBalance\",\n    value: function getBalance(account) {\n      var conversation = this.conversation;\n      var userId = this.userId;\n      var params = {\n        capability: 'MessageQuotaCapability',\n        capabilityFileName: 'messageQuotaCapability',\n        action: 'getSpecificQuota',\n        sync: true,\n        userId: userId,\n        conversation: conversation,\n        botId: account\n      };\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"storeBalance\",\n    value: function storeBalance(account, balance) {\n      var conversation = this.conversation;\n      var userId = this.userId;\n      var params = {\n        capability: 'MessageQuotaCapability',\n        capabilityFileName: 'messageQuotaCapability',\n        action: 'incrementUserAssignedQuota',\n        sync: true,\n        userId: userId,\n        conversation: conversation,\n        stats: {}\n      };\n      params.stats[account] = balance;\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"updateBalance\",\n    value: function updateBalance(account, balance) {\n      var conversation = this.conversation;\n      var userId = this.userId;\n      var params = {\n        capability: 'MessageQuotaCapability',\n        capabilityFileName: 'messageQuotaCapability',\n        action: 'updateUserUsedQuota',\n        sync: true,\n        userId: userId,\n        conversation: conversation,\n        stats: {}\n      };\n      params.stats[account] = balance;\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"resetBalance\",\n    value: function resetBalance(account, balance) {\n      var conversation = this.conversation;\n      var userId = this.userId;\n      var params = {\n        capability: 'MessageQuotaCapability',\n        capabilityFileName: 'messageQuotaCapability',\n        action: 'setUserAssignedClearUsedQuota',\n        sync: true,\n        userId: userId,\n        conversation: conversation,\n        stats: {}\n      };\n      params.stats[account] = balance;\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"getCallRates\",\n    value: function getCallRates(isoCountry) {\n      try {\n        var conversation = this.conversation;\n        var userId = this.userId;\n        var params = {\n          capability: 'VoipCapability',\n          capabilityFileName: 'voipCapability',\n          action: 'getCallTariffsForCountry',\n          isoCountry: isoCountry,\n          userDomains: this._state.userDomains,\n          sync: true,\n          userId: userId,\n          conversation: conversation\n        };\n        return this._state.callCapability(params);\n      } catch (error) {\n        this._state.addSystemErrorToStack(8, null, error.message);\n      }\n    }\n  }, {\n    key: \"getCallHistory\",\n    value: function getCallHistory() {\n      try {\n        var params = {\n          action: 'getCallHistory',\n          capability: 'VoipCapability',\n          capabilityFileName: 'voipCapability',\n          userId: this.userId,\n          conversation: this.conversation,\n          sync: true,\n          email: this._state.user.userEmail\n        };\n        return this._state.callCapability(params);\n      } catch (error) {\n        this._state.addSystemErrorToStack(8, null, error.message);\n      }\n    }\n  }]);\n  return Accounts;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Accounts.js?");

/***/ }),

/***/ "../../frontmjs/core/AiccPlayer.js":
/*!*****************************************!*\
  !*** ../../frontmjs/core/AiccPlayer.js ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AiccPlayer: function() { return /* binding */ AiccPlayer; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n\nvar AiccPlayer = /*#__PURE__*/function (_Intent) {\n  _inherits(AiccPlayer, _Intent);\n  var _super = _createSuper(AiccPlayer);\n  function AiccPlayer(intentId, state) {\n    var _this;\n    _classCallCheck(this, AiccPlayer);\n    _this = _super.call(this, intentId, state);\n    _this._state = state;\n    _this.onCourseStart = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    _this.onCourseEnd = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }));\n    return _this;\n  }\n  _createClass(AiccPlayer, [{\n    key: \"onMatching\",\n    get: function get() {\n      return function (state) {\n        return state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.RESPONSES.AICC_RESPONSE;\n      };\n    }\n  }, {\n    key: \"onResolution\",\n    get: function get() {\n      var _this2 = this;\n      return /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(state) {\n          var ACTIONS, _state$messageFromUse, _state$messageFromUse2, action, courseId;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                ACTIONS = {\n                  START_COURSE: 'startCourse',\n                  END_COURSE: 'endCourse'\n                };\n                _context3.prev = 1;\n                action = (_state$messageFromUse = state.messageFromUser) === null || _state$messageFromUse === void 0 ? void 0 : _state$messageFromUse.action;\n                courseId = (_state$messageFromUse2 = state.messageFromUser) === null || _state$messageFromUse2 === void 0 ? void 0 : _state$messageFromUse2.courseId;\n                _context3.t0 = action;\n                _context3.next = _context3.t0 === ACTIONS.START_COURSE ? 7 : _context3.t0 === ACTIONS.END_COURSE ? 10 : 13;\n                break;\n              case 7:\n                _context3.next = 9;\n                return _this2.onCourseStart(courseId);\n              case 9:\n                return _context3.abrupt(\"break\", 13);\n              case 10:\n                _context3.next = 12;\n                return _this2.onCourseEnd(courseId);\n              case 12:\n                return _context3.abrupt(\"break\", 13);\n              case 13:\n                _context3.next = 18;\n                break;\n              case 15:\n                _context3.prev = 15;\n                _context3.t1 = _context3[\"catch\"](1);\n                _this2._state.developer.log({\n                  message: 'Error in AiccPlayer onResolution',\n                  data: _context3.t1.message\n                });\n              case 18:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, null, [[1, 15]]);\n        }));\n        return function (_x) {\n          return _ref3.apply(this, arguments);\n        };\n      }();\n    }\n  }, {\n    key: \"options\",\n    value: function options() {\n      return {\n        controlId: this.controlId,\n        tabId: this.tabId\n      };\n    }\n  }, {\n    key: \"sendResponse\",\n    value: function sendResponse(courseId, courseUrl) {\n      this.controlId = courseId;\n      var payload = {\n        data: {\n          courseUrl: courseUrl\n        },\n        options: this.options()\n      };\n      this._state.addAiccResponse(payload);\n    }\n  }]);\n  return AiccPlayer;\n}(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/AiccPlayer.js?");

/***/ }),

/***/ "../../frontmjs/core/Collection.js":
/*!*****************************************!*\
  !*** ../../frontmjs/core/Collection.js ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Collection: function() { return /* binding */ Collection; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _FormFieldTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FormFieldTypes */ \"../../frontmjs/core/FormFieldTypes.js\");\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Utils */ \"../../frontmjs/core/Utils.js\");\n/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Error */ \"../../frontmjs/core/Error.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\n\n\n\nvar Collection = /*#__PURE__*/function (_Intent) {\n  _inherits(Collection, _Intent);\n  var _super = _createSuper(Collection);\n  function Collection(intentId, _ref) {\n    var _this;\n    var tabId = _ref.tabId,\n      name = _ref.name,\n      _ref$shared = _ref.shared,\n      shared = _ref$shared === void 0 ? false : _ref$shared,\n      title = _ref.title,\n      description = _ref.description,\n      emptyStateMessage = _ref.emptyStateMessage,\n      _ref$columnNames = _ref.columnNames,\n      columnNames = _ref$columnNames === void 0 ? [] : _ref$columnNames,\n      _ref$keys = _ref.keys,\n      keys = _ref$keys === void 0 ? [] : _ref$keys,\n      _ref$selectableRows = _ref.selectableRows,\n      selectableRows = _ref$selectableRows === void 0 ? false : _ref$selectableRows,\n      _ref$actionableRows = _ref.actionableRows,\n      actionableRows = _ref$actionableRows === void 0 ? false : _ref$actionableRows,\n      _ref$addNewRows = _ref.addNewRows,\n      addNewRows = _ref$addNewRows === void 0 ? false : _ref$addNewRows,\n      addNewRowsLabel = _ref.addNewRowsLabel,\n      _ref$allowMinimize = _ref.allowMinimize,\n      allowMinimize = _ref$allowMinimize === void 0 ? true : _ref$allowMinimize,\n      _ref$allowClose = _ref.allowClose,\n      allowClose = _ref$allowClose === void 0 ? true : _ref$allowClose,\n      _ref$minimizeOnAction = _ref.minimizeOnAction,\n      minimizeOnAction = _ref$minimizeOnAction === void 0 ? false : _ref$minimizeOnAction,\n      _ref$updateInBackgrou = _ref.updateInBackground,\n      updateInBackground = _ref$updateInBackgrou === void 0 ? false : _ref$updateInBackgrou,\n      _ref$topTableMenu = _ref.topTableMenu,\n      topTableMenu = _ref$topTableMenu === void 0 ? false : _ref$topTableMenu,\n      promptOnClose = _ref.promptOnClose,\n      footer = _ref.footer,\n      rowMenu = _ref.rowMenu,\n      pages = _ref.pages,\n      zone = _ref.zone,\n      _ref$allowEdit = _ref.allowEdit,\n      allowEdit = _ref$allowEdit === void 0 ? false : _ref$allowEdit,\n      _ref$allowDelete = _ref.allowDelete,\n      allowDelete = _ref$allowDelete === void 0 ? false : _ref$allowDelete,\n      _ref$allowDeleteWhile = _ref.allowDeleteWhileOffline,\n      allowDeleteWhileOffline = _ref$allowDeleteWhile === void 0 ? false : _ref$allowDeleteWhile,\n      _ref$allowRefresh = _ref.allowRefresh,\n      allowRefresh = _ref$allowRefresh === void 0 ? false : _ref$allowRefresh,\n      _ref$allowDownload = _ref.allowDownload,\n      allowDownload = _ref$allowDownload === void 0 ? false : _ref$allowDownload,\n      _ref$allowSearch = _ref.allowSearch,\n      allowSearch = _ref$allowSearch === void 0 ? false : _ref$allowSearch,\n      _ref$allowQuickAction = _ref.allowQuickAction,\n      allowQuickAction = _ref$allowQuickAction === void 0 ? true : _ref$allowQuickAction,\n      confirmAction = _ref.confirmAction,\n      selectionAction = _ref.selectionAction,\n      parentDoc = _ref.parentDoc,\n      _ref$temp = _ref.temp,\n      temp = _ref$temp === void 0 ? false : _ref$temp,\n      document = _ref.document,\n      modal = _ref.modal,\n      style = _ref.style,\n      calendarEntry = _ref.calendarEntry,\n      activeFilterName = _ref.activeFilterName,\n      availableFilters = _ref.availableFilters,\n      filterDoc = _ref.filterDoc,\n      state = _ref.state,\n      _ref$version = _ref.version,\n      version = _ref$version === void 0 ? 4 : _ref$version,\n      _ref$cache = _ref.cache,\n      cache = _ref$cache === void 0 ? true : _ref$cache,\n      _ref$local = _ref.local,\n      local = _ref$local === void 0 ? false : _ref$local,\n      timeScaleView = _ref.timeScaleView,\n      startDate = _ref.startDate,\n      activeQueryString = _ref.activeQueryString,\n      mapOptions = _ref.mapOptions,\n      acceptAttachments = _ref.acceptAttachments,\n      fileScope = _ref.fileScope,\n      _ref$system = _ref.system,\n      system = _ref$system === void 0 ? false : _ref$system,\n      searchPlaceholder = _ref.searchPlaceholder,\n      _ref$onInit = _ref.onInit,\n      onInit = _ref$onInit === void 0 ? /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(self) {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }() : _ref$onInit;\n    _classCallCheck(this, Collection);\n    if (!document) {\n      return _possibleConstructorReturn(_this, null);\n    }\n    _this = _super.call(this, intentId, state, tabId);\n    _defineProperty(_assertThisInitialized(_this), \"dataType\", _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TYPES.COLLECTION);\n    _this.onAction = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }));\n    _this.onQuickAction = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3);\n    }));\n    _this.onFieldAction = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) switch (_context4.prev = _context4.next) {\n          case 0:\n          case \"end\":\n            return _context4.stop();\n        }\n      }, _callee4);\n    }));\n    _this.onSelection = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5);\n    }));\n    _this.onRefresh = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) switch (_context6.prev = _context6.next) {\n          case 0:\n          case \"end\":\n            return _context6.stop();\n        }\n      }, _callee6);\n    }));\n    _this.onSearch = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) switch (_context7.prev = _context7.next) {\n          case 0:\n          case \"end\":\n            return _context7.stop();\n        }\n      }, _callee7);\n    }));\n    _this.onDownload = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) switch (_context8.prev = _context8.next) {\n          case 0:\n          case \"end\":\n            return _context8.stop();\n        }\n      }, _callee8);\n    }));\n    _this.onConfirm = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) switch (_context9.prev = _context9.next) {\n          case 0:\n          case \"end\":\n            return _context9.stop();\n        }\n      }, _callee9);\n    }));\n    _this.onTopMenuAction = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) switch (_context10.prev = _context10.next) {\n          case 0:\n          case \"end\":\n            return _context10.stop();\n        }\n      }, _callee10);\n    }));\n    _this.onDelete = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11() {\n      return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n        while (1) switch (_context11.prev = _context11.next) {\n          case 0:\n          case \"end\":\n            return _context11.stop();\n        }\n      }, _callee11);\n    }));\n    _this.onSave = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12() {\n      return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n        while (1) switch (_context12.prev = _context12.next) {\n          case 0:\n          case \"end\":\n            return _context12.stop();\n        }\n      }, _callee12);\n    }));\n    _this.onClose = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n      return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n        while (1) switch (_context13.prev = _context13.next) {\n          case 0:\n          case \"end\":\n            return _context13.stop();\n        }\n      }, _callee13);\n    }));\n    _this.onMenuAction = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14() {\n      return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n        while (1) switch (_context14.prev = _context14.next) {\n          case 0:\n          case \"end\":\n            return _context14.stop();\n        }\n      }, _callee14);\n    }));\n    _this.onPreviousPage = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15() {\n      return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n        while (1) switch (_context15.prev = _context15.next) {\n          case 0:\n          case \"end\":\n            return _context15.stop();\n        }\n      }, _callee15);\n    }));\n    _this.onNextPage = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16() {\n      return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n        while (1) switch (_context16.prev = _context16.next) {\n          case 0:\n          case \"end\":\n            return _context16.stop();\n        }\n      }, _callee16);\n    }));\n    _this.onFilter = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17() {\n      return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n        while (1) switch (_context17.prev = _context17.next) {\n          case 0:\n          case \"end\":\n            return _context17.stop();\n        }\n      }, _callee17);\n    }));\n    _this.onFilterDelete = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18() {\n      return _regeneratorRuntime().wrap(function _callee18$(_context18) {\n        while (1) switch (_context18.prev = _context18.next) {\n          case 0:\n          case \"end\":\n            return _context18.stop();\n        }\n      }, _callee18);\n    }));\n    _this.onFilterEdit = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19() {\n      return _regeneratorRuntime().wrap(function _callee19$(_context19) {\n        while (1) switch (_context19.prev = _context19.next) {\n          case 0:\n          case \"end\":\n            return _context19.stop();\n        }\n      }, _callee19);\n    }));\n    _this.onRenameFilter = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20() {\n      return _regeneratorRuntime().wrap(function _callee20$(_context20) {\n        while (1) switch (_context20.prev = _context20.next) {\n          case 0:\n          case \"end\":\n            return _context20.stop();\n        }\n      }, _callee20);\n    }));\n    _this.onMultipleSelection = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee21() {\n      return _regeneratorRuntime().wrap(function _callee21$(_context21) {\n        while (1) switch (_context21.prev = _context21.next) {\n          case 0:\n          case \"end\":\n            return _context21.stop();\n        }\n      }, _callee21);\n    }));\n    _this.onDiscard = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee22() {\n      return _regeneratorRuntime().wrap(function _callee22$(_context22) {\n        while (1) switch (_context22.prev = _context22.next) {\n          case 0:\n          case \"end\":\n            return _context22.stop();\n        }\n      }, _callee22);\n    }));\n    _this.onClearFilter = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee23() {\n      return _regeneratorRuntime().wrap(function _callee23$(_context23) {\n        while (1) switch (_context23.prev = _context23.next) {\n          case 0:\n          case \"end\":\n            return _context23.stop();\n        }\n      }, _callee23);\n    }));\n    _this.onClearSearch = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee24() {\n      return _regeneratorRuntime().wrap(function _callee24$(_context24) {\n        while (1) switch (_context24.prev = _context24.next) {\n          case 0:\n          case \"end\":\n            return _context24.stop();\n        }\n      }, _callee24);\n    }));\n    _this.onCreateOverlay = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee25() {\n      return _regeneratorRuntime().wrap(function _callee25$(_context25) {\n        while (1) switch (_context25.prev = _context25.next) {\n          case 0:\n          case \"end\":\n            return _context25.stop();\n        }\n      }, _callee25);\n    }));\n    _this.onEditOverlay = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee26() {\n      return _regeneratorRuntime().wrap(function _callee26$(_context26) {\n        while (1) switch (_context26.prev = _context26.next) {\n          case 0:\n          case \"end\":\n            return _context26.stop();\n        }\n      }, _callee26);\n    }));\n    _this.onDeleteOverlay = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee27() {\n      return _regeneratorRuntime().wrap(function _callee27$(_context27) {\n        while (1) switch (_context27.prev = _context27.next) {\n          case 0:\n          case \"end\":\n            return _context27.stop();\n        }\n      }, _callee27);\n    }));\n    _this.onShowAreas = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee28() {\n      return _regeneratorRuntime().wrap(function _callee28$(_context28) {\n        while (1) switch (_context28.prev = _context28.next) {\n          case 0:\n          case \"end\":\n            return _context28.stop();\n        }\n      }, _callee28);\n    }));\n    _this.onInit = onInit;\n    _this.title = title;\n    _this.description = description;\n    _this.columnNames = columnNames;\n    //this.filter = filter;\n    _this.keys = keys;\n    _this.selectableRows = selectableRows;\n    _this.actionableRows = actionableRows;\n    _this.addNewRows = addNewRows;\n    _this.addNewRowsLabel = addNewRowsLabel;\n    _this.allowMinimize = allowMinimize;\n    _this.allowClose = allowClose;\n    _this.allowSearch = allowSearch;\n    _this.minimizeOnAction = minimizeOnAction;\n    _this.updateInBackground = updateInBackground;\n    _this.promptOnClose = promptOnClose;\n    _this.style = style;\n    _this.calendarEntry = calendarEntry;\n    _this.footer = footer;\n    _this.rowMenu = rowMenu;\n    _this.pages = pages;\n    _this.zone = zone;\n    _this.modal = modal;\n    _this.allowChange = allowEdit;\n    _this.allowEdit = allowEdit;\n    _this.allowDelete = allowDelete;\n    _this.allowDeleteWhileOffline = allowDeleteWhileOffline;\n    _this.allowRefresh = allowRefresh;\n    _this.allowDownload = allowDownload;\n    _this.confirmAction = confirmAction;\n    _this.emptyStateMessage = emptyStateMessage;\n    _this._activeFilterName = activeFilterName;\n    _this._availableFilters = availableFilters;\n    _this._filteredColumns = [];\n    _this._version = version;\n    _this._columns = [];\n    _this._action = null;\n    _this._activeQueryString = activeQueryString;\n    _this._columnTemplate = [];\n    _this._preserveFieldData = {};\n    _this._mapOptions = mapOptions;\n    _this.selectionAction = selectionAction;\n    _this._keysForShortMessage = [];\n    _this.allowQuickAction = allowQuickAction;\n    _this.acceptAttachments = acceptAttachments;\n    _this.fileScope = fileScope;\n    _this.parentDocId = _this.intentId;\n    _this.topTableMenu = topTableMenu;\n    _this.searchPlaceholder = searchPlaceholder;\n    if (style === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.COLLECTION_TYPES.CALENDAR) {\n      _this._timeScaleView = timeScaleView;\n      _this._startDate = startDate;\n    }\n    _this._shared = shared;\n    var collectionName = \"\".concat(name || intentId);\n    _this._collectionName = collectionName;\n    _this._state = document._state;\n    _this._ = document._state._;\n    _this._rows = [];\n    _this._document = document;\n    _this.documentId = document.intentId;\n    _this._cache = cache;\n    _this._system = system;\n    _this.temp = temp;\n    _this._local = local;\n    if (_this._document) {\n      _this._state = _this._document._state;\n    }\n    _this._subCollection = false;\n    _this.filterDoc = filterDoc;\n    _this._sectionId = null;\n    if (parentDoc) {\n      _this.setParentDoc(parentDoc);\n    }\n    var _ = document._state._;\n    if (_this.addNewRows) {\n      // TODO: the _ is undefined in this context and causing errors.\n      _this.newRowFieldsOptions = document.message(true).fields || []; //_.get(document.message(true), 'fields')\n    }\n\n    _this._document.setCollection(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(Collection, [{\n    key: \"resetProperties\",\n    value: function resetProperties() {\n      this._action = null;\n      this.activeQueryString = null;\n      this.activeFilterName = null;\n      // we need to set the name  and call setCollection inside here\n      // because in the constructor we don't have the state.systemId seeded\n      // good to have in the feature: a json file with the bot metadata that the state\n      // can import and seed in the state constructor (having that we can move this again to the constructor)\n      this._name = this._shared ? \"\".concat(this._collectionName, \"_\").concat(this._state.systemId) : \"\".concat(this._collectionName, \"_\").concat(this._state.botId);\n      this._document.setCollection(this);\n    }\n  }, {\n    key: \"cloneCollection\",\n    value: function cloneCollection(collection, intentId) {\n      return new Collection(intentId || this.intentId, {\n        title: this.title,\n        description: this.description,\n        columnNames: this.columnNames,\n        keys: this.keys,\n        selectableRows: this.selectableRows,\n        actionableRows: this.actionableRows,\n        addNewRows: this.addNewRows,\n        addNewRowsLabel: this.addNewRowsLabel,\n        allowMinimize: this.allowMinimize,\n        allowClose: this.allowClose,\n        minimizeOnAction: this.minimizeOnAction,\n        updateInBackground: this.updateInBackground,\n        promptOnClose: this.promptOnClose,\n        footer: this.footer,\n        rowMenu: this.rowMenu,\n        pages: this.pages,\n        allowEdit: this.allowEdit || this.allowChange,\n        allowDelete: this.allowDelete,\n        allowDeleteWhileOffline: this.allowDeleteWhileOffline,\n        allowRefresh: this.allowRefresh,\n        allowDownload: this.allowDownload,\n        allowSearch: this.allowSearch,\n        confirmAction: this.confirmAction,\n        parentDoc: this.parentDoc,\n        document: this._document,\n        modal: this.modal,\n        style: this.style,\n        calendarEntry: this.calendarEntry,\n        activeFilterName: this._activeFilterName,\n        availableFilters: this._availableFilters,\n        filterDoc: this._filterDoc,\n        state: this.document._state,\n        version: this._version,\n        cache: this._cache,\n        timeScaleView: this._timeScaleView,\n        startDate: this._startDate,\n        activeQueryString: this._activeQueryString,\n        mapOptions: this._mapOptions,\n        selectionAction: this.selectionAction,\n        acceptAttachments: this.acceptAttachments,\n        fileScope: this.fileScope,\n        topTableMenu: this.topTableMenu,\n        searchPlaceholder: this.searchPlaceholder,\n        system: this._system,\n        emptyStateMessage: this.emptyStateMessage,\n        onInit: this.onInit\n      });\n    }\n  }, {\n    key: \"overrideOptions\",\n    value: function overrideOptions(newOptions) {\n      var _ = this._state._;\n      this.tabId = newOptions.tabId;\n      this.title = _.get(newOptions, 'title');\n      this.columnNames = _.get(newOptions, 'columnNames');\n      this._columns = _.get(newOptions, 'columns');\n      this._filteredColumns = newOptions.filteredColumns;\n      this.keys = newOptions.keys;\n      this.selectableRows = newOptions.selectableRows;\n      this.actionableRows = newOptions.actionableRows;\n      this.addNewRows = newOptions.addNewRows;\n      this.addNewRowsLabel = newOptions.addNewRowsLabel;\n      this.allowMinimize = newOptions.allowMinimize;\n      this.allowClose = newOptions.allowClose;\n      this.minimizeOnAction = newOptions.minimizeOnAction;\n      this.updateInBackground = newOptions.updateInBackground;\n      this.promptOnClose = newOptions.promptOnClose;\n      this.footer = newOptions.footer;\n      this.rowMenu = newOptions.rowMenu;\n      this.pages = newOptions.pages;\n      this.zone = newOptions.zone;\n      this.modal = newOptions.modal;\n      this.allowChange = newOptions.allowChange;\n      this.allowEdit = newOptions.allowEdit;\n      this.allowDelete = newOptions.allowDelete;\n      this.allowDeleteWhileOffline = newOptions.allowDeleteWhileOffline;\n      this.allowRefresh = newOptions.allowRefresh;\n      this.allowDownload = newOptions.allowDownload;\n      this.confirmAction = newOptions.confirmAction;\n      this.allowSearch = newOptions.allowSearch;\n      this.allowQuickAction = newOptions.allowQuickAction;\n      this.style = newOptions.style;\n      this.calendarEntry = newOptions.calendarEntry;\n      this._activeFilterName = newOptions.activeFilterName;\n      this._availableFilters = newOptions.availableFilters;\n      this._filterActive = newOptions.filterActive;\n      this.newRowFieldsOptions = newOptions.newRowFieldsOptions;\n      this._timeScaleView = newOptions.timeScaleView;\n      this._startDate = newOptions.startDate;\n      this._activeQueryString = newOptions.activeQueryString;\n      this._columnTemplate = newOptions.columnTemplate;\n      this._preserveFieldData = newOptions.preserveFieldData;\n      this._mapOptions = newOptions.mapOptions;\n      this._keysForShortMessage = newOptions.keysForShortMessage;\n      this.parentDocId = newOptions.parentDocId;\n      this.emptyStateMessage = newOptions.emptyStateMessage;\n      if (this._state) {\n        if (!newOptions.parent) {\n          delete this._parent;\n        } else {\n          this._parent = this._state.intents[newOptions.parent];\n        }\n      }\n      this.selectionAction = _.get(newOptions, 'selectionAction');\n      this.topTableMenu = _.get(newOptions, 'topTableMenu');\n    }\n  }, {\n    key: \"options\",\n    get: function get() {\n      var parent = null;\n      if (this._parent) {\n        parent = this._parent._intentId;\n      }\n      var parentDocId;\n      if (this._state) {\n        parentDocId = this._state._.get(this._state, 'messageFromUser.parentDocId') || this.parentDocId;\n      }\n      return {\n        parent: parent,\n        tableId: this.intentId,\n        controlId: this.intentId,\n        documentId: this.documentId,\n        action: this._action,\n        tabId: this.tabId,\n        title: this.title,\n        description: this.description,\n        columnNames: this.columnNames,\n        columns: this._columns,\n        filteredColumns: this._filteredColumns,\n        //filter: this.filter,\n        keys: this.keys,\n        selectableRows: this.selectableRows,\n        actionableRows: this.actionableRows,\n        addNewRows: this.addNewRows,\n        addNewRowsLabel: this.addNewRowsLabel,\n        allowMinimize: this.allowMinimize,\n        allowClose: this.allowClose,\n        minimizeOnAction: this.minimizeOnAction,\n        updateInBackground: this.updateInBackground,\n        promptOnClose: this.promptOnClose,\n        footer: this.footer,\n        rowMenu: this.rowMenu,\n        pages: this.pages,\n        zone: this.zone,\n        modal: this.modal,\n        allowChange: this.allowChange,\n        allowEdit: this.allowEdit,\n        allowDelete: this.allowDelete,\n        allowDeleteWhileOffline: this.allowDeleteWhileOffline,\n        allowRefresh: this.allowRefresh,\n        allowDownload: this.allowDownload,\n        confirmAction: this.confirmAction,\n        allowSearch: this.allowSearch,\n        style: this.style,\n        calendarEntry: this.calendarEntry,\n        activeFilterName: this._activeFilterName,\n        availableFilters: this._availableFilters,\n        filterActive: this._filterActive,\n        newRowFieldsOptions: this.newRowFieldsOptions,\n        timeScaleView: this._timeScaleView,\n        startDate: this._startDate,\n        activeQueryString: this._activeQueryString,\n        columnTemplate: this._columnTemplate,\n        preserveFieldData: this._preserveFieldData,\n        mapOptions: this._mapOptions,\n        selectionAction: this.selectionAction,\n        keysForShortMessage: this._keysForShortMessage,\n        acceptAttachments: this.acceptAttachments,\n        fileScope: this.fileScope,\n        allowQuickAction: this.allowQuickAction,\n        topTableMenu: this.topTableMenu,\n        searchPlaceholder: this.searchPlaceholder,\n        emptyStateMessage: this.emptyStateMessage,\n        parentDocId: parentDocId,\n        sectionId: this.sectionId\n      };\n    }\n  }, {\n    key: \"document\",\n    get: function get() {\n      return this._document;\n    },\n    set: function set(document) {\n      this._document = document;\n    }\n  }, {\n    key: \"parentDoc\",\n    get: function get() {\n      return this._parentDoc;\n    },\n    set: function set(parentDoc) {\n      this._parentDoc = parentDoc;\n    }\n  }, {\n    key: \"sectionId\",\n    get: function get() {\n      return this._sectionId;\n    },\n    set: function set(sectionId) {\n      this._sectionId = sectionId;\n    }\n  }, {\n    key: \"system\",\n    get: function get() {\n      return this._system;\n    }\n  }, {\n    key: \"name\",\n    get: function get() {\n      return this._shared ? \"\".concat(this._collectionName, \"_\").concat(this._state.systemId) : \"\".concat(this._collectionName, \"_\").concat(this._state.botId);\n    }\n  }, {\n    key: \"filterDoc\",\n    get: function get() {\n      return this._filterDoc;\n    },\n    set: function set(filterDoc) {\n      this._filterDoc = filterDoc;\n      if (this._filterDoc) {\n        this._filterActive = true;\n        this._filterDoc._filteredCollectionName = this.intentId;\n      } else {\n        this._filterActive = false;\n      }\n    }\n  }, {\n    key: \"isSubCollection\",\n    get: function get() {\n      return this._subCollection;\n    },\n    set: function set(isSubCollection) {\n      this._subCollection = isSubCollection;\n    }\n  }, {\n    key: \"sendResponse\",\n    value: function sendResponse(skipOnResponse) {\n      this._state.addTableResponse(this.message(false, skipOnResponse));\n    }\n  }, {\n    key: \"generateTableColumnLabels\",\n    value: function generateTableColumnLabels() {\n      var _this2 = this;\n      var _ = this._state._;\n      var tableRowLabels = [];\n      var columnNamesObject = {};\n      _.forEach(this._document.fields, function (field) {\n        if (!field.hidden) {\n          if (field.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_2__.FormFieldTypes.FILE_FIELD) {\n            if (_this2._version === 1) {\n              tableRowLabels.push(\"\".concat(field.title, \"_attachment\"));\n            } else {\n              columnNamesObject[field.id] = field.title;\n            }\n          } else {\n            if (_this2._version === 1) {\n              tableRowLabels.push(field.title);\n            } else {\n              columnNamesObject[field.id] = field.title;\n            }\n          }\n        }\n      });\n      if (this._version === 1) {\n        return tableRowLabels;\n      } else {\n        return columnNamesObject;\n      }\n    }\n  }, {\n    key: \"generateTableColumnTemplate\",\n    value: function generateTableColumnTemplate() {\n      var _ = this._state._;\n      var columnNamesObject = [];\n      _.forEach(this._document.fields, function (field) {\n        // Also considering the hidden fields as required to generate the fields back in expandShortTableResponse\n        // if (!field.hidden) {\n        //let fieldProperties = field.message(true);\n        // delete fieldProperties.value;\n        columnNamesObject.push(field.message(true, true));\n        // }\n      });\n\n      return columnNamesObject;\n    }\n  }, {\n    key: \"generateTableKeyLabels\",\n    value: function generateTableKeyLabels() {\n      var _ = this._state._;\n      var tableRowKeyLabels = [];\n      _.forEach(this._document.fields, function (field) {\n        if (field.primaryKey) {\n          tableRowKeyLabels.push(field.title);\n        }\n      });\n      return tableRowKeyLabels;\n    }\n  }, {\n    key: \"generateKeysForShortMessage\",\n    value: function generateKeysForShortMessage() {\n      //TODO: Check if the kays make sense. Filter temps??\n      var _ = this._state._;\n      var tableRowKey = [];\n      _.forEach(this._document.fields, function (field) {\n        tableRowKey.push(field.id);\n      });\n      return tableRowKey;\n    }\n  }, {\n    key: \"generateTableRows\",\n    value: function generateTableRows(skipOnResponse) {\n      var _this3 = this;\n      var _ = this._state._;\n      var D = this._state.developer;\n      var tableRows = [];\n      _.forEach(this._rows, function (row) {\n        var doc = row.document;\n        var tableRow = {};\n        if (_this3._version === 2) {\n          tableRow = _.get(row.message(null, null, null, null, skipOnResponse), 'fields');\n        } else if (_this3._version > 2) {\n          var rowMessage = row.message(null, null, null, null, skipOnResponse);\n          var rowOptions = {};\n          if (row.allowEdit === false) {\n            rowOptions.allowEdit = false;\n          }\n          if (row.allowDelete === false) {\n            rowOptions.allowDelete = false;\n          }\n          rowOptions.rowMenu = row.rowMenu;\n          tableRow[row.docId] = {\n            fields: _.get(rowMessage, 'fields'),\n            rowOptions: rowOptions\n          };\n        } else {\n          _.forEach(row.fields, function (field) {\n            if (field) field.onMessage(skipOnResponse);\n            if (field.primaryKey || !field.hidden) {\n              if (field.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_2__.FormFieldTypes.DATE || field.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_2__.FormFieldTypes.DATETIME) {\n                tableRow[field.title] = \"#date(\".concat(field.value, \")\");\n              } else {\n                tableRow[field.title] = field.value;\n              }\n            }\n          });\n        }\n        tableRows.push(tableRow);\n      });\n      return tableRows;\n    }\n  }, {\n    key: \"setFilterColumns\",\n    value: function setFilterColumns() {\n      var _ = this._state._;\n      if (this._filterDoc && this._filteredColumns.length === 0) {\n        var columns = [];\n        _.forEach(this._filterDoc.fields, function (field) {\n          if (!field.hidden) {\n            var fieldDetails = field.message();\n            if (fieldDetails) columns.push(fieldDetails);\n          }\n        });\n        this._filteredColumns = columns;\n      }\n    }\n  }, {\n    key: \"prepareCollectionOptions\",\n    value: function prepareCollectionOptions() {\n      var preserveFieldData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var currentAutoSave = this._document._autoSave;\n      if (!this.allowChange && !this.allowEdit && !this.addNewRows && !this.allowDelete && !this._parentDoc) {\n        this._document._autoSave = false;\n      }\n      this.setFilterColumns();\n      this.columnNames = this.generateTableColumnLabels();\n      this._columnTemplate = this.generateTableColumnTemplate();\n      this._keysForShortMessage = this.generateKeysForShortMessage();\n      this._preserveFieldData = preserveFieldData;\n      if (this._version === 2) {\n        this.keys = [];\n      } else {\n        this.keys = this.generateTableKeyLabels();\n      }\n      this._document._autoSave = currentAutoSave;\n    }\n  }, {\n    key: \"getRowsForShortResponse\",\n    value: function getRowsForShortResponse() {\n      var _this4 = this;\n      var preserveFieldData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _ = this._state._;\n      // let rowsResponse = [];\n      this.message(undefined, undefined, preserveFieldData);\n      //TODO: build the short response as array of arrays. Careful with the docId, allowDelete and allowEdit\n      // _.forEach(this._rows, row => {\n      //     row.onResponse(row);\n      //     let shortDoc = row._documentForShortResponse;\n      //     shortDoc.docId = row.docId;\n      //     shortDoc.allowEdit = row.allowEdit;\n      //     shortDoc.allowDelete = row.allowDelete;\n      //     rowsResponse.push(shortDoc);\n      // })\n      var rowsResponseDelta = [];\n      _.forEach(this._rows, function (row) {\n        var shortArr = [];\n        _.forEach(_this4._keysForShortMessage, function (key) {\n          shortArr.push(row._documentForShortResponse[key]);\n        });\n        var preservedFields = [];\n        _.forEach(Object.keys(preserveFieldData), function (field) {\n          var preservedFieldsArr = [];\n          _.forEach(preserveFieldData[field], function (fieldKey) {\n            preservedFieldsArr.push(row.f[field][fieldKey]);\n          });\n          preservedFields.push(preservedFieldsArr);\n        });\n        rowsResponseDelta.push([shortArr, [row.docId, row.allowEdit, row.allowDelete, row.rowMenu], preservedFields]);\n      });\n      return rowsResponseDelta;\n    }\n  }, {\n    key: \"sendShortResponse\",\n    value: function sendShortResponse(asyncPages, totalExpectedRows) {\n      var preserveFieldData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _ = this._state._;\n      this.prepareCollectionOptions(preserveFieldData);\n      this._state.addShortTableResponse({\n        options: this.options,\n        asyncPages: asyncPages,\n        totalExpectedRows: totalExpectedRows,\n        rows: this.getRowsForShortResponse(preserveFieldData)\n      });\n    }\n  }, {\n    key: \"message\",\n    value: function message(asyncPages, skipOnResponse) {\n      var preserveFieldData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _ = this._state._;\n      this.prepareCollectionOptions(preserveFieldData);\n      // this.generateAutoSaveBufferFromCollection();\n      if (asyncPages) {\n        this._action = _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TABLES.CHANGE_ACTION;\n        return {\n          rows: {\n            append: this.generateTableRows(skipOnResponse)\n          },\n          options: this.options\n        };\n      } else {\n        this._action = null;\n        return {\n          rows: this.generateTableRows(skipOnResponse),\n          options: this.options\n        };\n      }\n    }\n  }, {\n    key: \"sendEditFilterResponse\",\n    value: function sendEditFilterResponse() {\n      var D = this._state.developer;\n      this._action = _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TABLES.CHANGE_FILTER_ACTION;\n      this.setFilterColumns();\n      //D.log({message: \"Options on editResponse\", data: this.options});\n      this._state.addTableResponse({\n        rows: [],\n        options: this.options\n      });\n    }\n  }, {\n    key: \"sendFilterChangeResponse\",\n    value: function sendFilterChangeResponse(action, results) {\n      var D = this._state.developer;\n      this._action = action;\n      this._filteredColumns = results;\n      //D.log({message: \"Options on editResponse\", data: this.options});\n      this._state.addTableResponse({\n        rows: [],\n        options: this.options\n      });\n    }\n  }, {\n    key: \"getFilterCriteriaWithName\",\n    value: function getFilterCriteriaWithName(name) {\n      return this._state.getField(_ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.PREFIXES.FILTER_PREFIX + name);\n    }\n  }, {\n    key: \"addRow\",\n    value: function addRow(row) {\n      row.index = this._rows.length;\n      this._rows.push(row);\n    }\n  }, {\n    key: \"clearRows\",\n    value: function clearRows() {\n      this._rows = [];\n    }\n  }, {\n    key: \"rowAsDocumentsArray\",\n    value: function rowAsDocumentsArray() {\n      var _ = this._state._;\n      var resultsArray = [];\n      _.forEach(this.rows, function (row) {\n        resultsArray.push(row.document);\n      });\n      return resultsArray;\n    }\n  }, {\n    key: \"buildRowsFromArray\",\n    value: function buildRowsFromArray(rows) {\n      var _this5 = this;\n      var _ = this._state._;\n      if (Array.isArray(rows)) {\n        this.clearRows();\n        var i = 0;\n        rows.forEach(function (row) {\n          var newDoc = _this5._document.cloneDoc();\n          _this5.addRow(newDoc);\n          if (newDoc.hasSubDocs) {\n            newDoc.buildDocumentFromContainer(row, true);\n          } else {\n            newDoc.buildDocument(row, true);\n          }\n          i++;\n        });\n        //console.log('Final i ' + i);\n      }\n    }\n  }, {\n    key: \"buildRowsFromUserMessage\",\n    value: function buildRowsFromUserMessage(tabId, messageFromUser, state) {\n      this._state.duringBuild = true; // -- setting the auto save changes trigger to ignoring changes\n\n      this._state._.unset(this._state.autoSaveBuffer, this.getAutoSavePath(tabId));\n      this.buildRowsFromArray(messageFromUser.rows);\n      this._state.duringBuild = false;\n    }\n  }, {\n    key: \"getAutoSavePath\",\n    value: function getAutoSavePath(tabId, parentDocId) {\n      var state = this._state;\n      try {\n        var _ = state._;\n        var D = state.developer;\n        var tabIdToLoad = tabId || state.currentTabId || this.document.tabId;\n        if (this._parentDoc) {\n          var docPath = this._parentDoc.getAutoSavePath(tabIdToLoad, parentDocId);\n          return \"\".concat(docPath, \".\").concat(this.intentId);\n        } else {\n          return \"\".concat(tabIdToLoad, \".\").concat(this.intentId);\n        }\n      } catch (error) {\n        state.addSystemErrorToStack(999, error.message, this.intentId);\n      }\n    }\n  }, {\n    key: \"loadRowsFromAutoSaveBuffer\",\n    value: function loadRowsFromAutoSaveBuffer(tabId) {\n      var _this6 = this;\n      var state = this.document._state;\n      var _ = state._;\n      var D = state.developer;\n      var path = this.getAutoSavePath(tabId);\n      var autoSavedRows = _.get(state.autoSaveBuffer, path);\n      _.forEach(autoSavedRows, function (autoSavedRow, docId) {\n        var newRow = _this6.document.cloneDoc();\n        newRow.docId = docId;\n        _this6.addRow(newRow);\n        if (_this6.document._subDocs) {\n          newRow.buildDocumentFromContainer(autoSavedRow);\n        } else {\n          newRow.buildDocument(autoSavedRow);\n        }\n      });\n    }\n  }, {\n    key: \"generateAutoSaveBufferFromCollection\",\n    value: function generateAutoSaveBufferFromCollection() {\n      this._rows.forEach(function (row) {\n        row.generateAutoSaveBufferFromDoc();\n      });\n    }\n  }, {\n    key: \"clearAutoSaveBuffer\",\n    value: function clearAutoSaveBuffer(tabId) {\n      var state = this.document._state;\n      var _ = state._;\n      var path = this.getAutoSavePath(tabId);\n      _.unset(state.autoSaveBuffer, path);\n    }\n  }, {\n    key: \"clearAutoSaveBufferChanges\",\n    value: function clearAutoSaveBufferChanges(tabId) {\n      var state = this.document._state;\n      var _ = state._;\n      var path = this.getAutoSavePath(tabId);\n      _.unset(state.autoSaveBufferChanges, path);\n    }\n  }, {\n    key: \"buildTheDocsFromPayload\",\n    value: function () {\n      var _buildTheDocsFromPayload = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee29(payload) {\n        var _this7 = this;\n        var _, D, online, currentAutoSave, allDocs, allKeys, _loop, i;\n        return _regeneratorRuntime().wrap(function _callee29$(_context30) {\n          while (1) switch (_context30.prev = _context30.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              _context30.next = 4;\n              return this._state.online();\n            case 4:\n              online = _context30.sent;\n              currentAutoSave = this._document._autoSave;\n              if (!(Array.isArray(payload) && payload.length > 0)) {\n                _context30.next = 20;\n                break;\n              }\n              allDocs = [];\n              this._rows = [];\n              allKeys = {};\n              if (!this.allowChange && !this.allowEdit && !this.addNewRows && !this.allowDelete) {\n                this._document._autoSave = false;\n              }\n              _loop = /*#__PURE__*/_regeneratorRuntime().mark(function _loop() {\n                var document, docClone, addDocClone, primaryKey;\n                return _regeneratorRuntime().wrap(function _loop$(_context29) {\n                  while (1) switch (_context29.prev = _context29.next) {\n                    case 0:\n                      document = payload[i]; //let docClone = _.cloneDeep(this._document);\n                      docClone = _this7._document.cloneDoc(); //D.log({message: 'After clone', data: _.size(docClone.f)});\n                      allDocs.push(document);\n                      //this.addRow(docClone);\n                      if (_this7._document.hasSubDocs) {\n                        docClone.buildDocumentFromContainer(document);\n                      } else {\n                        docClone.buildDocument(document);\n                      }\n                      _context29.next = 6;\n                      return docClone.onPostLoad(docClone);\n                    case 6:\n                      addDocClone = function addDocClone(primaryKey) {\n                        if (!allKeys[primaryKey]) {\n                          _this7.addRow(docClone);\n                          allKeys[primaryKey] = true;\n                        }\n                      };\n                      primaryKey = _this7.document._state.sha1(JSON.stringify(docClone.getPrimaryKey()));\n                      addDocClone(primaryKey);\n                    case 9:\n                    case \"end\":\n                      return _context29.stop();\n                  }\n                }, _loop);\n              });\n              i = 0;\n            case 13:\n              if (!(i < payload.length)) {\n                _context30.next = 18;\n                break;\n              }\n              return _context30.delegateYield(_loop(), \"t0\", 15);\n            case 15:\n              i++;\n              _context30.next = 13;\n              break;\n            case 18:\n              this._document._autoSave = currentAutoSave;\n              return _context30.abrupt(\"return\", allDocs);\n            case 20:\n            case \"end\":\n              return _context30.stop();\n          }\n        }, _callee29, this);\n      }));\n      function buildTheDocsFromPayload(_x2) {\n        return _buildTheDocsFromPayload.apply(this, arguments);\n      }\n      return buildTheDocsFromPayload;\n    }()\n  }, {\n    key: \"loadCollectionWithQuery\",\n    value: function () {\n      var _loadCollectionWithQuery = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee30(_ref30) {\n        var _results;\n        var _ref30$action, action, _ref30$query, query, _ref30$projection, projection, _ref30$sort, sort, _ref30$skip, skip, _ref30$limit, limit, _ref30$collation, collation, results, _, D, payload;\n        return _regeneratorRuntime().wrap(function _callee30$(_context31) {\n          while (1) switch (_context31.prev = _context31.next) {\n            case 0:\n              _ref30$action = _ref30.action, action = _ref30$action === void 0 ? 'query' : _ref30$action, _ref30$query = _ref30.query, query = _ref30$query === void 0 ? {} : _ref30$query, _ref30$projection = _ref30.projection, projection = _ref30$projection === void 0 ? {} : _ref30$projection, _ref30$sort = _ref30.sort, sort = _ref30$sort === void 0 ? {} : _ref30$sort, _ref30$skip = _ref30.skip, skip = _ref30$skip === void 0 ? 0 : _ref30$skip, _ref30$limit = _ref30.limit, limit = _ref30$limit === void 0 ? 20 : _ref30$limit, _ref30$collation = _ref30.collation, collation = _ref30$collation === void 0 ? {} : _ref30$collation;\n              if (!this._subCollection) {\n                _context31.next = 4;\n                break;\n              }\n              this._state.addErrorToStack(7, 'We cannot retrieve data from subCollections');\n              return _context31.abrupt(\"return\");\n            case 4:\n              if (!this._local) {\n                _context31.next = 10;\n                break;\n              }\n              _context31.next = 7;\n              return this._state.deviceStorage.queryCollection(this.name);\n            case 7:\n              results = _context31.sent;\n              _context31.next = 15;\n              break;\n            case 10:\n              _ = this._state._;\n              D = this._state.developer; //console.log(\"Query 1\")\n              _context31.next = 14;\n              return this._state.db.getDataFromCollection({\n                collection: this.name,\n                action: action,\n                query: query,\n                projection: projection,\n                sort: sort,\n                skip: skip,\n                limit: limit,\n                collation: collation,\n                system: this._system,\n                cache: this._cache,\n                securedFields: this.document.getSecuredFieldsArray()\n              });\n            case 14:\n              results = _context31.sent;\n            case 15:\n              if (!(((_results = results) === null || _results === void 0 ? void 0 : _results.statusCode) === 200)) {\n                _context31.next = 18;\n                break;\n              }\n              payload = results.body; //console.log(\"Query 3\")\n              return _context31.abrupt(\"return\", this.buildTheDocsFromPayload(payload));\n            case 18:\n            case \"end\":\n              return _context31.stop();\n          }\n        }, _callee30, this);\n      }));\n      function loadCollectionWithQuery(_x3) {\n        return _loadCollectionWithQuery.apply(this, arguments);\n      }\n      return loadCollectionWithQuery;\n    }()\n  }, {\n    key: \"countCollectionWithQuery\",\n    value: function () {\n      var _countCollectionWithQuery = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee31(_ref31) {\n        var _ref31$query, query, _ref31$projection, projection, _ref31$collation, collation, results;\n        return _regeneratorRuntime().wrap(function _callee31$(_context32) {\n          while (1) switch (_context32.prev = _context32.next) {\n            case 0:\n              _ref31$query = _ref31.query, query = _ref31$query === void 0 ? {} : _ref31$query, _ref31$projection = _ref31.projection, projection = _ref31$projection === void 0 ? {} : _ref31$projection, _ref31$collation = _ref31.collation, collation = _ref31$collation === void 0 ? {} : _ref31$collation;\n              _context32.next = 3;\n              return this._state.db.countDataFromCollection({\n                collection: this.name,\n                query: query,\n                projection: projection,\n                collation: collation\n              });\n            case 3:\n              results = _context32.sent;\n              if (!(results.statusCode === 200)) {\n                _context32.next = 6;\n                break;\n              }\n              return _context32.abrupt(\"return\", results.body);\n            case 6:\n            case \"end\":\n              return _context32.stop();\n          }\n        }, _callee31, this);\n      }));\n      function countCollectionWithQuery(_x4) {\n        return _countCollectionWithQuery.apply(this, arguments);\n      }\n      return countCollectionWithQuery;\n    }()\n  }, {\n    key: \"loadCollectionFromIndex\",\n    value: function () {\n      var _loadCollectionFromIndex = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee32(queryObject, index) {\n        var _, D, payload;\n        return _regeneratorRuntime().wrap(function _callee32$(_context33) {\n          while (1) switch (_context33.prev = _context33.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              if (!index) index = this.intentId;\n              _context33.next = 5;\n              return this._state.db.getDataFromIndexWithQueryObject(index, queryObject);\n            case 5:\n              payload = _context33.sent;\n              D.log({\n                message: 'Results from ES query',\n                data: payload\n              });\n              if (!(_.get(payload, \"errorMessage\") || _.get(payload, \"error\"))) {\n                _context33.next = 11;\n                break;\n              }\n              return _context33.abrupt(\"return\");\n            case 11:\n              return _context33.abrupt(\"return\", this.buildTheDocsFromPayload(payload));\n            case 12:\n            case \"end\":\n              return _context33.stop();\n          }\n        }, _callee32, this);\n      }));\n      function loadCollectionFromIndex(_x5, _x6) {\n        return _loadCollectionFromIndex.apply(this, arguments);\n      }\n      return loadCollectionFromIndex;\n    }()\n  }, {\n    key: \"getQueryForSearch\",\n    value: function getQueryForSearch(queryString) {\n      var _ = this._state._;\n      var query = {};\n      var OR = '$or';\n      query[OR] = [];\n      _.forEach(this._document.fields, function (field) {\n        if (field.searchKey || field.primaryKey) {\n          var fieldQuery = {};\n          if (field.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_2__.FormFieldTypes.NUMBER_FIELD) {\n            fieldQuery[field.dbName || field.id] = parseInt(queryString, 10);\n          } else {\n            var regexSearch = {};\n            regexSearch['$regex'] = \"^(.*?)\".concat(queryString);\n            regexSearch['$options'] = \"i\";\n            fieldQuery[field.dbName || field.id] = regexSearch;\n          }\n          if (_.size(fieldQuery) > 0) {\n            query[OR].push(fieldQuery);\n          }\n        }\n      });\n      return query;\n    }\n  }, {\n    key: \"setParentDoc\",\n    value: function setParentDoc(parentDoc) {\n      if (parentDoc.dataType === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TYPES.DOC) {\n        this.isSubCollection = true;\n        this.parentDoc = parentDoc;\n        this._document.parentDocId = this._state.user.userId;\n        parentDoc.addChildDoc(this);\n      } else {\n        this._state.addSystemErrorToStack(7, \"Sub documents cannot be saved \".concat(this._intentId));\n      }\n    }\n  }, {\n    key: \"mapOptions\",\n    get: function get() {\n      return this._mapOptions;\n    }\n  }, {\n    key: \"activeQueryString\",\n    get: function get() {\n      return this._activeQueryString;\n    },\n    set: function set(activeQueryString) {\n      this._activeQueryString = activeQueryString;\n    }\n  }, {\n    key: \"startDate\",\n    get: function get() {\n      return this._startDate;\n    },\n    set: function set(startDate) {\n      this._startDate = startDate;\n    }\n  }, {\n    key: \"timeScaleView\",\n    get: function get() {\n      return this._timeScaleView;\n    },\n    set: function set(timeScaleView) {\n      this._timeScaleView = timeScaleView;\n    }\n  }, {\n    key: \"availableFilters\",\n    get: function get() {\n      return this._availableFilters;\n    },\n    set: function set(availableFilters) {\n      this._availableFilters = availableFilters;\n    }\n  }, {\n    key: \"activeFilterName\",\n    get: function get() {\n      return this._activeFilterName;\n    },\n    set: function set(activeFilterName) {\n      this._activeFilterName = activeFilterName;\n    }\n  }, {\n    key: \"parent\",\n    set: function set(parent) {\n      this._parent = parent;\n    }\n  }, {\n    key: \"tableId\",\n    get: function get() {\n      return this.intentId;\n    }\n  }, {\n    key: \"rows\",\n    get: function get() {\n      return this._rows;\n    },\n    set: function set(rows) {\n      this._rows = rows;\n    }\n  }, {\n    key: \"shared\",\n    get: function get() {\n      return this._rows;\n    },\n    set: function set(shared) {\n      this._shared = shared;\n    }\n  }, {\n    key: \"filteredColumns\",\n    get: function get() {\n      return this._filteredColumns;\n    },\n    set: function set(cols) {\n      this._filteredColumns = cols;\n    }\n  }, {\n    key: \"local\",\n    get: function get() {\n      return this._local;\n    },\n    set: function set(local) {\n      this._local = local;\n    }\n  }, {\n    key: \"insertRow\",\n    value: function insertRow(i, row) {\n      this._rows.splice(i, 0, row);\n    }\n  }, {\n    key: \"onMatching\",\n    get: function get() {\n      var _this8 = this;\n      return function (state) {\n        var _ = state._;\n        var D = state.developer;\n        var NO_VALUE = 'no value';\n        var action = _.get(state.messageFromUser, 'action');\n        var field = _.get(state.messageFromUser, 'currentFieldValue', _.get(state.messageFromUser, 'content.currentFieldValue', NO_VALUE));\n        return state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.RESPONSES.TABLE_RESPONSE && (state.messageFromUser.controlId === _this8.intentId || state.messageFromUser.tableId === _this8.intentId) && field === NO_VALUE && !(action && _Utils__WEBPACK_IMPORTED_MODULE_3__.Utils.IsFieldAction(action));\n      };\n    }\n  }, {\n    key: \"_callEvents\",\n    value: function () {\n      var _callEvents2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee33(state) {\n        return _regeneratorRuntime().wrap(function _callee33$(_context34) {\n          while (1) switch (_context34.prev = _context34.next) {\n            case 0:\n              if (this._parent && this._parent._intentId === state.currentControlId) {\n                state.currentControlId = this._parent._intentId;\n              } else {\n                state.currentControlId = this.intentId;\n              }\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_ACTION)) {\n                _context34.next = 6;\n                break;\n              }\n              _context34.next = 4;\n              return this.onAction();\n            case 4:\n              _context34.next = 137;\n              break;\n            case 6:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.QUICK_ACTION)) {\n                _context34.next = 11;\n                break;\n              }\n              _context34.next = 9;\n              return this.onQuickAction();\n            case 9:\n              _context34.next = 137;\n              break;\n            case 11:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_SELECTION)) {\n                _context34.next = 16;\n                break;\n              }\n              _context34.next = 14;\n              return this.onSelection();\n            case 14:\n              _context34.next = 137;\n              break;\n            case 16:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_SAVE)) {\n                _context34.next = 21;\n                break;\n              }\n              _context34.next = 19;\n              return this.onSave();\n            case 19:\n              _context34.next = 137;\n              break;\n            case 21:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.DISCARD)) {\n                _context34.next = 26;\n                break;\n              }\n              _context34.next = 24;\n              return this.onDiscard();\n            case 24:\n              _context34.next = 137;\n              break;\n            case 26:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CLOSE)) {\n                _context34.next = 31;\n                break;\n              }\n              _context34.next = 29;\n              return this.onClose();\n            case 29:\n              _context34.next = 137;\n              break;\n            case 31:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.SEARCH)) {\n                _context34.next = 36;\n                break;\n              }\n              _context34.next = 34;\n              return this.onSearch();\n            case 34:\n              _context34.next = 137;\n              break;\n            case 36:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_MENU_ACTION)) {\n                _context34.next = 41;\n                break;\n              }\n              _context34.next = 39;\n              return this.onMenuAction();\n            case 39:\n              _context34.next = 137;\n              break;\n            case 41:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_FIELD_ACTION)) {\n                _context34.next = 46;\n                break;\n              }\n              _context34.next = 44;\n              return this.onFieldAction();\n            case 44:\n              _context34.next = 137;\n              break;\n            case 46:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_REFRESH)) {\n                _context34.next = 51;\n                break;\n              }\n              _context34.next = 49;\n              return this.onRefresh();\n            case 49:\n              _context34.next = 137;\n              break;\n            case 51:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_DOWNLOAD)) {\n                _context34.next = 56;\n                break;\n              }\n              _context34.next = 54;\n              return this.onDownload();\n            case 54:\n              _context34.next = 137;\n              break;\n            case 56:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_CONFIRM)) {\n                _context34.next = 61;\n                break;\n              }\n              _context34.next = 59;\n              return this.onConfirm();\n            case 59:\n              _context34.next = 137;\n              break;\n            case 61:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_DELETE)) {\n                _context34.next = 66;\n                break;\n              }\n              _context34.next = 64;\n              return this.onDelete();\n            case 64:\n              _context34.next = 137;\n              break;\n            case 66:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_PREVIOUS_PAGE)) {\n                _context34.next = 71;\n                break;\n              }\n              _context34.next = 69;\n              return this.onPreviousPage();\n            case 69:\n              _context34.next = 137;\n              break;\n            case 71:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_NEXT_PAGE)) {\n                _context34.next = 76;\n                break;\n              }\n              _context34.next = 74;\n              return this.onNextPage();\n            case 74:\n              _context34.next = 137;\n              break;\n            case 76:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_FILTER_ACTION)) {\n                _context34.next = 81;\n                break;\n              }\n              _context34.next = 79;\n              return this.onFilter();\n            case 79:\n              _context34.next = 137;\n              break;\n            case 81:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_FILTER_DELETE_ACTION)) {\n                _context34.next = 86;\n                break;\n              }\n              _context34.next = 84;\n              return this.onFilterDelete();\n            case 84:\n              _context34.next = 137;\n              break;\n            case 86:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_EDIT_FILTER_ACTION)) {\n                _context34.next = 91;\n                break;\n              }\n              _context34.next = 89;\n              return this.onFilterEdit();\n            case 89:\n              _context34.next = 137;\n              break;\n            case 91:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TABLES.MULTIPLE_SELECTION_ACTION)) {\n                _context34.next = 96;\n                break;\n              }\n              _context34.next = 94;\n              return this.onMultipleSelection();\n            case 94:\n              _context34.next = 137;\n              break;\n            case 96:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TABLES.RENAME_FILTER_ACTION)) {\n                _context34.next = 101;\n                break;\n              }\n              _context34.next = 99;\n              return this.onRenameFilter();\n            case 99:\n              _context34.next = 137;\n              break;\n            case 101:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TABLES.CLEAR_FILTER_ACTION)) {\n                _context34.next = 106;\n                break;\n              }\n              _context34.next = 104;\n              return this.onClearFilter();\n            case 104:\n              _context34.next = 137;\n              break;\n            case 106:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TABLES.CLEAR_SEARCH_ACTION)) {\n                _context34.next = 111;\n                break;\n              }\n              _context34.next = 109;\n              return this.onClearSearch();\n            case 109:\n              _context34.next = 137;\n              break;\n            case 111:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_CREATE_OVERLAY)) {\n                _context34.next = 116;\n                break;\n              }\n              _context34.next = 114;\n              return this.onCreateOverlay();\n            case 114:\n              _context34.next = 137;\n              break;\n            case 116:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_EDIT_OVERLAY)) {\n                _context34.next = 121;\n                break;\n              }\n              _context34.next = 119;\n              return this.onEditOverlay();\n            case 119:\n              _context34.next = 137;\n              break;\n            case 121:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_DELETE_OVERLAY)) {\n                _context34.next = 126;\n                break;\n              }\n              _context34.next = 124;\n              return this.onDeleteOverlay();\n            case 124:\n              _context34.next = 137;\n              break;\n            case 126:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_SHOW_AREAS)) {\n                _context34.next = 131;\n                break;\n              }\n              _context34.next = 129;\n              return this.onShowAreas();\n            case 129:\n              _context34.next = 137;\n              break;\n            case 131:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_TOP_MENU_ACTION)) {\n                _context34.next = 136;\n                break;\n              }\n              _context34.next = 134;\n              return this.onTopMenuAction();\n            case 134:\n              _context34.next = 137;\n              break;\n            case 136:\n              state.addSystemErrorToStack(28, _Error__WEBPACK_IMPORTED_MODULE_4__.Error.getErrorMessageforCodeAndLang(28));\n            case 137:\n              if (state.responsesArray.length === 0) {\n                state.addSilentResponse();\n              }\n            case 138:\n            case \"end\":\n              return _context34.stop();\n          }\n        }, _callee33, this);\n      }));\n      function _callEvents(_x7) {\n        return _callEvents2.apply(this, arguments);\n      }\n      return _callEvents;\n    }()\n  }, {\n    key: \"onResolution\",\n    get: function get() {\n      var _this9 = this;\n      var _ = this.document._state._;\n      var D = this.document._state.developer;\n      return /*#__PURE__*/function () {\n        var _ref32 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee34(state) {\n          var docId, parentDocId, tabId, docToBuild, docToRestore, rawDocToRestore, _docToRestore, _rawDocToRestore, _docToRestore2, _rawDocToRestore2;\n          return _regeneratorRuntime().wrap(function _callee34$(_context35) {\n            while (1) switch (_context35.prev = _context35.next) {\n              case 0:\n                docId = _.get(state.messageFromUser, 'docId');\n                parentDocId = _.get(state.messageFromUser, 'parentDocId');\n                if (!docId && parentDocId) {\n                  docId = parentDocId;\n                }\n                if (docId) {\n                  tabId = _.get(state.messageFromUser, 'tabId');\n                  _this9.document.loadDocFromAutoSaveBuffer(tabId, docId, parentDocId);\n                  if (state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_DELETE || state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.DISCARD && state.messageFromUser.newRow) {\n                    docToBuild = _.get(state.messageFromUser, \"content.\".concat(docId));\n                    docToRestore = _Utils__WEBPACK_IMPORTED_MODULE_3__.Utils.formResponseAsObject(docToBuild);\n                    _this9.document.docId = docId;\n                    _this9.document.buildDocument(docToRestore, true);\n                    _this9.document.clearAutoSaveBuffer(tabId, docId, parentDocId);\n                  } else if (state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.DISCARD && !state.messageFromUser.newRow) {\n                    rawDocToRestore = _.get(state.messageFromUser, \"content.\".concat(docId));\n                    _docToRestore = _Utils__WEBPACK_IMPORTED_MODULE_3__.Utils.formResponseAsObject(rawDocToRestore);\n                    _this9.document.docId = docId;\n                    _this9.document.buildDocument(_docToRestore, true);\n                  } else if (state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_SAVE) {\n                    _rawDocToRestore = _.get(state.messageFromUser, \"content\");\n                    D.log({\n                      message: \"rawDocToRestore\",\n                      data: _rawDocToRestore\n                    });\n                    _docToRestore2 = _Utils__WEBPACK_IMPORTED_MODULE_3__.Utils.formResponseAsObject({\n                      fields: _rawDocToRestore\n                    });\n                    D.log({\n                      message: \"docToRestore\",\n                      data: _docToRestore2\n                    });\n                    _this9.document.docId = docId;\n                    _this9.document.buildDocument(_docToRestore2, true, true);\n                    D.log({\n                      message: \"builtDocument\",\n                      data: _this9.document.document\n                    });\n                  } else if (state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ON_MENU_ACTION) {\n                    _rawDocToRestore2 = _.get(state.messageFromUser, \"content.row\");\n                    _this9.document.docId = docId;\n                    _this9.document.buildDocument(_rawDocToRestore2, true, true);\n                  }\n\n                  //console.log(\"Document \" + JSON.stringify(this.document.document));\n                }\n                _context35.next = 6;\n                return _this9._callEvents(state);\n              case 6:\n              case \"end\":\n                return _context35.stop();\n            }\n          }, _callee34);\n        }));\n        return function (_x8) {\n          return _ref32.apply(this, arguments);\n        };\n      }();\n    }\n  }]);\n  return Collection;\n}(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Collection.js?");

/***/ }),

/***/ "../../frontmjs/core/Companies.js":
/*!****************************************!*\
  !*** ../../frontmjs/core/Companies.js ***!
  \****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Companies: function() { return /* binding */ Companies; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Companies = /*#__PURE__*/function () {\n  function Companies(state) {\n    _classCallCheck(this, Companies);\n    this['_state'] = state;\n    this['_'] = state._;\n  }\n  _createClass(Companies, [{\n    key: \"callCreateCompanyCapability\",\n    value: function callCreateCompanyCapability(params) {\n      var capabilities = this._state.context.capabilities.capabilities;\n      var capFileName = params.capabilityFileName;\n      var capabilityModule = capabilities[capFileName];\n      return capabilityModule.execute(params, this._state.context.capabilities);\n    }\n  }, {\n    key: \"createChildCompany\",\n    value: function createChildCompany(_ref) {\n      var _this = this;\n      var companyAddress = _ref.companyAddress,\n        companyName = _ref.companyName,\n        phoneNumbers = _ref.phoneNumbers,\n        contractDuration = _ref.contractDuration,\n        account = _ref.account;\n      var companyId = this._state.getUniqueId();\n      var params = {\n        capability: 'CompanyCapability',\n        capabilityFileName: 'companyCapability',\n        sync: true,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation,\n        action: 'createCompany',\n        company: {\n          companyAddress: companyAddress,\n          companyId: companyId,\n          companyName: companyName,\n          phoneNumbers: phoneNumbers,\n          contractDuration: contractDuration,\n          account: account\n        },\n        companyDomain: {\n          userDomain: this._state.currentUserDomain\n        }\n      };\n      return this.callCreateCompanyCapability(params).then(function (response) {\n        _this._state.developer.info({\n          message: 'After created company',\n          data: response\n        });\n        if (_this._.get(response, 'status')) {\n          return {\n            status: true,\n            companyId: companyId\n          };\n        } else {\n          return {\n            status: false,\n            errorMessage: _this._.get(_this._state._.compact(response), 'errorMessage', 'There was a problem creating the company')\n          };\n        }\n      });\n    }\n  }, {\n    key: \"addOfferToCompany\",\n    value: function addOfferToCompany(_ref2) {\n      var _this2 = this;\n      var companyId = _ref2.companyId,\n        verificationCode = _ref2.verificationCode,\n        validFrom = _ref2.validFrom,\n        validTo = _ref2.validTo,\n        maxUsersPerLicense = _ref2.maxUsersPerLicense,\n        offers = _ref2.offers,\n        offerType = _ref2.offerType,\n        description = _ref2.description,\n        role = _ref2.role;\n      var params = {\n        capability: 'CompanyCapability',\n        capabilityFileName: 'companyCapability',\n        sync: true,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation,\n        action: 'createCompany',\n        company: {\n          companyId: companyId\n        },\n        companyDomain: {\n          userDomain: this._state.currentUserDomain\n        },\n        userOffers: [{\n          verificationCode: verificationCode,\n          offerType: offerType,\n          description: description,\n          role: role,\n          valid_from: validFrom,\n          valid_to: validTo,\n          codeUsage: {\n            maximum: maxUsersPerLicense\n          },\n          offers: offers\n        }]\n      };\n      return this.callCreateCompanyCapability(params).then(function (response) {\n        _this2._state.developer.info({\n          message: 'After added offer to company',\n          data: response\n        });\n        if (_this2._.get(response, 'status')) {\n          return {\n            status: true,\n            companyId: companyId\n          };\n        } else {\n          return {\n            status: false,\n            errorMessage: _this2._.get(_this2._state._.compact(response), 'errorMessage', 'There was a problem creating the company')\n          };\n        }\n      });\n    }\n  }]);\n  return Companies;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Companies.js?");

/***/ }),

/***/ "../../frontmjs/core/ContactCentre.js":
/*!********************************************!*\
  !*** ../../frontmjs/core/ContactCentre.js ***!
  \********************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContactCentre: function() { return /* binding */ ContactCentre; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nvar ContactCentre = /*#__PURE__*/function () {\n  function ContactCentre(state) {\n    _classCallCheck(this, ContactCentre);\n    this['_state'] = state;\n    this['_'] = state._;\n  }\n  _createClass(ContactCentre, [{\n    key: \"getBotIDs\",\n    value: function () {\n      var _getBotIDs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(key) {\n        var query, response, items, botIDs;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              query = [{\n                operand: 'dataKey',\n                value: key,\n                operator: 'eq'\n              }];\n              _context.next = 3;\n              return this._state.db.getStaticData(query);\n            case 3:\n              response = _context.sent;\n              items = this._.get(response, 'items');\n              if (!(Array.isArray(items) && items.length > 0)) {\n                _context.next = 9;\n                break;\n              }\n              botIDs = items[0].value;\n              if (!(this._.size(botIDs) > 0)) {\n                _context.next = 9;\n                break;\n              }\n              return _context.abrupt(\"return\", botIDs);\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function getBotIDs(_x) {\n        return _getBotIDs.apply(this, arguments);\n      }\n      return getBotIDs;\n    }()\n  }, {\n    key: \"loadContactCentreTeam\",\n    value: function () {\n      var _loadContactCentreTeam = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(contactCentreBotId) {\n        var SHIFT_MANAGER_KEY_PREFIX, pattern, response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!contactCentreBotId) {\n                _context2.next = 13;\n                break;\n              }\n              _context2.prev = 1;\n              SHIFT_MANAGER_KEY_PREFIX = 'CONTACT_CENTRE_SHIFT_';\n              pattern = \"\".concat(SHIFT_MANAGER_KEY_PREFIX, \"_\").concat(contactCentreBotId, \"*\"); //console.log(pattern);\n              _context2.next = 6;\n              return this._state.db.getKeysOnPattern(pattern);\n            case 6:\n              response = _context2.sent;\n              return _context2.abrupt(\"return\", response);\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](1);\n              state.addSystemErrorToStack(100, \"Error reading call centre staff \".concat(this._state.R.toString(_context2.t0)));\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[1, 10]]);\n      }));\n      function loadContactCentreTeam(_x2) {\n        return _loadContactCentreTeam.apply(this, arguments);\n      }\n      return loadContactCentreTeam;\n    }()\n  }, {\n    key: \"getTranscriptionForCurrentConversation\",\n    value: function () {\n      var _getTranscriptionForCurrentConversation = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref) {\n        var epochTime, bot, conversation, params;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              epochTime = _ref.epochTime, bot = _ref.bot, conversation = _ref.conversation;\n              params = {\n                capability: 'ArchivedMessagesReader',\n                action: 'getPaginatedMessages',\n                // parameters: {\n                //   startTime: epochTime || 1,\n                // },\n                conversationId: this._state._.get(conversation, 'conversationId') || this._state.conversationId,\n                bot: bot || this._state.conversation.bot,\n                sync: true,\n                conversation: conversation || this._state.conversation,\n                capabilityDomain: this._state.currentUserDomain,\n                userEmail: this._state.user.userEmail,\n                userId: this._state.user.userId,\n                userDomain: this._state.userDomains\n              };\n              return _context3.abrupt(\"return\", this._state.callLambda('ArchivedMessagesReader', params, 'RequestResponse').then(function (response) {\n                var payload = JSON.parse(response.Payload);\n                //console.log(this._state.R.toString(response));\n                return payload;\n              }));\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function getTranscriptionForCurrentConversation(_x3) {\n        return _getTranscriptionForCurrentConversation.apply(this, arguments);\n      }\n      return getTranscriptionForCurrentConversation;\n    }()\n  }, {\n    key: \"addEntryToContactCentreQueue\",\n    value: function () {\n      var _addEntryToContactCentreQueue = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(entry, contactCentreBot, overrideBotId, customQueue) {\n        var chatForm, conversationToQueue, CONTACT_CENTRE_CACHE, OPEN_STATUS, key;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              chatForm = this._state._.cloneDeep(entry);\n              chatForm.botDetails = this._state._.cloneDeep(contactCentreBot);\n              chatForm.userId = this._state.user.userId;\n              conversationToQueue = {\n                ticket: Math.round(Math.random() * (99999999 - 1) + 1),\n                content: chatForm,\n                createdOn: Date.now(),\n                open: true,\n                status: ContactCentre.WAITING_STATUS(),\n                botId: overrideBotId || this._state.conversation.bot,\n                conversationId: this._state.conversationId,\n                userId: this._state.user.userId\n              };\n              CONTACT_CENTRE_CACHE = 'CONTACT_CENTRE_';\n              OPEN_STATUS = 'open';\n              key = \"\".concat(CONTACT_CENTRE_CACHE, \"_\").concat(OPEN_STATUS, \"_\").concat(overrideBotId || this._state.conversation.bot, \"_\").concat(customQueue || \"\", \"_\").concat(this._state.conversationId);\n              _context4.next = 10;\n              return this._state.db.setOneValueInCacheWithExpiry(key, conversationToQueue, 3600 * 24 * 7);\n            case 10:\n              return _context4.abrupt(\"return\", conversationToQueue);\n            case 13:\n              _context4.prev = 13;\n              _context4.t0 = _context4[\"catch\"](0);\n              this._state.addSystemErrorToStack(5, \"Error adding entry to queue \".concat(_context4.t0));\n            case 16:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[0, 13]]);\n      }));\n      function addEntryToContactCentreQueue(_x4, _x5, _x6, _x7) {\n        return _addEntryToContactCentreQueue.apply(this, arguments);\n      }\n      return addEntryToContactCentreQueue;\n    }()\n  }, {\n    key: \"closeEntryInContactCentreQueue\",\n    value: function () {\n      var _closeEntryInContactCentreQueue = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(entry, customQueue) {\n        var CONTACT_CENTRE_CACHE, OPEN_STATUS, key;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              entry.open = false;\n              entry.owner = this._state.user.userId;\n              CONTACT_CENTRE_CACHE = 'CONTACT_CENTRE_';\n              OPEN_STATUS = 'open';\n              key = \"\".concat(CONTACT_CENTRE_CACHE, \"_\").concat(OPEN_STATUS, \"_\").concat(entry.botId, \"_\").concat(customQueue || \"\", \"_\").concat(entry.conversationId);\n              _context5.next = 7;\n              return this._state.db.setOneValueInCacheWithExpiry(key, entry, 3600 * 24 * 7);\n            case 7:\n              return _context5.abrupt(\"return\", entry);\n            case 8:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function closeEntryInContactCentreQueue(_x8, _x9) {\n        return _closeEntryInContactCentreQueue.apply(this, arguments);\n      }\n      return closeEntryInContactCentreQueue;\n    }()\n  }, {\n    key: \"changeQueueEntryStatus\",\n    value: function () {\n      var _changeQueueEntryStatus = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(entry, status, customQueue) {\n        var CONTACT_CENTRE_CACHE, OPEN_STATUS, key;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              entry.status = status;\n              CONTACT_CENTRE_CACHE = 'CONTACT_CENTRE_';\n              OPEN_STATUS = 'open';\n              key = \"\".concat(CONTACT_CENTRE_CACHE, \"_\").concat(OPEN_STATUS, \"_\").concat(entry.botId, \"_\").concat(customQueue || \"\", \"_\").concat(entry.conversationId);\n              _context6.next = 6;\n              return this._state.db.setOneValueInCacheWithExpiry(key, entry, 3600 * 24 * 7);\n            case 6:\n              return _context6.abrupt(\"return\", entry);\n            case 7:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function changeQueueEntryStatus(_x10, _x11, _x12) {\n        return _changeQueueEntryStatus.apply(this, arguments);\n      }\n      return changeQueueEntryStatus;\n    }()\n  }, {\n    key: \"changeQueueVideoSessionId\",\n    value: function () {\n      var _changeQueueVideoSessionId = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(entry, videoSessionId, customQueue) {\n        var CONTACT_CENTRE_CACHE, OPEN_STATUS, key;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              entry.content.videoSessionId = videoSessionId;\n              CONTACT_CENTRE_CACHE = 'CONTACT_CENTRE_';\n              OPEN_STATUS = 'open';\n              key = \"\".concat(CONTACT_CENTRE_CACHE, \"_\").concat(OPEN_STATUS, \"_\").concat(entry.botId, \"_\").concat(customQueue || \"\", \"_\").concat(entry.conversationId);\n              _context7.next = 6;\n              return this._state.db.setOneValueInCacheWithExpiry(key, entry, 3600 * 24 * 7);\n            case 6:\n              return _context7.abrupt(\"return\", entry);\n            case 7:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function changeQueueVideoSessionId(_x13, _x14, _x15) {\n        return _changeQueueVideoSessionId.apply(this, arguments);\n      }\n      return changeQueueVideoSessionId;\n    }()\n  }, {\n    key: \"storeQueueEntry\",\n    value: function () {\n      var _storeQueueEntry = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(entry, customQueue) {\n        var CONTACT_CENTRE_CACHE, OPEN_STATUS, key;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              CONTACT_CENTRE_CACHE = 'CONTACT_CENTRE_';\n              OPEN_STATUS = 'open';\n              key = \"\".concat(CONTACT_CENTRE_CACHE, \"_\").concat(OPEN_STATUS, \"_\").concat(entry.botId, \"_\").concat(customQueue || \"\", \"_\").concat(entry.conversationId);\n              _context8.next = 5;\n              return this._state.db.setOneValueInCacheWithExpiry(key, entry, 3600 * 24 * 7);\n            case 5:\n              return _context8.abrupt(\"return\", entry);\n            case 6:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function storeQueueEntry(_x16, _x17) {\n        return _storeQueueEntry.apply(this, arguments);\n      }\n      return storeQueueEntry;\n    }()\n  }, {\n    key: \"loadConversationsInQueue\",\n    value: function () {\n      var _loadConversationsInQueue = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(botId) {\n        var botToLoad, CONTACT_CENTRE_CACHE, OPEN_STATUS, pattern, response, parsedResponse, R;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.prev = 0;\n              botToLoad = botId || this._state.conversation.bot;\n              CONTACT_CENTRE_CACHE = 'CONTACT_CENTRE_';\n              OPEN_STATUS = 'open';\n              pattern = \"\".concat(CONTACT_CENTRE_CACHE, \"_\").concat(OPEN_STATUS, \"_\").concat(botToLoad, \"*\");\n              _context9.next = 7;\n              return this._state.db.getKeysOnPattern(pattern);\n            case 7:\n              response = _context9.sent;\n              parsedResponse = [];\n              R = this._state.R;\n              this._state._.forEach(response, function (conversation) {\n                var parsedConversation = JSON.parse(conversation.content);\n                var i = 0;\n                while (i < parsedResponse.length && parsedConversation.createdOn > parsedResponse[i].createdOn) {\n                  i++;\n                }\n                parsedResponse.splice(i, 0, parsedConversation);\n              });\n              return _context9.abrupt(\"return\", parsedResponse);\n            case 14:\n              _context9.prev = 14;\n              _context9.t0 = _context9[\"catch\"](0);\n              this._state.addSystemErrorToStack(100, \"Error reading conversations \".concat(this._state.R.toString(_context9.t0)));\n            case 17:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this, [[0, 14]]);\n      }));\n      function loadConversationsInQueue(_x18) {\n        return _loadConversationsInQueue.apply(this, arguments);\n      }\n      return loadConversationsInQueue;\n    }()\n  }, {\n    key: \"getQueueEntry\",\n    value: function () {\n      var _getQueueEntry = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(_ref2) {\n        var videoSessionId, botId, ticket, parsedQueue, index, i;\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              videoSessionId = _ref2.videoSessionId, botId = _ref2.botId, ticket = _ref2.ticket;\n              _context10.next = 3;\n              return this.loadConversationsInQueue(botId);\n            case 3:\n              parsedQueue = _context10.sent;\n              //console.log('Queue to search for ' + this._state.R.toString(parsedQueue));\n              //console.log(videoSessionId);\n              index = -1;\n              for (i = 0; i < parsedQueue.length; i++) {\n                if (videoSessionId && parsedQueue[i].content.videoSessionId === videoSessionId || ticket && parsedQueue[i].ticket === ticket) {\n                  index = i;\n                }\n              }\n              //console.log(index);\n              return _context10.abrupt(\"return\", parsedQueue[index]);\n            case 7:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function getQueueEntry(_x19) {\n        return _getQueueEntry.apply(this, arguments);\n      }\n      return getQueueEntry;\n    }()\n  }, {\n    key: \"loadConversationsForBot\",\n    value: function () {\n      var _loadConversationsForBot = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(botId, pagination, sort) {\n        var size, from, docQuery, rangeDuration, allConversations, finalResponse;\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) switch (_context11.prev = _context11.next) {\n            case 0:\n              _context11.prev = 0;\n              size = this._state._.get(pagination, 'size') || 6;\n              from = this._state._.get(pagination, 'from') || 0; //let sqlQuery = {};\n              docQuery = {\n                _source: ['conversationId', 'createdOn', 'modifiedOn', 'duration'],\n                query: {\n                  bool: {\n                    must: {\n                      term: {\n                        bot: botId\n                      }\n                    }\n                  }\n                },\n                sort: {\n                  createdOn: {\n                    order: 'desc'\n                  }\n                },\n                size: size\n              };\n              rangeDuration = {\n                duration: {\n                  gte: 10000\n                }\n              };\n              if (from === 0) {\n                docQuery.query.bool.filter = {\n                  range: rangeDuration\n                };\n              } else {\n                docQuery.query.bool.filter = [{\n                  range: rangeDuration\n                }, {\n                  range: {\n                    createdOn: {\n                      lt: from\n                    }\n                  }\n                }];\n              }\n              //let allConversations = await this._state.db.getDataFromIndexWithSQL(sqlQuery);\n              _context11.next = 8;\n              return this._state.db.getDataFromIndexWithQueryObject(DB.CONVERSATIONS_INDEX(), docQuery);\n            case 8:\n              allConversations = _context11.sent;\n              finalResponse = [];\n              this._state._.forEach(allConversations, function (conversation) {\n                // conversation.state = JSON.parse(conversation.state);\n                // conversation.lastMessage = JSON.parse(conversation.lastMessage);\n                finalResponse.push(conversation);\n              });\n              return _context11.abrupt(\"return\", finalResponse);\n            case 14:\n              _context11.prev = 14;\n              _context11.t0 = _context11[\"catch\"](0);\n              this._state.addSystemErrorToStack(100, \"Error reading conversations \".concat(this._state.R.toString(_context11.t0)));\n            case 17:\n            case \"end\":\n              return _context11.stop();\n          }\n        }, _callee11, this, [[0, 14]]);\n      }));\n      function loadConversationsForBot(_x20, _x21, _x22) {\n        return _loadConversationsForBot.apply(this, arguments);\n      }\n      return loadConversationsForBot;\n    }()\n  }, {\n    key: \"loadConversationData\",\n    value: function () {\n      var _loadConversationData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(conversationId) {\n        var tableName, query;\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              _context12.prev = 0;\n              tableName = 'Conversations'; //console.log(tableName);\n              query = [{\n                operand: 'conversationId',\n                value: conversationId,\n                operator: 'eq'\n              }];\n              return _context12.abrupt(\"return\", this._state.db.getData(tableName, query));\n            case 6:\n              _context12.prev = 6;\n              _context12.t0 = _context12[\"catch\"](0);\n              this._state.addSystemErrorToStack(100, \"Error reading conversations \".concat(this._state.R.toString(_context12.t0)));\n            case 9:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this, [[0, 6]]);\n      }));\n      function loadConversationData(_x23) {\n        return _loadConversationData.apply(this, arguments);\n      }\n      return loadConversationData;\n    }()\n  }, {\n    key: \"getConfigurationForKey\",\n    value: function () {\n      var _getConfigurationForKey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(key) {\n        var _this = this;\n        var query, returnResponse, STATIC_DATA, response, _response;\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              query = [{\n                operand: 'dataKey',\n                value: key,\n                operator: 'eq'\n              }];\n              returnResponse = function returnResponse(response) {\n                var items = _this._state._.get(response, 'items');\n                if (Array.isArray(items) && items.length > 0) {\n                  var botIDs = items[0].value;\n                  return botIDs;\n                }\n              }; //console.log('Checking static data');\n              STATIC_DATA = 'staticData';\n              if (!(this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT || this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE && this._state.v1Compatibility)) {\n                _context13.next = 11;\n                break;\n              }\n              _context13.next = 6;\n              return this._state.db.getStaticData(query);\n            case 6:\n              response = _context13.sent;\n              this._state.addObjectToSyncMessage(STATIC_DATA, key, response);\n              return _context13.abrupt(\"return\", returnResponse(response));\n            case 11:\n              //console.log('Reading from local');\n              this._state.developer.log({\n                message: 'Reading from local'\n              });\n              _context13.next = 14;\n              return this._state.deviceStorage.loadDocument(STATIC_DATA, this._state.sha1(key));\n            case 14:\n              _response = _context13.sent;\n              return _context13.abrupt(\"return\", returnResponse(_response));\n            case 16:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this);\n      }));\n      function getConfigurationForKey(_x24) {\n        return _getConfigurationForKey.apply(this, arguments);\n      }\n      return getConfigurationForKey;\n    }()\n  }], [{\n    key: \"WAITING_STATUS\",\n    value: function WAITING_STATUS() {\n      return 'Waiting';\n    }\n  }, {\n    key: \"WAITING_VESSEL_STATUS\",\n    value: function WAITING_VESSEL_STATUS() {\n      return 'WaitingVessel';\n    }\n  }, {\n    key: \"ACTIVE_STATUS\",\n    value: function ACTIVE_STATUS() {\n      return 'Active';\n    }\n  }, {\n    key: \"ENDED_STATUS\",\n    value: function ENDED_STATUS() {\n      return 'Ended';\n    }\n  }, {\n    key: \"MISSED_STATUS\",\n    value: function MISSED_STATUS() {\n      return 'Missed';\n    }\n  }, {\n    key: \"MISSED_CALL_TEXT\",\n    value: function MISSED_CALL_TEXT() {\n      return 'Missed call';\n    }\n  }, {\n    key: \"CONTACT_CENTRE_APP\",\n    value: function CONTACT_CENTRE_APP() {\n      return 'callCentreBot';\n    }\n  }, {\n    key: \"CLIENT_APP\",\n    value: function CLIENT_APP() {\n      return 'clientBot';\n    }\n  }, {\n    key: \"MANAGER_APP\",\n    value: function MANAGER_APP() {\n      return 'shiftManagerBot';\n    }\n  }]);\n  return ContactCentre;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/ContactCentre.js?");

/***/ }),

/***/ "../../frontmjs/core/Contacts.js":
/*!***************************************!*\
  !*** ../../frontmjs/core/Contacts.js ***!
  \***************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Contacts: function() { return /* binding */ Contacts; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nvar Contacts = /*#__PURE__*/function () {\n  function Contacts(state) {\n    _classCallCheck(this, Contacts);\n    this['_state'] = state;\n    this['_'] = state._;\n    if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n      this['contactCapability'] = this._state.context.getCapability('Contact');\n    }\n  }\n  _createClass(Contacts, [{\n    key: \"refreshContactsOnEdge\",\n    value: function refreshContactsOnEdge() {\n      if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n        this.contactCapability.refreshContacts();\n      } else {\n        this._state.addSystemErrorToStack(18);\n      }\n    }\n  }, {\n    key: \"getAllContactsFromEdge\",\n    value: function getAllContactsFromEdge() {\n      return this.contactCapability.getAddedContacts().then(function (contactIds) {\n        return contactIds;\n      });\n    }\n  }, {\n    key: \"getAllContactsFromBackend\",\n    value: function getAllContactsFromBackend() {\n      var params = {\n        capability: 'GetContacts',\n        capabilityFileName: 'contactsListCapability',\n        userDomain: this._state.conversation.userDomain,\n        sync: true,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation\n      };\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"syncContacts\",\n    value: function () {\n      var _syncContacts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(usersToSync, userId) {\n        var params, lambda, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              params = {\n                userId: userId || this._state.user.userId,\n                usersToSync: usersToSync\n              };\n              _context.prev = 1;\n              lambda = this._state.frontmlib;\n              _context.next = 5;\n              return lambda.invokeLambda(\"SyncContacts\", \"RequestResponse\", params);\n            case 5:\n              response = _context.sent;\n              return _context.abrupt(\"return\", response);\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](1);\n              this._state.addSystemErrorToStack(7, \"Error in sync contacts\");\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[1, 9]]);\n      }));\n      function syncContacts(_x, _x2) {\n        return _syncContacts.apply(this, arguments);\n      }\n      return syncContacts;\n    }()\n  }]);\n  return Contacts;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Contacts.js?");

/***/ }),

/***/ "../../frontmjs/core/DB.js":
/*!*********************************!*\
  !*** ../../frontmjs/core/DB.js ***!
  \*********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DB: function() { return /* binding */ DB; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _State__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./State */ \"../../frontmjs/core/State.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\nvar DB = /*#__PURE__*/function () {\n  function DB(state) {\n    _classCallCheck(this, DB);\n    this['_state'] = state;\n    this['_'] = state._;\n  }\n  _createClass(DB, [{\n    key: \"checkMongoResponse\",\n    value: function () {\n      var _checkMongoResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(response, params, cache, audit, expectOneResult, operation, sync) {\n        var D, results, parsedResponse, auditDoc, _, payload;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              D = this._state.developer;\n              results = response.Payload; //In case of async lambda calls, there is no Payload\n              parsedResponse = results ? JSON.parse(results) : {\n                statusCode: 200\n              };\n              if (!(parsedResponse.statusCode === 500)) {\n                _context.next = 7;\n                break;\n              }\n              this._state.addSystemErrorToStack(7, \"Error in database with error \" + response.Payload);\n              _context.next = 12;\n              break;\n            case 7:\n              auditDoc = params.document;\n              if (params.query) {\n                _ = this._state._;\n                auditDoc = _.merge(auditDoc, params.query);\n              }\n              _context.next = 11;\n              return this.writeAuditIndex(params.collection, auditDoc, audit, operation, sync);\n            case 11:\n              if (cache) {\n                payload = parsedResponse.body;\n                if (payload === 'success' && params.document || Array.isArray(payload) && payload.length > 0 && expectOneResult) {\n                  if (payload === 'success') {\n                    parsedResponse.body = [params.document];\n                  }\n                }\n                this._state.addObjectToSyncMessage(params.collection, JSON.stringify(params), parsedResponse);\n              }\n            case 12:\n              return _context.abrupt(\"return\", parsedResponse);\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function checkMongoResponse(_x, _x2, _x3, _x4, _x5, _x6, _x7) {\n        return _checkMongoResponse.apply(this, arguments);\n      }\n      return checkMongoResponse;\n    }()\n  }, {\n    key: \"bulkWriteToCollection\",\n    value: function () {\n      var _bulkWriteToCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref) {\n        var collection, documents, params, lambda, response, results, parsedResponse;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              collection = _ref.collection, documents = _ref.documents;\n              params = {\n                action: 'bulkWrite',\n                db: this._state.currentUserDomain,\n                // no bulk writes to system domain\n                collection: collection,\n                documents: documents,\n                userId: this._state.user.userId\n              };\n              _context2.t0 = this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT;\n              if (_context2.t0) {\n                _context2.next = 7;\n                break;\n              }\n              _context2.next = 6;\n              return this._state.online();\n            case 6:\n              _context2.t0 = _context2.sent;\n            case 7:\n              if (!_context2.t0) {\n                _context2.next = 19;\n                break;\n              }\n              lambda = this._state.frontmlib;\n              _context2.next = 11;\n              return lambda.invokeLambda('MongoDBManager', 'RequestResponse', params);\n            case 11:\n              response = _context2.sent;\n              results = response.Payload;\n              parsedResponse = JSON.parse(results);\n              if (!(parsedResponse.statusCode === 500)) {\n                _context2.next = 18;\n                break;\n              }\n              this._state.addSystemErrorToStack(7, \"Error in database with error \" + response.Payload);\n              _context2.next = 19;\n              break;\n            case 18:\n              return _context2.abrupt(\"return\", parsedResponse);\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function bulkWriteToCollection(_x8) {\n        return _bulkWriteToCollection.apply(this, arguments);\n      }\n      return bulkWriteToCollection;\n    }()\n  }, {\n    key: \"countDataFromCollection\",\n    value: function () {\n      var _countDataFromCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref2) {\n        var collection, _ref2$query, query, _ref2$projection, projection, collation, _ref2$system, system, params, lambda, response, results, parsedResponse;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              collection = _ref2.collection, _ref2$query = _ref2.query, query = _ref2$query === void 0 ? {} : _ref2$query, _ref2$projection = _ref2.projection, projection = _ref2$projection === void 0 ? {} : _ref2$projection, collation = _ref2.collation, _ref2$system = _ref2.system, system = _ref2$system === void 0 ? false : _ref2$system;\n              params = {\n                action: 'count',\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                query: query,\n                projection: projection,\n                collation: collation,\n                userId: this._state.user.userId\n              };\n              _context3.t0 = this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT;\n              if (_context3.t0) {\n                _context3.next = 7;\n                break;\n              }\n              _context3.next = 6;\n              return this._state.online();\n            case 6:\n              _context3.t0 = _context3.sent;\n            case 7:\n              if (!_context3.t0) {\n                _context3.next = 19;\n                break;\n              }\n              lambda = this._state.frontmlib;\n              _context3.next = 11;\n              return lambda.invokeLambda('MongoDBManager', 'RequestResponse', params);\n            case 11:\n              response = _context3.sent;\n              results = response.Payload;\n              parsedResponse = JSON.parse(results);\n              if (!(parsedResponse.statusCode === 500)) {\n                _context3.next = 18;\n                break;\n              }\n              this._state.addSystemErrorToStack(7, \"Error in database with error \" + response.Payload);\n              _context3.next = 19;\n              break;\n            case 18:\n              return _context3.abrupt(\"return\", parsedResponse);\n            case 19:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function countDataFromCollection(_x9) {\n        return _countDataFromCollection.apply(this, arguments);\n      }\n      return countDataFromCollection;\n    }()\n  }, {\n    key: \"getDataFromCollection\",\n    value: function () {\n      var _getDataFromCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref3) {\n        var collection, _ref3$action, action, _ref3$query, query, _ref3$projection, projection, _ref3$sort, sort, _ref3$skip, skip, _ref3$limit, limit, collation, _ref3$expectOneResult, expectOneResult, _ref3$cache, cache, _ref3$system, system, _ref3$local, local, securedFields, params, lambda, response, hashedKey, fromStorage;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              collection = _ref3.collection, _ref3$action = _ref3.action, action = _ref3$action === void 0 ? 'query' : _ref3$action, _ref3$query = _ref3.query, query = _ref3$query === void 0 ? {} : _ref3$query, _ref3$projection = _ref3.projection, projection = _ref3$projection === void 0 ? {} : _ref3$projection, _ref3$sort = _ref3.sort, sort = _ref3$sort === void 0 ? {} : _ref3$sort, _ref3$skip = _ref3.skip, skip = _ref3$skip === void 0 ? 0 : _ref3$skip, _ref3$limit = _ref3.limit, limit = _ref3$limit === void 0 ? 20 : _ref3$limit, collation = _ref3.collation, _ref3$expectOneResult = _ref3.expectOneResult, expectOneResult = _ref3$expectOneResult === void 0 ? false : _ref3$expectOneResult, _ref3$cache = _ref3.cache, cache = _ref3$cache === void 0 ? true : _ref3$cache, _ref3$system = _ref3.system, system = _ref3$system === void 0 ? false : _ref3$system, _ref3$local = _ref3.local, local = _ref3$local === void 0 ? false : _ref3$local, securedFields = _ref3.securedFields;\n              _context4.prev = 1;\n              params = {\n                action: action,\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                query: query,\n                projection: projection,\n                sort: sort,\n                skip: skip,\n                limit: limit,\n                collation: collation,\n                userId: this._state.user.userId,\n                securedFields: securedFields\n              };\n              _context4.t1 = this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT;\n              if (_context4.t1) {\n                _context4.next = 8;\n                break;\n              }\n              _context4.next = 7;\n              return this._state.online();\n            case 7:\n              _context4.t1 = _context4.sent;\n            case 8:\n              _context4.t0 = _context4.t1;\n              if (!_context4.t0) {\n                _context4.next = 11;\n                break;\n              }\n              _context4.t0 = !local;\n            case 11:\n              if (!_context4.t0) {\n                _context4.next = 19;\n                break;\n              }\n              lambda = this._state.frontmlib;\n              _context4.next = 15;\n              return lambda.invokeLambda('MongoDBManager', 'RequestResponse', params);\n            case 15:\n              response = _context4.sent;\n              return _context4.abrupt(\"return\", this.checkMongoResponse(response, params, cache, false, expectOneResult, _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.DB_OPERATIONS.QUERY));\n            case 19:\n              // let query = params.query;\n              // if(params?.action === \"query\" && params.hasOwnProperty('skip') && !expectOneResult) query = { ...params.query, skip: params.skip };\n              hashedKey = this._state.sha1(JSON.stringify(params));\n              if (!expectOneResult) {\n                _context4.next = 26;\n                break;\n              }\n              _context4.next = 23;\n              return this._state.deviceStorage.loadDocument(params.collection, hashedKey);\n            case 23:\n              fromStorage = _context4.sent;\n              _context4.next = 29;\n              break;\n            case 26:\n              _context4.next = 28;\n              return this._state.deviceStorage.queryCollection(params.collection, hashedKey);\n            case 28:\n              fromStorage = _context4.sent;\n            case 29:\n              if (!fromStorage) {\n                //this._state.addSystemErrorToStack(40);\n                fromStorage = {\n                  statusCode: 200,\n                  body: []\n                };\n              }\n              return _context4.abrupt(\"return\", fromStorage);\n            case 31:\n              _context4.next = 36;\n              break;\n            case 33:\n              _context4.prev = 33;\n              _context4.t2 = _context4[\"catch\"](1);\n              this._state.addSystemErrorToStack(26, '3 ' + _context4.t2.name + ': ' + _context4.t2.message);\n            case 36:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[1, 33]]);\n      }));\n      function getDataFromCollection(_x10) {\n        return _getDataFromCollection.apply(this, arguments);\n      }\n      return getDataFromCollection;\n    }()\n  }, {\n    key: \"archiveMessages\",\n    value: function () {\n      var _archiveMessages = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var state, _, frontmlib, THIRTY_DAYS_IN_MILLISECONDS, messageToArchive, messages;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              state = this._state;\n              _ = state._;\n              frontmlib = state.frontmlib;\n              THIRTY_DAYS_IN_MILLISECONDS = 1000 * 60 * 60 * 24 * 30; //TODO: Need to adjust this logic to hipaa\n              messageToArchive = {\n                conversationId: state.conversationId,\n                messageId: state.messageIdFromUser || state.getUniqueId(),\n                content: [state.messageFromUser],\n                contentType: \"10\",\n                createdOn: Date.now(),\n                ttl: Date.now() + THIRTY_DAYS_IN_MILLISECONDS,\n                deleted: [],\n                delivered: [],\n                opened: [],\n                userDomain: state.currentUserDomain,\n                createdBy: state.user.userId\n              };\n              messages = [];\n              _State__WEBPACK_IMPORTED_MODULE_1__.D.debug({\n                message: \"Responses array\",\n                data: state.responsesArray\n              });\n              if (_.isEmpty(state.responsesArray)) {\n                if (state.messageTypeFromUser === \"10\" || state.messageTypeFromUser === \"string\") {\n                  messages.push(messageToArchive);\n                }\n              } else {\n                _State__WEBPACK_IMPORTED_MODULE_1__.D.debug({\n                  message: \"messageToArchive\",\n                  data: messageToArchive\n                });\n                _State__WEBPACK_IMPORTED_MODULE_1__.D.debug({\n                  message: \"nlpResults\",\n                  data: state.nlpResults\n                });\n                if (!_.isEmpty(state.nlpResults)) {\n                  messages.push(messageToArchive);\n                }\n                _.forEach(state.responsesArray, function (response) {\n                  if (response.type === \"string\") {\n                    var newMessageToArchive = _.clone(messageToArchive);\n                    delete newMessageToArchive.createdBy;\n                    newMessageToArchive.messageId = response.messageId || state.getUniqueId();\n                    newMessageToArchive.content = [response.message];\n                    newMessageToArchive.createdOn = Date.now();\n                    messages.push(newMessageToArchive);\n                  }\n                });\n              }\n              _State__WEBPACK_IMPORTED_MODULE_1__.D.debug({\n                message: \"Messages to archive\",\n                data: messages\n              });\n              if (!(messages.length > 0)) {\n                _context5.next = 12;\n                break;\n              }\n              _context5.next = 12;\n              return frontmlib.insertMessages(messages);\n            case 12:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function archiveMessages() {\n        return _archiveMessages.apply(this, arguments);\n      }\n      return archiveMessages;\n    }()\n  }, {\n    key: \"writeAuditIndex\",\n    value: function () {\n      var _writeAuditIndex = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(collection, document, audit, operation, sync) {\n        var auditDoc, doc, index;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              if (!audit) {\n                _context6.next = 9;\n                break;\n              }\n              auditDoc = {\n                operation: operation,\n                location: sync ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE : _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD,\n                timestamp: Date.now(),\n                userId: this._state.user.userId,\n                userEmail: this._state.user.userEmail,\n                client: this._state.client,\n                appVersion: this._state.appVersion,\n                botId: this._state.botId,\n                userDomain: this._state.currentUserDomain\n              };\n              doc = {};\n              if (collection === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.ACTIVITY_COLLECTION) {\n                doc = this._state.R.merge(auditDoc, document);\n              } else {\n                doc = this._state.R.merge(auditDoc, {\n                  document: document\n                });\n              }\n              index = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.PREFIXES.AUDIT, \"_\").concat(this._state.currentUserDomain, \"_\").concat(collection);\n              _context6.next = 7;\n              return this._state.db.writeDataIntoIndex({\n                index: index,\n                doc: doc\n              });\n            case 7:\n              _context6.next = 9;\n              return this.archiveMessages();\n            case 9:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function writeAuditIndex(_x11, _x12, _x13, _x14, _x15) {\n        return _writeAuditIndex.apply(this, arguments);\n      }\n      return writeAuditIndex;\n    }()\n  }, {\n    key: \"insertDocumentInCollection\",\n    value: function () {\n      var _insertDocumentInCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(_ref4) {\n        var _this = this;\n        var collection, document, audit, _ref4$sync, sync, _ref4$system, system, securedFields, _ref4$cache, cache, _ref4$asyncCall, asyncCall, params;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              collection = _ref4.collection, document = _ref4.document, audit = _ref4.audit, _ref4$sync = _ref4.sync, sync = _ref4$sync === void 0 ? false : _ref4$sync, _ref4$system = _ref4.system, system = _ref4$system === void 0 ? false : _ref4$system, securedFields = _ref4.securedFields, _ref4$cache = _ref4.cache, cache = _ref4$cache === void 0 ? false : _ref4$cache, _ref4$asyncCall = _ref4.asyncCall, asyncCall = _ref4$asyncCall === void 0 ? false : _ref4$asyncCall;\n              params = {\n                action: 'insertOne',\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                document: document,\n                userId: this._state.user.userId,\n                securedFields: securedFields\n              };\n              return _context7.abrupt(\"return\", this._state.callLambda('MongoDBManager', params, this.getLambdaInvocationType(asyncCall)).then(function (response) {\n                return _this.checkMongoResponse(response, params, cache, audit, false, _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.DB_OPERATIONS.INSERT, sync);\n              })[\"catch\"](function (error) {\n                console.log(\"6. adding system error\");\n                _this._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 3:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function insertDocumentInCollection(_x16) {\n        return _insertDocumentInCollection.apply(this, arguments);\n      }\n      return insertDocumentInCollection;\n    }()\n  }, {\n    key: \"insertManyDocumentsInCollection\",\n    value: function () {\n      var _insertManyDocumentsInCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(_ref5) {\n        var _this2 = this;\n        var collection, documents, audit, _ref5$sync, sync, _ref5$system, system, securedFields, _ref5$cache, cache, _ref5$asyncCall, asyncCall, params;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              collection = _ref5.collection, documents = _ref5.documents, audit = _ref5.audit, _ref5$sync = _ref5.sync, sync = _ref5$sync === void 0 ? false : _ref5$sync, _ref5$system = _ref5.system, system = _ref5$system === void 0 ? false : _ref5$system, securedFields = _ref5.securedFields, _ref5$cache = _ref5.cache, cache = _ref5$cache === void 0 ? false : _ref5$cache, _ref5$asyncCall = _ref5.asyncCall, asyncCall = _ref5$asyncCall === void 0 ? false : _ref5$asyncCall;\n              params = {\n                action: 'insertArray',\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                documents: documents,\n                userId: this._state.user.userId,\n                securedFields: securedFields\n              };\n              return _context8.abrupt(\"return\", this._state.callLambda('MongoDBManager', params, this.getLambdaInvocationType(asyncCall)).then(function (response) {\n                return _this2.checkMongoResponse(response, params, cache, audit, false, _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.DB_OPERATIONS.INSERT, sync);\n              })[\"catch\"](function (error) {\n                console.log(\"6. adding system error\");\n                _this2._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 3:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function insertManyDocumentsInCollection(_x17) {\n        return _insertManyDocumentsInCollection.apply(this, arguments);\n      }\n      return insertManyDocumentsInCollection;\n    }()\n  }, {\n    key: \"getLambdaInvocationType\",\n    value: function getLambdaInvocationType(asyncCall) {\n      if (asyncCall) {\n        return \"Event\";\n      }\n      return \"RequestResponse\";\n    }\n  }, {\n    key: \"updateDataInCollection\",\n    value: function () {\n      var _updateDataInCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(_ref6) {\n        var _this3 = this;\n        var collection, document, query, options, audit, _ref6$sync, sync, _ref6$system, system, securedFields, _ref6$cache, cache, _ref6$updateMany, updateMany, _ref6$local, local, _ref6$updateOperator, updateOperator, _ref6$asyncCall, asyncCall, _, params, hashedKey, fromStorage, docArray, docInStorage, i;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              collection = _ref6.collection, document = _ref6.document, query = _ref6.query, options = _ref6.options, audit = _ref6.audit, _ref6$sync = _ref6.sync, sync = _ref6$sync === void 0 ? false : _ref6$sync, _ref6$system = _ref6.system, system = _ref6$system === void 0 ? false : _ref6$system, securedFields = _ref6.securedFields, _ref6$cache = _ref6.cache, cache = _ref6$cache === void 0 ? false : _ref6$cache, _ref6$updateMany = _ref6.updateMany, updateMany = _ref6$updateMany === void 0 ? true : _ref6$updateMany, _ref6$local = _ref6.local, local = _ref6$local === void 0 ? false : _ref6$local, _ref6$updateOperator = _ref6.updateOperator, updateOperator = _ref6$updateOperator === void 0 ? '$set' : _ref6$updateOperator, _ref6$asyncCall = _ref6.asyncCall, asyncCall = _ref6$asyncCall === void 0 ? false : _ref6$asyncCall;\n              _ = this._state._;\n              params = {\n                action: updateMany ? 'updateMany' : 'update',\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                document: document,\n                query: query,\n                options: options,\n                userId: this._state.user.userId,\n                updateOperator: updateOperator,\n                securedFields: securedFields\n              };\n              _context9.t0 = this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT;\n              if (_context9.t0) {\n                _context9.next = 11;\n                break;\n              }\n              _context9.next = 7;\n              return this._state.online();\n            case 7:\n              _context9.t1 = _context9.sent;\n              if (!_context9.t1) {\n                _context9.next = 10;\n                break;\n              }\n              _context9.t1 = !(this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE);\n            case 10:\n              _context9.t0 = _context9.t1;\n            case 11:\n              if (!_context9.t0) {\n                _context9.next = 15;\n                break;\n              }\n              return _context9.abrupt(\"return\", this._state.callLambda('MongoDBManager', params, this.getLambdaInvocationType(asyncCall)).then(function (response) {\n                return _this3.checkMongoResponse(response, params, cache, audit, false, _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.DB_OPERATIONS.UPSERT, sync);\n              })[\"catch\"](function (error) {\n                _this3._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 15:\n              hashedKey = this._state.sha1(JSON.stringify(params));\n              _context9.next = 18;\n              return this._state.deviceStorage.loadDocument(collection, hashedKey);\n            case 18:\n              _context9.t2 = _context9.sent;\n              if (_context9.t2) {\n                _context9.next = 21;\n                break;\n              }\n              _context9.t2 = {};\n            case 21:\n              fromStorage = _context9.t2;\n              if (_.size(fromStorage) > 0) {\n                //Update the fields in the doc and save\n                docArray = _.get(fromStorage, 'body');\n                if (Array.isArray(docArray)) {\n                  docInStorage = [];\n                  for (i = 0; i < docArray.length; i++) {\n                    docInStorage.push(_.merge(docArray[i], document));\n                  }\n                  fromStorage.body = docInStorage;\n                } else {\n                  this._state.addSystemErrorToStack(7, 'Error updating document in local storage');\n                }\n              } else {\n                fromStorage = {\n                  statusCode: 200,\n                  body: [document]\n                };\n              }\n              //console.log('This is the key in updateDataInCollection ' + JSON.stringify(params.query));\n              _context9.next = 25;\n              return this._state.deviceStorage.saveDocument(collection, hashedKey, fromStorage);\n            case 25:\n              if (!local) {\n                this._state.addObjectToSyncMessage(collection, JSON.stringify(params), fromStorage);\n              }\n            case 26:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this);\n      }));\n      function updateDataInCollection(_x18) {\n        return _updateDataInCollection.apply(this, arguments);\n      }\n      return updateDataInCollection;\n    }()\n  }, {\n    key: \"updateManyDataInCollection\",\n    value: function () {\n      var _updateManyDataInCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(_ref7) {\n        var _this4 = this;\n        var collection, document, query, options, audit, _ref7$sync, sync, _ref7$system, system, securedFields, _ref7$updateOperator, updateOperator, _ref7$cache, cache, _ref7$asyncCall, asyncCall, _, params, hashedKey, fromStorage, docArray, docInStorage, i;\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              collection = _ref7.collection, document = _ref7.document, query = _ref7.query, options = _ref7.options, audit = _ref7.audit, _ref7$sync = _ref7.sync, sync = _ref7$sync === void 0 ? false : _ref7$sync, _ref7$system = _ref7.system, system = _ref7$system === void 0 ? false : _ref7$system, securedFields = _ref7.securedFields, _ref7$updateOperator = _ref7.updateOperator, updateOperator = _ref7$updateOperator === void 0 ? \"$set\" : _ref7$updateOperator, _ref7$cache = _ref7.cache, cache = _ref7$cache === void 0 ? false : _ref7$cache, _ref7$asyncCall = _ref7.asyncCall, asyncCall = _ref7$asyncCall === void 0 ? false : _ref7$asyncCall;\n              _ = this._state._;\n              params = {\n                action: 'updateMany',\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                document: document,\n                query: query,\n                options: options,\n                userId: this._state.user.userId,\n                updateOperator: updateOperator,\n                securedFields: securedFields\n              };\n              _context10.t0 = this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT;\n              if (_context10.t0) {\n                _context10.next = 11;\n                break;\n              }\n              _context10.next = 7;\n              return this._state.online();\n            case 7:\n              _context10.t1 = _context10.sent;\n              if (!_context10.t1) {\n                _context10.next = 10;\n                break;\n              }\n              _context10.t1 = !(this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE);\n            case 10:\n              _context10.t0 = _context10.t1;\n            case 11:\n              if (!_context10.t0) {\n                _context10.next = 15;\n                break;\n              }\n              return _context10.abrupt(\"return\", this._state.callLambda('MongoDBManager', params, this.getLambdaInvocationType(asyncCall)).then(function (response) {\n                console.log(\"6.9 in then\");\n                return _this4.checkMongoResponse(response, params, cache, audit, false, _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.DB_OPERATIONS.UPSERT, sync);\n              })[\"catch\"](function (error) {\n                console.log(\"7. adding system error \" + JSON.stringify(error));\n                _this4._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 15:\n              hashedKey = this._state.sha1(JSON.stringify(params));\n              _context10.next = 18;\n              return this._state.deviceStorage.loadDocument(collection, hashedKey);\n            case 18:\n              _context10.t2 = _context10.sent;\n              if (_context10.t2) {\n                _context10.next = 21;\n                break;\n              }\n              _context10.t2 = {};\n            case 21:\n              fromStorage = _context10.t2;\n              if (_.size(fromStorage) > 0) {\n                //Update the fields in the doc and save\n                docArray = _.get(fromStorage, 'body');\n                if (Array.isArray(docArray)) {\n                  docInStorage = [];\n                  for (i = 0; i < docArray.length; i++) {\n                    docInStorage.push(_.merge(docArray[i], document));\n                  }\n                  fromStorage.body = docInStorage;\n                } else {\n                  this._state.addSystemErrorToStack(7, 'Error updating document in local storage');\n                }\n              } else {\n                fromStorage = {\n                  statusCode: 200,\n                  body: [document]\n                };\n              }\n              //console.log('This is the key in updateDataInCollection ' + JSON.stringify(params.query));\n              _context10.next = 25;\n              return this._state.deviceStorage.saveDocument(collection, hashedKey, fromStorage);\n            case 25:\n              this._state.addObjectToSyncMessage(collection, JSON.stringify(params), fromStorage);\n            case 26:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function updateManyDataInCollection(_x19) {\n        return _updateManyDataInCollection.apply(this, arguments);\n      }\n      return updateManyDataInCollection;\n    }()\n  }, {\n    key: \"deleteDataFromCollection\",\n    value: function () {\n      var _deleteDataFromCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(_ref8) {\n        var _this5 = this;\n        var collection, query, sync, audit, _ref8$system, system, _ref8$deleteMany, deleteMany, _ref8$local, local, params, hashedKey;\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) switch (_context11.prev = _context11.next) {\n            case 0:\n              collection = _ref8.collection, query = _ref8.query, sync = _ref8.sync, audit = _ref8.audit, _ref8$system = _ref8.system, system = _ref8$system === void 0 ? false : _ref8$system, _ref8$deleteMany = _ref8.deleteMany, deleteMany = _ref8$deleteMany === void 0 ? false : _ref8$deleteMany, _ref8$local = _ref8.local, local = _ref8$local === void 0 ? false : _ref8$local;\n              params = {\n                action: deleteMany ? 'deleteMany' : 'delete',\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                query: query,\n                userId: this._state.user.userId\n              };\n              if (!local) {\n                _context11.next = 7;\n                break;\n              }\n              hashedKey = this._state.sha1(JSON.stringify(params));\n              _context11.next = 6;\n              return this._state.deviceStorage.deleteDocument(collection, hashedKey);\n            case 6:\n              return _context11.abrupt(\"return\", _context11.sent);\n            case 7:\n              return _context11.abrupt(\"return\", this._state.callLambda('MongoDBManager', params, 'RequestResponse').then(function (response) {\n                return _this5.checkMongoResponse(response, params, false, audit, false, _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.DB_OPERATIONS.DELETE, sync);\n              })[\"catch\"](function (error) {\n                console.log(\"8. adding system error\");\n                _this5._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 8:\n            case \"end\":\n              return _context11.stop();\n          }\n        }, _callee11, this);\n      }));\n      function deleteDataFromCollection(_x20) {\n        return _deleteDataFromCollection.apply(this, arguments);\n      }\n      return deleteDataFromCollection;\n    }()\n  }, {\n    key: \"deleteManyDataFromCollection\",\n    value: function () {\n      var _deleteManyDataFromCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(_ref9) {\n        var _this6 = this;\n        var collection, query, sync, audit, _ref9$system, system, params;\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              collection = _ref9.collection, query = _ref9.query, sync = _ref9.sync, audit = _ref9.audit, _ref9$system = _ref9.system, system = _ref9$system === void 0 ? false : _ref9$system;\n              params = {\n                action: 'deleteMany',\n                db: system ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.SYSTEM_DB : this._state.currentUserDomain,\n                collection: collection,\n                query: query,\n                userId: this._state.user.userId\n              };\n              return _context12.abrupt(\"return\", this._state.callLambda('MongoDBManager', params, 'RequestResponse').then(function (response) {\n                return _this6.checkMongoResponse(response, params, false, audit, false, _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.DB_OPERATIONS.DELETE, sync);\n              })[\"catch\"](function (error) {\n                console.log(\"8. adding system error\");\n                _this6._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 3:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this);\n      }));\n      function deleteManyDataFromCollection(_x21) {\n        return _deleteManyDataFromCollection.apply(this, arguments);\n      }\n      return deleteManyDataFromCollection;\n    }()\n  }, {\n    key: \"getCatalogue\",\n    value: function () {\n      var _getCatalogue = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(_ref10) {\n        var query, userDomain, params, response;\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              query = _ref10.query, userDomain = _ref10.userDomain;\n              _context13.prev = 1;\n              params = {\n                query: query,\n                isAllBotsRequest: true,\n                selectedDomain: userDomain,\n                email: this._state.user.userEmail\n              };\n              _context13.next = 5;\n              return this._state.callLambda('catalogueLambda', params, 'RequestResponse');\n            case 5:\n              response = _context13.sent;\n              if (!response) {\n                _context13.next = 8;\n                break;\n              }\n              return _context13.abrupt(\"return\", JSON.parse(response.Payload));\n            case 8:\n              _context13.next = 14;\n              break;\n            case 10:\n              _context13.prev = 10;\n              _context13.t0 = _context13[\"catch\"](1);\n              console.log(\"9. adding system error\");\n              this._state.addSystemErrorToStack(7, null, _context13.t0.message);\n            case 14:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this, [[1, 10]]);\n      }));\n      function getCatalogue(_x22) {\n        return _getCatalogue.apply(this, arguments);\n      }\n      return getCatalogue;\n    }()\n  }, {\n    key: \"getStaticData\",\n    value: function getStaticData(query, scan, pagination, sort) {\n      var tableName = 'KeyValues_' + this._state.currentUserDomain;\n      //console.log(tableName);\n      return this.getData(tableName, query, scan, pagination, sort);\n    }\n  }, {\n    key: \"getData\",\n    value: function getData(table, query, scan, pagination, sort) {\n      var _this7 = this;\n      var params = {\n        collection: table,\n        query: query,\n        scan: scan,\n        capability: 'GetData',\n        pagination: pagination,\n        sort: sort,\n        sync: true\n      };\n      return this._state.callLambda('SystemCapabilities', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"10. adding system error\");\n        _this7._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"getDataFromIndex\",\n    value: function getDataFromIndex(index, queryString, pageSize, sort, exactMatch) {\n      var _this8 = this;\n      var params = {\n        method: 'GET',\n        action: 'search',\n        index: this._state._.toLower(index),\n        q: queryString,\n        size: pageSize,\n        sort: sort,\n        exact: exactMatch\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"11. adding system error\");\n        _this8._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"getDataFromIndexWithID\",\n    value: function getDataFromIndexWithID(index, type, id) {\n      var _this9 = this;\n      var params = {\n        method: 'GET_WITH_ID',\n        index: this._state._.toLower(index),\n        docType: type,\n        id: id\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"12. adding system error\");\n        _this9._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"getDataFromIndexWithSQL\",\n    value: function getDataFromIndexWithSQL(queryString) {\n      var _this10 = this;\n      var params = {\n        method: 'SQL',\n        q: queryString\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"13. adding system error\");\n        _this10._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"deleteDataFromIndex\",\n    value: function deleteDataFromIndex(index, type, objectId) {\n      var _this11 = this;\n      var params = {\n        method: 'DELETE',\n        index: this._state._.toLower(index),\n        q: objectId,\n        docType: type\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"14. adding system error\");\n        _this11._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"deleteDataFromIndexByID\",\n    value: function deleteDataFromIndexByID(index, type, objectId) {\n      var _this12 = this;\n      var params = {\n        method: 'DELETE',\n        index: this._state._.toLower(index),\n        docType: type,\n        id: objectId\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"15. adding system error\");\n        _this12._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"getDataFromIndexWithQueryObject\",\n    value: function getDataFromIndexWithQueryObject(index, queryObject) {\n      var _this13 = this;\n      var params = {\n        method: 'GET',\n        action: 'bodySearch',\n        index: this._state._.toLower(index),\n        q: queryObject\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        //console.log(JSON.stringify(response));\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"16. adding system error\");\n        //console.log(JSON.stringify(response));\n        _this13._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"countDataInIndex\",\n    value: function countDataInIndex(index, queryString) {\n      var _this14 = this;\n      var params = {\n        method: 'GET',\n        action: 'count',\n        index: this._state._.toLower(index),\n        q: queryString\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"17. adding system error\");\n        _this14._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"writeDataIntoIndex\",\n    value: function writeDataIntoIndex(_ref11) {\n      var _this15 = this;\n      var index = _ref11.index,\n        _ref11$docType = _ref11.docType,\n        docType = _ref11$docType === void 0 ? '_doc' : _ref11$docType,\n        doc = _ref11.doc;\n      var params = {\n        method: 'POST',\n        action: 'insert',\n        index: this._state._.toLower(index),\n        docType: docType,\n        doc: doc\n      };\n      return this._state.callLambda(\"elastiSearch\", params, \"Event\").then(function (response) {\n        // return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"18. adding system error\");\n        _this15._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"bulkWriteDataIntoIndex\",\n    value: function bulkWriteDataIntoIndex(_ref12) {\n      var _this16 = this;\n      var index = _ref12.index,\n        _ref12$docType = _ref12.docType,\n        docType = _ref12$docType === void 0 ? '_doc' : _ref12$docType,\n        docs = _ref12.docs,\n        docIdField = _ref12.docIdField;\n      var params = {\n        method: 'BULK_INSERT',\n        action: 'insert',\n        index: this._state._.toLower(index),\n        docType: docType,\n        docs: docs,\n        docIdField: docIdField\n      };\n      return this._state.callLambda('elastiSearch', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"19. adding system error\");\n        _this16._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"updateDataInIndex\",\n    value: function updateDataInIndex(_ref13) {\n      var _this17 = this;\n      var index = _ref13.index,\n        _ref13$docType = _ref13.docType,\n        docType = _ref13$docType === void 0 ? '_doc' : _ref13$docType,\n        doc = _ref13.doc;\n      var params = {\n        method: 'PUT',\n        docType: docType,\n        index: this._state._.toLower(index),\n        doc: doc,\n        id: doc.id\n      };\n      return this._state.callLambda(\"elastiSearch\", params, \"Event\").then(function (response) {\n        // return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"20. adding system error\");\n        _this17._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"writeTransactionData\",\n    value: function writeTransactionData(documents) {\n      var tableName = 'Transactions_' + this._state.currentUserDomain;\n      return this.writeData(tableName, documents);\n    }\n  }, {\n    key: \"writeStaticData\",\n    value: function writeStaticData(documents) {\n      var tableName = 'KeyValues_' + this._state.currentUserDomain;\n      return this.writeData(tableName, documents);\n    }\n  }, {\n    key: \"writeData\",\n    value: function writeData(table, documents) {\n      var _this18 = this;\n      var params = {\n        collection: table,\n        documents: documents,\n        capability: 'WriteData'\n      };\n      return this._state.callLambda('SystemCapabilities', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"21. adding system error\");\n        _this18._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"updateStaticData\",\n    value: function () {\n      var _updateStaticData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(filter, expression, expressionAttributeValues, expressionAttributeNames) {\n        var tableName, state, D, frontmLib, updateQueryResponse;\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) switch (_context14.prev = _context14.next) {\n            case 0:\n              tableName = 'KeyValues_' + this._state.currentUserDomain;\n              state = this._state;\n              D = state.developer;\n              _context14.prev = 3;\n              if (!(this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE && this._state.v1Compatibility)) {\n                _context14.next = 10;\n                break;\n              }\n              frontmLib = this._state.frontmlib;\n              _context14.next = 8;\n              return frontmLib.dbUpdateItem(tableName, filter, expression, expressionAttributeValues, expressionAttributeNames);\n            case 8:\n              updateQueryResponse = _context14.sent;\n              return _context14.abrupt(\"return\", updateQueryResponse);\n            case 10:\n              _context14.next = 17;\n              break;\n            case 12:\n              _context14.prev = 12;\n              _context14.t0 = _context14[\"catch\"](3);\n              console.log(\"22. adding system error\");\n              D.log({\n                message: 'Error updateStaticData::: ',\n                data: JSON.stringify(_context14.t0)\n              });\n              this._state.addSystemErrorToStack(7, null, _context14.t0.message);\n            case 17:\n            case \"end\":\n              return _context14.stop();\n          }\n        }, _callee14, this, [[3, 12]]);\n      }));\n      function updateStaticData(_x23, _x24, _x25, _x26) {\n        return _updateStaticData.apply(this, arguments);\n      }\n      return updateStaticData;\n    }()\n  }, {\n    key: \"deleteTransactionData\",\n    value: function deleteTransactionData(query) {\n      var tableName = 'Transactions_' + this._state.currentUserDomain;\n      return this.deleteData(tableName, query);\n    }\n  }, {\n    key: \"deleteStaticData\",\n    value: function deleteStaticData(query) {\n      var tableName = 'KeyValues_' + this._state.currentUserDomain;\n      return this.deleteData(tableName, query);\n    }\n  }, {\n    key: \"deleteData\",\n    value: function deleteData(table, query) {\n      var _this19 = this;\n      var params = {\n        collection: table,\n        query: query,\n        capability: 'DeleteData'\n      };\n      return this._state.callLambda('SystemCapabilities', params, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      })[\"catch\"](function (error) {\n        console.log(\"23. adding system error\");\n        _this19._state.addSystemErrorToStack(7, error.message);\n      });\n    }\n  }, {\n    key: \"strigifyValue\",\n    value: function strigifyValue(value) {\n      if (this._.isString(value)) {\n        return value;\n      }\n      return this._.isObjectLike(value) ? JSON.stringify(value) : this._.toString(value);\n    }\n  }, {\n    key: \"createParamsForAdd\",\n    value: function createParamsForAdd(keyValuePairs) {\n      var _this20 = this;\n      if (!Array.isArray(keyValuePairs)) {\n        keyValuePairs = [keyValuePairs];\n      }\n      return keyValuePairs.map(function (keyValue) {\n        var key = keyValue.key,\n          value = keyValue.value,\n          expiry = keyValue.expiry,\n          isArrayElement = keyValue.isArrayElement,\n          index = keyValue.index;\n        value = _this20.strigifyValue(value);\n        return {\n          key: key,\n          value: value,\n          expiry: expiry,\n          isArrayElement: isArrayElement,\n          index: index\n        };\n      });\n    }\n  }, {\n    key: \"callRedisWriteQueue\",\n    value: function callRedisWriteQueue(keyValuePairs) {\n      var lambdaParams = {\n        action: 'add',\n        data: keyValuePairs\n      };\n      var size = this._state.sizeOfObject(JSON.stringify(lambdaParams, null, 0));\n      if (size >= 200000) {\n        //console.log(\"********** Danger danger danger!! Your PARAMS is too big!! ********** \" + size)\n      } else {\n        //console.log(\"********** Size is not important ********** \" + size)\n      }\n      return this._state.callLambda('RedisWriteQueue', lambdaParams, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      });\n    }\n  }, {\n    key: \"callRedisDeleteQueue\",\n    value: function callRedisDeleteQueue(key) {\n      var lambdaParams = {\n        action: 'delete',\n        key: key\n      };\n      return this._state.callLambda('RedisWriteQueue', lambdaParams, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      });\n    }\n  }, {\n    key: \"deleteOneKeyInCache\",\n    value: function deleteOneKeyInCache(key) {\n      return this.callRedisDeleteQueue(key);\n    }\n  }, {\n    key: \"setOneValueInCache\",\n    value: function setOneValueInCache(key, value) {\n      return this.callRedisWriteQueue(this.createParamsForAdd({\n        key: key,\n        value: value\n      }));\n    }\n  }, {\n    key: \"setOneValueInCacheWithExpiry\",\n    value: function setOneValueInCacheWithExpiry(key, value, expiry) {\n      var lambdaParams = this.createParamsForAdd({\n        key: key,\n        value: value,\n        expiry: expiry\n      });\n      //console.log('Storing key ' + key);\n      return this.callRedisWriteQueue(lambdaParams);\n    }\n  }, {\n    key: \"setMultipleValuesInCache\",\n    value: function setMultipleValuesInCache(keyValuePairs) {\n      return this.callRedisWriteQueue(this.createParamsForAdd(keyValuePairs));\n    }\n  }, {\n    key: \"addOneListElementInCache\",\n    value: function addOneListElementInCache(key, value) {\n      return this.addMultipleListElementInCache({\n        key: key,\n        value: value\n      });\n    }\n  }, {\n    key: \"updateOneListElementInCache\",\n    value: function updateOneListElementInCache(key, value, index) {\n      return this.addMultipleListElementInCache({\n        key: key,\n        value: value,\n        index: index\n      });\n    }\n  }, {\n    key: \"addMultipleListElementInCache\",\n    value: function addMultipleListElementInCache(keyValuePairs) {\n      if (!Array.isArray(keyValuePairs)) {\n        keyValuePairs = [keyValuePairs];\n      }\n      keyValuePairs = keyValuePairs.map(function (keyValue) {\n        keyValue.isArrayElement = true;\n        return keyValue;\n      });\n      return this.callRedisWriteQueue(this.createParamsForAdd(keyValuePairs));\n    }\n  }, {\n    key: \"getValueFromCache\",\n    value: function getValueFromCache(key) {\n      return this.getMultipleValuesFromCache(key).then(function (data) {\n        return data[key];\n      });\n    }\n  }, {\n    key: \"getObjectFromCache\",\n    value: function getObjectFromCache(key) {\n      return this.getMultipleValuesFromCache(key).then(function (data) {\n        var _data$key;\n        var object = (_data$key = data[key]) === null || _data$key === void 0 ? void 0 : _data$key.content;\n        if (object) {\n          try {\n            return JSON.parse(object);\n          } catch (err) {\n            return object;\n          }\n        }\n      });\n    }\n  }, {\n    key: \"getMultipleValuesFromCache\",\n    value: function getMultipleValuesFromCache(keys) {\n      if (!Array.isArray(keys)) {\n        keys = [keys];\n      }\n      var lambdaParams = {\n        multiKeys: keys\n      };\n      return this._state.callLambda('RedisReadQueue', lambdaParams, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      });\n    }\n  }, {\n    key: \"getKeysOnPattern\",\n    value: function getKeysOnPattern(pattern) {\n      var lambdaParams = {\n        pattern: pattern\n      };\n      return this._state.callLambda('RedisReadQueue', lambdaParams, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      });\n    }\n  }, {\n    key: \"getUser\",\n    value: function () {\n      var _getUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(userId) {\n        var frontmLib;\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) switch (_context15.prev = _context15.next) {\n            case 0:\n              _context15.prev = 0;\n              if (!(this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE && this._state.v1Compatibility)) {\n                _context15.next = 6;\n                break;\n              }\n              frontmLib = this._state.frontmlib;\n              _context15.next = 5;\n              return frontmLib.getUser(userId);\n            case 5:\n              return _context15.abrupt(\"return\", _context15.sent);\n            case 6:\n              _context15.next = 12;\n              break;\n            case 8:\n              _context15.prev = 8;\n              _context15.t0 = _context15[\"catch\"](0);\n              console.log(\"24. adding system error\");\n              this._state.addSystemErrorToStack(7, null, _context15.t0.message);\n            case 12:\n            case \"end\":\n              return _context15.stop();\n          }\n        }, _callee15, this, [[0, 8]]);\n      }));\n      function getUser(_x27) {\n        return _getUser.apply(this, arguments);\n      }\n      return getUser;\n    }()\n  }], [{\n    key: \"CONVERSATIONS_INDEX\",\n    value: function CONVERSATIONS_INDEX() {\n      return 'conversations*';\n    }\n  }]);\n  return DB;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/DB.js?");

/***/ }),

/***/ "../../frontmjs/core/Developer.js":
/*!****************************************!*\
  !*** ../../frontmjs/core/Developer.js ***!
  \****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Developer: function() { return /* binding */ Developer; }\n/* harmony export */ });\n/* harmony import */ var _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LogEntrytype */ \"../../frontmjs/core/LogEntrytype.js\");\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _UnitTest__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./UnitTest */ \"../../frontmjs/core/UnitTest.js\");\n/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Error */ \"../../frontmjs/core/Error.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\n\n\nvar Developer = /*#__PURE__*/function () {\n  function Developer(state) {\n    _classCallCheck(this, Developer);\n    this['_state'] = state;\n    this['_debugMode'] = false;\n    this['_command'] = [];\n    this['_runProfile'] = Developer.PROD();\n    this._performanceLogs = false;\n  }\n  _createClass(Developer, [{\n    key: \"init\",\n    value: function init() {\n      this['_'] = this._state._;\n      this['R'] = this._state.R;\n    }\n  }, {\n    key: \"runProfile\",\n    get: function get() {\n      return this._runProfile;\n    },\n    set: function set(runProfile) {\n      this._runProfile = runProfile;\n      if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT && this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.LOCATIONS.EDGE && !this._state.v1Compatibility) {\n        this._state.context.devMode();\n      }\n    }\n  }, {\n    key: \"callBotPublisher\",\n    value: function callBotPublisher(newBot, action) {\n      var _this = this;\n      var params = {\n        action: action,\n        conversation: this._state.conversation,\n        botMetadata: newBot,\n        userId: this._state.user.userId\n      };\n      return this._state.callLambda('BotPublisher', params, 'RequestResponse').then(function (response) {\n        var payload = JSON.parse(response.Payload);\n        if (payload.error !== 0) {\n          if (payload.error === 9) {\n            _this._state.addSystemErrorToStack(9);\n          } else {\n            console.log(\"1. adding system error\");\n            _this._state.addSystemErrorToStack(7, payload.error);\n          }\n        }\n        return payload.error;\n      });\n    }\n  }, {\n    key: \"publishBot\",\n    value: function publishBot(newBot) {\n      return this.callBotPublisher(newBot, 'publishNewBot');\n    }\n  }, {\n    key: \"updateBot\",\n    value: function updateBot(newBot) {\n      return this.callBotPublisher(newBot, 'updateBot');\n    }\n  }, {\n    key: \"deleteBotFromCatalogue\",\n    value: function deleteBotFromCatalogue(newBot) {\n      return this.callBotPublisher(newBot, 'deleteBot');\n    }\n  }, {\n    key: \"publishApp\",\n    value: function publishApp(newBot) {\n      return this.callBotPublisher(newBot, 'publishNewBotInNewFormat');\n    }\n  }, {\n    key: \"updateApp\",\n    value: function updateApp(newBot) {\n      return this.callBotPublisher(newBot, 'updateBotInNewFormat');\n    }\n  }, {\n    key: \"deleteAppFromCatalogue\",\n    value: function deleteAppFromCatalogue(newBot) {\n      return this.callBotPublisher(newBot, 'deleteBotInNewFormat');\n    }\n  }, {\n    key: \"setDebugActive\",\n    value: function setDebugActive() {\n      this.log({\n        message: 'Activating debug mode'\n      });\n      this._debugMode = true;\n    }\n  }, {\n    key: \"validDeveloperDomains\",\n    value: function validDeveloperDomains() {\n      var _this2 = this;\n      var domains = [];\n      if (this._state.conversation.userDomain === 'frontmai') {\n        this._state._.each(this._state.userDomains, function (userDomain) {\n          var index = _this2._state._.findIndex(userDomain.roles, function (role) {\n            return role = 'developer';\n          });\n          if (index > -1) {\n            domains.push(userDomain.domain);\n          }\n        });\n      } else {\n        domains.push(this._state.conversation.userDomain);\n      }\n      return domains;\n    }\n  }, {\n    key: \"isDeveloperIntent\",\n    value: function isDeveloperIntent() {\n      return typeof this._state.messageFromUser === 'string' && this._state.messageFromUser.substring(0, 2) === '@@' && this._state.messageFromUser.substring(0, 5) !== '@@run';\n    }\n  }, {\n    key: \"identifyDeveloperIntent\",\n    value: function identifyDeveloperIntent() {\n      if (typeof this._state.messageFromUser === 'string') {\n        var command = this._state.messageFromUser.toLowerCase();\n        switch (command) {\n          case '@@reset conversation':\n            return '_dev_reset_conversation';\n          case '@@debug on':\n            return '_dev_debug_switch_on';\n          case '@@debug off':\n            return '_dev_debug_switch_off';\n          case '@@inspect all':\n            return '_dev_inspect_all';\n          case '@@inspect nlp':\n            return '_dev_inspect_nlp';\n          case '@@inspect history':\n            return '_dev_inspect_history';\n          case '@@inspect messages':\n            return '_dev_inspect_messages';\n          case '@@inspect old fields':\n            return '_dev_inspect_old';\n          default:\n            if (this.R.includes('@@inspect state', command)) {\n              return '_dev_inspect_state';\n            } else if (this.R.includes('@@inspect', command)) {\n              return '_dev_inspect';\n            }\n        }\n      }\n      return null;\n    }\n  }, {\n    key: \"debug\",\n    value: function debug(_ref) {\n      var message = _ref.message,\n        errorCode = _ref.errorCode,\n        data = _ref.data,\n        more = _ref.more;\n      if (this.runProfile === Developer.DEBUG()) {\n        this.addEntryInES({\n          level: _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__.LogEntrytype.DEBUG(),\n          message: message,\n          errorCode: errorCode,\n          data: data,\n          more: more\n        });\n      }\n    }\n  }, {\n    key: \"log\",\n    value: function log(_ref2) {\n      var message = _ref2.message,\n        errorCode = _ref2.errorCode,\n        data = _ref2.data,\n        more = _ref2.more;\n      if (this.runProfile === Developer.DEV() || this.runProfile === Developer.DEBUG()) {\n        this.addEntryInES({\n          level: _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__.LogEntrytype.LOG(),\n          message: message,\n          errorCode: errorCode,\n          data: data,\n          more: more\n        });\n      }\n    }\n  }, {\n    key: \"info\",\n    value: function info(_ref3) {\n      var message = _ref3.message,\n        errorCode = _ref3.errorCode,\n        data = _ref3.data,\n        more = _ref3.more;\n      if (this.runProfile === Developer.DEBUG()) {\n        this.addEntryInES({\n          level: _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__.LogEntrytype.INFO(),\n          message: message,\n          errorCode: errorCode,\n          data: data,\n          more: more\n        });\n      }\n    }\n  }, {\n    key: \"warning\",\n    value: function warning(_ref4) {\n      var message = _ref4.message,\n        errorCode = _ref4.errorCode,\n        data = _ref4.data,\n        more = _ref4.more;\n      this.addEntryInES({\n        level: _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__.LogEntrytype.WARNING(),\n        message: message,\n        errorCode: errorCode,\n        data: data,\n        more: more\n      });\n    }\n  }, {\n    key: \"perf\",\n    value: function perf(_ref5) {\n      var message = _ref5.message,\n        errorCode = _ref5.errorCode,\n        data = _ref5.data,\n        more = _ref5.more;\n      if (this.runProfile === Developer.DEBUG() || this.runProfile === Developer.PERF()) {\n        this.addEntryInES({\n          level: _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__.LogEntrytype.PERF(),\n          message: message,\n          errorCode: errorCode,\n          data: data,\n          more: more\n        });\n      }\n    }\n  }, {\n    key: \"systemError\",\n    value: function systemError(_ref6) {\n      var message = _ref6.message,\n        errorCode = _ref6.errorCode,\n        data = _ref6.data,\n        more = _ref6.more;\n      this.addEntryInES({\n        level: _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__.LogEntrytype.SYSTEM_ERROR(),\n        message: message,\n        errorCode: errorCode,\n        data: data,\n        more: more\n      });\n    }\n  }, {\n    key: \"userError\",\n    value: function userError(_ref7) {\n      var message = _ref7.message,\n        errorCode = _ref7.errorCode,\n        data = _ref7.data,\n        more = _ref7.more;\n      this.addEntryInES({\n        level: _LogEntrytype__WEBPACK_IMPORTED_MODULE_0__.LogEntrytype.USER_ERROR(),\n        message: message,\n        errorCode: errorCode,\n        data: data,\n        more: more\n      });\n    }\n  }, {\n    key: \"addEntryInES\",\n    value: function addEntryInES(_ref8) {\n      var level = _ref8.level,\n        errorCode = _ref8.errorCode,\n        message = _ref8.message,\n        data = _ref8.data,\n        more = _ref8.more;\n      try {\n        //console.log('Message ' + this._state.R.toString(message));\n        var activeIntent;\n        if (this._state.activeIntent !== '') {\n          activeIntent = this._state.activeIntent;\n        }\n        var params = {\n          type: 'USER',\n          entry: {\n            userDomain: this._state.currentUserDomain,\n            userId: this._state.user.userId,\n            userEmail: this._state.user.userEmail,\n            botId: this._state.conversation.bot,\n            conversationId: this._state.conversationId,\n            entity: 'Micro-App',\n            intent: activeIntent,\n            client: this._state.client,\n            location: this._state.location,\n            timestamp: Date.now(),\n            level: level,\n            errorCode: errorCode,\n            message: message,\n            data: !data || typeof data === 'string' ? data : JSON.stringify(data)\n          }\n        };\n        if (more) {\n          params.entry = _objectSpread(_objectSpread({}, params.entry), more);\n        }\n        var size = this._state.sizeOfObject(JSON.stringify(params));\n        if (size > 200000) {\n          this.warning({\n            message: _Error__WEBPACK_IMPORTED_MODULE_3__.Error.getErrorMessageforCodeAndLang(50, 'en'),\n            data: message\n          });\n          return;\n        }\n        if (this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.LOCATIONS.EDGE && this._state.v1Compatibility) {\n          try {\n            var invocationType = \"Event\";\n            if (this.runProfile === Developer.DEBUG()) {\n              invocationType = \"RequestResponse\";\n            }\n            var lambda = this._state.frontmlib;\n            return lambda.invokeLambda('logger', invocationType, params);\n          } catch (err) {\n            this._state.context.log(params);\n          }\n        } else {\n          params.data = params.entry.data;\n          this._state.context.log(params);\n        }\n      } catch (err) {\n        // TODO: the function is causing maximum stack error. Has to replace.\n        // this._state.addSystemErrorToStack(26, '1 ' + err.name + ': ' + err.message);\n        console.log(err);\n      }\n    }\n  }, {\n    key: \"processCommand\",\n    value: function processCommand(command) {\n      switch (command) {\n        case '_dev_reset_conversation':\n          {\n            this.resetConversation();\n            break;\n          }\n        case '_dev_debug_switch_on':\n          {\n            this.debugSwitch(true);\n            break;\n          }\n        case '_dev_debug_switch_off':\n          {\n            this.debugSwitch(false);\n            break;\n          }\n        case '_dev_inspect':\n          {\n            this.inspectField();\n            break;\n          }\n        case '_dev_inspect_all':\n          {\n            this.inspectAllFields();\n            break;\n          }\n        case '_dev_inspect_nlp':\n          {\n            this.inspectNLPFields();\n            break;\n          }\n        case '_dev_inspect_state':\n          {\n            this.inspectStateField();\n            break;\n          }\n        case '_dev_inspect_history':\n          {\n            this.inspectHistory();\n            break;\n          }\n        case '_dev_inspect_messages':\n          {\n            return this.inspectMessages();\n          }\n        case '_dev_inspect_old':\n          {\n            return this.inspectOldFields();\n          }\n        default:\n          break;\n      }\n    }\n\n    //Commands\n  }, {\n    key: \"inspectField\",\n    value: function inspectField() {\n      var fieldName = this.R.head(this.R.drop(1, this.R.split(' ')(this._state.messageFromUser)));\n      if (fieldName) {\n        var fieldContent = this.R.toString(this._.get(this._state.fields, fieldName));\n        if (fieldContent) {\n          this._state.addStringResponse(fieldContent);\n          return;\n        }\n      }\n      this._state.addStringResponse('Could not find ' + fieldName);\n    }\n  }, {\n    key: \"inspectAllFields\",\n    value: function inspectAllFields() {\n      var fieldContent = this.R.toString(this._state.fields);\n      this._state.addStringResponse(fieldContent);\n    }\n  }, {\n    key: \"inspectOldFields\",\n    value: function inspectOldFields() {\n      var fieldContent = this.R.toString(this._state._oldFields);\n      this._state.addStringResponse(fieldContent);\n    }\n  }, {\n    key: \"inspectNLPFields\",\n    value: function inspectNLPFields() {\n      var fieldContent = this.R.toString(this._state._lastNLPResults);\n      this._state.addStringResponse(fieldContent);\n    }\n  }, {\n    key: \"inspectStateField\",\n    value: function inspectStateField() {\n      this._state.addStringResponse(this._state.R.toString(this._state.getAllProperties()));\n    }\n  }, {\n    key: \"inspectHistory\",\n    value: function inspectHistory() {\n      this._state.addStringResponse(this._state.R.toString(this._state._intentHistory));\n    }\n  }, {\n    key: \"inspectMessages\",\n    value: function inspectMessages() {\n      this._state.addStringResponse(this._state.R.toString(this._state._inputHistory));\n    }\n  }, {\n    key: \"debugSwitch\",\n    value: function debugSwitch(mode) {\n      if (this._debugMode && mode) {\n        this._state.addStringResponse('Debug mode is already active');\n      } else if (this._debugMode === mode) {\n        this._state.addStringResponse('Debug mode is already inactive');\n      } else {\n        this._debugMode = mode;\n        if (this._debugMode) {\n          this.log({\n            message: 'Debug mode set to active'\n          });\n          this._state.addStringResponse('Debug mode activated');\n        } else {\n          this.log({\n            message: 'Debug mode set to inactive'\n          });\n          this._state.addStringResponse('Debug mode deactivated');\n        }\n      }\n    }\n  }, {\n    key: \"resetConversation\",\n    value: function resetConversation() {\n      console.log(\"Resetting conversation\");\n      this._state._activeIntent = '';\n      this._state.requestIdsArray = [];\n      this._state._intentHistory = [];\n      this._state._intentStats = {};\n      this._state.lastGreetingTime = 0;\n      this._state.errorStack = [];\n      this._state.fields = {};\n      this._state.sessionFields = {};\n      this._state.waitingCustomCap = 0;\n      this._state._currentSearchBox = '';\n      this._state._inSilence = false;\n      this._state._lastNLPResults = {};\n      this._state.clearSmartSuggestionsArray();\n      this._state.blockSuggestions = true;\n      this._state._silentIntent = false;\n      this._state.clearAutoSaveBuffer();\n      this._state.clearAutoSaveBufferChanges();\n      this._state.addStringResponse('The conversation has been reset');\n      this._state.sendMessage({\n        intentId: '@@reset'\n      });\n    }\n  }, {\n    key: \"logCurrentEventDurationWithStartTime\",\n    value: function logCurrentEventDurationWithStartTime(event, startTime, endTime, message, data) {\n      try {\n        if (this._performanceLogs) {\n          var newEventLog = {\n            event: event,\n            startTime: startTime,\n            duration: endTime - startTime\n          };\n          this.perf({\n            message: message,\n            more: newEventLog,\n            data: data\n          });\n        }\n      } catch (error) {}\n    }\n  }, {\n    key: \"generateTestCaseStep\",\n    value: function generateTestCaseStep(_ref9) {\n      var message = _ref9.message;\n      var params = {\n        state: this._state.getAllProperties(),\n        schedule: Date.now()\n      };\n      params.state.messageTypeFromUser = message.type;\n      params.state.messageFromUser = message.content;\n      params.state.client = this._state.client;\n      params.state.userName = this._state.userName;\n      params.state.lang = 'en';\n      params.state.waitingCustomCap = 0;\n      params.state.messageFromUser.page = 0;\n      params.state.unitTestMode = true;\n      return params;\n    }\n  }, {\n    key: \"submitTest\",\n    value: function () {\n      var _submitTest = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref10) {\n        var testCases, currentTestCase, fullState, jobId, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              testCases = _ref10.testCases;\n              currentTestCase = testCases[0];\n              this._state.setField(_UnitTest__WEBPACK_IMPORTED_MODULE_2__.UnitTest.TEST_CASES_FIELD(), testCases);\n              this._state.setField(_UnitTest__WEBPACK_IMPORTED_MODULE_2__.UnitTest.CURRENT_TEST_FIELD(), this._state.activeIntent);\n              fullState = this.generateTestCaseStep({\n                message: currentTestCase\n              });\n              jobId = this._state.getUniqueId(); //console.log('Before submitting job');\n              _context.next = 8;\n              return this._state.jobScheduler.addNewJob(this._state.client, fullState, jobId, null);\n            case 8:\n              response = _context.sent;\n              if (!(response.jobId !== jobId)) {\n                _context.next = 13;\n                break;\n              }\n              this._state.addErrorToStack(1000, \"Problems submitting test case\");\n              _context.next = 14;\n              break;\n            case 13:\n              return _context.abrupt(\"return\", response.jobId);\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function submitTest(_x) {\n        return _submitTest.apply(this, arguments);\n      }\n      return submitTest;\n    }()\n  }], [{\n    key: \"DEBUG\",\n    value: function DEBUG() {\n      return 'Debug';\n    }\n  }, {\n    key: \"DEV\",\n    value: function DEV() {\n      return 'Dev';\n    }\n  }, {\n    key: \"PROD\",\n    value: function PROD() {\n      return 'Prod';\n    }\n  }, {\n    key: \"TEST\",\n    value: function TEST() {\n      return 'Test';\n    }\n  }, {\n    key: \"PERF\",\n    value: function PERF() {\n      return 'Perf';\n    }\n  }]);\n  return Developer;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Developer.js?");

/***/ }),

/***/ "../../frontmjs/core/DeviceStorage.js":
/*!********************************************!*\
  !*** ../../frontmjs/core/DeviceStorage.js ***!
  \********************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DeviceStorage: function() { return /* binding */ DeviceStorage; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar DeviceStorage = /*#__PURE__*/function () {\n  function DeviceStorage(state) {\n    _classCallCheck(this, DeviceStorage);\n    this._state = state;\n    this.botContext = state.context;\n    var D = this._state.developer;\n    try {\n      this.deviceStorageCapability = this.botContext.getCapability('DeviceStorage');\n      this.sha1 = state.context.getCapability('sha1');\n    } catch (err) {\n      console.log('Problems creating device storage');\n    }\n  }\n  _createClass(DeviceStorage, [{\n    key: \"getKeyFromStorage\",\n    value: function getKeyFromStorage(key) {\n      return this.deviceStorageCapability.get(key).then(function (result) {\n        return result;\n      });\n    }\n  }, {\n    key: \"saveKeyInStorage\",\n    value: function saveKeyInStorage(key, value) {\n      return this.deviceStorageCapability.save(key, value);\n    }\n  }, {\n    key: \"removeKeyFromStorage\",\n    value: function removeKeyFromStorage(key) {\n      return this.deviceStorageCapability[\"delete\"](key);\n    }\n  }, {\n    key: \"getStateForConversation\",\n    value: function getStateForConversation(conversationId) {\n      if (!conversationId) {\n        return;\n      }\n      return this.getKeyFromStorage.get(conversationId);\n    }\n  }, {\n    key: \"saveConversationState\",\n    value: function saveConversationState(state) {\n      if (!state) {\n        return;\n      }\n      return this.saveKeyInStorage(state.conversationId, state);\n    }\n  }, {\n    key: \"saveDocument\",\n    value: function () {\n      var _saveDocument = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(collection, primaryKey, document) {\n        var _, D, key, collectionKey, allCollectionKeys, index;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              key = \"\".concat(collection, \"_\").concat(primaryKey);\n              collectionKey = \"Collection_\".concat(collection);\n              _context.next = 6;\n              return this.getKeyFromStorage(collectionKey);\n            case 6:\n              _context.t0 = _context.sent;\n              if (_context.t0) {\n                _context.next = 9;\n                break;\n              }\n              _context.t0 = [];\n            case 9:\n              allCollectionKeys = _context.t0;\n              index = _.findIndex(allCollectionKeys, function (keyFromArray) {\n                return keyFromArray === key;\n              });\n              if (index > -1) {\n                allCollectionKeys.splice(index, 1);\n              }\n              allCollectionKeys.push(key);\n              if (!(allCollectionKeys.length > 10)) {\n                _context.next = 17;\n                break;\n              }\n              allCollectionKeys.splice(0, 1);\n              _context.next = 17;\n              return this.removeKeyFromStorage(key);\n            case 17:\n              _context.next = 19;\n              return this.saveKeyInStorage(collectionKey, allCollectionKeys);\n            case 19:\n              _context.next = 21;\n              return this.saveKeyInStorage(key, document);\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function saveDocument(_x, _x2, _x3) {\n        return _saveDocument.apply(this, arguments);\n      }\n      return saveDocument;\n    }()\n  }, {\n    key: \"deleteDocument\",\n    value: function () {\n      var _deleteDocument = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(collection, primaryKey) {\n        var _, D, key, collectionKey, allCollectionKeys, index;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              key = \"\".concat(collection, \"_\").concat(primaryKey);\n              collectionKey = \"Collection_\".concat(collection);\n              _context2.next = 6;\n              return this.getKeyFromStorage(collectionKey);\n            case 6:\n              _context2.t0 = _context2.sent;\n              if (_context2.t0) {\n                _context2.next = 9;\n                break;\n              }\n              _context2.t0 = [];\n            case 9:\n              allCollectionKeys = _context2.t0;\n              index = _.findIndex(allCollectionKeys, function (keyFromArray) {\n                return keyFromArray === key;\n              });\n              if (index > -1) {\n                allCollectionKeys.splice(index, 1);\n              }\n              _context2.next = 14;\n              return this.saveKeyInStorage(collectionKey, allCollectionKeys);\n            case 14:\n              _context2.next = 16;\n              return this.removeKeyFromStorage(key);\n            case 16:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function deleteDocument(_x4, _x5) {\n        return _deleteDocument.apply(this, arguments);\n      }\n      return deleteDocument;\n    }()\n  }, {\n    key: \"loadDocument\",\n    value: function () {\n      var _loadDocument = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(collection, primaryKey) {\n        var _, key, document;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _ = this._state._;\n              key = \"\".concat(collection, \"_\").concat(primaryKey);\n              _context3.next = 5;\n              return this.getKeyFromStorage(key);\n            case 5:\n              document = _context3.sent;\n              return _context3.abrupt(\"return\", document);\n            case 9:\n              _context3.prev = 9;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.log(\"DeviceStorage class error: Error stringifying primary key\");\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[0, 9]]);\n      }));\n      function loadDocument(_x6, _x7) {\n        return _loadDocument.apply(this, arguments);\n      }\n      return loadDocument;\n    }()\n  }, {\n    key: \"queryCollection\",\n    value: function () {\n      var _queryCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(collection, query) {\n        var _, D, doc, collectionKey, allCollectionKeys, allDocs, i, key, _doc, body;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _ = this._state._;\n              D = this._state.developer; // if we have a query we get only the data for that query\n              if (!query) {\n                _context4.next = 13;\n                break;\n              }\n              query = \"\".concat(collection, \"_\").concat(query);\n              _context4.next = 7;\n              return this.getKeyFromStorage(query);\n            case 7:\n              doc = _context4.sent;\n              if (!doc) {\n                _context4.next = 12;\n                break;\n              }\n              return _context4.abrupt(\"return\", doc);\n            case 12:\n              return _context4.abrupt(\"return\", {\n                statusCode: 200,\n                body: []\n              });\n            case 13:\n              collectionKey = \"Collection_\".concat(collection);\n              _context4.next = 16;\n              return this.getKeyFromStorage(collectionKey);\n            case 16:\n              _context4.t0 = _context4.sent;\n              if (_context4.t0) {\n                _context4.next = 19;\n                break;\n              }\n              _context4.t0 = [];\n            case 19:\n              allCollectionKeys = _context4.t0;\n              allDocs = [];\n              i = 0;\n            case 22:\n              if (!(i < allCollectionKeys.length)) {\n                _context4.next = 32;\n                break;\n              }\n              key = allCollectionKeys[i];\n              _context4.next = 26;\n              return this.getKeyFromStorage(key);\n            case 26:\n              _doc = _context4.sent;\n              body = _.get(_doc, 'body');\n              if (body) {\n                allDocs = allDocs.concat(body);\n              }\n            case 29:\n              i++;\n              _context4.next = 22;\n              break;\n            case 32:\n              return _context4.abrupt(\"return\", {\n                statusCode: 200,\n                body: allDocs\n              });\n            case 35:\n              _context4.prev = 35;\n              _context4.t1 = _context4[\"catch\"](0);\n              console.log(\"DeviceStorage class error: Error stringifying primary key\");\n            case 38:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[0, 35]]);\n      }));\n      function queryCollection(_x8, _x9) {\n        return _queryCollection.apply(this, arguments);\n      }\n      return queryCollection;\n    }()\n  }]);\n  return DeviceStorage;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/DeviceStorage.js?");

/***/ }),

/***/ "../../frontmjs/core/Doc.js":
/*!**********************************!*\
  !*** ../../frontmjs/core/Doc.js ***!
  \**********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Doc: function() { return /* binding */ Doc; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Utils */ \"../../frontmjs/core/Utils.js\");\n/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Error */ \"../../frontmjs/core/Error.js\");\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\n\n\nvar Doc = /*#__PURE__*/function (_Intent) {\n  _inherits(Doc, _Intent);\n  var _super = _createSuper(Doc);\n  function Doc(intentId, state, _ref) {\n    var _this;\n    var tabId = _ref.tabId,\n      _ref$title = _ref.title,\n      title = _ref$title === void 0 ? 'Lookup' : _ref$title,\n      _ref$description = _ref.description,\n      description = _ref$description === void 0 ? 'lookup' : _ref$description,\n      _ref$allowMinimize = _ref.allowMinimize,\n      allowMinimize = _ref$allowMinimize === void 0 ? true : _ref$allowMinimize,\n      _ref$allowClose = _ref.allowClose,\n      allowClose = _ref$allowClose === void 0 ? true : _ref$allowClose,\n      _ref$minimizeOnConfir = _ref.minimizeOnConfirm,\n      minimizeOnConfirm = _ref$minimizeOnConfir === void 0 ? true : _ref$minimizeOnConfir,\n      _ref$updateInBackgrou = _ref.updateInBackground,\n      updateInBackground = _ref$updateInBackgrou === void 0 ? false : _ref$updateInBackgrou,\n      promptOnClose = _ref.promptOnClose,\n      confirm = _ref.confirm,\n      cancel = _ref.cancel,\n      icon = _ref.icon,\n      _ref$readOnly = _ref.readOnly,\n      readOnly = _ref$readOnly === void 0 ? false : _ref$readOnly,\n      _ref$allowEdit = _ref.allowEdit,\n      allowEdit = _ref$allowEdit === void 0 ? true : _ref$allowEdit,\n      zone = _ref.zone,\n      parentDoc = _ref.parentDoc,\n      _ref$temp = _ref.temp,\n      temp = _ref$temp === void 0 ? false : _ref$temp,\n      subDocs = _ref.subDocs,\n      _ref$autoSave = _ref.autoSave,\n      autoSave = _ref$autoSave === void 0 ? false : _ref$autoSave,\n      modal = _ref.modal,\n      _ref$onResponse = _ref.onResponse,\n      onResponse = _ref$onResponse === void 0 ? function () {} : _ref$onResponse,\n      audit = _ref.audit,\n      _ref$autoIndex = _ref.autoIndex,\n      autoIndex = _ref$autoIndex === void 0 ? false : _ref$autoIndex,\n      _ref$docId = _ref.docId,\n      docId = _ref$docId === void 0 ? state.user.userId : _ref$docId,\n      rowMenu = _ref.rowMenu,\n      allowDelete = _ref.allowDelete,\n      allowDeleteWhileOffline = _ref.allowDeleteWhileOffline,\n      _id = _ref._id,\n      version = _ref.version,\n      _ref$onPostBuild = _ref.onPostBuild,\n      onPostBuild = _ref$onPostBuild === void 0 ? function (self, doc) {} : _ref$onPostBuild,\n      _ref$onPostBuildConta = _ref.onPostBuildContainer,\n      onPostBuildContainer = _ref$onPostBuildConta === void 0 ? function (self, container) {} : _ref$onPostBuildConta,\n      _ref$onSave = _ref.onSave,\n      onSave = _ref$onSave === void 0 ? /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(self) {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }() : _ref$onSave,\n      _ref$onPostLoad = _ref.onPostLoad,\n      onPostLoad = _ref$onPostLoad === void 0 ? /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(self) {\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2);\n        }));\n        return function (_x2) {\n          return _ref3.apply(this, arguments);\n        };\n      }() : _ref$onPostLoad,\n      _ref$onSubmit = _ref.onSubmit,\n      onSubmit = _ref$onSubmit === void 0 ? /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      })) : _ref$onSubmit,\n      _ref$onCancel = _ref.onCancel,\n      onCancel = _ref$onCancel === void 0 ? /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      })) : _ref$onCancel,\n      _ref$onClose = _ref.onClose,\n      onClose = _ref$onClose === void 0 ? /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5);\n      })) : _ref$onClose,\n      _ref$onInit = _ref.onInit,\n      onInit = _ref$onInit === void 0 ? /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6);\n      })) : _ref$onInit;\n    _classCallCheck(this, Doc);\n    _this = _super.call(this, intentId, state, tabId);\n    _defineProperty(_assertThisInitialized(_this), \"dataType\", _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TYPES.DOC);\n    var D = _this._state.developer;\n    _this._state = state;\n    _this._children = {};\n    _this._document = {};\n    _this._dbDocument = {};\n    _this._documentForShortResponse = {};\n    _this._subDoc = false;\n    _this._subDocs = subDocs || [];\n    _this._subCollections = [];\n    _this._sectionCollections = {};\n    _this._autoSave = autoSave;\n    _this._audit = audit;\n    _this.index = -1;\n    _this._filteredCollectionName = \"\";\n    _this._sections = {};\n    _this._id = _id;\n    _this.temp = temp;\n    _this._autoIndex = autoIndex;\n    _this.title = title;\n    _this.description = description;\n    _this.allowMinimize = allowMinimize;\n    _this.allowClose = allowClose;\n    _this.minimizeOnConfirm = minimizeOnConfirm;\n    _this.updateInBackground = updateInBackground;\n    _this.confirm = confirm;\n    _this.cancel = cancel;\n    _this.icon = icon;\n    _this.modal = modal;\n    _this.readOnly = readOnly;\n    _this.allowEdit = allowEdit;\n    _this.promptOnClose = promptOnClose;\n    _this._rowMenu = rowMenu;\n    _this._allowDelete = allowDelete;\n    _this._allowDeleteWhileOffline = allowDeleteWhileOffline;\n    _this._version = version;\n    _this.zone = zone;\n    _this._fields = [];\n    _this._f = {};\n    _this.docId = docId;\n    _this.onPostBuild = onPostBuild;\n    _this.onPostBuildContainer = onPostBuildContainer;\n    _this.onSave = onSave;\n    _this.onPostLoad = onPostLoad;\n    _this.onSubmit = onSubmit;\n    _this.onCancel = onCancel;\n    _this.onClose = onClose;\n    _this.onResponse = onResponse;\n    _this.onInit = onInit;\n    if (parentDoc) {\n      if (parentDoc.dataType === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TYPES.DOC) {\n        _this._subDoc = true;\n        _this._parentDoc = parentDoc;\n        parentDoc.addChildDoc(_assertThisInitialized(_this));\n      } else {\n        _this._state.addSystemErrorToStack(7, \"Sub documents cannot be saved \".concat(_this._intentId));\n      }\n    }\n    return _this;\n  }\n  _createClass(Doc, [{\n    key: \"resetProperties\",\n    value: function resetProperties() {\n      this.docId = this._state.user.userId;\n    }\n  }, {\n    key: \"cloneDoc\",\n    value: function cloneDoc(intentId, fieldsSuffix) {\n      var _ = this._state._;\n      var D = this._state.developer;\n      var newDoc = new Doc(intentId || this.intentId, this._state, {\n        title: this.title,\n        description: this.description,\n        allowMinimize: this.allowMinimize,\n        allowClose: this.allowClose,\n        minimizeOnConfirm: this.minimizeOnConfirm,\n        updateInBackground: this.updateInBackground,\n        promptOnClose: this.promptOnClose,\n        confirm: this.confirm,\n        cancel: this.cancel,\n        icon: this.icon,\n        readOnly: this.readOnly,\n        allowEdit: this.allowEdit,\n        zone: this.zone,\n        autoSave: this.autoSave,\n        modal: this.modal,\n        onResponse: this.onResponse,\n        onPostBuild: this.onPostBuild,\n        onPostBuildContainer: this.onPostBuildContainer,\n        audit: this._audit,\n        allowDelete: this.allowDelete,\n        allowDeleteWhileOffline: this.allowDeleteWhileOffline,\n        rowMenu: this.rowMenu,\n        onInit: this.onInit,\n        docId: this._state.getUniqueId()\n      });\n      newDoc._sections = this._sections;\n      newDoc.onPostBuild = this.onPostBuild;\n      newDoc.onSave = this.onSave;\n      newDoc.onPostBuildContainer = this.onPostBuildContainer;\n      newDoc.onPostLoad = this.onPostLoad;\n      if (this._collection) {\n        newDoc._collection = this._collection;\n        newDoc._collectionDBName = this._collectionDBName;\n        //newDoc.setCollection(doc._collection);\n      }\n\n      this._state.duringBuild = true;\n      _.forEach(this.fields, function (field) {\n        // field.duringBuild = true;\n        field.cloneField(newDoc, fieldsSuffix);\n      });\n      this._state.duringBuild = false;\n      _.forEach(this._subDocs, function (subDoc) {\n        // D.log({message: 'Adding subDoc', data: subDoc.intentId});\n        var newSubDoc = subDoc.cloneDoc();\n        newSubDoc._autoSave = newDoc._autoSave;\n        newSubDoc._parentDoc = newDoc;\n        newSubDoc._subDoc = true;\n        newDoc.addChildDoc(newSubDoc);\n      });\n      return newDoc;\n    }\n  }, {\n    key: \"options\",\n    value: function options(parent, quickForm) {\n      return {\n        parent: parent,\n        formId: this.intentId,\n        controlId: this.intentId,\n        docId: this.docId,\n        tabId: this.tabId,\n        title: this.title,\n        description: this.description,\n        allowMinimize: this.allowMinimize,\n        allowClose: this.allowClose,\n        minimizeOnConfirm: this.minimizeOnConfirm,\n        updateInBackground: this.updateInBackground,\n        promptOnClose: this.promptOnClose,\n        confirm: this.confirm,\n        cancel: this.cancel,\n        icon: this.icon,\n        readOnly: this.readOnly,\n        allowEdit: this.allowEdit,\n        zone: this.zone,\n        allowDelete: this._allowDelete,\n        allowDeleteWhileOffline: this._allowDeleteWhileOffline,\n        rowMenu: this._rowMenu,\n        modal: !!quickForm,\n        sections: this._sections,\n        version: this.version\n      };\n    }\n  }, {\n    key: \"getCollectionData\",\n    value: function getCollectionData() {\n      var D = this._state.developer;\n      var _ = this._state._;\n      var collectionData = {};\n      _.map(this._sectionCollections, function (collection, section) {\n        collection.prepareCollectionOptions();\n        collectionData[section] = {\n          rows: collection.getRowsForShortResponse(),\n          options: collection.options\n        };\n      });\n      return collectionData;\n    }\n  }, {\n    key: \"formResponseWithAction\",\n    value: function formResponseWithAction(action, result, quickForm, forCollection, parent) {\n      var oldAllowDelete = this._allowDelete;\n      var oldAllowEdit = this.allowEdit;\n      var r = result;\n      var a = action;\n      var columnTemplate;\n      if (action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CHANGE && Array.isArray(r)) {\n        r = {\n          fields: result\n        };\n      } else if (action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.DELETE_ROW) {\n        r = {\n          deleteRow: [this.docId]\n        };\n        a = _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CHANGE;\n      } else if (action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.ADD_ROW && Array.isArray(r)) {\n        r = {\n          append: result\n        };\n        a = _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CHANGE;\n      } else if (action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CHANGE_COLUMN_TEMPLATE) {\n        r = [];\n        var _collection = this.collection;\n        if (_collection) {\n          columnTemplate = _collection.generateTableColumnTemplate();\n        }\n      }\n      var collection = this.collection;\n      var tableId;\n      var parentDocId;\n      var rowOptions;\n      if (forCollection && collection) {\n        tableId = collection.intentId;\n        if (this._state && this._state.messageFromUser) {\n          parentDocId = this._state.messageFromUser.parentDocId;\n        }\n        if (this._state && this._state.messageFromUser.action !== _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.MOVE && this._state.messageFromUser.action !== _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.SEARCH && (oldAllowDelete !== this._allowDelete || oldAllowEdit !== this.allowEdit)) {\n          rowOptions = {\n            allowDelete: this._allowDelete,\n            allowEdit: this.allowEdit,\n            rowMenu: this.rowMenu\n          };\n        }\n      }\n      var options = this.options(parent, quickForm);\n      options.tableId = tableId;\n      options.parentDocId = parentDocId;\n      options.action = a;\n      options.rowOptions = rowOptions;\n      options.columnTemplate = columnTemplate;\n      options.sectionId = collection === null || collection === void 0 ? void 0 : collection.sectionId;\n      return {\n        result: r,\n        options: options\n      };\n    }\n  }, {\n    key: \"getParentForMessage\",\n    value: function getParentForMessage(skipOnResponse) {\n      if (!skipOnResponse) {\n        this.onResponse(this);\n      }\n      var parent = null;\n      if (this._parent) {\n        parent = this._parent._intentId;\n      }\n      return parent;\n    }\n  }, {\n    key: \"message\",\n    value: function message(action, result, quickForm, forCollection, skipOnResponse) {\n      var parent = this.getParentForMessage(skipOnResponse);\n      if (action) {\n        return this.formResponseWithAction(action, result, quickForm, forCollection, parent);\n      } else {\n        var fields = [];\n        this._fields.forEach(function (field) {\n          var fieldMessage = field.message(skipOnResponse);\n          if (fieldMessage && (!quickForm || quickForm && field.includeInQuickEdit)) {\n            fields.push(fieldMessage);\n          }\n        });\n        return {\n          fields: fields,\n          options: this.options(parent, quickForm)\n        };\n      }\n    }\n  }, {\n    key: \"shortMessage\",\n    value: function shortMessage(action, result, quickForm, forCollection, skipOnResponse) {\n      var parent = this.getParentForMessage(skipOnResponse);\n      if (action) {\n        return this.formResponseWithAction(action, result, quickForm, forCollection, parent);\n      } else {\n        var fieldKeys = _Utils__WEBPACK_IMPORTED_MODULE_2__.Utils.getGenericKeys();\n        var fieldData = [];\n        this._fields.forEach(function (field) {\n          var fieldMessage = field.shortMessage(skipOnResponse);\n          if (fieldMessage && (!quickForm || quickForm && field.includeInQuickEdit)) {\n            fieldData.push(fieldMessage);\n          }\n        });\n        return {\n          fields: {\n            fieldKeys: fieldKeys,\n            fieldData: fieldData\n          },\n          options: this.options(parent, quickForm),\n          collectionData: this.getCollectionData()\n        };\n      }\n    }\n  }, {\n    key: \"parent\",\n    set: function set(parent) {\n      this._parent = parent;\n    }\n  }, {\n    key: \"formId\",\n    get: function get() {\n      return this.intentId;\n    }\n  }, {\n    key: \"fields\",\n    get: function get() {\n      return this._fields;\n    },\n    set: function set(fields) {\n      this._fields = [];\n      this.addFields(fields);\n    }\n  }, {\n    key: \"f\",\n    get: function get() {\n      return this._f;\n    }\n  }, {\n    key: \"version\",\n    get: function get() {\n      return this._version;\n    },\n    set: function set(version) {\n      this._version = version;\n    }\n  }, {\n    key: \"addField\",\n    value: function addField(field) {\n      if (field.dataType === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TYPES.FIELD) {\n        this._fields.push(field);\n        this._f[field._intentId] = field;\n        return this._fields.length > 0 ? this._fields.length - 1 : 0;\n      } else {\n        state.addSystemErrorToStack(_Error__WEBPACK_IMPORTED_MODULE_3__.Error.getErrorMessageforCodeAndLang(28));\n      }\n    }\n  }, {\n    key: \"addFields\",\n    value: function addFields(fields) {\n      var _this2 = this;\n      if (Array.isArray(fields)) {\n        fields.forEach(function (field) {\n          _this2.addField(field);\n        });\n      }\n    }\n  }, {\n    key: \"removeFieldWithId\",\n    value: function removeFieldWithId(id) {\n      delete this._f[id];\n      var _ = this._state._;\n      var index = _.findIndex(this._fields, function (field) {\n        return field.id === id;\n      });\n      if (index > -1) {\n        this._fields.splice(index, 0, 1);\n      }\n    }\n  }, {\n    key: \"addSection\",\n    value: function addSection(section) {\n      this._sections[section.sectionId] = section.message();\n    }\n  }, {\n    key: \"allowDelete\",\n    get: function get() {\n      return this._allowDelete;\n    },\n    set: function set(allowDelete) {\n      this._allowDelete = allowDelete;\n    }\n  }, {\n    key: \"rowMenu\",\n    get: function get() {\n      return this._rowMenu;\n    },\n    set: function set(rowMenu) {\n      this._rowMenu = rowMenu;\n    }\n  }, {\n    key: \"sendResponse\",\n    value: function sendResponse() {\n      this._state.addFormResponse(this.message());\n    }\n  }, {\n    key: \"sendShortResponse\",\n    value: function sendShortResponse() {\n      this._state.addShortFormResponse(this.shortMessage());\n    }\n  }, {\n    key: \"sendChangeResponse\",\n    value: function sendChangeResponse(changedFieldsArray) {\n      this._state.addFormChangeResponse(this.message(_ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CHANGE, changedFieldsArray));\n    }\n  }, {\n    key: \"sendQuickDocResponse\",\n    value: function sendQuickDocResponse() {\n      this._state.addFormResponse(this.message(null, null, true));\n    }\n  }, {\n    key: \"setCollection\",\n    value: function setCollection(collection) {\n      this._collection = collection.intentId;\n      this._collectionDBName = collection.name;\n    }\n  }, {\n    key: \"collection\",\n    get: function get() {\n      return this._state.intents[this._collection];\n    }\n  }, {\n    key: \"getPrimaryKey\",\n    value: function getPrimaryKey() {\n      var _ = this._state._;\n      var D = this._state.developer;\n      var primaryKey = {};\n      _.forEach(this._fields, function (field) {\n        if (field.primaryKey && field.value && !field.temp) {\n          primaryKey[field.dbName || field._intentId] = field.value;\n        }\n      });\n      return primaryKey;\n    }\n  }, {\n    key: \"getPrimaryKeyAsStringForSearch\",\n    value: function getPrimaryKeyAsStringForSearch(object) {\n      var _this3 = this;\n      var result = \"\";\n      this._state._.forEach(object, function (field) {\n        var f = field;\n        if (typeof field !== 'string') {\n          f = _this3._state.R.toString(field);\n        }\n        if (result === \"\") {\n          result = result + f;\n        } else {\n          result = result + \"-\" + f;\n        }\n      });\n      return result;\n    }\n  }, {\n    key: \"getNonPrimaryKey\",\n    value: function getNonPrimaryKey() {\n      var _ = this._state._;\n      var D = this._state.developer;\n      var primaryKey = {};\n      _.forEach(this._fields, function (field) {\n        if (!field.primaryKey && field.value) {\n          primaryKey[field._intentId] = field.value;\n        }\n      });\n      return primaryKey;\n    }\n  }, {\n    key: \"buildDocumentFromContainer\",\n    value: function buildDocumentFromContainer(container, skipPostBuild) {\n      var _this4 = this;\n      var _ = this._state._;\n      var D = this._state.developer;\n      var rootDoc = container[this.intentId];\n      var start = Date.now();\n      if (typeof rootDoc !== 'undefined') {\n        this.buildDocument(rootDoc, skipPostBuild);\n      } else {\n        this.buildDocument(container, skipPostBuild);\n      }\n      _.forEach(this._subDocs, function (subDoc) {\n        var doc = container[subDoc.intentId];\n        if (doc && !subDoc.temp) {\n          subDoc.buildDocument(doc, skipPostBuild);\n          _this4._document[subDoc.intentId] = subDoc.document;\n          _this4._dbDocument[subDoc.intentId] = subDoc.document;\n        }\n      });\n      _.forEach(this._subCollections, function (subCollection) {\n        var collection = container[subCollection.intentId];\n        if (collection && !subCollection.temp) {\n          var childArray = [];\n          subCollection.clearRows();\n          _.forEach(collection, function (entry) {\n            var newDoc = subCollection.document.cloneDoc();\n            subCollection.addRow(newDoc);\n            newDoc.buildDocument(entry, skipPostBuild);\n            childArray.push(newDoc.document);\n          });\n          _this4._document[subCollection.intentId] = childArray;\n          _this4._dbDocument[subCollection.intentId] = childArray;\n        }\n      });\n      return this._document;\n    }\n  }, {\n    key: \"buildDocument\",\n    value: function buildDocument(docFromDB, skipPostBuild, withAutoSave) {\n      var _this5 = this;\n      var _ = this._state._;\n      var D = this._state.developer;\n      try {\n        if (!withAutoSave) this._state.duringBuild = true; // -- setting the auto save changes trigger to ignoring changes\n        var doc = {};\n        _.forEach(docFromDB, function (value, key) {\n          if (key === '_id') {\n            _this5._id = value;\n          } else if (key === 'docId') {\n            _this5.docId = value;\n          } else if (key === 'allowEdit') {\n            _this5.allowEdit = value;\n          } else if (key === 'allowDelete') {\n            _this5.allowDelete = value;\n          } else if (key === 'rowMenu') {\n            _this5.rowMenu = value;\n          } else {\n            var v = docFromDB[key];\n            if (_typeof(v) === 'object' && _.get(v, 'text')) {\n              v = _.get(v, 'text');\n            }\n            if (_typeof(v) === 'object' && _.get(v, 'fileName')) {\n              v = {\n                value: _.get(v, 'value'),\n                fileName: _.get(v, 'fileName')\n              };\n            }\n            if (_this5.f[key]) {\n              // this.f[key].duringBuild = true;\n              _this5.f[key].value = v;\n              doc[key] = _this5.f[key].value;\n            } else {\n              _.forEach(_this5._fields, function (field) {\n                if (field._intentId === key || field.title === key || field.dbName === key) {\n                  // field.duringBuild = true;\n                  field.value = v;\n                  doc[field._intentId] = field.value;\n                }\n              });\n            }\n          }\n        });\n        if (!skipPostBuild) {\n          this.onPostBuild(this, docFromDB);\n        }\n        this._state.duringBuild = false; // -- auto save changes trigger to the usual state\n        return this._document;\n      } catch (error) {\n        D.log({\n          message: 'Error building document',\n          data: docFromDB\n        });\n        this._state.addSystemErrorToStack(45, null, error.message);\n      }\n    }\n  }, {\n    key: \"buildDocumentFromUserMessage\",\n    value: function buildDocumentFromUserMessage(messageFromUser) {\n      var _ = this._state._;\n      this._state.duringBuild = true; // -- setting the auto save changes trigger to ignoring changes\n\n      var messageFromUserRefactored = {};\n      _.forEach(messageFromUser.fields, function (message) {\n        messageFromUserRefactored[message.id] = message;\n      });\n      _.forEach(this._fields, function (field) {\n        if (_.get(messageFromUserRefactored[field.intentId], 'fileName')) {\n          field.value = {\n            value: _.get(messageFromUserRefactored[field.intentId], 'value'),\n            fileName: _.get(messageFromUserRefactored[field.intentId], 'fileName')\n          };\n        } else {\n          field.value = _.get(messageFromUserRefactored[field.intentId], 'value');\n        }\n      });\n      this._state.duringBuild = false;\n    }\n  }, {\n    key: \"clearDocument\",\n    value: function clearDocument() {\n      var _ = this._state._;\n      var D = this._state.developer;\n      this._document = {};\n      this._dbDocument = {};\n      _.forEach(this._fields, function (field) {\n        if (!field.primaryKey) {\n          field._value = field._originalValue;\n        }\n      });\n    }\n  }, {\n    key: \"processDataFromDB\",\n    value: function processDataFromDB(payload) {\n      if (Array.isArray(payload)) {\n        if (payload.length === 1) {\n          var result = {};\n          if (this.hasSubDocs) {\n            result = this.buildDocumentFromContainer(payload[0]);\n          } else {\n            result = this.buildDocument(payload[0]);\n          }\n          return result;\n        } else if (payload.length > 1) {\n          this._state.addErrorToStack(7, 'Multiple records returned by query while expecting only one', payload);\n        } else return {};\n      } else {\n        return this.buildDocument(payload);\n      }\n    }\n  }, {\n    key: \"loadDocument\",\n    value: function () {\n      var _loadDocument = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(query) {\n        var start, _, R, D, primaryKey, results, payload, result;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              start = Date.now();\n              if (!this._subDoc) {\n                _context7.next = 4;\n                break;\n              }\n              this._state.addSystemErrorToStack(7, \"Sub documents cannot be loaded \".concat(this._intentId));\n              return _context7.abrupt(\"return\");\n            case 4:\n              if (this._collection) {\n                _context7.next = 7;\n                break;\n              }\n              this._state.addSystemErrorToStack(7, \"Collection not assigned to document \".concat(this._intentId));\n              return _context7.abrupt(\"return\");\n            case 7:\n              _ = this._state._;\n              R = this._state.R;\n              D = this._state.developer;\n              this.clearDocument();\n              this.docId = this._state.user.userId;\n              this.clearAutoSaveBuffer();\n              primaryKey = {};\n              if (query) {\n                primaryKey = query;\n              } else {\n                primaryKey = this.getPrimaryKey();\n              }\n              if (!(_.size(primaryKey) > 0)) {\n                _context7.next = 30;\n                break;\n              }\n              _context7.next = 18;\n              return this._state.db.getDataFromCollection({\n                collection: this._collectionDBName,\n                local: this.collection.local,\n                query: primaryKey,\n                expectOneResult: true,\n                system: _.get(this.collection, 'system'),\n                cache: _.get(this.collection, '_cache'),\n                securedFields: this.getSecuredFieldsArray()\n              });\n            case 18:\n              results = _context7.sent;\n              if (!(_.get(results, 'statusCode') === 200)) {\n                _context7.next = 27;\n                break;\n              }\n              payload = results.body;\n              result = this.processDataFromDB(payload);\n              _context7.next = 24;\n              return this.onPostLoad(this);\n            case 24:\n              return _context7.abrupt(\"return\", result);\n            case 27:\n              this._state.addSystemErrorToStack(7, 'Error reading MongoDB');\n            case 28:\n              _context7.next = 31;\n              break;\n            case 30:\n              this._state.addErrorToStack(7, 'You need to add some values to the primary key or passing a value in query before calling loadDocument(query)');\n            case 31:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function loadDocument(_x3) {\n        return _loadDocument.apply(this, arguments);\n      }\n      return loadDocument;\n    }()\n  }, {\n    key: \"deltaDoc\",\n    get: function get() {\n      var _ = this._state._;\n      var delta = {};\n      var D = this._state.developer;\n      _.forEach(this._fields, function (field) {\n        if (field.getAutoSavedValueChanged()) {\n          delta[field.dbName || field._intentId] = field.value;\n        }\n      });\n      if (this.hasSubDocs) {\n        _.forEach(this._subDocs, function (subDoc) {\n          var deltaSubDoc = subDoc.deltaDoc;\n          if (_.size(deltaSubDoc) > 0) {\n            _.forEach(deltaSubDoc, function (value, key) {\n              delta[\"\".concat(subDoc.intentId, \".\").concat(key)] = value;\n            });\n          }\n        });\n        // has an issue and have to check properly\n        _.forEach(this._subCollections, function (subCollection) {\n          delta[subCollection.intentId] = subCollection.rowAsDocumentsArray();\n        });\n      }\n      return delta;\n    }\n\n    //sync is a flag to indicate that the save is coming from an offline sync and not from a save\n  }, {\n    key: \"saveDelta\",\n    value: function () {\n      var _saveDelta = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(sync, withKey) {\n        var D, _, query, options;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              //TODO: saveDelta is not yet fully functional\n              D = this._state.developer;\n              _ = this._state._;\n              _context8.next = 4;\n              return this.onSave(this);\n            case 4:\n              if (!this._subDoc) {\n                _context8.next = 7;\n                break;\n              }\n              this._state.addSystemErrorToStack(7, \"Sub documents cannot be saved \".concat(this._intentId));\n              return _context8.abrupt(\"return\");\n            case 7:\n              query = {};\n              if (withKey) {\n                query = withKey;\n              } else {\n                query = this.getPrimaryKey();\n              }\n              options = {\n                upsert: true // or 1\n              };\n\n              D.info({\n                message: 'Saving doc delta',\n                data: {\n                  collection: this._collectionDBName,\n                  document: this.deltaDoc,\n                  query: query\n                }\n              });\n              if (!this._autoIndex) {\n                _context8.next = 14;\n                break;\n              }\n              _context8.next = 14;\n              return this.saveToIndex();\n            case 14:\n              _context8.next = 16;\n              return this._state.db.updateDataInCollection({\n                collection: this._collectionDBName,\n                document: this.deltaDoc,\n                query: query,\n                options: options,\n                audit: this._audit,\n                sync: sync,\n                system: _.get(this.collection, 'system'),\n                securedFields: this.getSecuredFieldsArray(),\n                cache: this.collection.cache\n              });\n            case 16:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function saveDelta(_x4, _x5) {\n        return _saveDelta.apply(this, arguments);\n      }\n      return saveDelta;\n    }()\n  }, {\n    key: \"save\",\n    value: function () {\n      var _save = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(sync, withKey, legacy, clearFields) {\n        var _this$collection;\n        var D, _, query, options, document;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              //sync is a flag to indicate that the save is coming from an offline sync and not from a save\n              D = this._state.developer;\n              _ = this._state._;\n              _context9.next = 4;\n              return this.onSave(this);\n            case 4:\n              if (!this._subDoc) {\n                _context9.next = 7;\n                break;\n              }\n              this._state.addSystemErrorToStack(7, \"Sub documents cannot be saved \".concat(this._intentId));\n              return _context9.abrupt(\"return\");\n            case 7:\n              query = {};\n              if (withKey) {\n                query = withKey;\n              } else {\n                query = this.getPrimaryKey();\n              }\n              options = {\n                upsert: true // or 1\n              };\n              document = legacy ? this._document : this._dbDocument;\n              if (clearFields) {\n                document = _objectSpread(_objectSpread({}, document), {}, {\n                  $unset: this.getClearedFields(legacy)\n                });\n              }\n              D.info({\n                message: 'Saving doc',\n                data: {\n                  collection: this._collectionDBName,\n                  document: this._dbDocument,\n                  query: query\n                }\n              });\n              if (!this._autoIndex) {\n                _context9.next = 16;\n                break;\n              }\n              _context9.next = 16;\n              return this.saveToIndex();\n            case 16:\n              _context9.next = 18;\n              return this._state.db.updateDataInCollection({\n                collection: this._collectionDBName,\n                document: document,\n                local: (_this$collection = this.collection) === null || _this$collection === void 0 ? void 0 : _this$collection.local,\n                query: query,\n                options: options,\n                audit: this._audit,\n                sync: sync,\n                system: _.get(this.collection, 'system'),\n                securedFields: this.getSecuredFieldsArray(),\n                cache: this.collection.cache\n              });\n            case 18:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this);\n      }));\n      function save(_x6, _x7, _x8, _x9) {\n        return _save.apply(this, arguments);\n      }\n      return save;\n    }()\n  }, {\n    key: \"legacySave\",\n    value: function () {\n      var _legacySave = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(sync, withKey) {\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return this.save(sync, withKey, true);\n            case 2:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function legacySave(_x10, _x11) {\n        return _legacySave.apply(this, arguments);\n      }\n      return legacySave;\n    }()\n  }, {\n    key: \"indexName\",\n    get: function get() {\n      return \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.PREFIXES.INDEX, \"_\").concat(this._state.currentUserDomain, \"_\").concat(this._collectionDBName);\n    }\n  }, {\n    key: \"queryKeyFromIndex\",\n    value: function () {\n      var _queryKeyFromIndex = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11() {\n        var D, _, primaryKey, queryObject, payload;\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) switch (_context11.prev = _context11.next) {\n            case 0:\n              D = this._state.developer;\n              _ = this._state._;\n              primaryKey = this.getPrimaryKey();\n              queryObject = _Utils__WEBPACK_IMPORTED_MODULE_2__.Utils.getTermQueryForObject(primaryKey, this._state);\n              _context11.next = 6;\n              return this._state.db.getDataFromIndexWithQueryObject(this.indexName, queryObject);\n            case 6:\n              payload = _context11.sent;\n              if (!(!_.get(payload, \"errorMessage\") && !_.get(payload, \"error\"))) {\n                _context11.next = 9;\n                break;\n              }\n              return _context11.abrupt(\"return\", payload);\n            case 9:\n            case \"end\":\n              return _context11.stop();\n          }\n        }, _callee11, this);\n      }));\n      function queryKeyFromIndex() {\n        return _queryKeyFromIndex.apply(this, arguments);\n      }\n      return queryKeyFromIndex;\n    }()\n  }, {\n    key: \"loadDocumentFromIndex\",\n    value: function () {\n      var _loadDocumentFromIndex = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12() {\n        var _, D, payload, result;\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              this.clearDocument();\n              _context12.next = 5;\n              return this.queryKeyFromIndex();\n            case 5:\n              payload = _context12.sent;\n              _context12.next = 8;\n              return this.processDataFromDB(payload);\n            case 8:\n              result = _context12.sent;\n              return _context12.abrupt(\"return\", result);\n            case 10:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this);\n      }));\n      function loadDocumentFromIndex() {\n        return _loadDocumentFromIndex.apply(this, arguments);\n      }\n      return loadDocumentFromIndex;\n    }()\n  }, {\n    key: \"saveToIndex\",\n    value: function () {\n      var _saveToIndex = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n        var _, D, payload, docToUpdate;\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              _context13.next = 4;\n              return this.queryKeyFromIndex();\n            case 4:\n              payload = _context13.sent;\n              if (!payload) {\n                _context13.next = 13;\n                break;\n              }\n              D.info({\n                message: 'Updating record in ES'\n              });\n              docToUpdate = _.cloneDeep(this._dbDocument);\n              docToUpdate.id = _.get(payload[0], '_id');\n              _context13.next = 11;\n              return this._state.db.updateDataInIndex({\n                index: this.indexName,\n                doc: docToUpdate\n              });\n            case 11:\n              _context13.next = 16;\n              break;\n            case 13:\n              D.info({\n                message: 'Inserting record in ES'\n              });\n              _context13.next = 16;\n              return this._state.db.writeDataIntoIndex({\n                index: this.indexName,\n                doc: this._dbDocument\n              });\n            case 16:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this);\n      }));\n      function saveToIndex() {\n        return _saveToIndex.apply(this, arguments);\n      }\n      return saveToIndex;\n    }()\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14() {\n        var _this$collection2;\n        var D, _, query;\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) switch (_context14.prev = _context14.next) {\n            case 0:\n              D = this._state.developer;\n              _ = this._state._;\n              D.info({\n                message: 'Deleting doc',\n                data: {\n                  collection: this._collectionDBName,\n                  document: this._dbDocument\n                }\n              });\n              query = this.getPrimaryKey();\n              _context14.next = 6;\n              return this._state.db.deleteDataFromCollection({\n                collection: this._collectionDBName,\n                document: this._dbDocument,\n                query: query,\n                local: (_this$collection2 = this.collection) === null || _this$collection2 === void 0 ? void 0 : _this$collection2.local,\n                system: _.get(this.collection, 'system')\n              });\n            case 6:\n            case \"end\":\n              return _context14.stop();\n          }\n        }, _callee14, this);\n      }));\n      function _delete() {\n        return _delete2.apply(this, arguments);\n      }\n      return _delete;\n    }()\n  }, {\n    key: \"rebuildDocumentObject\",\n    value: function rebuildDocumentObject() {\n      var _this6 = this;\n      var _ = this._state._;\n      if (_.size(this._document) === 0) {\n        _.forEach(this._fields, function (field) {\n          if (!field.temp) {\n            _this6._document[field._intentId] = field.value;\n            _this6._dbDocument[field.dbName || field._intentId] = field.value;\n          }\n        });\n      }\n      if (this.hasSubDocs) {\n        _.forEach(this._subDocs, function (subDoc) {\n          if (!subDoc.temp) {\n            _this6._document[subDoc.intentId] = subDoc.rebuildDocumentObject();\n            _this6._dbDocument[subDoc.intentId] = _this6._document[subDoc.intentId];\n          }\n        });\n        _.forEach(this._subCollections, function (subCollection) {\n          if (!subCollection.temp) {\n            var rowDocuments = [];\n            _.forEach(subCollection.rows, function (row) {\n              rowDocuments.push(row.rebuildDocumentObject());\n            });\n            _this6._document[subCollection.intentId] = rowDocuments;\n            _this6._dbDocument[subCollection.intentId] = _this6._document[subCollection.intentId];\n          }\n        });\n      }\n      return this._document;\n    }\n  }, {\n    key: \"getSecuredFieldsArray\",\n    value: function getSecuredFieldsArray() {\n      var _ = this._state._;\n      var D = this._state.developer;\n      var securedFieldsArray = [];\n      _.forEach(this._fields, function (field) {\n        if (field.encrypted) {\n          securedFieldsArray.push(field.dbName || field.id);\n        }\n      });\n      if (this.hasSubDocs) {\n        _.forEach(this._subDocs, function (subDoc) {\n          var subDocArray = subDoc.getSecuredFieldsArray();\n          _.forEach(subDocArray, function (entry) {\n            securedFieldsArray.push(\"\".concat(subDoc.intentId, \".\").concat(entry));\n          });\n        });\n        _.forEach(this._subCollections, function (subCollection) {\n          var subDoc = subCollection.document;\n          var subDocArray = subDoc.getSecuredFieldsArray();\n          _.forEach(subDocArray, function (entry) {\n            securedFieldsArray.push(\"\".concat(subDoc.intentId, \".\").concat(entry));\n          });\n        });\n      }\n      return securedFieldsArray;\n    }\n  }, {\n    key: \"getClearedFields\",\n    value: function getClearedFields(legacy) {\n      var _ = this._state._;\n      var D = this._state.developer;\n      var unsetObject = {};\n      _.forEach(this._fields, function (field) {\n        if (field.value === undefined || field.value === null) {\n          unsetObject[legacy ? field.intentId : field.dbName] = 1;\n        }\n      });\n      if (this.hasSubDocs) {\n        _.forEach(this._subDocs, function (subDoc) {\n          var subDocUnsetObject = subDoc.getClearedFields(legacy);\n          _.forEach(subDocUnsetObject, function (value, key) {\n            unsetObject[\"\".concat(subDoc.intentId, \".\").concat(key)] = 1;\n          });\n        });\n      }\n      return unsetObject;\n    }\n  }, {\n    key: \"document\",\n    get: function get() {\n      var _this7 = this;\n      var _ = this._state._;\n      if (_.size(this._document) === 0) {\n        _.forEach(this._fields, function (field) {\n          _this7._document[field._intentId] = field.value;\n        });\n      }\n      return this._document;\n    },\n    set: function set(doc) {\n      this._document = doc;\n    }\n  }, {\n    key: \"hasSubDocs\",\n    get: function get() {\n      return this._subDocs.length > 0 || this._subCollections.length > 0;\n    }\n  }, {\n    key: \"autoSave\",\n    get: function get() {\n      return this._autoSave;\n    },\n    set: function set(autoSave) {\n      this._autoSave = autoSave;\n    }\n  }, {\n    key: \"addChildDoc\",\n    value: function addChildDoc(child) {\n      this.docId = this._state.user.userId;\n      if (child.dataType === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TYPES.DOC) {\n        this._subDocs.push(child);\n      } else if (child.dataType === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.TYPES.COLLECTION) {\n        this._subCollections.push(child);\n      } else {\n        this._state.addSystemErrorToStack(7, \"Child must be instance of either Doc or Collection classes \".concat(this._intentId));\n        return false;\n      }\n      this._children[child.intentId] = child;\n      return true;\n    }\n  }, {\n    key: \"children\",\n    get: function get() {\n      return this._children;\n    }\n  }, {\n    key: \"onMatching\",\n    get: function get() {\n      var _this8 = this;\n      return function (state) {\n        var inputControlId = state.messageFromUser.controlId || state.messageFromUser.formId;\n        return state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.RESPONSES.FORM_RESPONSE && !state.messageFromUser.currentField && inputControlId === _this8.formId;\n      };\n    }\n  }, {\n    key: \"_callEvents\",\n    value: function () {\n      var _callEvents2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(state) {\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) switch (_context15.prev = _context15.next) {\n            case 0:\n              if (this._parent && this._parent._intentId === state.currentControlId) {\n                state.currentControlId = this._parent._intentId;\n              } else {\n                state.currentControlId = this.intentId;\n              }\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CONFIRM)) {\n                _context15.next = 6;\n                break;\n              }\n              _context15.next = 4;\n              return this.onSubmit();\n            case 4:\n              _context15.next = 17;\n              break;\n            case 6:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CANCEL)) {\n                _context15.next = 11;\n                break;\n              }\n              _context15.next = 9;\n              return this.onCancel();\n            case 9:\n              _context15.next = 17;\n              break;\n            case 11:\n              if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CLOSE)) {\n                _context15.next = 16;\n                break;\n              }\n              _context15.next = 14;\n              return this.onClose();\n            case 14:\n              _context15.next = 17;\n              break;\n            case 16:\n              state.addSystemErrorToStack(29, _Error__WEBPACK_IMPORTED_MODULE_3__.Error.getErrorMessageforCodeAndLang(29));\n            case 17:\n              if (state.responsesArray.length === 0) {\n                state.addSilentResponse();\n              }\n            case 18:\n            case \"end\":\n              return _context15.stop();\n          }\n        }, _callee15, this);\n      }));\n      function _callEvents(_x12) {\n        return _callEvents2.apply(this, arguments);\n      }\n      return _callEvents;\n    }()\n  }, {\n    key: \"onResolution\",\n    get: function get() {\n      var _this9 = this;\n      return /*#__PURE__*/function () {\n        var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16(state) {\n          var _, docId, tabId, parentDocId, document;\n          return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n            while (1) switch (_context16.prev = _context16.next) {\n              case 0:\n                console.log(\"In Doc resolution\");\n                _ = state._;\n                docId = _.get(state.messageFromUser, 'docId');\n                tabId = _.get(state.messageFromUser, 'tabId');\n                if (docId) {\n                  parentDocId = _.get(state.messageFromUser, 'parentDocId');\n                  _this9.loadDocFromAutoSaveBuffer(tabId, docId, parentDocId);\n                }\n                if (!docId || _.get(state.messageFromUser, 'action') === _ALLConstants__WEBPACK_IMPORTED_MODULE_1__.ALL_CONSTANTS.ACTIONS.CONFIRM) {\n                  document = _Utils__WEBPACK_IMPORTED_MODULE_2__.Utils.formResponseAsObject(state.messageFromUser);\n                  _this9.buildDocument(document);\n                }\n                state.currentControlId = _this9.intentId;\n                if (tabId) {\n                  _this9.tabId = tabId;\n                }\n                _context16.next = 10;\n                return _this9._callEvents(state);\n              case 10:\n              case \"end\":\n                return _context16.stop();\n            }\n          }, _callee16);\n        }));\n        return function (_x13) {\n          return _ref8.apply(this, arguments);\n        };\n      }();\n    }\n  }, {\n    key: \"overrideParentDocId\",\n    value: function overrideParentDocId(parentDocId) {\n      var _ = this._state._;\n      if (this._parentDoc) {\n        this._parentDoc.overrideParentDocId(parentDocId);\n      } else {\n        if (this._collection) {\n          var collection = _.get(this._state.intents, this._collection);\n          if (collection._parentDoc) {\n            collection._parentDoc.overrideParentDocId(parentDocId);\n          } else {\n            if (_.size(this._children) > 0) {\n              this.docId = parentDocId;\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"loadDocFromAutoSaveBuffer\",\n    value: function loadDocFromAutoSaveBuffer(tabId, docId, parentDocId) {\n      var _this10 = this;\n      if (this.autoSave) {\n        var _this$_subCollections;\n        var _ = this._state._;\n        if (docId) this.docId = docId;\n        if (parentDocId) this.overrideParentDocId(parentDocId);\n        this._state.duringBuild = true;\n        _.forEach(this._fields, function (field) {\n          field.setValueFromAutoSave(tabId, parentDocId);\n        });\n        if (((_this$_subCollections = this._subCollections) === null || _this$_subCollections === void 0 ? void 0 : _this$_subCollections.length) > 0) {\n          _.forEach(this._subCollections, function (subCollection) {\n            subCollection.clearRows();\n            subCollection.loadRowsFromAutoSaveBuffer(tabId);\n            _this10._document[subCollection.intentId] = subCollection.rowAsDocumentsArray();\n            _this10._dbDocument[subCollection.intentId] = subCollection.rowAsDocumentsArray();\n          });\n        }\n        this._state.duringBuild = false;\n      }\n    }\n  }, {\n    key: \"generateAutoSaveBufferFromDoc\",\n    value: function generateAutoSaveBufferFromDoc() {\n      if (!this.docId) {\n        this.docId = this._state.getUniqueId();\n        this._fields.forEach(function (field) {\n          field.setAutoSaveFieldValue(field.value);\n        });\n      }\n    }\n  }, {\n    key: \"getAutoSavePath\",\n    value: function getAutoSavePath(tabId, parentDocId) {\n      var state = this._state;\n      try {\n        var _ = state._;\n        var D = state.developer;\n        var tabIdToLoad = tabId || state.currentTabId || this.tabId;\n        if (this._parentDoc) {\n          var docPath = this._parentDoc.getAutoSavePath(tabIdToLoad, parentDocId);\n          return \"\".concat(docPath, \".\").concat(this.intentId);\n        } else {\n          var collectionName = _.get(this, '_collection');\n          if (collectionName) {\n            var collection = _.get(state.intents, collectionName); //It will be present if the doc is correctly defined for storage\n            if (collection) {\n              var _docPath = collection.getAutoSavePath(tabIdToLoad, parentDocId);\n              var docIdToUse = this.docId;\n              if (!collection._parentDoc) {\n                if (parentDocId) {\n                  docIdToUse = parentDocId;\n                }\n              }\n              return state._version >= 3 ? \"\".concat(_docPath, \".\").concat(docIdToUse) : \"\".concat(_docPath, \".\").concat(this.intentId);\n            }\n          }\n        }\n      } catch (error) {\n        state.addSystemErrorToStack(999, error.message, this.intentId);\n      }\n    }\n  }, {\n    key: \"clearAutoSaveBuffer\",\n    value: function clearAutoSaveBuffer(tabId, docId, parentDocId) {\n      if (!this.autoSave) return;\n      var _ = this._state._;\n      var autoSaveBuffer = this._state.autoSaveBuffer;\n      var tabIdToUse = tabId || this._state.currentTabId || this.tabId;\n      if (docId) this.docId = docId;\n      if (parentDocId) this.overrideParentDocId(parentDocId);\n      if (_.get(autoSaveBuffer, tabIdToUse)) {\n        var path = this.getAutoSavePath(tabIdToUse, parentDocId);\n        if (path) {\n          _.unset(autoSaveBuffer, path);\n        }\n      }\n    }\n  }, {\n    key: \"clearAutoSaveBufferChanges\",\n    value: function clearAutoSaveBufferChanges(tabId, docId, parentDocId) {\n      var _ = this._state._;\n      var autoSaveBufferChanges = this._state.autoSaveBufferChanges;\n      var tabIdToUse = tabId || this._state.currentTabId || this.tabId;\n      if (docId) this.docId = docId;\n      if (parentDocId) this.overrideParentDocId(parentDocId);\n      if (_.get(autoSaveBufferChanges, tabIdToUse)) {\n        var path = this.getAutoSavePath(tabIdToUse, parentDocId);\n        if (path) {\n          _.unset(autoSaveBufferChanges, path);\n        }\n      }\n    }\n  }, {\n    key: \"addCollectionToSection\",\n    value: function addCollectionToSection(collection, section) {\n      var D = this._state.developer;\n      if (!section.forCollection) {\n        D.systemError({\n          message: \"Trying to add a collection in a normal section\"\n        });\n        return;\n      }\n      if (!collection.isSubCollection) {\n        collection.setParentDoc(this);\n      } else if (collection.parentDoc.intentId !== this.intentId) {\n        return D.systemError({\n          message: \"Trying to add a collection with other parentDoc\"\n        });\n      }\n      this.version = 4;\n      collection.sectionId = section.intentId;\n      this._sectionCollections[section.intentId] = collection;\n    }\n  }]);\n  return Doc;\n}(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Doc.js?");

/***/ }),

/***/ "../../frontmjs/core/Error.js":
/*!************************************!*\
  !*** ../../frontmjs/core/Error.js ***!
  \************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Error: function() { return /* binding */ Error; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Error = /*#__PURE__*/function () {\n  function Error(state, errorCode, errorMessage) {\n    _classCallCheck(this, Error);\n    this._errorCode = errorCode;\n    if (errorCode < 1000) {\n      if (errorMessage) {\n        this._errorMessage = Error.getErrorMessageforCodeAndLang(errorCode, state.lang) + ' ' + errorMessage;\n      } else {\n        this._errorMessage = Error.getErrorMessageforCodeAndLang(errorCode, state.lang);\n      }\n    } else {\n      this._errorMessage = errorMessage;\n    }\n  }\n  _createClass(Error, [{\n    key: \"errorCode\",\n    get: function get() {\n      return this._errorCode;\n    }\n  }, {\n    key: \"errorMessage\",\n    get: function get() {\n      return this._errorMessage;\n    }\n  }], [{\n    key: \"getErrorMessageforCodeAndLang\",\n    value: function getErrorMessageforCodeAndLang(errorCode, lang) {\n      var errorsLibrary = {\n        0: {\n          en: 'No error'\n        },\n        1: {\n          en: 'The valid values for RunLocation are Edge and Cloud'\n        },\n        2: {\n          en: 'RunLocation attribute is mandatory'\n        },\n        3: {\n          en: 'The onResolution function is mandatory'\n        },\n        4: {\n          en: 'To process your request, I need to reach the cloud and you appear to be offline at this moment. Please try again later'\n        },\n        5: {\n          en: 'Error in edge bot logic with message '\n        },\n        6: {\n          en: 'NLP.js cannot be called with other data than string'\n        },\n        7: {\n          en: 'Error processing botResolver in backend'\n        },\n        8: {\n          en: 'Error in cloud bot logic with message '\n        },\n        9: {\n          en: 'The name for the bot name already exists for your domain, please change it and try again'\n        },\n        10: {\n          en: 'An unknown problem has appeared during the bot publication process. Please contact FrontM support.'\n        },\n        11: {\n          en: 'Logic error in onError function'\n        },\n        12: {\n          en: 'Wrong debug command'\n        },\n        13: {\n          en: 'I Cannot run inApp purchases in the cloud'\n        },\n        14: {\n          en: 'Invalid message adding a response'\n        },\n        15: {\n          en: 'I have not received the authorisation to activate the notifications. You can request me to activate the notifications in any time.'\n        },\n        16: {\n          en: 'I could not register your device for notifications at this moment. Please try again later'\n        },\n        17: {\n          en: 'I could not modify your password. Please be sure that your old password is correct and that you are following the FrontM password policy'\n        },\n        18: {\n          en: 'Capability not available on the cloud'\n        },\n        19: {\n          en: 'I encountered a problem unregistering your device for notifications'\n        },\n        20: {\n          en: 'I could not deregister your device for notifications at this moment. Please try again later'\n        },\n        21: {\n          en: 'Invalid intent object found'\n        },\n        22: {\n          en: 'Ambiguous NLP.js results'\n        },\n        23: {\n          en: 'This method requires an array of Strings'\n        },\n        24: {\n          en: 'Invalid NLP.js Id'\n        },\n        25: {\n          en: 'Invalid backend capability'\n        },\n        26: {\n          en: 'Backend capabilities are not present on edge'\n        },\n        27: {\n          en: 'Error running predictors with message '\n        },\n        28: {\n          en: 'Bad table action '\n        },\n        29: {\n          en: 'Bad form action '\n        },\n        30: {\n          en: 'Action not recognized during video call'\n        },\n        31: {\n          en: 'Error while encrypting data'\n        },\n        32: {\n          en: 'Error while decrypting data'\n        },\n        33: {\n          en: 'Could not send push notification '\n        },\n        34: {\n          en: 'Ambiguous intent matching. Please review your forms, tables and containers looking for duplicated names'\n        },\n        35: {\n          en: 'Ambiguous intent matching. Please review your intentIds looking for duplicated names or check your matching rules'\n        },\n        36: {\n          en: 'Could not write data in DB'\n        },\n        37: {\n          en: 'Error calling service'\n        },\n        38: {\n          en: 'Unidentified intent or control'\n        },\n        39: {\n          en: 'Bad data from cache in backend'\n        },\n        40: {\n          en: 'The Record you are trying to open is not available offline'\n        },\n        41: {\n          en: 'Invalid coordinates'\n        },\n        42: {\n          en: 'Error synchronising data '\n        },\n        43: {\n          en: 'Error sending a message in backend'\n        },\n        45: {\n          en: 'Error building document'\n        },\n        46: {\n          en: 'Bad field action '\n        },\n        47: {\n          en: 'Bad container action '\n        },\n        48: {\n          en: 'Bad map action '\n        },\n        49: {\n          en: 'Bad geofence action '\n        },\n        50: {\n          en: 'The data property is too big and it cannot be logged. Message: '\n        },\n        51: {\n          en: 'Duplicated entries in autoSave buffer'\n        },\n        52: {\n          en: 'The autoSave buffer is empty'\n        },\n        53: {\n          en: 'Location not available or with very weak signal'\n        },\n        54: {\n          en: 'Location not available on the cloud'\n        },\n        55: {\n          en: 'SQS Messages can only be sent from the cloud'\n        },\n        56: {\n          en: 'Your system appears to be offline. Please check your internet connection and try again later'\n        },\n        57: {\n          en: 'Field value error'\n        },\n        58: {\n          en: 'Error in video meeting'\n        },\n        59: {\n          en: 'Error in timelines response'\n        },\n        60: {\n          en: 'OpenAI response in error'\n        },\n        61: {\n          en: \"The Main intent running on cloud doesn't have an onResolution event\"\n        },\n        62: {\n          en: \"getMultipleStaticDataKeys requires an array of keys\"\n        },\n        63: {\n          en: \"NO INTENT MATCHED\"\n        },\n        999: {\n          en: ''\n        }\n      };\n      return errorsLibrary[errorCode][lang];\n    }\n  }]);\n  return Error;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Error.js?");

/***/ }),

/***/ "../../frontmjs/core/Field.js":
/*!************************************!*\
  !*** ../../frontmjs/core/Field.js ***!
  \************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Field: function() { return /* binding */ Field; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FormFieldTypes */ \"../../frontmjs/core/FormFieldTypes.js\");\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Error */ \"../../frontmjs/core/Error.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\n\n\nvar Field = /*#__PURE__*/function (_Intent) {\n  _inherits(Field, _Intent);\n  var _super = _createSuper(Field);\n  function Field(intentId, _ref) {\n    var _this;\n    var tabId = _ref.tabId,\n      doc = _ref.doc,\n      _ref$primaryKey = _ref.primaryKey,\n      primaryKey = _ref$primaryKey === void 0 ? false : _ref$primaryKey,\n      title = _ref.title,\n      activeIconUrl = _ref.activeIconUrl,\n      inactiveIconUrl = _ref.inactiveIconUrl,\n      type = _ref.type,\n      _ref$mandatory = _ref.mandatory,\n      mandatory = _ref$mandatory === void 0 ? false : _ref$mandatory,\n      _ref$validation = _ref.validation,\n      validation = _ref$validation === void 0 ? false : _ref$validation,\n      _ref$readOnly = _ref.readOnly,\n      readOnly = _ref$readOnly === void 0 ? false : _ref$readOnly,\n      value = _ref.value,\n      options = _ref.options,\n      info = _ref.info,\n      minLength = _ref.minLength,\n      maxLength = _ref.maxLength,\n      height = _ref.height,\n      maxSelectionOptions = _ref.maxSelectionOptions,\n      section = _ref.section,\n      _ref$column = _ref.column,\n      column = _ref$column === void 0 ? 0 : _ref$column,\n      _ref$hidden = _ref.hidden,\n      hidden = _ref$hidden === void 0 ? false : _ref$hidden,\n      _ref$quickView = _ref.quickView,\n      quickView = _ref$quickView === void 0 ? true : _ref$quickView,\n      _ref$lookup = _ref.lookup,\n      lookup = _ref$lookup === void 0 ? false : _ref$lookup,\n      lookUpCollection = _ref.lookUpCollection,\n      lookUpFilter = _ref.lookUpFilter,\n      valueFromLookUp = _ref.valueFromLookUp,\n      lookUpForeignKey = _ref.lookUpForeignKey,\n      _ref$searchKey = _ref.searchKey,\n      searchKey = _ref$searchKey === void 0 ? false : _ref$searchKey,\n      _ref$temp = _ref.temp,\n      temp = _ref$temp === void 0 ? false : _ref$temp,\n      _ref$includeInQuickEd = _ref.includeInQuickEdit,\n      includeInQuickEdit = _ref$includeInQuickEd === void 0 ? false : _ref$includeInQuickEd,\n      _ref$onMessage = _ref.onMessage,\n      onMessage = _ref$onMessage === void 0 ? function (self) {} : _ref$onMessage,\n      _ref$onResponse = _ref.onResponse,\n      onResponse = _ref$onResponse === void 0 ? function (self) {} : _ref$onResponse,\n      _ref$onInit = _ref.onInit,\n      onInit = _ref$onInit === void 0 ? /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(self) {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }() : _ref$onInit,\n      state = _ref.state,\n      _ref$onlineStatus = _ref.onlineStatus,\n      onlineStatus = _ref$onlineStatus === void 0 ? 0 : _ref$onlineStatus,\n      pointType = _ref.pointType,\n      iconType = _ref.iconType,\n      routeId = _ref.routeId,\n      iconColor = _ref.iconColor,\n      iconUrl = _ref.iconUrl,\n      fileScope = _ref.fileScope,\n      _ref$encrypted = _ref.encrypted,\n      encrypted = _ref$encrypted === void 0 ? false : _ref$encrypted,\n      dbName = _ref.dbName;\n    _classCallCheck(this, Field);\n    _this = _super.call(this, intentId, state, tabId);\n    _defineProperty(_assertThisInitialized(_this), \"dataType\", _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.TYPES.FIELD);\n    _this.onMoveOut = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }));\n    _this.onClick = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3);\n    }));\n    _this.onSearch = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) switch (_context4.prev = _context4.next) {\n          case 0:\n          case \"end\":\n            return _context4.stop();\n        }\n      }, _callee4);\n    }));\n    _this.onCompletion = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5);\n    }));\n    _this.onInit = onInit;\n    _this.onMessage = onMessage;\n    _this.onResponse = onResponse;\n    if ((typeof primaryKey !== 'boolean' || !title || !type) && !lookup && type !== _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.COLOR_FIELD) {\n      state.addSystemErrorToStack(7, 'Field title or type missing on field ' + intentId);\n      return _possibleConstructorReturn(_this);\n    }\n    _this.title = title;\n    _this.type = type;\n    _this.primaryKey = primaryKey;\n    _this.mandatory = mandatory;\n    _this.validation = validation;\n    _this.readOnly = readOnly;\n    _this._originalValue = value;\n    _this.options = options;\n    _this.info = info;\n    _this.maxLength = maxLength;\n    _this.minLength = minLength;\n    _this.maxSelectionOptions = maxSelectionOptions;\n    if (section && !section.forCollection) {\n      _this.section = section;\n    }\n    _this.column = column;\n    _this.hidden = hidden;\n    _this.temp = temp;\n    _this.lookup = lookup;\n    _this.onlineStatus = onlineStatus;\n    _this._changed = false;\n    _this.fileScope = fileScope;\n    _this._defaultValue = value;\n    _this.quickView = quickView;\n    _this.lookUpCollection = lookUpCollection;\n    _this.includeInQuickEdit = includeInQuickEdit;\n    _this.activeIconUrl = activeIconUrl;\n    _this.inactiveIconUrl = inactiveIconUrl;\n    _this._encrypted = encrypted;\n    _this._height = height;\n    _this._dbName = dbName || _this.intentId;\n    if (lookUpFilter) {\n      if (Array.isArray(lookUpFilter)) {\n        _this.lookUpFilter = lookUpFilter;\n      } else {\n        _this.lookUpFilter = [lookUpFilter];\n      }\n    }\n    if (Array.isArray(lookUpForeignKey)) {\n      _this.lookUpForeignKey = lookUpForeignKey;\n    } else {\n      _this.lookUpForeignKey = [lookUpForeignKey];\n    }\n    _this.valueFromLookUp = valueFromLookUp;\n    _this.searchKey = searchKey;\n    _this._doc = null;\n    _this._pointType = pointType;\n    _this._iconType = iconType;\n    _this._routeId = routeId;\n    _this._iconColor = iconColor;\n    _this._iconUrl = iconUrl;\n    _this.disableHistoryLogging();\n    if (doc) {\n      _this.formId = doc.intentId;\n      _this._doc = doc;\n      _this._index = doc.addField(_assertThisInitialized(_this));\n    }\n    if (value) _this.value = value;\n    return _this;\n  }\n  _createClass(Field, [{\n    key: \"resetProperties\",\n    value: function resetProperties() {\n      this._value = this._originalValue;\n    }\n  }, {\n    key: \"cloneField\",\n    value: function cloneField(doc, suffix) {\n      var fieldName = typeof suffix === \"undefined\" ? this.intentId : this.intentId + suffix;\n      var newField = new Field(fieldName, {\n        doc: doc,\n        tabId: this.tabId,\n        primaryKey: this.primaryKey,\n        title: this.title,\n        type: this.type,\n        mandatory: this.mandatory,\n        validation: this.validation,\n        readOnly: this.readOnly,\n        options: this.options,\n        info: this.info,\n        minLength: this.minLength,\n        maxLength: this.maxLength,\n        maxSelectionOptions: this.maxSelectionOptions,\n        section: this.section,\n        fileScope: this.fileScope,\n        column: this.column,\n        hidden: this.hidden,\n        quickView: this.quickView,\n        lookup: this.lookup,\n        lookUpCollection: this.lookUpCollection,\n        lookUpFilter: this.lookUpFilter,\n        valueFromLookUp: this.valueFromLookUp,\n        lookUpForeignKey: this.lookUpForeignKey,\n        searchKey: this.searchKey,\n        temp: this.temp,\n        state: doc._state,\n        onResponse: this.onResponse,\n        onInit: this.onInit,\n        onMessage: this.onMessage,\n        dbName: this.dbName,\n        activeIconUrl: this.activeIconUrl,\n        inactiveIconUrl: this.inactiveIconUrl,\n        routeId: this._routeId,\n        height: this._height\n      });\n      newField._changed = this._changed;\n      return newField;\n    }\n  }, {\n    key: \"message\",\n    value: function message(skipOnResponse, withDefault) {\n      this.runOnResponseLogic(skipOnResponse);\n      var _ = this._state._;\n      var v = this.value;\n      var type = this.type;\n      var fileName = '';\n      if (_typeof(this.value) === 'object' && _ !== null && _.get(this.value, 'fileName')) {\n        v = _.get(this.value, 'value');\n        fileName = _.get(this.value, 'fileName');\n      }\n      if (this.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.COORDINATES) {\n        v = \"\".concat(v[0], \", \").concat(v[1]);\n        type = _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.TEXT_FIELD;\n      }\n      return {\n        id: this.intentId,\n        tabId: this.tabId,\n        title: this.title,\n        type: type,\n        info: this.info,\n        mandatory: this.mandatory,\n        validation: this.validation,\n        readOnly: this.readOnly,\n        primaryKey: this.primaryKey,\n        value: withDefault ? this._defaultValue : v,\n        fileName: fileName,\n        maxLength: this.maxLength,\n        minLength: this.minLength,\n        maxSelectionOptions: this.maxSelectionOptions,\n        section: _.get(this.section, 'intentId'),\n        column: this.column,\n        options: this.options,\n        search: this.search,\n        hidden: this.hidden,\n        index: this._index,\n        onlineStatus: this.onlineStatus,\n        pointType: this._pointType,\n        iconType: this._iconType,\n        fileScope: this.fileScope,\n        quickView: this.quickView,\n        activeIconUrl: this.activeIconUrl,\n        inactiveIconUrl: this.inactiveIconUrl,\n        routeId: this._routeId,\n        iconColor: this._iconColor,\n        iconUrl: this._iconUrl,\n        height: this._height\n      };\n    }\n  }, {\n    key: \"runOnResponseLogic\",\n    value: function runOnResponseLogic(skipOnResponse) {\n      if (!skipOnResponse) {\n        this.onMessage(this);\n        this.onResponse(this);\n      }\n    }\n  }, {\n    key: \"shortMessage\",\n    value: function shortMessage(skipOnResponse, withDefault) {\n      var _ = this._state._;\n      this.runOnResponseLogic(skipOnResponse);\n      var v = this.value;\n      var type = this.type;\n      var fileName = '';\n      if (_typeof(this.value) === 'object' && _ !== null && _.get(this.value, 'fileName')) {\n        v = _.get(this.value, 'value');\n        fileName = _.get(this.value, 'fileName');\n      }\n      if (this.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.COORDINATES) {\n        v = \"\".concat(v[0], \", \").concat(v[1]);\n        type = _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.TEXT_FIELD;\n      }\n      return [this.intentId, this.tabId, this.title, type, this.info, this.mandatory, this.validation, this.readOnly, this.primaryKey, withDefault ? this._defaultValue : v, fileName, this.maxLength, this.minLength, _.get(this.section, 'intentId'), this.column, this.options, this.search, this.hidden, this._index, this.onlineStatus, this._pointType, this._iconType, this.fileScope, this.quickView, this.maxSelectionOptions, this.height];\n    }\n  }, {\n    key: \"updateFieldFromMessage\",\n    value: function updateFieldFromMessage(message) {\n      var _ = this._state._;\n      if (message && message.hasOwnProperty(\"id\") && message.id === this.id) {\n        this.tabId = _.get(message, \"tabId\", this.tabId);\n        this.title = _.get(message, \"title\", this.title);\n        this.type = _.get(message, \"type\", this.type); // Check\n        this.info = _.get(message, \"info\", this.info);\n        this.mandatory = _.get(message, \"mandatory\", this.mandatory);\n        this.validation = _.get(message, \"validation\", this.validation);\n        this.readOnly = _.get(message, \"readOnly\", this.readOnly);\n        this.primaryKey = _.get(message, \"primaryKey\", this.primaryKey);\n        this.maxLength = _.get(message, \"maxLength\", this.maxLength);\n        this.minLength = _.get(message, \"minLength\", this.minLength);\n        this.maxSelectionOptions = _.get(message, \"maxSelectionOptions\", this.maxSelectionOptions);\n        this.column = _.get(message, \"column\", this.column);\n        this.options = _.get(message, \"options\", this.options);\n        this.search = _.get(message, \"search\", this.search);\n        this.hidden = _.get(message, \"hidden\", this.hidden);\n        this._index = _.get(message, \"index\", this._index);\n        this.onlineStatus = _.get(message, \"onlineStatus\", this.onlineStatus);\n        this._pointType = _.get(message, \"pointType\", this._pointType);\n        this._iconType = _.get(message, \"iconType\", this._iconType);\n        this.fileScope = _.get(message, \"fileScope\", this.fileScope);\n        this.quickView = _.get(message, \"quickView\", this.quickView);\n        this.height = _.get(message, \"height\", this.height);\n      }\n    }\n  }, {\n    key: \"dbName\",\n    get: function get() {\n      return this._dbName;\n    },\n    set: function set(dbName) {\n      this._dbName = dbName;\n    }\n  }, {\n    key: \"encrypted\",\n    get: function get() {\n      return this._encrypted;\n    }\n  }, {\n    key: \"pointType\",\n    get: function get() {\n      return this._pointType;\n    },\n    set: function set(pointType) {\n      this._pointType = pointType;\n    }\n  }, {\n    key: \"iconType\",\n    get: function get() {\n      return this._iconType;\n    },\n    set: function set(iconType) {\n      this._iconType = iconType;\n    }\n  }, {\n    key: \"height\",\n    get: function get() {\n      return this._height;\n    },\n    set: function set(height) {\n      this._height = height;\n    }\n  }, {\n    key: \"routeId\",\n    get: function get() {\n      return this._routeId;\n    },\n    set: function set(routeId) {\n      this._routeId = routeId;\n    }\n  }, {\n    key: \"doc\",\n    get: function get() {\n      return this._doc;\n    },\n    set: function set(doc) {\n      this.formId = doc.formId;\n      this._doc = doc;\n      this._index = doc.addField(this);\n    }\n  }, {\n    key: \"value\",\n    get: function get() {\n      var _ = this._state._;\n      if (!_.isArray(this._value) && _typeof(this._value) === 'object' && _.size(this._value) === 0) {\n        //Nothing to do\n      } else {\n        return this._value;\n      }\n    },\n    set: function set(value) {\n      if (!this._state.stateInitialized) {\n        this._state.initializationErrorMessages.push(\"Values cannot be initialized outside a function. Default value ignored. Field \".concat(this.intentId));\n        return;\n      }\n      if (!this._doc) {\n        return;\n      }\n      var _ = this._state._;\n      if (this.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.COORDINATES && !Array.isArray(value)) {\n        this._state.addSystemErrorToStack(41);\n      }\n      if (!Array.isArray(value) && _typeof(value) === 'object' && _.size(value) === 0) return;\n      var v = value;\n      if (typeof v === 'string' && (this.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.DATE || this.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.DATETIME)) {\n        // v = new Date(value).getTime();\n        if (v.substring(0, 5) === '#date') {\n          v = parseInt(v.substring(6, 19));\n        } else {\n          v = parseInt(v);\n        }\n      }\n      if (this.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.LOOKUP && _typeof(v) === 'object' && _.size(v) > 1) {\n        v = _.get(v, 'text');\n      }\n      if (this.type !== _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.COLOR_FIELD) {\n        if (v !== this.tempValue) {\n          this._change = true;\n        }\n        this.setAutoSaveFieldValue(v);\n        if (!this.temp) {\n          this._doc._document[this._intentId] = v;\n          this._doc._dbDocument[this.dbName || this._intentId] = v;\n        }\n      }\n      this._doc._documentForShortResponse[this._intentId] = v;\n      this._value = v;\n    }\n  }, {\n    key: \"tempValue\",\n    get: function get() {\n      return this.getAutoSavedValue();\n    }\n  }, {\n    key: \"getAutoSavePath\",\n    value: function getAutoSavePath(tabId, parentDocId) {\n      var state = this._state;\n      var _ = state._;\n      try {\n        var docPath = this.doc.getAutoSavePath(tabId, parentDocId);\n        if (docPath) {\n          return \"\".concat(docPath, \".\").concat(this.id);\n        }\n      } catch (error) {\n        state.addSystemErrorToStack(999, 'Error in field getAutoSavePath', this.id);\n      }\n    }\n  }, {\n    key: \"setAutoSaveFieldValue\",\n    value: function setAutoSaveFieldValue(value) {\n      var state = this._state;\n      if (this.doc.autoSave && this.doc.docId) {\n        var _ = state._;\n        var path = this.getAutoSavePath();\n        if (!path) return;\n        if (value || value === 0) {\n          _.set(this.doc._state.autoSaveBuffer, path, value);\n        } else {\n          if (_.get(this.doc._state.autoSaveBuffer, path)) {\n            _.unset(this.doc._state.autoSaveBuffer, path);\n          }\n        }\n        if (!this.doc._state.duringBuild) {\n          _.set(this.doc._state.autoSaveBufferChanges, path, true);\n        }\n      }\n    }\n  }, {\n    key: \"getAutoSavedValue\",\n    value: function getAutoSavedValue(tabId, parentDocId) {\n      var state = this.doc._state;\n      if (this.doc.autoSave) {\n        var _ = state._;\n        var path = this.getAutoSavePath(tabId, parentDocId);\n        if (path) {\n          var v = _.get(this.doc._state.autoSaveBuffer, path);\n          return _.get(this.doc._state.autoSaveBuffer, path);\n        }\n      }\n    }\n  }, {\n    key: \"getAutoSavedValueChanged\",\n    value: function getAutoSavedValueChanged(tabId, parentDocId) {\n      var state = this.doc._state;\n      if (this.doc.autoSave) {\n        var _ = state._;\n        var path = this.getAutoSavePath(tabId, parentDocId);\n        if (path) {\n          return _.get(this.doc._state.autoSaveBufferChanges, path);\n        }\n      }\n    }\n  }, {\n    key: \"clearAutoSavedValue\",\n    value: function clearAutoSavedValue() {\n      this.setAutoSaveFieldValue();\n    }\n  }, {\n    key: \"setValueFromAutoSave\",\n    value: function setValueFromAutoSave(tabId, parentDocId) {\n      var _ = this._state._;\n      var autoSavedValue = this.getAutoSavedValue(tabId, parentDocId);\n      this.value = _.isNil(autoSavedValue) ? this.value : autoSavedValue;\n    }\n  }, {\n    key: \"id\",\n    get: function get() {\n      return this.intentId;\n    }\n  }, {\n    key: \"onMatching\",\n    get: function get() {\n      var _this2 = this;\n      return function (state) {\n        var _ = state._;\n        var inputControlId = state.messageFromUser.controlId || state.messageFromUser.formId;\n        return _this2.doc && (state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.RESPONSES.FORM_RESPONSE || state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.RESPONSES.TABLE_RESPONSE || state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.RESPONSES.CONTAINER_RESPONSE) && state.messageFromUser.currentField === _this2.id && (inputControlId === _this2.formId || inputControlId === _this2.doc._filteredCollectionName || inputControlId === _this2.doc._collection);\n      };\n    }\n  }, {\n    key: \"autoSaveLogic\",\n    value: function autoSaveLogic(state, currentFieldValue) {\n      if (!this._doc) {\n        return;\n      }\n      var _ = this._state._;\n      var D = this._state.developer;\n      if (this._doc.autoSave) {\n        if (typeof currentFieldValue !== 'undefined' && currentFieldValue !== null) {\n          if (_typeof(currentFieldValue) === 'object' && _.size(currentFieldValue) > 0 && this.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.LOOKUP && this.lookUpCollection) {\n            this.value = _.get(currentFieldValue, 'text');\n            var lookupArray = state.getField(_ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.PREFIXES.FIELD_LOOKUP_PREFIX + this.id);\n            var index = _.findIndex(lookupArray, function (entry) {\n              return _.get(entry, 'info') === _.get(currentFieldValue, 'info');\n            });\n            if (index > -1) {\n              var lookUpRecord = _.get(lookupArray[index], 'doc');\n              var changedFields = [];\n              _.forEach(this._doc.fields, function (field) {\n                if (field.valueFromLookUp) {\n                  _.forEach(lookUpRecord, function (value, key) {\n                    if (key === field.valueFromLookUp) {\n                      field.value = lookUpRecord[key];\n                      changedFields.push(field.message(true));\n                    }\n                  });\n                }\n              });\n              if (changedFields.length > 0) {\n                if (state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.RESPONSES.TABLE_RESPONSE) {\n                  state.addInLineFormChangeResponse(this._doc.message(_ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.CHANGE, changedFields, null, true, true));\n                } else {\n                  state.addFormChangeResponse(this._doc.message(_ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.CHANGE, changedFields, null, null, true));\n                }\n              }\n            }\n          } else {\n            if (currentFieldValue === '' || _.get(currentFieldValue, 'text') === '') {\n              this.clearAutoSavedValue();\n            } else {\n              this.value = currentFieldValue;\n            }\n            state.storeAutoSaveBuffer();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"lookupLogic\",\n    value: function () {\n      var _lookupLogic = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(state) {\n        var _this3 = this;\n        var _, currentFieldValue, query, and, i, or, orArray, rows, resultsArray, queryResults, results, _results;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              if (this._doc) {\n                _context6.next = 2;\n                break;\n              }\n              return _context6.abrupt(\"return\");\n            case 2:\n              _ = state._; //{\"formId\":\"caseDoc\",\"action\":\"search\",\"currentField\":\"casePatient\",\"currentFieldValue\":\"aaaaaaa\"}\n              currentFieldValue = _.get(state.messageFromUser, 'currentFieldValue', _.get(state.messageFromUser, 'content.currentFieldValue')); //let currentField = state._.get(state.messageFromUser, 'currentField');\n              if (!(currentFieldValue !== '' && this.lookUpCollection)) {\n                _context6.next = 22;\n                break;\n              }\n              query = {};\n              and = [];\n              if (this.lookUpFilter) {\n                i = 0;\n                _.forEach(this.lookUpFilter, function (filter) {\n                  var filterValue = filter.tempValue;\n                  if (filterValue !== null) {\n                    var fieldQuery = {};\n                    fieldQuery[_this3.lookUpForeignKey[i]] = filterValue;\n                    and.push(fieldQuery);\n                  }\n                  i++;\n                });\n              }\n              or = {};\n              orArray = [];\n              this.lookUpCollection.document.fields.forEach(function (field) {\n                var fieldQuery = {};\n                if (field.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.NUMBER_FIELD) {\n                  fieldQuery[field.id] = field.value;\n                } else {\n                  var regexSearch = {};\n                  regexSearch['$regex'] = \"^(.*?)\".concat(currentFieldValue);\n                  regexSearch['$options'] = \"i\";\n                  fieldQuery[field.id] = regexSearch;\n                }\n                orArray.push(fieldQuery);\n              });\n              or['$or'] = orArray;\n              and.push(or);\n              query['$and'] = and;\n              _context6.next = 16;\n              return this.lookUpCollection.loadCollectionWithQuery({\n                query: query\n              });\n            case 16:\n              rows = _context6.sent;\n              resultsArray = [];\n              queryResults = [];\n              _.forEach(this.lookUpCollection.rows, function (doc) {\n                var text = _this3.valueFromLookUp ? doc.document[_this3.valueFromLookUp] : doc.getPrimaryKeyAsStringForSearch(doc.getPrimaryKey());\n                var info = doc.getPrimaryKeyAsStringForSearch(doc.getNonPrimaryKey());\n                var newResultEntry = {\n                  text: text,\n                  info: info !== \"\" ? info : null\n                };\n                // D.log({message: 'Result entry', data: newResultEntry});\n                resultsArray.push(newResultEntry);\n                var resultsToStore = _.cloneDeep(newResultEntry);\n                resultsToStore.doc = doc.document;\n                queryResults.push(resultsToStore);\n              });\n              if (_.get(this.doc, '_state.messageTypeFromUser') === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.RESPONSES.TABLE_RESPONSE) {\n                results = this._doc.message(_ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.RESULTS, {\n                  field: this.id,\n                  results: resultsArray\n                }, null, true, true);\n                state.addInLineFormChangeResponse(results);\n              } else {\n                _results = this._doc.message(_ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.RESULTS, {\n                  field: this.id,\n                  results: resultsArray\n                }, null, null, true);\n                state.addFormChangeResponse(_results);\n              }\n              state.setField(_ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.PREFIXES.FIELD_LOOKUP_PREFIX + this.id, queryResults);\n            case 22:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function lookupLogic(_x2) {\n        return _lookupLogic.apply(this, arguments);\n      }\n      return lookupLogic;\n    }()\n  }, {\n    key: \"onResolution\",\n    get: function get() {\n      var _this4 = this;\n      return /*#__PURE__*/function () {\n        var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(state) {\n          var _, D, currentFieldValue, currentFileValue, docId, tabId, parentDocId;\n          return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n            while (1) switch (_context7.prev = _context7.next) {\n              case 0:\n                _ = state._;\n                D = state.developer;\n                currentFieldValue = _.get(state.messageFromUser, 'currentFieldValue', _.get(state.messageFromUser, 'content.currentFieldValue'));\n                currentFileValue = _.get(state.messageFromUser, 'fileName', _.get(state.messageFromUser, 'content.fileName'));\n                if (currentFileValue) {\n                  currentFieldValue = {\n                    value: currentFieldValue,\n                    fileName: currentFileValue\n                  };\n                }\n                if (_this4._doc && _this4._doc._parent && _this4._doc._parent._intentId === state.currentControlId) {\n                  state.currentControlId = _this4._doc._parent._intentId;\n                } else {\n                  state.currentControlId = _this4._doc.intentId;\n                }\n                docId = _.get(state.messageFromUser, 'docId');\n                if (docId) {\n                  tabId = _.get(state.messageFromUser, 'tabId');\n                  parentDocId = _.get(state.messageFromUser, 'parentDocId');\n                  _this4.doc.loadDocFromAutoSaveBuffer(tabId, docId, parentDocId);\n                }\n                if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.MOVE)) {\n                  _context7.next = 16;\n                  break;\n                }\n                //console.log('Inside on resolution for ' + this.id);\n                state.messageFromUser.oldFieldValue = _this4.tempValue;\n                if (!(_this4.validation || currentFieldValue !== state.messageFromUser.oldFieldValue || _this4.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_1__.FormFieldTypes.RADIOBUTTON)) {\n                  _context7.next = 14;\n                  break;\n                }\n                if (currentFieldValue !== state.messageFromUser.oldFieldValue) {\n                  _this4.autoSaveLogic(state, currentFieldValue);\n                }\n                _context7.next = 14;\n                return _this4.onMoveOut();\n              case 14:\n                _context7.next = 37;\n                break;\n              case 16:\n                if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.CLICK)) {\n                  _context7.next = 22;\n                  break;\n                }\n                _this4.autoSaveLogic(state, currentFieldValue);\n                _context7.next = 20;\n                return _this4.onClick();\n              case 20:\n                _context7.next = 37;\n                break;\n              case 22:\n                if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.SEARCH)) {\n                  _context7.next = 30;\n                  break;\n                }\n                _this4.autoSaveLogic(state, currentFieldValue);\n                _context7.next = 26;\n                return _this4.lookupLogic(state);\n              case 26:\n                _context7.next = 28;\n                return _this4.onSearch();\n              case 28:\n                _context7.next = 37;\n                break;\n              case 30:\n                if (!(state.messageFromUser.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.COMPLETION)) {\n                  _context7.next = 36;\n                  break;\n                }\n                _this4.autoSaveLogic(state, currentFieldValue);\n                _context7.next = 34;\n                return _this4.onCompletion();\n              case 34:\n                _context7.next = 37;\n                break;\n              case 36:\n                state.addSystemErrorToStack(46, _Error__WEBPACK_IMPORTED_MODULE_3__.Error.getErrorMessageforCodeAndLang(46));\n              case 37:\n                state.developer.debug({\n                  message: 'About to leave onResolution'\n                });\n                if (state.responsesArray.length === 0) {\n                  state.addSilentResponse();\n                }\n              case 39:\n              case \"end\":\n                return _context7.stop();\n            }\n          }, _callee7);\n        }));\n        return function (_x3) {\n          return _ref7.apply(this, arguments);\n        };\n      }();\n    }\n  }, {\n    key: \"onResponse\",\n    get: function get() {\n      return this._onResponse;\n    },\n    set: function set(onResponse) {\n      this._onResponse = onResponse;\n    }\n  }, {\n    key: \"sendValidationResponse\",\n    value: function sendValidationResponse(_ref8) {\n      var _ref8$result = _ref8.result,\n        result = _ref8$result === void 0 ? true : _ref8$result,\n        message = _ref8.message;\n      var response = {\n        field: this.id,\n        validationResult: result,\n        validationMessage: message\n      };\n      this._state.addFormChangeResponse(this.doc.message(_ALLConstants__WEBPACK_IMPORTED_MODULE_2__.ALL_CONSTANTS.ACTIONS.VALIDATION, response));\n    }\n  }]);\n  return Field;\n}(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Field.js?");

/***/ }),

/***/ "../../frontmjs/core/File.js":
/*!***********************************!*\
  !*** ../../frontmjs/core/File.js ***!
  \***********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   File: function() { return /* binding */ File; }\n/* harmony export */ });\n/* harmony import */ var _FormFieldTypes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FormFieldTypes */ \"../../frontmjs/core/FormFieldTypes.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nvar File = /*#__PURE__*/function () {\n  function File(state) {\n    _classCallCheck(this, File);\n    this['_state'] = state;\n    this['_'] = state._;\n    var capabilities = state.context.capabilities.capabilities;\n    var context = null;\n    if (capabilities) {\n      context = state.context.capabilities;\n    } else {\n      context = state.context;\n    }\n    this['_context'] = context;\n  }\n  _createClass(File, [{\n    key: \"read\",\n    value: function read() {\n      var s3Params = {\n        Bucket: envConfig.BOT_LOGO_BUCKET,\n        CopySource: conversationBucket + '/' + conversationId + '/' + fileName,\n        Key: botName.replace(/[^A-Z0-9]+/gi, '_') + '_' + botId + '.' + fileExtension,\n        ACL: 'public-read'\n      };\n      return s3.copyObject(s3Params).promise();\n    }\n  }, {\n    key: \"createQRCode\",\n    value: function () {\n      var _createQRCode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(qrText, qrImageName) {\n        var _this$_context, QRCode, config, env, aws, _s, qrString, base64Data, bucket, _conversationId, params;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (qrText) {\n                _context.next = 2;\n                break;\n              }\n              throw new Error('qrText is required');\n            case 2:\n              if (!qrImageName) {\n                qrImageName = \"\".concat(this._state.getUniqueId(), \".png\");\n              }\n              _context.prev = 3;\n              _this$_context = this._context, QRCode = _this$_context.QRCode, config = _this$_context.config, env = _this$_context.env, aws = _this$_context.aws;\n              _s = new aws.S3();\n              qrString = QRCode.toDataURL(qrText);\n              base64Data = Buffer.from(qrString.replace(/^data:image\\/\\w+;base64,/, \"\"), 'base64');\n              bucket = config[env].CONVERSATIONS_BUCKET;\n              _conversationId = this._state.conversationId;\n              params = {\n                Bucket: bucket,\n                Key: \"\".concat(_conversationId, \"/\").concat(qrImageName),\n                Body: base64Data,\n                ContentType: 'image/png',\n                ContentEncoding: 'base64'\n              };\n              this._state.developer.log({\n                message: 'createQRCode',\n                data: {\n                  bucket: bucket,\n                  conversationId: _conversationId,\n                  qrImageName: qrImageName\n                }\n              });\n              _context.next = 14;\n              return _s.upload(params).promise();\n            case 14:\n              return _context.abrupt(\"return\", qrImageName);\n            case 17:\n              _context.prev = 17;\n              _context.t0 = _context[\"catch\"](3);\n              throw new Error('Error while creating QR Code' + _context.t0.message);\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[3, 17]]);\n      }));\n      function createQRCode(_x, _x2) {\n        return _createQRCode.apply(this, arguments);\n      }\n      return createQRCode;\n    }() // options has the following schema\n    // headers - Array of strings of field names, collection - name of the collection, limit - number of entried you want in your csv file\n    // withAutoDownload = true will add a header for auto download when accessing the file with a url\n  }, {\n    key: \"generateCsvFileFromMongo\",\n    value: function () {\n      var _generateCsvFileFromMongo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(query, options, conversationId, fileName, withAutoDownload) {\n        var startTime, _this$_context2, stream, config, env, frontmlib, aws, moment, headers, headerTitles, collection, limit, sort, projection, skip, stringCSV, headerString, finalProjection, _s2, _moment, finalArr, _final, bucket, params, dataSaved;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(options && options.headers && options.headerTitles && options.collection && fileName && conversationId)) {\n                _context2.next = 42;\n                break;\n              }\n              startTime = Date.now();\n              _this$_context2 = this._context, stream = _this$_context2.stream, config = _this$_context2.config, env = _this$_context2.env, frontmlib = _this$_context2.frontmlib, aws = _this$_context2.aws, moment = _this$_context2.moment;\n              headers = options.headers, headerTitles = options.headerTitles, collection = options.collection, limit = options.limit, sort = options.sort, projection = options.projection, skip = options.skip;\n              stringCSV = \"\";\n              headerString = headerTitles.join(',') + '\\n';\n              this._state.developer.log({\n                message: 'generateCsvFileFromMongo: Header String Logging',\n                data: {\n                  headerString: headerString\n                }\n              });\n              stringCSV = stringCSV + headerString;\n              finalProjection = {};\n              headers.map(function (h) {\n                finalProjection[h] = 1;\n              });\n              collection.document.cache = false;\n              this._state.developer.log({\n                message: 'generateCsvFileFromMongo: query',\n                data: query\n              });\n              _context2.next = 14;\n              return collection.loadCollectionWithQuery({\n                query: query || {},\n                projection: finalProjection,\n                sort: sort || {},\n                skip: skip || 0,\n                limit: limit || 100,\n                collation: {}\n              });\n            case 14:\n              if (!(collection.rows.length > 0)) {\n                _context2.next = 39;\n                break;\n              }\n              _s2 = new aws.S3();\n              _moment = this._state.moment;\n              finalArr = collection.rows.map(function (row) {\n                return headers.map(function (h) {\n                  var value;\n                  var _iterator = _createForOfIteratorHelper(row.fields),\n                    _step;\n                  try {\n                    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                      var field = _step.value;\n                      if (field.id === h || field.dbName === h) {\n                        if (field.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_0__.FormFieldTypes.DATETIME || field.type === _FormFieldTypes__WEBPACK_IMPORTED_MODULE_0__.FormFieldTypes.DATE) {\n                          var dateValue = new Date(field.value);\n                          value = !isNaN(dateValue) ? _moment(dateValue).format('YYYY/MM/DD hh:mm:ss Z') : \" \";\n                        } else if (typeof field.value !== \"string\" && typeof field.value !== \"undefined\") value = field.value.toString();else value = field.value;\n                      }\n                    }\n                  } catch (err) {\n                    _iterator.e(err);\n                  } finally {\n                    _iterator.f();\n                  }\n                  return value || '\" \"';\n                });\n              });\n              _final = finalArr.map(function (e) {\n                return e.join(\",\");\n              }).join(\"\\n\");\n              stringCSV = stringCSV + _final;\n              this._state.developer.log({\n                message: 'generateCsvFileFromMongo: final csv string before upload',\n                data: {\n                  stringCSV: stringCSV\n                }\n              });\n              fileName = fileName || \"mongoUpload\".concat(this._state.UUID(), \".csv\");\n              bucket = config[env].CONVERSATIONS_BUCKET;\n              params = {\n                Bucket: bucket,\n                Key: \"\".concat(conversationId, \"/\").concat(fileName),\n                Body: stringCSV\n              };\n              if (withAutoDownload) {\n                params.ContentDisposition = \"attachment;filename=\\\"\".concat(fileName, \"\\\"\");\n                params.ACL = 'public-read';\n              }\n              _context2.prev = 25;\n              _context2.next = 28;\n              return _s2.upload(params).promise();\n            case 28:\n              dataSaved = _context2.sent;\n              this._state.developer.log({\n                message: 'generateCsvFileFromMongo: Successfully Uploaded to S3',\n                data: {\n                  datafromUpload: dataSaved\n                }\n              });\n              return _context2.abrupt(\"return\", dataSaved);\n            case 33:\n              _context2.prev = 33;\n              _context2.t0 = _context2[\"catch\"](25);\n              this._state.developer.log({\n                message: 'generateCsvFileFromMongo: Error Uploading to S3',\n                data: {\n                  err: _context2.t0\n                }\n              });\n              return _context2.abrupt(\"return\", {\n                error: _context2.t0\n              });\n            case 37:\n              _context2.next = 40;\n              break;\n            case 39:\n              this._state.developer.log({\n                message: 'generateCsvFileFromMongo: No Data from MongoDb'\n              });\n            case 40:\n              _context2.next = 43;\n              break;\n            case 42:\n              this._state.developer.log({\n                message: 'generateCsvFileFromMongo: Validation failed'\n              });\n            case 43:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[25, 33]]);\n      }));\n      function generateCsvFileFromMongo(_x3, _x4, _x5, _x6, _x7) {\n        return _generateCsvFileFromMongo.apply(this, arguments);\n      }\n      return generateCsvFileFromMongo;\n    }()\n  }, {\n    key: \"generateCsvFileFromDynamo\",\n    value: function () {\n      var _generateCsvFileFromDynamo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(query, options, conversationId, fileName) {\n        var _this = this;\n        var startTime, _this$_context3, stream, config, env, frontmlib, aws, moment, s3, headers, specialFields, specialFieldNames, defaultsObj, inStream, bucket, params, uploadPromise, response;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              // todo: add error handling for input params\n              startTime = Date.now(); //let {stream, config, env, frontmlib, aws, moment} = this._context.capabilities;\n              _this$_context3 = this._context, stream = _this$_context3.stream, config = _this$_context3.config, env = _this$_context3.env, frontmlib = _this$_context3.frontmlib, aws = _this$_context3.aws, moment = _this$_context3.moment;\n              s3 = new aws.S3();\n              headers = options.headers, specialFields = options.specialFields;\n              specialFieldNames = Object.keys(options.specialFields || {});\n              defaultsObj = this._(headers).mapKeys().mapValues(function () {\n                return '';\n              }).value();\n              inStream = new stream.Readable({\n                read: function read() {}\n              });\n              bucket = config[env].CONVERSATIONS_BUCKET;\n              params = {\n                Bucket: bucket,\n                Key: \"\".concat(conversationId, \"/\").concat(fileName),\n                Body: inStream\n              };\n              this._state.developer.log({\n                message: 'generateCsvFileFromDynamo',\n                data: {\n                  bucket: bucket,\n                  conversationId: conversationId,\n                  fileName: fileName\n                }\n              });\n              uploadPromise = new Promise( /*#__PURE__*/function () {\n                var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(resolve, reject) {\n                  var headerString, _yield$frontmlib$dbGe, Items, LastEvaluatedKey;\n                  return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n                    while (1) switch (_context3.prev = _context3.next) {\n                      case 0:\n                        s3.upload(params, function (err, data) {\n                          if (err !== null) {\n                            reject(err);\n                          } else {\n                            resolve(data);\n                          }\n                        });\n                        headerString = '\"' + headers.join('\",\"') + '\"\\n';\n                        inStream.push(headerString);\n                        _this._state.developer.log({\n                          message: 'generateCsvFileFromDynamo: Wrote header to the csv file'\n                        });\n                      case 4:\n                        _context3.next = 6;\n                        return frontmlib.dbGetWithPagination(query.TableName, query.IndexName, query.KeyConditionExpression, query.FilterExpression, query.ExpressionAttributeValues, query.ExclusiveStartKey || null, query.Fields, query.options);\n                      case 6:\n                        _yield$frontmlib$dbGe = _context3.sent;\n                        Items = _yield$frontmlib$dbGe.Items;\n                        LastEvaluatedKey = _yield$frontmlib$dbGe.LastEvaluatedKey;\n                        _this._state.developer.log({\n                          message: 'generateCsvFileFromDynamo: got items from dynamo',\n                          data: {\n                            size: _this._.size(Items),\n                            LastEvaluatedKey: LastEvaluatedKey\n                          }\n                        });\n                        _this._.map(Items, function (obj) {\n                          var newObjWithHeaders = _this._({}).assign(defaultsObj, _this._.pick(obj, headers)).value();\n                          if (specialFieldNames) {\n                            _this._.forEach(specialFieldNames, function (headerName) {\n                              var headerProcessor = specialFields[headerName];\n                              var fieldValue = newObjWithHeaders[headerName];\n                              if (!_this._.isNumber(fieldValue) && _this._.isEmpty(fieldValue)) {\n                                return true;\n                              }\n                              switch (headerProcessor.type) {\n                                case 'dateTime':\n                                  newObjWithHeaders[headerName] = moment(_this._.toNumber(fieldValue)).format(headerProcessor.format || 'DD/MMMM/YYYY hh:mm a');\n                                  break;\n                              }\n                            });\n                          }\n                          var line = _this._(newObjWithHeaders).values().join('\",\"');\n                          inStream.push(\"\\\"\".concat(line, \"\\\"\\n\"));\n                        });\n                        if (!(!LastEvaluatedKey || _.size(Items) === 0)) {\n                          _context3.next = 13;\n                          break;\n                        }\n                        return _context3.abrupt(\"break\", 15);\n                      case 13:\n                        query.ExclusiveStartKey = LastEvaluatedKey;\n                      case 14:\n                        if (query.ExclusiveStartKey !== null) {\n                          _context3.next = 4;\n                          break;\n                        }\n                      case 15:\n                        inStream.push(null);\n                        inStream.on('end', function () {\n                          var totalTime = Date.now() - startTime;\n                          _this._state.developer.log({\n                            message: 'generateCsvFileFromDynamo: totalTime to create csv in generateCsvFileFromDynamo:',\n                            data: {\n                              totalTime: totalTime\n                            }\n                          });\n                        });\n                        inStream.on('error', function (data) {\n                          _this._state.developer.log({\n                            message: 'generateCsvFileFromDynamo: Stream erred',\n                            data: data\n                          });\n                          reject(data);\n                        });\n                      case 18:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }, _callee3);\n                }));\n                return function (_x12, _x13) {\n                  return _ref.apply(this, arguments);\n                };\n              }());\n              _context4.prev = 11;\n              _context4.next = 14;\n              return uploadPromise;\n            case 14:\n              response = _context4.sent;\n              this._state.developer.log({\n                message: 'generateCsvFileFromDynamo: final response:',\n                data: response\n              });\n              return _context4.abrupt(\"return\", response);\n            case 19:\n              _context4.prev = 19;\n              _context4.t0 = _context4[\"catch\"](11);\n            case 21:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[11, 19]]);\n      }));\n      function generateCsvFileFromDynamo(_x8, _x9, _x10, _x11) {\n        return _generateCsvFileFromDynamo.apply(this, arguments);\n      }\n      return generateCsvFileFromDynamo;\n    }()\n  }, {\n    key: \"compressVideo\",\n    value: function () {\n      var _compressVideo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(bucket, filename) {\n        var _this2 = this;\n        var params;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              params = {\n                'Records': [{\n                  's3': {\n                    'bucket': {\n                      'name': bucket\n                    },\n                    'object': {\n                      'key': filename\n                    }\n                  }\n                }]\n              };\n              return _context5.abrupt(\"return\", this._state.callLambda('videoConverterLambda', params, 'RequestResponse').then(function (response) {\n                return JSON.parse(response.Payload);\n              })[\"catch\"](function (error) {\n                _this2._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function compressVideo(_x14, _x15) {\n        return _compressVideo.apply(this, arguments);\n      }\n      return compressVideo;\n    }()\n  }, {\n    key: \"validateGeoJSON\",\n    value: function () {\n      var _validateGeoJSON = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(bucket, fileName) {\n        var _this3 = this;\n        var params;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              params = {\n                bucket: bucket,\n                fileName: fileName\n              };\n              return _context6.abrupt(\"return\", this._state.callLambda('geoJSONValidationLambda', params, 'RequestResponse').then(function (response) {\n                return JSON.parse(response.Payload);\n              })[\"catch\"](function (error) {\n                console.log(\"26. adding system error\");\n                _this3._state.addSystemErrorToStack(7, error.message);\n              }));\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function validateGeoJSON(_x16, _x17) {\n        return _validateGeoJSON.apply(this, arguments);\n      }\n      return validateGeoJSON;\n    }()\n  }]);\n  return File;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/File.js?");

/***/ }),

/***/ "../../frontmjs/core/FormFieldTypes.js":
/*!*********************************************!*\
  !*** ../../frontmjs/core/FormFieldTypes.js ***!
  \*********************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FormFieldTypes: function() { return /* binding */ FormFieldTypes; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar FormFieldTypes = /*#__PURE__*/_createClass(function FormFieldTypes() {\n  _classCallCheck(this, FormFieldTypes);\n});\n_defineProperty(FormFieldTypes, \"TEXT_FIELD\", 'text_field');\n_defineProperty(FormFieldTypes, \"NUMBER_FIELD\", 'number');\n_defineProperty(FormFieldTypes, \"TEXT_AREA\", 'text_area');\n_defineProperty(FormFieldTypes, \"RICH_TEXT_AREA\", 'rich_text_area');\n_defineProperty(FormFieldTypes, \"CHECKBOX\", 'checkbox');\n_defineProperty(FormFieldTypes, \"RADIOBUTTON\", 'radiobutton');\n_defineProperty(FormFieldTypes, \"DROPDOWN\", 'dropdown');\n_defineProperty(FormFieldTypes, \"SWITCH\", 'switch');\n_defineProperty(FormFieldTypes, \"SLIDER\", 'slider');\n_defineProperty(FormFieldTypes, \"DATE\", 'date');\n_defineProperty(FormFieldTypes, \"DATETIME\", 'datetime');\n_defineProperty(FormFieldTypes, \"TIME\", 'time');\n_defineProperty(FormFieldTypes, \"MULTI_SELECTION\", 'multi_selection');\n_defineProperty(FormFieldTypes, \"PASSWORD_FIELD\", 'password_field');\n_defineProperty(FormFieldTypes, \"LOOKUP\", 'lookup');\n_defineProperty(FormFieldTypes, \"IMAGE_FIELD\", 'image_field');\n_defineProperty(FormFieldTypes, \"VIDEO_FIELD\", 'video_field');\n_defineProperty(FormFieldTypes, \"FILE_FIELD\", 'file_field');\n_defineProperty(FormFieldTypes, \"BUTTONS_FIELD\", 'buttons_field');\n_defineProperty(FormFieldTypes, \"CHAT_FIELD\", 'chat_field');\n_defineProperty(FormFieldTypes, \"VIDEO_CALL_FIELD\", 'video_call_field');\n_defineProperty(FormFieldTypes, \"VOICE_CALL_FIELD\", 'voice_call_field');\n_defineProperty(FormFieldTypes, \"ROW_MENU_FIELD\", 'row_menu_field');\n_defineProperty(FormFieldTypes, \"COLOR_FIELD\", 'color_field');\n_defineProperty(FormFieldTypes, \"ALERT_FIELD\", 'alert_field');\n_defineProperty(FormFieldTypes, \"COORDINATES\", 'coordinates_field');\n_defineProperty(FormFieldTypes, \"GEO_POINT_FIELD\", 'geo_point_field');\n_defineProperty(FormFieldTypes, \"GEO_AREA_FIELD\", 'geo_area_field');\n_defineProperty(FormFieldTypes, \"OBJECT_DROPDOWN\", 'object_dropdown');\n_defineProperty(FormFieldTypes, \"OBJECT_LOOKUP\", 'object_lookup');\n_defineProperty(FormFieldTypes, \"OBJECT_MULTI_SELECTION\", 'object_multi_selection');\n_defineProperty(FormFieldTypes, \"MAP_AREA\", 'map_area');\n_defineProperty(FormFieldTypes, \"MAP_DATA\", 'map_data');\n_defineProperty(FormFieldTypes, \"PHONE_NUMBER_FIELD\", 'phone_number');\n_defineProperty(FormFieldTypes, \"EMAIL_FIELD\", 'email_field');\n_defineProperty(FormFieldTypes, \"COLOR_PICKER_FIELD\", 'color_picker');\n_defineProperty(FormFieldTypes, \"ICON_FIELD\", 'icon_field');\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/FormFieldTypes.js?");

/***/ }),

/***/ "../../frontmjs/core/Geofence.js":
/*!***************************************!*\
  !*** ../../frontmjs/core/Geofence.js ***!
  \***************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Geofence: function() { return /* binding */ Geofence; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Error */ \"../../frontmjs/core/Error.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n\nvar Geofence = /*#__PURE__*/function (_Intent) {\n  _inherits(Geofence, _Intent);\n  var _super = _createSuper(Geofence);\n  function Geofence(intentId, _ref) {\n    var _this;\n    var tabId = _ref.tabId,\n      id = _ref.id,\n      name = _ref.name,\n      description = _ref.description,\n      color = _ref.color,\n      coordinates = _ref.coordinates,\n      state = _ref.state;\n    _classCallCheck(this, Geofence);\n    _this = _super.call(this, intentId, state, tabId);\n    _this.onSave = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    _this.onDelete = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }));\n    _this._id = id;\n    _this._name = name;\n    _this._description = description;\n    _this._color = color;\n    _this._coordinates = coordinates;\n    return _this;\n  }\n  _createClass(Geofence, [{\n    key: \"message\",\n    value: function message(action) {\n      return {\n        options: {\n          controlId: this.intentId,\n          tabId: this.tabId,\n          id: this._id,\n          //Mandatory\n          name: this._name,\n          description: this._description,\n          color: this._color,\n          action: action\n        },\n        coordinates: this._coordinates\n      };\n    }\n  }, {\n    key: \"onMatching\",\n    get: function get() {\n      var _this2 = this;\n      return function (state) {\n        return state.messageTypeFromUser === Geofence.GEOFENCE_RESPONSE() && state.messageFromUser.controlId === _this2.intentId;\n      };\n    }\n  }, {\n    key: \"onResolution\",\n    get: function get() {\n      var _this3 = this;\n      return /*#__PURE__*/function () {\n        var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(state) {\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                state.currentControlId = _this3.intentId;\n                if (!(state.messageFromUser.action === Geofence.SAVE_ACTION())) {\n                  _context3.next = 6;\n                  break;\n                }\n                _context3.next = 4;\n                return _this3.onSave();\n              case 4:\n                _context3.next = 12;\n                break;\n              case 6:\n                if (!(state.messageFromUser.action === Geofence.DELETE_ACTION())) {\n                  _context3.next = 11;\n                  break;\n                }\n                _context3.next = 9;\n                return _this3.onDelete();\n              case 9:\n                _context3.next = 12;\n                break;\n              case 11:\n                state.addSystemErrorToStack(49, _Error__WEBPACK_IMPORTED_MODULE_1__.Error.getErrorMessageforCodeAndLang(49));\n              case 12:\n                if (state.responsesArray.length === 0) {\n                  state.addSilentResponse();\n                }\n              case 13:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3);\n        }));\n        return function (_x) {\n          return _ref4.apply(this, arguments);\n        };\n      }();\n    }\n  }], [{\n    key: \"GEOFENCE_MESSAGE\",\n    value: function GEOFENCE_MESSAGE() {\n      return 'geofence';\n    }\n  }, {\n    key: \"GEOFENCE_RESPONSE\",\n    value: function GEOFENCE_RESPONSE() {\n      return 'geofence_response';\n    }\n  }, {\n    key: \"SAVE_ACTION\",\n    value: function SAVE_ACTION() {\n      return 'save';\n    }\n  }, {\n    key: \"NEW_ACTION\",\n    value: function NEW_ACTION() {\n      return 'new';\n    }\n  }, {\n    key: \"UPDATE_ACTION\",\n    value: function UPDATE_ACTION() {\n      return 'update';\n    }\n  }, {\n    key: \"DISPLAY_ACTION\",\n    value: function DISPLAY_ACTION() {\n      return 'display';\n    }\n  }, {\n    key: \"DELETE_ACTION\",\n    value: function DELETE_ACTION() {\n      return 'delete';\n    }\n  }]);\n  return Geofence;\n}(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Geofence.js?");

/***/ }),

/***/ "../../frontmjs/core/InputQueue.js":
/*!*****************************************!*\
  !*** ../../frontmjs/core/InputQueue.js ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) { _checkPrivateRedeclaration(obj, privateMap); privateMap.set(obj, value); }\nfunction _checkPrivateRedeclaration(obj, privateCollection) { if (privateCollection.has(obj)) { throw new TypeError(\"Cannot initialize the same private elements twice on an object\"); } }\nfunction _classPrivateFieldGet(receiver, privateMap) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"get\"); return _classApplyDescriptorGet(receiver, descriptor); }\nfunction _classApplyDescriptorGet(receiver, descriptor) { if (descriptor.get) { return descriptor.get.call(receiver); } return descriptor.value; }\nfunction _classPrivateFieldSet(receiver, privateMap, value) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"set\"); _classApplyDescriptorSet(receiver, descriptor, value); return value; }\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) { if (!privateMap.has(receiver)) { throw new TypeError(\"attempted to \" + action + \" private field on non-instance\"); } return privateMap.get(receiver); }\nfunction _classApplyDescriptorSet(receiver, descriptor, value) { if (descriptor.set) { descriptor.set.call(receiver, value); } else { if (!descriptor.writable) { throw new TypeError(\"attempted to set read only private field\"); } descriptor.value = value; } }\nvar _queue = /*#__PURE__*/new WeakMap();\nvar InputQueue = /*#__PURE__*/function () {\n  function InputQueue() {\n    _classCallCheck(this, InputQueue);\n    _classPrivateFieldInitSpec(this, _queue, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldSet(this, _queue, []);\n  }\n  _createClass(InputQueue, [{\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      return _classPrivateFieldGet(this, _queue).length === 0;\n    }\n  }, {\n    key: \"addMessage\",\n    value: function addMessage(message, action) {\n      if (!message || !action) {\n        return false;\n      }\n      _classPrivateFieldGet(this, _queue).push({\n        message: message,\n        action: action\n      });\n    }\n  }, {\n    key: \"pollMessage\",\n    value: function pollMessage() {\n      if (this.isEmpty()) {\n        return false;\n      }\n      return _classPrivateFieldGet(this, _queue).shift();\n    }\n  }]);\n  return InputQueue;\n}();\n/* harmony default export */ __webpack_exports__[\"default\"] = (InputQueue);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/InputQueue.js?");

/***/ }),

/***/ "../../frontmjs/core/Intent.js":
/*!*************************************!*\
  !*** ../../frontmjs/core/Intent.js ***!
  \*************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Intent: function() { return /* binding */ Intent; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nvar Intent = /*#__PURE__*/function () {\n  function Intent(intentId, state, tabId) {\n    _classCallCheck(this, Intent);\n    this['_intentId'] = intentId;\n    this['_runLocation'] = _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE;\n    this['_edgeEvents'] = [];\n    this['_cloudEvents'] = [];\n    this['_presentEvent'] = '';\n    this['_nlpId'] = '';\n    this['_smartSuggestions'] = [];\n    this['_dependencies'] = [];\n    this['_logHistory'] = true;\n    this['_silentIntent'] = false;\n    this._onPrediction = function () {};\n    this.tabId = tabId || intentId;\n    this.onInit = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(self) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    if (state) {\n      this._state = state;\n      this._state.setIntentWithId(intentId, this);\n    }\n  }\n  _createClass(Intent, [{\n    key: \"resetProperties\",\n    value: function resetProperties() {}\n  }, {\n    key: \"runOnCloud\",\n    value: function runOnCloud() {\n      this._runLocation = _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD;\n    }\n  }, {\n    key: \"runOnCloudWithEdgeEvents\",\n    value: function runOnCloudWithEdgeEvents(events) {\n      if (events && Array.isArray(events) && events.length > 0) {\n        this._edgeEvents = events;\n      }\n      this._runLocation = _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD;\n    }\n  }, {\n    key: \"runOnEdge\",\n    value: function runOnEdge() {\n      this._runLocation = _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE;\n    }\n  }, {\n    key: \"runOnEdgeWithCloudEvents\",\n    value: function runOnEdgeWithCloudEvents(events) {\n      if (events && Array.isArray(events) && events.length > 0) {\n        this._cloudEvents = events;\n      }\n      this._runLocation = _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE;\n    }\n  }, {\n    key: \"disableHistoryLogging\",\n    value: function disableHistoryLogging() {\n      this._logHistory = false;\n    }\n  }, {\n    key: \"silenceIntent\",\n    value: function silenceIntent() {\n      this._silentIntent = true;\n    }\n  }, {\n    key: \"silentIntent\",\n    get: function get() {\n      return this._silentIntent;\n    }\n  }, {\n    key: \"logHistory\",\n    get: function get() {\n      return this._logHistory;\n    }\n  }, {\n    key: \"runLocation\",\n    get: function get() {\n      if (this._edgeEvents.indexOf(this._presentEvent) > -1) {\n        return _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE;\n      }\n      if (this._cloudEvents.indexOf(this._presentEvent) > -1) {\n        return _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE;\n      }\n      return this._runLocation;\n    }\n  }, {\n    key: \"onValidation\",\n    get: function get() {\n      return this._onValidation;\n    },\n    set: function set(onValidationBlock) {\n      this._onValidation = onValidationBlock;\n    }\n  }, {\n    key: \"onError\",\n    get: function get() {\n      return this._onError;\n    },\n    set: function set(onErrorBlock) {\n      this._onError = onErrorBlock;\n    }\n  }, {\n    key: \"id\",\n    get: function get() {\n      return this._intentId;\n    }\n  }, {\n    key: \"intentId\",\n    get: function get() {\n      return this._intentId;\n    }\n  }, {\n    key: \"nlpId\",\n    get: function get() {\n      return this._nlpId;\n    },\n    set: function set(nlpId) {\n      this._nlpId = nlpId;\n    }\n  }, {\n    key: \"suggestionsArray\",\n    get: function get() {\n      return this._smartSuggestions;\n    },\n    set: function set(suggestions) {\n      this._smartSuggestions = suggestions;\n    }\n  }, {\n    key: \"setEnglishSmartSuggestions\",\n    value: function setEnglishSmartSuggestions(suggestions) {\n      if (Array.isArray(suggestions)) {\n        this._smartSuggestions = [{\n          lang: 'en',\n          list: suggestions.reverse()\n        }];\n      } else {\n        this._state.developer.warning({\n          message: \"The suggestions argument must be an array\",\n          data: this._intentId\n        });\n      }\n    }\n  }, {\n    key: \"setEnglishSmartSuggestionsWithCondition\",\n    value: function setEnglishSmartSuggestionsWithCondition(defaultSuggestions, newSuggestions, conditionBlock) {\n      if (Array.isArray(newSuggestions) && Array.isArray(defaultSuggestions)) {\n        if (conditionBlock()) {\n          this._smartSuggestions = [{\n            lang: 'en',\n            list: newSuggestions.reverse()\n          }];\n        } else {\n          this._smartSuggestions = [{\n            lang: 'en',\n            list: defaultSuggestions.reverse()\n          }];\n        }\n      } else {\n        this._smartSuggestions = [{\n          lang: 'en',\n          list: ['Invalid smart suggestion type. Must be array']\n        }];\n      }\n    }\n  }, {\n    key: \"setSmartSuggestions\",\n    value: function setSmartSuggestions(lang, suggestions) {\n      this._smartSuggestions = [{\n        lang: lang,\n        list: suggestions\n      }];\n    }\n  }, {\n    key: \"matchSuggestions\",\n    value: function matchSuggestions() {\n      var _this = this;\n      if (typeof this._state.messageFromUser === 'string') {\n        var findSuggestion = function findSuggestion(suggestion) {\n          var list = suggestion.list;\n          return list.includes(_this._state.messageFromUser);\n        };\n        return !!this._smartSuggestions.find(findSuggestion);\n      }\n      return false;\n    }\n  }, {\n    key: \"onMatching\",\n    get: function get() {\n      return this._onMatching;\n    },\n    set: function set(matcher) {\n      this._onMatching = matcher;\n    }\n  }, {\n    key: \"onResolution\",\n    get: function get() {\n      return this['_onResolution'];\n    },\n    set: function set(resolver) {\n      this['_onResolution'] = resolver;\n    }\n  }, {\n    key: \"onPrediction\",\n    get: function get() {\n      return this['_onPrediction'];\n    },\n    set: function set(predictor) {\n      this['_onPrediction'] = predictor;\n    }\n  }], [{\n    key: \"SPEECH\",\n    value: function SPEECH() {\n      return 'speech';\n    }\n  }, {\n    key: \"LOCATION\",\n    value: function LOCATION() {\n      return '__location_';\n    }\n  }, {\n    key: \"CONTACT\",\n    value: function CONTACT() {\n      return '__contact_';\n    }\n  }, {\n    key: \"IMAGE\",\n    value: function IMAGE() {\n      return '__image_';\n    }\n  }, {\n    key: \"VIDEO\",\n    value: function VIDEO() {\n      return '__video_';\n    }\n  }, {\n    key: \"FILE\",\n    value: function FILE() {\n      return '__file_';\n    }\n  }]);\n  return Intent;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Intent.js?");

/***/ }),

/***/ "../../frontmjs/core/JobScheduler.js":
/*!*******************************************!*\
  !*** ../../frontmjs/core/JobScheduler.js ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   JobScheduler: function() { return /* binding */ JobScheduler; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _MessageTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MessageTypes */ \"../../frontmjs/core/MessageTypes.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\nvar JobScheduler = /*#__PURE__*/function () {\n  function JobScheduler(state) {\n    _classCallCheck(this, JobScheduler);\n    this['_state'] = state;\n    this['_'] = state._;\n  }\n  _createClass(JobScheduler, [{\n    key: \"addNewJob\",\n    value: function addNewJob(client, params, jobId, repeats) {\n      var scheduleJobParams = {\n        jobId: jobId,\n        capability: 'ScheduleBatchJob',\n        conversation: this._state.conversation,\n        params: this._state.cleanFieldsForSave(params),\n        repeats: repeats,\n        requestUuid: this._state.getUniqueId(),\n        scheduledCapability: this._state.conversation.bot + '_CustomCap',\n        userEmail: this._state.user.userEmail,\n        userId: this._state.user.userId,\n        userDomain: this._state.conversation.userDomain,\n        botId: this._state.conversation.bot,\n        client: client,\n        schedule: this._.get(params, 'schedule')\n      };\n      return this._state.callLambda('SystemCapabilities', scheduleJobParams, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      });\n    }\n  }, {\n    key: \"scheduleMessage\",\n    value: function scheduleMessage(_ref) {\n      var _this = this;\n      var _ref$toBot = _ref.toBot,\n        toBot = _ref$toBot === void 0 ? this._state.conversation.bot : _ref$toBot,\n        toUser = _ref.toUser,\n        messages = _ref.messages,\n        _ref$jobId = _ref.jobId,\n        jobId = _ref$jobId === void 0 ? this._state.getUniqueId() : _ref$jobId,\n        _ref$schedule = _ref.schedule,\n        schedule = _ref$schedule === void 0 ? Date.now() : _ref$schedule,\n        repeats = _ref.repeats,\n        _ref$client = _ref.client,\n        client = _ref$client === void 0 ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT : _ref$client,\n        _ref$realTimeMessage = _ref.realTimeMessage,\n        realTimeMessage = _ref$realTimeMessage === void 0 ? true : _ref$realTimeMessage,\n        _ref$v1Compatibility = _ref.v1Compatibility,\n        v1Compatibility = _ref$v1Compatibility === void 0 ? false : _ref$v1Compatibility;\n      var requestUuid = this._state.getUniqueId();\n      var generateFullMessageForMessage = function generateFullMessageForMessage(msg) {\n        var messageToSend = msg;\n        if (!realTimeMessage) {\n          var state = toBot === _this._state.botId ? _this._state.stateToBackEnd() : {\n            state: {}\n          };\n          state.state.messageFromUser = msg;\n          state.state.messageTypeFromUser = 'object';\n          state.state.fromGreeting = false;\n          state.state.responsesArray = [];\n          state.state._syncToCloud = {};\n          state.state._syncToEdge = {};\n          // state.state._delayedNotification = [];\n          state.state._activeIntent = '';\n          //D.log({message: 'Setting v1Compatibility'});\n          if (!realTimeMessage && v1Compatibility) {\n            //v1Compatibility generates simple responses in case of bot to bot messages\n            state.state.v1Compatibility = true;\n          }\n          messageToSend = state;\n        }\n        //D.log({message: 'Bot to bot message content', data: messageToSend});\n        return {\n          content: [messageToSend],\n          contentType: _MessageTypes__WEBPACK_IMPORTED_MODULE_1__.MessageTypes.BOT_TO_BOT(),\n          requestUuid: requestUuid,\n          createdBy: _this._state.user.userId,\n          createdOn: Date.now(),\n          messageId: _this._state.getUniqueId()\n        };\n      };\n      var _ = this._state._;\n      var allMessages = [];\n      if (Array.isArray(messages)) {\n        _.forEach(messages, function (msg) {\n          allMessages.push(generateFullMessageForMessage(msg));\n        });\n      } else {\n        allMessages.push(generateFullMessageForMessage(messages));\n      }\n      var params = {\n        target: {\n          bot: toBot,\n          users: Array.isArray(toUser) ? toUser : toUser ? [toUser] : toUser,\n          userDomain: this._state.currentUserDomain\n        },\n        action: 'get',\n        bot: this._state.conversation.bot || _.get(this._state.context, 'botManifest.botId'),\n        sync: true,\n        userDomain: this._state.conversation.userDomain,\n        email: this._state.user.userEmail,\n        conversation: this._state.conversation,\n        requestUuid: requestUuid,\n        messages: allMessages,\n        realTimeMessage: realTimeMessage\n      };\n      var scheduleJobParams = {\n        jobId: jobId,\n        capability: 'ScheduleBatchJob',\n        conversation: this._state.conversation,\n        params: params,\n        repeats: repeats,\n        requestUuid: requestUuid,\n        scheduledCapability: 'BroadCastMessageCapability',\n        userEmail: this._state.user.userEmail,\n        userId: this._state.user.userId,\n        userDomain: this._state.conversation.userDomain,\n        botId: this._state.conversation.bot,\n        client: client,\n        schedule: schedule\n      };\n      return this._state.callLambda('SystemCapabilities', scheduleJobParams, 'RequestResponse').then(function (response) {\n        return JSON.parse(response.Payload);\n      });\n    }\n  }, {\n    key: \"deleteJob\",\n    value: function deleteJob(jobId) {\n      var scheduleJobParams = {\n        jobId: jobId,\n        capability: 'DeleteBatchJob'\n      };\n      return this._state.callLambda('SystemCapabilities', scheduleJobParams, 'RequestResponse');\n    }\n  }, {\n    key: \"scheduleLocalJob\",\n    value: function scheduleLocalJob(jobId, interval) {\n      var bgTaskOptions = {\n        key: jobId,\n        botId: this._state.context.botManifest.botId,\n        timeInterval: interval,\n        conversationId: this._state.conversationId\n      };\n      var backgroundTaskQueue = this._state.context.getCapability('BackgroundTaskQueue');\n      return backgroundTaskQueue.enqueue(bgTaskOptions);\n    }\n  }, {\n    key: \"stopLocalJob\",\n    value: function stopLocalJob(jobId) {\n      var backgroundTaskQueue = this._state.context.getCapability('BackgroundTaskQueue');\n      var bgTaskOptions = {\n        key: jobId,\n        botId: this._state.context.botManifest.botId,\n        conversationId: this._state.conversationId\n      };\n      return backgroundTaskQueue.dequeue(bgTaskOptions);\n    }\n  }]);\n  return JobScheduler;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/JobScheduler.js?");

/***/ }),

/***/ "../../frontmjs/core/LocationServices.js":
/*!***********************************************!*\
  !*** ../../frontmjs/core/LocationServices.js ***!
  \***********************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LocationServices: function() { return /* binding */ LocationServices; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _MessageTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MessageTypes */ \"../../frontmjs/core/MessageTypes.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\nvar LocationServices = /*#__PURE__*/function () {\n  function LocationServices(state) {\n    _classCallCheck(this, LocationServices);\n    this._state = state;\n    this._ = state._;\n    var capabilities = state.context.capabilities.capabilities;\n    if (capabilities) {\n      this._turf = state.context.capabilities.turf;\n    } else {\n      this._turf = state.context.turf;\n    }\n    // this._turf = state.context.turf;\n    this.offlineMaps = {};\n    if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT && this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE) {\n      this.offlineMaps = this._state.context.getCapability('OfflineMap');\n    }\n  }\n  _createClass(LocationServices, [{\n    key: \"getDeviceLocation\",\n    value: function getDeviceLocation() {\n      var _this = this;\n      if (this._state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE) {\n        return this._state.context.getCapability('DeviceLocation').getDeviceLocation()[\"catch\"](function (error) {\n          //come back\n          _this._state.addSystemErrorToStack(53, null, error);\n        });\n      } else {\n        this._state.addSystemErrorToStack(54);\n        return Promise.resolve();\n      }\n    }\n  }, {\n    key: \"getLocationWithQuery\",\n    value: function () {\n      var _getLocationWithQuery = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(query) {\n        var stringQuery, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              stringQuery = query;\n              if (typeof stringQuery !== 'string') {\n                stringQuery = JSON.stringify(query);\n              }\n              _context.next = 5;\n              return this._state.api.callService('Geocode', {\n                queryParams: 'q=' + stringQuery\n              });\n            case 5:\n              response = _context.sent;\n              if (response) {\n                _context.next = 8;\n                break;\n              }\n              return _context.abrupt(\"return\", []);\n            case 8:\n              return _context.abrupt(\"return\", JSON.parse(response));\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](0);\n              this._state.developer.log({\n                message: 'Getting error while calling Geocode: ' + _context.t0.message\n              });\n              return _context.abrupt(\"return\", {\n                error: 'err'\n              });\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[0, 11]]);\n      }));\n      function getLocationWithQuery(_x) {\n        return _getLocationWithQuery.apply(this, arguments);\n      }\n      return getLocationWithQuery;\n    }()\n  }, {\n    key: \"startLocationTracking\",\n    value: function startLocationTracking() {\n      var precision = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 5;\n      var heartbeatInterval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 180;\n      return this._state.context.getCapability('LocationTracker').start_tracking({\n        botId: this._state.context.botManifest.botId,\n        conversationId: this._state.conversationId\n      }, precision, heartbeatInterval);\n    }\n  }, {\n    key: \"stopLocationTracking\",\n    value: function stopLocationTracking() {\n      return this._state.context.getCapability('LocationTracker').stop_tracking({\n        botId: this._state.context.botManifest.botId,\n        conversationId: this._state.conversationId\n      });\n    }\n  }, {\n    key: \"saveMap\",\n    value: function () {\n      var _saveMap = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref) {\n        var name, neBound, swBound, _ref$minZoom, minZoom, _ref$maxZoom, maxZoom, _ref$progressListener, progressListener, _ref$errorListener, errorListener, state, D;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              name = _ref.name, neBound = _ref.neBound, swBound = _ref.swBound, _ref$minZoom = _ref.minZoom, minZoom = _ref$minZoom === void 0 ? 12 : _ref$minZoom, _ref$maxZoom = _ref.maxZoom, maxZoom = _ref$maxZoom === void 0 ? 16 : _ref$maxZoom, _ref$progressListener = _ref.progressListener, progressListener = _ref$progressListener === void 0 ? this.progressListener : _ref$progressListener, _ref$errorListener = _ref.errorListener, errorListener = _ref$errorListener === void 0 ? this.errorListener : _ref$errorListener;\n              state = this._state;\n              D = state.developer;\n              if (!(state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT)) {\n                _context2.next = 18;\n                break;\n              }\n              _context2.prev = 4;\n              if (!state.maps[name]) {\n                _context2.next = 8;\n                break;\n              }\n              _context2.next = 8;\n              return this.deleteMap(name);\n            case 8:\n              state.maps[name] = true;\n              _context2.next = 11;\n              return this.offlineMaps.saveMap(name, neBound, swBound, minZoom, maxZoom, function (completedResourceCount, completedResourceSize, completedTileCount, completedTileSize, name, percentage, requiredResourceCount, state) {\n                D.log({\n                  message: \"Progress being made downloading map\",\n                  data: percentage\n                });\n              }, function (offLinePack, error) {\n                D.log({\n                  message: \"Error downloading map\",\n                  data: error\n                });\n              });\n            case 11:\n              _context2.next = 16;\n              break;\n            case 13:\n              _context2.prev = 13;\n              _context2.t0 = _context2[\"catch\"](4);\n              D.log({\n                message: \"Error downloading map\",\n                data: _context2.t0\n              });\n            case 16:\n              _context2.next = 19;\n              break;\n            case 18:\n              D.warning({\n                message: \"Maps cannot be downloaded on web app for now\"\n              });\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[4, 13]]);\n      }));\n      function saveMap(_x2) {\n        return _saveMap.apply(this, arguments);\n      }\n      return saveMap;\n    }()\n  }, {\n    key: \"deleteMap\",\n    value: function () {\n      var _deleteMap = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(name) {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return this.offlineMaps.deleteMap(name);\n            case 2:\n              delete this._state.maps[name];\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function deleteMap(_x3) {\n        return _deleteMap.apply(this, arguments);\n      }\n      return deleteMap;\n    }()\n  }, {\n    key: \"startTracking\",\n    value: function () {\n      var _startTracking = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(assetType, assetDetails, schedule, intentId) {\n        var trackingSessionId, messageToTracker;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              trackingSessionId = this._state.getUniqueId();\n              messageToTracker = {\n                intentId: LocationServices.START_TRACKING(),\n                jobId: trackingSessionId,\n                assetType: assetType,\n                assetDetails: assetDetails\n              };\n              if (schedule) {\n                messageToTracker.repeats = schedule;\n              }\n              if (intentId) {\n                messageToTracker.respondsTo = {\n                  userId: this._state.user.userId,\n                  botId: this._state.conversation.bot,\n                  userDomain: this._state.conversation.userDomain,\n                  intentId: intentId\n                };\n              }\n              _context4.next = 6;\n              return this._state.notification.sendBroadcastNotificationToBot(LocationServices.TRACKER_BOT(), this._state.conversation.userDomain, _MessageTypes__WEBPACK_IMPORTED_MODULE_1__.MessageTypes.BOT_TO_BOT(), messageToTracker);\n            case 6:\n              return _context4.abrupt(\"return\", trackingSessionId);\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function startTracking(_x4, _x5, _x6, _x7) {\n        return _startTracking.apply(this, arguments);\n      }\n      return startTracking;\n    }()\n  }, {\n    key: \"startTrackingVessel\",\n    value: function startTrackingVessel(assetDetails, schedule, intentId) {\n      return this.startTracking(LocationServices.VESSEL(), assetDetails, schedule, intentId);\n    }\n  }, {\n    key: \"startTrackingFlight\",\n    value: function startTrackingFlight(assetDetails, schedule, intentId) {\n      return this.startTracking(LocationServices.FLIGHT(), assetDetails, schedule, intentId);\n    }\n  }, {\n    key: \"stopTracking\",\n    value: function stopTracking(trackingSessionId) {}\n  }, {\n    key: \"getLatestKnownLocation\",\n    value: function getLatestKnownLocation(asset, trackingSessionId, tableName) {\n      var params = {\n        capability: 'AssetTrackerCapability',\n        capabilityFileName: 'assetTrackerCapability',\n        action: 'getLatestAssetLocation',\n        assetId: asset,\n        sessionId: trackingSessionId,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation\n      };\n      if (tableName) {\n        params['tableName'] = tableName;\n      }\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"getLocation\",\n    value: function getLocation(asset, trackingSessionId, from, to, tableName) {\n      var params = {\n        capability: 'AssetTrackerCapability',\n        capabilityFileName: 'assetTrackerCapability',\n        action: 'getAssetLocationForDuration',\n        assetId: asset,\n        sessionId: trackingSessionId,\n        from: from,\n        to: to,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation\n      };\n      if (tableName) {\n        params['tableName'] = tableName;\n      }\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"getLocationWithPagination\",\n    value: function getLocationWithPagination(asset, trackingSessionId) {\n      var pageSize = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 50;\n      var last = arguments.length > 3 ? arguments[3] : undefined;\n      var tableName = arguments.length > 4 ? arguments[4] : undefined;\n      var params = {\n        capability: 'AssetTrackerCapability',\n        capabilityFileName: 'assetTrackerCapability',\n        action: 'getAssetLocationsWithPagination',\n        assetId: asset,\n        sessionId: trackingSessionId,\n        pageSize: pageSize,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation\n      };\n      if (last) {\n        params.last = last;\n      }\n      if (tableName) {\n        params['tableName'] = tableName;\n      }\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"storeNewLocation\",\n    value: function storeNewLocation(trackingSessionId, assetId, assetDetails, createdOn, tableName) {\n      var params = {\n        capability: 'AssetTrackerCapability',\n        capabilityFileName: 'assetTrackerCapability',\n        action: 'addNewLocation',\n        assetId: assetId,\n        sessionId: trackingSessionId,\n        details: assetDetails,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation\n      };\n      if (createdOn) {\n        params.createdOn = createdOn;\n      }\n      if (tableName) {\n        params['tableName'] = tableName;\n      }\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"getWeatherOnLocation\",\n    value: function () {\n      var _getWeatherOnLocation = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(latitude, longitude) {\n        var location, WEATHER_SERVICE, response;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              location = \"\".concat(latitude, \",\").concat(longitude);\n              WEATHER_SERVICE = 'MaritimeWeather';\n              _context5.prev = 2;\n              response = this._state.api.callService(WEATHER_SERVICE, {\n                queryParams: 'q=' + location\n              });\n              return _context5.abrupt(\"return\", response);\n            case 7:\n              _context5.prev = 7;\n              _context5.t0 = _context5[\"catch\"](2);\n              d.log({\n                message: 'Getting error while calling WEATHER_SERVICE ' + JSON.stringify(_context5.t0)\n              });\n              return _context5.abrupt(\"return\", {\n                error: _context5.t0\n              });\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this, [[2, 7]]);\n      }));\n      function getWeatherOnLocation(_x8, _x9) {\n        return _getWeatherOnLocation.apply(this, arguments);\n      }\n      return getWeatherOnLocation;\n    }()\n  }, {\n    key: \"getPolygonsThatContainsLocation\",\n    value: function getPolygonsThatContainsLocation(location, polygonList) {\n      var _this2 = this;\n      var foundPolygons = [];\n      var turfPoint = this._turf.point(location);\n      try {\n        this._.forEach(polygonList, function (poly) {\n          var polygon = _this2._turf.polygon(poly.coordinates);\n          if (_this2._turf.booleanPointInPolygon(turfPoint, polygon)) {\n            foundPolygons.push(poly);\n          }\n        });\n        return foundPolygons;\n      } catch (err) {\n        throw err;\n      }\n    }\n  }], [{\n    key: \"START_TRACKING\",\n    value: function START_TRACKING() {\n      return 'startTracking';\n    }\n  }, {\n    key: \"STOP_TRACKING\",\n    value: function STOP_TRACKING() {\n      return 'stopTracking';\n    }\n  }, {\n    key: \"VESSEL\",\n    value: function VESSEL() {\n      return 'vessel';\n    }\n  }, {\n    key: \"FLIGHT\",\n    value: function FLIGHT() {\n      return 'flight';\n    }\n  }, {\n    key: \"TRACKER_BOT\",\n    value: function TRACKER_BOT() {\n      return 'tracker-bot';\n    }\n  }]);\n  return LocationServices;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/LocationServices.js?");

/***/ }),

/***/ "../../frontmjs/core/LogEntrytype.js":
/*!*******************************************!*\
  !*** ../../frontmjs/core/LogEntrytype.js ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LogEntrytype: function() { return /* binding */ LogEntrytype; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar LogEntrytype = /*#__PURE__*/function () {\n  function LogEntrytype() {\n    _classCallCheck(this, LogEntrytype);\n  }\n  _createClass(LogEntrytype, null, [{\n    key: \"SYSTEM_ERROR\",\n    value: function SYSTEM_ERROR() {\n      return 'SYSTEM_ERROR';\n    }\n  }, {\n    key: \"USER_ERROR\",\n    value: function USER_ERROR() {\n      return 'USER_ERROR';\n    }\n  }, {\n    key: \"WARNING\",\n    value: function WARNING() {\n      return 'WARNING';\n    }\n  }, {\n    key: \"INFO\",\n    value: function INFO() {\n      return 'INFO';\n    }\n  }, {\n    key: \"DEBUG\",\n    value: function DEBUG() {\n      return 'DEBUG';\n    }\n  }, {\n    key: \"LOG\",\n    value: function LOG() {\n      return 'LOG';\n    }\n  }, {\n    key: \"PERF\",\n    value: function PERF() {\n      return 'PERF';\n    }\n  }]);\n  return LogEntrytype;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/LogEntrytype.js?");

/***/ }),

/***/ "../../frontmjs/core/Marketplace.js":
/*!******************************************!*\
  !*** ../../frontmjs/core/Marketplace.js ***!
  \******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Marketplace: function() { return /* binding */ Marketplace; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Marketplace = /*#__PURE__*/function () {\n  function Marketplace(state) {\n    _classCallCheck(this, Marketplace);\n    this['_state'] = state;\n    this['_'] = state._;\n  }\n  _createClass(Marketplace, [{\n    key: \"validateActivationCode\",\n    value: function validateActivationCode(code, userId, userEmail) {\n      var params = {\n        capability: 'SubscribeDomainRole',\n        capabilityFileName: 'subscribeDomainRole',\n        verificationCode: code,\n        sync: true,\n        userId: userId || this._state.user.userId,\n        userEmail: userEmail || this._state.user.userEmail,\n        conversation: this._state.conversation\n      };\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"activateDomainsOnEdge\",\n    value: function activateDomainsOnEdge(domains) {\n      return this._state.context.getCapability('authContext').setDomains(domains, this._state.context);\n    }\n  }, {\n    key: \"autoInstallAllBotsOnEdge\",\n    value: function autoInstallAllBotsOnEdge() {\n      return this._state.context.getCapability('RemoteBotInstall').syncronizeBots();\n    }\n  }]);\n  return Marketplace;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Marketplace.js?");

/***/ }),

/***/ "../../frontmjs/core/MessageTypes.js":
/*!*******************************************!*\
  !*** ../../frontmjs/core/MessageTypes.js ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MessageTypes: function() { return /* binding */ MessageTypes; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar MessageTypes = /*#__PURE__*/function () {\n  function MessageTypes() {\n    _classCallCheck(this, MessageTypes);\n  }\n  _createClass(MessageTypes, null, [{\n    key: \"MESSAGE_TYPE_STRING\",\n    value: function MESSAGE_TYPE_STRING() {\n      return 10;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_IMAGE\",\n    value: function MESSAGE_TYPE_IMAGE() {\n      return 30;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_VIDEO\",\n    value: function MESSAGE_TYPE_VIDEO() {\n      return 40;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_AUDIO\",\n    value: function MESSAGE_TYPE_AUDIO() {\n      return 60;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_HTML\",\n    value: function MESSAGE_TYPE_HTML() {\n      return 140;\n    }\n  }, {\n    key: \"BACKEND_RESPONSE\",\n    value: function BACKEND_RESPONSE() {\n      return 150;\n    }\n  }, {\n    key: \"BOT_TO_BOT\",\n    value: function BOT_TO_BOT() {\n      return 160;\n    }\n  }, {\n    key: \"SOCKET_RECONNECTION\",\n    value: function SOCKET_RECONNECTION() {\n      return 170;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_LIST\",\n    value: function MESSAGE_TYPE_LIST() {\n      return 200;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_SLIDER\",\n    value: function MESSAGE_TYPE_SLIDER() {\n      return 210;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_BUTTON\",\n    value: function MESSAGE_TYPE_BUTTON() {\n      return 220;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_FORM\",\n    value: function MESSAGE_TYPE_FORM() {\n      return 230;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_MAP\",\n    value: function MESSAGE_TYPE_MAP() {\n      return 240;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_SMART_SUGGESTIONS\",\n    value: function MESSAGE_TYPE_SMART_SUGGESTIONS() {\n      return 250;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_WEB_CARD\",\n    value: function MESSAGE_TYPE_WEB_CARD() {\n      return 260;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_STD_NOTIFICATION\",\n    value: function MESSAGE_TYPE_STD_NOTIFICATION() {\n      return 270;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_CRITICAL_NOTIFICATION\",\n    value: function MESSAGE_TYPE_CRITICAL_NOTIFICATION() {\n      return 280;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_LOCATION\",\n    value: function MESSAGE_TYPE_LOCATION() {\n      return 290;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_PDF\",\n    value: function MESSAGE_TYPE_PDF() {\n      return 300;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_TEXT\",\n    value: function MESSAGE_TYPE_TEXT() {\n      return 320;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_OTHER_FILE\",\n    value: function MESSAGE_TYPE_OTHER_FILE() {\n      return 330;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_CSV\",\n    value: function MESSAGE_TYPE_CSV() {\n      return 340;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_JAVASCRIPT\",\n    value: function MESSAGE_TYPE_JAVASCRIPT() {\n      return 350;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_FORM2\",\n    value: function MESSAGE_TYPE_FORM2() {\n      return 400;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_MENU\",\n    value: function MESSAGE_TYPE_MENU() {\n      return 410;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_TABLE\",\n    value: function MESSAGE_TYPE_TABLE() {\n      return 420;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_CONTACT_CARD\",\n    value: function MESSAGE_TYPE_CONTACT_CARD() {\n      return 430;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_DATA_CARD\",\n    value: function MESSAGE_TYPE_DATA_CARD() {\n      return 440;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_FORM_RESPONSE\",\n    value: function MESSAGE_TYPE_FORM_RESPONSE() {\n      return 450;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_STRIPE\",\n    value: function MESSAGE_TYPE_STRIPE() {\n      return 460;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_STRIPE_RESPONSE\",\n    value: function MESSAGE_TYPE_STRIPE_RESPONSE() {\n      return 470;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_CLOSE_FORM\",\n    value: function MESSAGE_TYPE_CLOSE_FORM() {\n      return 480;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_MAP_RESPONSE\",\n    value: function MESSAGE_TYPE_MAP_RESPONSE() {\n      return 490;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_SEARCH_BOX\",\n    value: function MESSAGE_TYPE_SEARCH_BOX() {\n      return 510;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_SEARCH_BOX_RESPONSE\",\n    value: function MESSAGE_TYPE_SEARCH_BOX_RESPONSE() {\n      return 520;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_CARDS\",\n    value: function MESSAGE_TYPE_CARDS() {\n      return 530;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_CARD_ACTION\",\n    value: function MESSAGE_TYPE_CARD_ACTION() {\n      return 540;\n    }\n  }, {\n    key: \"MESSAGE_RUN_MODE\",\n    value: function MESSAGE_RUN_MODE() {\n      return 550;\n    }\n  }, {\n    key: \"SHORT_TABLE_RESPONSE\",\n    value: function SHORT_TABLE_RESPONSE() {\n      return 1000;\n    }\n  }, {\n    key: \"SHORT_CONTAINER_RESPONSE\",\n    value: function SHORT_CONTAINER_RESPONSE() {\n      return 1100;\n    }\n  }, {\n    key: \"MESSAGE_VOICE_CALL\",\n    value: function MESSAGE_VOICE_CALL() {\n      return 1200;\n    }\n  }, {\n    key: \"SHORT_FORM_RESPONSE\",\n    value: function SHORT_FORM_RESPONSE() {\n      return 1300;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_TIMELINE_LIST\",\n    value: function MESSAGE_TYPE_TIMELINE_LIST() {\n      return 2000;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_TIMELINE_POST\",\n    value: function MESSAGE_TYPE_TIMELINE_POST() {\n      return 2100;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_AICC\",\n    value: function MESSAGE_TYPE_AICC() {\n      return 2500;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_AICC_STRING\",\n    value: function MESSAGE_TYPE_AICC_STRING() {\n      return 'aiccPlayer';\n    }\n  }, {\n    key: \"MESSAGE_TYPE_SURVEY\",\n    value: function MESSAGE_TYPE_SURVEY() {\n      return 3000;\n    }\n  }, {\n    key: \"MESSAGE_TYPE_SURVEY_RESPONSE\",\n    value: function MESSAGE_TYPE_SURVEY_RESPONSE() {\n      return 3001;\n    }\n  }, {\n    key: \"DASHBOARD\",\n    value: function DASHBOARD() {\n      return 5000;\n    }\n  }]);\n  return MessageTypes;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/MessageTypes.js?");

/***/ }),

/***/ "../../frontmjs/core/NLP.js":
/*!**********************************!*\
  !*** ../../frontmjs/core/NLP.js ***!
  \**********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NLP: function() { return /* binding */ NLP; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _MessageTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MessageTypes */ \"../../frontmjs/core/MessageTypes.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\nvar NLP = /*#__PURE__*/function () {\n  function NLP(state) {\n    _classCallCheck(this, NLP);\n    this['_state'] = state;\n    this._nlpEngine = _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.NLP.ENGINES.OPEN_AI;\n    this._nlpAlias = '';\n    this._assistantName = state.systemId || NLP.DEFAULT_ASSISTANT_NAME();\n    this._nlpIds = [this._assistantName]; //For backward compatibility\n    this._automaticSuggestions = true;\n  }\n  _createClass(NLP, [{\n    key: \"getKeyForPrompt\",\n    value: function getKeyForPrompt() {\n      return \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_0__.PREFIXES.LLM_CONTEXT).concat(this._state.conversationId, \"_\").concat(this._assistantName);\n    }\n  }, {\n    key: \"clearConversationContext\",\n    value: function () {\n      var _clearConversationContext = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return this._state.db.deleteOneKeyInCache(this.getKeyForPrompt());\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function clearConversationContext() {\n        return _clearConversationContext.apply(this, arguments);\n      }\n      return clearConversationContext;\n    }()\n  }, {\n    key: \"assistantName\",\n    get: function get() {\n      return this._assistantName;\n    },\n    set: function set(name) {\n      this._assistantName = name;\n    }\n  }, {\n    key: \"nlpEngine\",\n    get: function get() {\n      return this._nlpEngine;\n    },\n    set: function set(nlpEngine) {\n      this._nlpEngine = nlpEngine;\n    }\n  }, {\n    key: \"nlpIds\",\n    get: function get() {\n      return this._nlpIds;\n    }\n  }, {\n    key: \"automaticSuggestions\",\n    get: function get() {\n      return this._automaticSuggestions;\n    },\n    set: function set(automaticSuggestions) {\n      this._automaticSuggestions = automaticSuggestions;\n    }\n  }, {\n    key: \"addNlp\",\n    value: function addNlp(nlpId) {\n      var _ = this._state._;\n      var index = _.findIndex(this.nlpIds, function (existingId) {\n        return existingId === nlpId;\n      });\n      if (index === -1) {\n        this._nlpIds.push(nlpId);\n      }\n    }\n  }, {\n    key: \"nlpAlias\",\n    get: function get() {\n      return this._nlpAlias;\n    },\n    set: function set(nlpAlias) {\n      this._nlpAlias = nlpAlias;\n    }\n  }, {\n    key: \"getNlpParameters\",\n    value: function getNlpParameters(nlpParameters) {\n      var _this = this;\n      return nlpParameters;\n      var parsedParameters = {};\n      var fields = nlpParameters.fields;\n      var _ = this._state._;\n      var processFields = function processFields(field) {\n        switch (fields[field].kind) {\n          case 'stringValue':\n            {\n              parsedParameters[field] = fields[field].stringValue;\n              break;\n            }\n          case 'numberValue':\n            {\n              parsedParameters[field] = fields[field].numberValue;\n              break;\n            }\n          case 'structValue':\n            {\n              parsedParameters[field] = _this.getNlpParameters(fields[field].structValue);\n              break;\n            }\n          case 'listValue':\n            {\n              var listFromNLP = _.get(fields[field], 'listValue.values');\n              var listToBot = [];\n              _.each(listFromNLP, function (value) {\n                if (_.get(value, 'structValue')) {\n                  listToBot.push(_this.getNlpParameters(_.get(value, 'structValue')));\n                } else {\n                  listToBot.push(_.get(value, 'stringValue') || _.get(value, 'numberValue') || 'unknownType');\n                }\n              });\n              parsedParameters[field] = listToBot;\n              break;\n            }\n          default:\n            break;\n        }\n      };\n      this._state.R.forEach(processFields, this._state.R.keys(fields));\n      return parsedParameters;\n    }\n  }, {\n    key: \"runNlpForMessage\",\n    value: function runNlpForMessage(message) {\n      var _this2 = this;\n      var state = this._state;\n      var D = state.developer;\n      var _ = state._;\n      var R = state.R;\n      var nlpBotsList = this.nlpIds;\n      D.info({\n        message: 'Starting NLP.js event',\n        data: nlpBotsList\n      });\n      if (this.nlpEngine === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.NLP.ENGINES.DIALOGFLOW) {\n        if (nlpBotsList.length > 0) {\n          var params = {\n            capability: 'NLP2',\n            capabilityFileName: 'nlpv2',\n            queryString: message,\n            nlpIds: nlpBotsList,\n            sync: true,\n            userId: state.user.userId,\n            conversation: state.conversation\n          };\n          return state.callCapability(params).then(function (dataArray) {\n            var startNLP = Date.now();\n            _.each(dataArray, function (nlpResponse) {\n              D.info({\n                message: 'Response from NLP.js',\n                data: nlpResponse\n              });\n              if (nlpResponse.error === 'Invalid NLP.js ID') {\n                state.addSystemErrorToStack(24, nlpResponse.nlpId);\n                return;\n              }\n              var nlpParameters = '';\n              var action = nlpResponse.action;\n              var nlpId = nlpResponse.nlpId;\n              D.info({\n                message: 'Found NLP.js action: ',\n                data: action\n              });\n              if (nlpResponse.parameters && _.size(nlpResponse.parameters) > 0) {\n                nlpParameters = nlpResponse.parameters;\n                D.info({\n                  message: 'Found NLP.js parameters: ',\n                  data: nlpParameters\n                });\n              }\n              var suggestions = [];\n              if (nlpResponse.messages) {\n                _.forEach(nlpResponse.messages, function (entry) {\n                  if (entry.type === 4) {\n                    if (entry.payload.messages) {\n                      state.addSmartSuggestionsArray([{\n                        lang: state.lang,\n                        list: entry.payload.messages\n                      }]);\n                      suggestions = entry.payload.messages;\n                    }\n                  }\n                });\n              }\n              state.nlpResults[nlpId] = {\n                speech: ''\n              };\n              if (nlpResponse.speech && nlpResponse.speech !== '') {\n                state.nlpResults[nlpId].speech = nlpResponse.speech;\n              }\n              state.nlpResults[nlpId].action = action;\n              state.nlpResults[nlpId].nlpParameters = _this2.getNlpParameters(nlpParameters);\n              state.nlpResults[nlpId].nlpSuggestions = suggestions;\n            });\n            D.logCurrentEventDurationWithStartTime('nlpAnalysis', startNLP, Date.now());\n          });\n        } else {\n          D.warning({\n            message: 'No NLP.js Engine added to the bot'\n          });\n        }\n      }\n      return [];\n    }\n  }, {\n    key: \"addContextPromptsToChat\",\n    value: function () {\n      var _addContextPromptsToChat = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(currentPrompt) {\n        var D, context, webBrowserCommonPrompt;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              D = this._state.developer;\n              context = [];\n              context.push({\n                role: \"system\",\n                content: \"The name of the user talking with you is \".concat(this._state.user.userName, \". Today is \").concat(new Date().toLocaleDateString(), \" and the current time is \").concat(new Date().toLocaleTimeString(), \". The user is running a micro-app called \").concat(this._state.botName, \" with description and purpose of \").concat(this._state.botDescription, \".\")\n              });\n              if (!(this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT)) {\n                _context2.next = 11;\n                break;\n              }\n              context.push({\n                role: \"system\",\n                content: \"The user talking to you is connected from a mobile phone using a mobile app called onship. When you give instructions take that in consideration\"\n              });\n              if (this._state.platform !== \"\") {\n                context.push({\n                  role: \"system\",\n                  content: \"The mobile platform that the user is using is \".concat(this._state.platform)\n                });\n              }\n              if (this._state.osVersion !== \"\") {\n                context.push({\n                  role: \"system\",\n                  content: \"The mobile operating system version that the user is using is \".concat(this._state.osVersion)\n                });\n              }\n              if (this._state.phoneModel !== \"\") {\n                context.push({\n                  role: \"system\",\n                  content: \"The mobile phone model that the user is using is \".concat(this._state.phoneModel)\n                });\n              }\n              if (this._state.brand !== \"\") {\n                context.push({\n                  role: \"system\",\n                  content: \"The mobile phone brand that the user is using is \".concat(this._state.brand)\n                });\n              }\n              _context2.next = 16;\n              break;\n            case 11:\n              _context2.next = 13;\n              return this._state.getSystemStaticData(_ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.NLP.FIELDS.WEB_BROWSER_COMMON_PROMPT);\n            case 13:\n              webBrowserCommonPrompt = _context2.sent;\n              D.debug({\n                message: \"webBrowserCommonPrompt\",\n                data: webBrowserCommonPrompt\n              });\n              if (webBrowserCommonPrompt && Array.isArray(webBrowserCommonPrompt)) {\n                context = context.concat(webBrowserCommonPrompt);\n              }\n            case 16:\n              context = context.concat(currentPrompt);\n              return _context2.abrupt(\"return\", context);\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function addContextPromptsToChat(_x) {\n        return _addContextPromptsToChat.apply(this, arguments);\n      }\n      return addContextPromptsToChat;\n    }()\n  }, {\n    key: \"extractObjectFromMessage\",\n    value: function extractObjectFromMessage(message) {\n      try {\n        var startIndex = message.indexOf('{'); // Find the starting index of the JSON object\n        var endIndex = message.lastIndexOf('}'); // Find the ending index of the JSON object\n        var jsonObjectString = message.substring(startIndex, endIndex + 1); // Extract the JSON object as a string\n        // Parse the JSON object\n        return JSON.parse(jsonObjectString);\n      } catch (error) {\n        return false;\n      }\n    }\n  }, {\n    key: \"formatMarkdownAsHTML\",\n    value: function formatMarkdownAsHTML(message) {\n      var D = this._state.developer;\n      var state = this._state;\n      if (state.marked) {\n        // Create a renderer\n        var renderer = new state.marked.Renderer();\n        renderer.link = function (href, title, text) {\n          var link = state.marked.Renderer.prototype.link.call(this, href, title, text);\n          return link.replace(\"<a\", \"<a target='_blank' rel='noopener noreferrer'\");\n        };\n        state.marked.setOptions({\n          renderer: renderer\n        });\n        return state.marked.parse(message);\n      } else {\n        D.warning({\n          message: \"Marked is not present\"\n        });\n      }\n      return message;\n    }\n  }, {\n    key: \"getAPIKeyFromParameters\",\n    value: function getAPIKeyFromParameters(param) {\n      var NO_SERVICE = \"NO_SERVICE\";\n      if (param) {\n        if (Array.isArray(param)) {\n          var index = Math.floor(Math.random() * param.length);\n          return param[index] || NO_SERVICE;\n        } else if (typeof param === \"string\") {\n          return param;\n        }\n      }\n      return NO_SERVICE;\n    }\n  }, {\n    key: \"callOpenAIWithMessageFromUser\",\n    value: function () {\n      var _callOpenAIWithMessageFromUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref) {\n        var _this$_state$messageF;\n        var _ref$service, service, userPrompt, _ref$role, role, _, D, defaultNLPKey, defaultPromptKey, history, promptName, prompt, nlpName, nlpParameters, _this$_state$messageF2, _this$_state$messageF3, newContent, options, serviceName, _response$choices$, _this$_state$messageF5, response, DEFAULT_MESSAGE, openAIContent, text, openAICallPassed, _this$_state$messageF4, DEFAULT_MAX_CONTEXT_LENGTH, maxSize, object;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _ref$service = _ref.service, service = _ref$service === void 0 ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.LLM_SERVICE.CHAT : _ref$service, userPrompt = _ref.userPrompt, _ref$role = _ref.role, role = _ref$role === void 0 ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.OPEN_AI_ROLES.USER : _ref$role;\n              _ = this._state._;\n              D = this._state.developer;\n              D.debug({\n                message: \"Assistant Name\",\n                data: this._assistantName\n              });\n              if (!(typeof this._state.messageFromUser === \"string\" || userPrompt || ((_this$_state$messageF = this._state.messageFromUser) === null || _this$_state$messageF === void 0 ? void 0 : _this$_state$messageF.intentId) === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS)) {\n                _context3.next = 93;\n                break;\n              }\n              defaultNLPKey = service === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.LLM_SERVICE.CHAT ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.NLP.FIELDS.DEFAULT_CHAT_NLP_KEY : _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.NLP.FIELDS.DEFAULT_NLP_KEY;\n              defaultPromptKey = service === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.LLM_SERVICE.CHAT ? _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.NLP.FIELDS.DEFAULT_CHAT_PROMPT_KEY : _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.NLP.FIELDS.DEFAULT_PROMPT_KEY;\n              history = [];\n              promptName = this._assistantName !== NLP.DEFAULT_ASSISTANT_NAME() ? \"\".concat(this._assistantName.toLowerCase(), \"Prompt\") : defaultPromptKey;\n              _context3.next = 11;\n              return this._state.getStaticData(promptName, null, true);\n            case 11:\n              _context3.t1 = _context3.sent;\n              if (_context3.t1) {\n                _context3.next = 16;\n                break;\n              }\n              _context3.next = 15;\n              return this._state.getSystemStaticData(defaultPromptKey);\n            case 15:\n              _context3.t1 = _context3.sent;\n            case 16:\n              _context3.t0 = _context3.t1;\n              if (_context3.t0) {\n                _context3.next = 19;\n                break;\n              }\n              _context3.t0 = [];\n            case 19:\n              prompt = _context3.t0;\n              nlpName = this._assistantName !== NLP.DEFAULT_ASSISTANT_NAME() ? \"\".concat(this._assistantName.toLowerCase(), \"NLP\") : defaultNLPKey;\n              _context3.next = 23;\n              return this._state.getStaticData(nlpName, null, true);\n            case 23:\n              _context3.t3 = _context3.sent;\n              if (_context3.t3) {\n                _context3.next = 28;\n                break;\n              }\n              _context3.next = 27;\n              return this._state.getSystemStaticData(defaultNLPKey);\n            case 27:\n              _context3.t3 = _context3.sent;\n            case 28:\n              _context3.t2 = _context3.t3;\n              if (_context3.t2) {\n                _context3.next = 31;\n                break;\n              }\n              _context3.t2 = {};\n            case 31:\n              nlpParameters = _context3.t2;\n              if (!(service === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.LLM_SERVICE.CHAT)) {\n                _context3.next = 49;\n                break;\n              }\n              newContent = {};\n              if (((_this$_state$messageF2 = this._state.messageFromUser) === null || _this$_state$messageF2 === void 0 ? void 0 : _this$_state$messageF2.intentId) === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS) {\n                newContent = {\n                  role: _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.OPEN_AI_ROLES.SYSTEM,\n                  content: \"Generate 3 relevant follow up questions for the content above, impersonating the user, with each question in less than 8 words and in JSON object with the questions within an array identified as \\\"q\\\"\"\n                };\n                this._state.addActiveIntent(_ALLConstants__WEBPACK_IMPORTED_MODULE_0__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS);\n              } else {\n                newContent = {\n                  role: role,\n                  content: userPrompt || this._state.messageFromUser\n                };\n              }\n              _context3.next = 37;\n              return this._state.db.getObjectFromCache(this.getKeyForPrompt());\n            case 37:\n              _context3.t4 = _context3.sent;\n              if (_context3.t4) {\n                _context3.next = 40;\n                break;\n              }\n              _context3.t4 = [];\n            case 40:\n              history = _context3.t4;\n              D.debug({\n                message: \"Context\",\n                data: history\n              });\n              if (typeof history === \"string\") {\n                history = [];\n              }\n              _context3.next = 45;\n              return this.addContextPromptsToChat(prompt);\n            case 45:\n              prompt = _context3.sent;\n              if (((_this$_state$messageF3 = this._state.messageFromUser) === null || _this$_state$messageF3 === void 0 ? void 0 : _this$_state$messageF3.intentId) !== _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS) {\n                history.push(newContent);\n                prompt = prompt.concat(history);\n              } else {\n                prompt = prompt.concat(newContent);\n              }\n              _context3.next = 50;\n              break;\n            case 49:\n              if (typeof prompt === \"string\") {\n                prompt = prompt.concat(userPrompt);\n              }\n            case 50:\n              options = {\n                body: {\n                  model: nlpParameters.model,\n                  messages: prompt,\n                  temperature: nlpParameters.temperature,\n                  max_tokens: nlpParameters.max_tokens,\n                  top_p: nlpParameters.top_p,\n                  frequency_penalty: nlpParameters.frequency_penalty,\n                  presence_penalty: nlpParameters.presence_penalty,\n                  stop: nlpParameters.stop,\n                  user: this._state.user.userId\n                }\n              };\n              D.debug({\n                message: \"Call to openAI\",\n                data: options\n              });\n              serviceName = this.getAPIKeyFromParameters(nlpParameters === null || nlpParameters === void 0 ? void 0 : nlpParameters.apiServiceNames);\n              if (!(serviceName !== \"NO_SERVICE\")) {\n                _context3.next = 93;\n                break;\n              }\n              _context3.next = 56;\n              return this._state.api.callService(serviceName, options);\n            case 56:\n              response = _context3.sent;\n              D.debug({\n                message: \"Response from openAI\",\n                data: response\n              });\n              DEFAULT_MESSAGE = \"We are not able to process your message at this time, please try again later\";\n              openAIContent = response === null || response === void 0 || (_response$choices$ = response.choices[0]) === null || _response$choices$ === void 0 || (_response$choices$ = _response$choices$.message) === null || _response$choices$ === void 0 ? void 0 : _response$choices$.content;\n              text = \"\";\n              openAICallPassed = true;\n              if (!(typeof openAIContent === \"string\")) {\n                _context3.next = 69;\n                break;\n              }\n              text = openAIContent;\n              text = text.replace(\"OnShip\", \"onship\");\n              text = text.replace(\"Onship\", \"onship\");\n              text = text.trim();\n              _context3.next = 75;\n              break;\n            case 69:\n              openAICallPassed = false;\n              text = DEFAULT_MESSAGE;\n              this._state.addSystemErrorToStack(60, null, response);\n              this._state.clearError();\n              if (!(((_this$_state$messageF4 = this._state.messageFromUser) === null || _this$_state$messageF4 === void 0 ? void 0 : _this$_state$messageF4.intentId) === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS)) {\n                _context3.next = 75;\n                break;\n              }\n              return _context3.abrupt(\"return\");\n            case 75:\n              if (!(((_this$_state$messageF5 = this._state.messageFromUser) === null || _this$_state$messageF5 === void 0 ? void 0 : _this$_state$messageF5.intentId) !== _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS)) {\n                _context3.next = 83;\n                break;\n              }\n              if (!(service === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.LLM_SERVICE.CHAT)) {\n                _context3.next = 83;\n                break;\n              }\n              if (text === DEFAULT_MESSAGE) {\n                history.pop();\n              } else {\n                history.push({\n                  role: _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.OPEN_AI_ROLES.SYSTEM,\n                  content: text\n                });\n              }\n              DEFAULT_MAX_CONTEXT_LENGTH = 20;\n              maxSize = nlpParameters !== null && nlpParameters !== void 0 && nlpParameters.maxContextLength ? nlpParameters.maxContextLength : DEFAULT_MAX_CONTEXT_LENGTH;\n              if (history.length > maxSize) {\n                history.splice(0, history.length - maxSize);\n              }\n              _context3.next = 83;\n              return this._state.db.setOneValueInCache(this.getKeyForPrompt(), history);\n            case 83:\n              object = this.extractObjectFromMessage(text);\n              if (!(object === false)) {\n                _context3.next = 92;\n                break;\n              }\n              if (!(this._automaticSuggestions && this._state.platform !== \"android\")) {\n                _context3.next = 89;\n                break;\n              }\n              if (!openAICallPassed) {\n                _context3.next = 89;\n                break;\n              }\n              _context3.next = 89;\n              return this._state.notification.sendMessageToUserInBot(_MessageTypes__WEBPACK_IMPORTED_MODULE_1__.MessageTypes.BOT_TO_BOT(), {\n                intentId: _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS\n              }, [this._state.user.userId], this._state.botId, this._state.currentUserDomain, false, null, false);\n            case 89:\n              return _context3.abrupt(\"return\", this.formatMarkdownAsHTML(text));\n            case 92:\n              return _context3.abrupt(\"return\", object);\n            case 93:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function callOpenAIWithMessageFromUser(_x2) {\n        return _callOpenAIWithMessageFromUser.apply(this, arguments);\n      }\n      return callOpenAIWithMessageFromUser;\n    }()\n  }], [{\n    key: \"OPEN_AI\",\n    value: function OPEN_AI() {\n      return 'openAI';\n    }\n  }, {\n    key: \"DEFAULT_ASSISTANT_NAME\",\n    value: function DEFAULT_ASSISTANT_NAME() {\n      return 'AI';\n    }\n  }, {\n    key: \"CONVERSATION_CONTEXT_FIELD\",\n    value: function CONVERSATION_CONTEXT_FIELD() {\n      return \"_conversationContextField\";\n    }\n  }]);\n  return NLP;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/NLP.js?");

/***/ }),

/***/ "../../frontmjs/core/Notification.js":
/*!*******************************************!*\
  !*** ../../frontmjs/core/Notification.js ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Notification: function() { return /* binding */ Notification; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nvar Notification = /*#__PURE__*/function () {\n  function Notification(state) {\n    _classCallCheck(this, Notification);\n    this['_state'] = state;\n    this['_'] = state._;\n    if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n      this['notification'] = this._state.context.getCapability('Notification');\n    }\n  }\n  _createClass(Notification, [{\n    key: \"sendEmail\",\n    value: function sendEmail(to, title, body, attachments, from, cc) {\n      var params = {\n        capability: 'SendEmailCustomCapability',\n        capabilityFileName: 'email',\n        address: to,\n        cc: cc,\n        fromEmail: from,\n        htmlBody: body,\n        title: title,\n        sync: true,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation,\n        attachments: []\n      };\n      var allAttachments = [];\n      if (attachments) {\n        this._.each(attachments, function (attachment) {\n          var a = {\n            fileContentName: attachment.name\n          };\n          if (attachment.type === 'csv' || attachment.type === 'string') {\n            a.stringContent = attachment.content;\n          } else {\n            a.jsonContent = attachment.content;\n          }\n          allAttachments.push(a);\n        });\n        params.attachments = allAttachments;\n      }\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"sendIMMessage\",\n    value: function sendIMMessage() {\n      //console.log('Sending IM message');\n      var messageToSend = {\n        messageId: this._state.messageIdFromUser,\n        contentType: this._state.messageTypeIntFromUser,\n        createdOn: this._state.messageCreatedOnFromUser,\n        createdBy: this._state.user.userId,\n        //this._state.messageCreatedByFromUser,\n        content: this._state.messageContentFromUser,\n        options: this._state.messageOptionsFromUser\n      };\n      //console.log(JSON.stringify(messageToSend));\n      var params = {\n        capability: 'SendIMMessage',\n        capabilityFileName: 'sendIMMessage',\n        sync: true,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation,\n        messages: [messageToSend],\n        isNewConversation: false\n      };\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"sendVoipPushNotificationToUserDevices\",\n    value: function () {\n      var _sendVoipPushNotificationToUserDevices = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(userDevices, sns, conversationId, message, data) {\n        var _this = this;\n        var _, D, createVoipMsg, callVoipMessage;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              createVoipMsg = function createVoipMsg(conversationId) {\n                var apsMsg = {\n                  aps: {\n                    alert: message,\n                    data: {\n                      videoSessionId: _.get(data, 'videoSessionId'),\n                      botId: _.get(data, 'botId'),\n                      userDomain: _.get(data, 'userDomain'),\n                      userId: _.get(data, 'userId'),\n                      videoControlId: _.get(data, 'videoControlId'),\n                      video: _.get(data, 'video'),\n                      mediasoupHost: _.get(data, 'mediasoupHost'),\n                      codec: _.get(data, 'codec'),\n                      iAmHost: _.get(data, 'iAmHost'),\n                      startWithVideoMuted: _.get(data, 'startWithVideoMuted'),\n                      preConnectCallCheck: _.get(data, 'preConnectCallCheck'),\n                      uid: _.get(data, 'uid'),\n                      ur: _.get(data, 'ur'),\n                      callAction: _.get(data, 'callAction'),\n                      conversationId: conversationId,\n                      roomName: _.get(data, 'roomName'),\n                      brand: _.get(data, 'brand')\n                    },\n                    sound: _.get(data, 'soundName', 'default')\n                  }\n                };\n                var gcmMsg = {\n                  data: {\n                    message: message,\n                    conversationId: conversationId,\n                    videoSessionId: _.get(data, 'videoSessionId'),\n                    botId: _.get(data, 'botId'),\n                    userDomain: _.get(data, 'userDomain'),\n                    userId: _.get(data, 'userId'),\n                    videoControlId: _.get(data, 'videoControlId'),\n                    video: _.get(data, 'video'),\n                    mediasoupHost: _.get(data, 'mediasoupHost'),\n                    iAmHost: _.get(data, 'iAmHost'),\n                    startWithVideoMuted: _.get(data, 'startWithVideoMuted'),\n                    preConnectCallCheck: _.get(data, 'preConnectCallCheck'),\n                    uid: _.get(data, 'uid'),\n                    ur: _.get(data, 'ur'),\n                    callAction: _.get(data, 'callAction'),\n                    codec: _.get(data, 'codec'),\n                    soundName: _.get(data, 'soundName'),\n                    roomName: _.get(data, 'roomName'),\n                    brand: _.get(data, 'brand')\n                  },\n                  time_to_live: 10,\n                  priority: 'high'\n                };\n                var snsMsg = {\n                  \"default\": message,\n                  GCM: JSON.stringify(gcmMsg),\n                  APNS_VOIP: JSON.stringify(apsMsg),\n                  APNS_VOIP_SANDBOX: JSON.stringify(apsMsg)\n                };\n                return JSON.stringify(snsMsg);\n              };\n              callVoipMessage = function callVoipMessage(conversationId, sns, message, arn) {\n                var snsParams = {\n                  Message: createVoipMsg(conversationId, message),\n                  MessageStructure: 'json',\n                  MessageAttributes: {\n                    'AWS.SNS.MOBILE.APNS.TTL': {\n                      DataType: 'String',\n                      StringValue: '10'\n                    },\n                    'AWS.SNS.MOBILE.APNS.PRIORITY': {\n                      DataType: 'String',\n                      StringValue: '10'\n                    },\n                    'AWS.SNS.MOBILE.APNS.PUSH_TYPE': {\n                      DataType: 'String',\n                      StringValue: 'voip'\n                    }\n                  },\n                  TargetArn: arn\n                };\n                return sns.publish(snsParams).promise();\n              };\n              _.forEach(userDevices, function (arn) {\n                callVoipMessage(conversationId, sns, message, arn).then(function () {\n                  _this._state.developer.info({\n                    message: 'Push notification sent with no error'\n                  });\n                })[\"catch\"](function (err) {\n                  _this._state.developer.warning({\n                    message: 'Could not send push notification to a device',\n                    data: JSON.stringify(err)\n                  });\n                  //console.log('Push notification error');\n                  return 'error occurred while sending notification to :' + arn;\n                });\n              });\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function sendVoipPushNotificationToUserDevices(_x, _x2, _x3, _x4, _x5) {\n        return _sendVoipPushNotificationToUserDevices.apply(this, arguments);\n      }\n      return sendVoipPushNotificationToUserDevices;\n    }()\n  }, {\n    key: \"sendVoipCallPushNotifications\",\n    value: function () {\n      var _sendVoipCallPushNotifications = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(conversations, message, data, onlyAndroid, onlyIOS, ignoreTimeDelay) {\n        var state, R, _, D, sns, devices, notificationsTargets, keys, i, conversation, participants, j, participant, notificationKey, previousNotificationTime, key, people, allDevices, webPushAppType, sendWebPush, webPushPromises, _i, _key, target;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              state = this._state;\n              R = state.R;\n              _ = state._;\n              D = state.developer;\n              sns = new this._state.aws.SNS({\n                apiVersion: '2010-03-31'\n              });\n              devices = [];\n              notificationsTargets = {};\n              keys = [];\n              i = 0;\n            case 9:\n              if (!(i < conversations.length)) {\n                _context2.next = 32;\n                break;\n              }\n              conversation = conversations[i]; //_.forEach(conversations, (conversation) => {\n              participants = _.get(conversation, 'participants') || [];\n              j = 0;\n            case 13:\n              if (!(j < participants.length)) {\n                _context2.next = 29;\n                break;\n              }\n              participant = participants[j]; //_.forEach(_.get(conversation, 'participants'), (participant) => {\n              if (!(participant !== _.get(conversation, 'bot'))) {\n                _context2.next = 26;\n                break;\n              }\n              notificationKey = \"PUSH_NOTIFICATION_KEY_\".concat(participant);\n              _context2.next = 19;\n              return this._state.getSharedField(notificationKey);\n            case 19:\n              previousNotificationTime = _context2.sent;\n              if (!(Date.now() - _.get(previousNotificationTime, 'timeStamp', 0) > 10000 || ignoreTimeDelay)) {\n                _context2.next = 26;\n                break;\n              }\n              _context2.next = 23;\n              return this._state.setSharedField(notificationKey, {\n                timeStamp: Date.now()\n              }, 10);\n            case 23:\n              //Redis entry expires within 10 seconds\n              key = \"People_\".concat(participant);\n              keys.push(key);\n              notificationsTargets[key] = {\n                conversationId: conversation.conversationId\n              };\n            case 26:\n              j++;\n              _context2.next = 13;\n              break;\n            case 29:\n              i++;\n              _context2.next = 9;\n              break;\n            case 32:\n              if (!_.isEmpty(notificationsTargets)) {\n                _context2.next = 34;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 34:\n              _context2.next = 36;\n              return this._state.db.getMultipleValuesFromCache(keys);\n            case 36:\n              people = _context2.sent;\n              allDevices = [];\n              _context2.next = 40;\n              return this._state.getStaticData(\"webPushAppType\");\n            case 40:\n              webPushAppType = _context2.sent;\n              sendWebPush = function sendWebPush(person) {\n                D.log({\n                  message: \"webPushAppType\",\n                  data: webPushAppType\n                });\n                if (webPushAppType) {\n                  var params = {\n                    pushType: \"WEB_PUSH\",\n                    action: \"SendNotification\",\n                    webPushAppType: webPushAppType,\n                    userId: _.get(person, \"userId\"),\n                    userEmail: _.get(person, \"emailAddress\"),\n                    message: {\n                      title: \"FrontM Notifications\",\n                      text: message\n                    }\n                  };\n                  D.log({\n                    message: \"params\",\n                    data: params\n                  });\n                  return state.callLambda(\"PushNotificationHandler\", params, \"Event\");\n                }\n              };\n              webPushPromises = [];\n              _.forEach(people, function (person, key) {\n                var parsedPerson = JSON.parse(person.content);\n                //Deduplicate devices here\n                var personDevices = _.get(parsedPerson, 'voipDevices', []);\n                var _iterator = _createForOfIteratorHelper(personDevices.entries()),\n                  _step;\n                try {\n                  var _loop = function _loop() {\n                    var _step$value = _slicedToArray(_step.value, 2),\n                      i = _step$value[0],\n                      device = _step$value[1];\n                    var index = _.findIndex(allDevices, function (currentDevice) {\n                      return currentDevice === device;\n                    });\n                    if (index > -1) {\n                      personDevices.splice(i, 1);\n                    } else {\n                      if (onlyAndroid) {\n                        if (device.includes(\"APN\")) {\n                          personDevices.splice(i, 1);\n                        }\n                      } else if (onlyIOS) {\n                        if (device.includes(\"GCM\")) {\n                          personDevices.splice(i, 1);\n                        }\n                      }\n                      allDevices.push(device);\n                    }\n                  };\n                  for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                    _loop();\n                  }\n                } catch (err) {\n                  _iterator.e(err);\n                } finally {\n                  _iterator.f();\n                }\n                if (_.size(personDevices) > 0) {\n                  notificationsTargets[key].devices = personDevices;\n                } else {\n                  delete notificationsTargets[key];\n                }\n                webPushPromises.push(sendWebPush(parsedPerson));\n              });\n              _context2.next = 46;\n              return Promise.all(webPushPromises);\n            case 46:\n              _i = 0;\n            case 47:\n              if (!(_i < _.keys(notificationsTargets).length)) {\n                _context2.next = 56;\n                break;\n              }\n              _key = _.keys(notificationsTargets)[_i];\n              target = notificationsTargets[_key]; //_.forEach(notificationsTargets, (target) => {\n              _context2.next = 52;\n              return this.sendVoipPushNotificationToUserDevices(_.get(target, 'devices'), sns, _.get(target, 'conversationId'), message, data);\n            case 52:\n              D.info({\n                message: 'Sent to device',\n                data: target\n              });\n            case 53:\n              _i++;\n              _context2.next = 47;\n              break;\n            case 56:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function sendVoipCallPushNotifications(_x6, _x7, _x8, _x9, _x10, _x11) {\n        return _sendVoipCallPushNotifications.apply(this, arguments);\n      }\n      return sendVoipCallPushNotifications;\n    }()\n  }, {\n    key: \"sendPushNotificationToUserDevices\",\n    value: function () {\n      var _sendPushNotificationToUserDevices = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(userDevices, sns, conversationId, message, data) {\n        var _this2 = this;\n        var _, createSNSMsg, callSNS;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _ = this._state._;\n              createSNSMsg = function createSNSMsg(conversationId) {\n                var soundName = _.get(data, 'soundName', 'default');\n                var apsMsg = {\n                  aps: {\n                    alert: message,\n                    sound: soundName === 'default' ? soundName : \"\".concat(soundName, \".wav\"),\n                    \"interruption-level\": \"time-sensitive\"\n                  },\n                  videoSessionId: _.get(data, 'videoSessionId'),\n                  botId: _.get(data, 'botId'),\n                  userDomain: _.get(data, 'userDomain'),\n                  userId: _.get(data, 'userId'),\n                  videoControlId: _.get(data, 'videoControlId'),\n                  video: _.get(data, 'video'),\n                  conversationId: conversationId\n                };\n                var gcmMsg = {\n                  collapse_key: 'FrontM messages',\n                  notification: {\n                    title: message,\n                    conversationId: conversationId,\n                    botId: _.get(data, 'botId'),\n                    userDomain: _.get(data, 'userDomain'),\n                    userId: _.get(data, 'userId'),\n                    android_channel_id: \"high_priority_channel\",\n                    channel_id: soundName\n                  },\n                  data: {\n                    message: message,\n                    conversationId: conversationId,\n                    videoSessionId: _.get(data, 'videoSessionId'),\n                    botId: _.get(data, 'botId'),\n                    userDomain: _.get(data, 'userDomain'),\n                    userId: _.get(data, 'userId'),\n                    videoControlId: _.get(data, 'videoControlId'),\n                    video: _.get(data, 'video')\n                  },\n                  priority: \"high\"\n                };\n                var snsMsg = {\n                  \"default\": message,\n                  GCM: JSON.stringify(gcmMsg),\n                  APNS: JSON.stringify(apsMsg),\n                  APNS_SANDBOX: JSON.stringify(apsMsg)\n                };\n                return JSON.stringify(snsMsg);\n              };\n              callSNS = function callSNS(conversationId, sns, message, arn) {\n                var snsParams = {\n                  Message: createSNSMsg(conversationId, message),\n                  MessageStructure: 'json',\n                  Subject: 'New Message',\n                  TargetArn: arn\n                };\n                return sns.publish(snsParams).promise();\n              };\n              _.forEach(userDevices, function (arn) {\n                callSNS(conversationId, sns, message, arn).then(function () {\n                  _this2._state.developer.info({\n                    message: 'Push notification sent with no error'\n                  });\n                })[\"catch\"](function (err) {\n                  _this2._state.developer.warning({\n                    message: 'Could not send push notification to a device',\n                    data: JSON.stringify(err)\n                  });\n                  //console.log('Push notification error');\n                  return 'error occurred while sending notification to :' + arn;\n                });\n              });\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function sendPushNotificationToUserDevices(_x12, _x13, _x14, _x15, _x16) {\n        return _sendPushNotificationToUserDevices.apply(this, arguments);\n      }\n      return sendPushNotificationToUserDevices;\n    }()\n  }, {\n    key: \"sendPushNotifications\",\n    value: function () {\n      var _sendPushNotifications = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(conversations, message, data) {\n        var _this3 = this;\n        var R, _, D, sns, devices, notificationsTargets, keys, people;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              R = this._state.R;\n              _ = this._state._;\n              D = this._state.developer;\n              D.debug({\n                message: \"Sending push\",\n                data: {\n                  conversations: conversations,\n                  message: message,\n                  data: data\n                }\n              });\n              sns = new this._state.aws.SNS({\n                apiVersion: '2010-03-31'\n              });\n              devices = [];\n              notificationsTargets = {};\n              keys = [];\n              _.forEach(conversations, function (conversation) {\n                _.forEach(_.get(conversation, 'participants'), function (participant) {\n                  if (participant !== _.get(conversation, 'bot')) {\n                    var key = \"People_\".concat(participant);\n                    keys.push(key);\n                    notificationsTargets[key] = {\n                      conversationId: conversation.conversationId\n                    };\n                  }\n                });\n              });\n              if (!(keys.length > 0)) {\n                _context4.next = 17;\n                break;\n              }\n              _context4.next = 12;\n              return this._state.db.getMultipleValuesFromCache(keys);\n            case 12:\n              people = _context4.sent;\n              _.forEach(people, function (person, key) {\n                var parsedPerson = JSON.parse(person.content);\n                notificationsTargets[key].devices = devices.concat(_.get(parsedPerson, 'devices', []));\n              });\n              // D.debug({message: 'Targets ', data: R.toString(notificationsTargets)});\n              _.forEach(notificationsTargets, function (target) {\n                _this3.sendPushNotificationToUserDevices(_.get(target, 'devices'), sns, _.get(target, 'conversationId'), message, data).then(function () {\n                  //console.log(\"notification sent\");\n                });\n              });\n              _context4.next = 18;\n              break;\n            case 17:\n              D.warning({\n                message: \"No participants within the conversation\"\n              });\n            case 18:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function sendPushNotifications(_x17, _x18, _x19) {\n        return _sendPushNotifications.apply(this, arguments);\n      }\n      return sendPushNotifications;\n    }()\n  }, {\n    key: \"ringParticipantsInConversationList\",\n    value: function () {\n      var _ringParticipantsInConversationList = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(conversations, alertMessage, data) {\n        var _, D, i, conversation, conversationId, participants, l, participant;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer; //D.debug({message: 'In ring request'});\n              i = 0;\n            case 3:\n              if (!(i < conversations.length)) {\n                _context5.next = 20;\n                break;\n              }\n              conversation = conversations[i];\n              conversationId = _.get(conversation, 'conversationId');\n              participants = _.get(conversation, 'participants');\n              l = 0;\n            case 8:\n              if (!(l < participants.length)) {\n                _context5.next = 17;\n                break;\n              }\n              participant = participants[l];\n              data.conversationId = conversationId;\n              if (!(participant !== this._state.user.userId)) {\n                _context5.next = 14;\n                break;\n              }\n              _context5.next = 14;\n              return this.sendVoipPushNotifications(participant, alertMessage, data);\n            case 14:\n              l++;\n              _context5.next = 8;\n              break;\n            case 17:\n              i++;\n              _context5.next = 3;\n              break;\n            case 20:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function ringParticipantsInConversationList(_x20, _x21, _x22) {\n        return _ringParticipantsInConversationList.apply(this, arguments);\n      }\n      return ringParticipantsInConversationList;\n    }()\n  }, {\n    key: \"sendVoipPushNotifications\",\n    value: function () {\n      var _sendVoipPushNotifications = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(receiverUserId, alertMessage, data) {\n        var _this4 = this;\n        var R, _, D, _createVoipMsg, sendVoipNotification, frontmLib, receiver, voipDevices, sns;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              R = this._state.R;\n              _ = this._state._;\n              D = this._state.developer;\n              _context6.prev = 3;\n              //D.debug({message: 'In sending push'});\n              _createVoipMsg = function _createVoipMsg(alertMessage, data) {\n                var apsMsg = {\n                  aps: {\n                    alert: alertMessage,\n                    data: data\n                  }\n                };\n                var androidMessage = {\n                  notification: {\n                    title: alertMessage,\n                    body: data.message,\n                    sound: 'incallmanager_ringback.mp3',\n                    android_channel_id: '500'\n                  },\n                  data: data,\n                  \"priority\": \"high\"\n                };\n                var snsMsg = {\n                  APNS_VOIP_SANDBOX: JSON.stringify(apsMsg),\n                  APNS_VOIP: JSON.stringify(apsMsg),\n                  GCM: JSON.stringify(androidMessage)\n                };\n                return JSON.stringify(snsMsg);\n              };\n              sendVoipNotification = function sendVoipNotification(alertMessage, data, arn, sns) {\n                var snsParams = {\n                  Message: _createVoipMsg(alertMessage, data),\n                  MessageStructure: 'json',\n                  MessageAttributes: {\n                    \"AWS.SNS.MOBILE.APNS.PRIORITY\": {\n                      \"DataType\": \"String\",\n                      \"StringValue\": \"10\"\n                    },\n                    \"AWS.SNS.MOBILE.APNS.PUSH_TYPE\": {\n                      \"DataType\": \"String\",\n                      \"StringValue\": \"voip\"\n                    }\n                  },\n                  TargetArn: arn\n                };\n                return sns.publish(snsParams).promise();\n              };\n              frontmLib = this._state.frontmlib;\n              _context6.next = 9;\n              return frontmLib.dbGetWithKey('People', {\n                userId: receiverUserId\n              });\n            case 9:\n              receiver = _context6.sent;\n              voipDevices = _.get(receiver, 'Item.voipDevices', []);\n              sns = new this._state.aws.SNS({\n                apiVersion: '2010-03-31'\n              });\n              _.forEach(voipDevices, function (arn) {\n                sendVoipNotification(alertMessage, data, arn, sns).then(function () {\n                  _this4._state.developer.info({\n                    message: \"Voip Push notification sent with no error: \".concat(arn)\n                  });\n                })[\"catch\"](function (err) {\n                  _this4._state.developer.warning({\n                    message: \"Could not send voip push notification to a device to: \".concat(arn),\n                    data: JSON.stringify(err)\n                  });\n                  //console.log('Voip Push notification error');\n                });\n              });\n              _context6.next = 18;\n              break;\n            case 15:\n              _context6.prev = 15;\n              _context6.t0 = _context6[\"catch\"](3);\n              D.warning({\n                message: 'Fail voip push',\n                data: _context6.t0.message\n              });\n            case 18:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this, [[3, 15]]);\n      }));\n      function sendVoipPushNotifications(_x23, _x24, _x25) {\n        return _sendVoipPushNotifications.apply(this, arguments);\n      }\n      return sendVoipPushNotifications;\n    }()\n  }, {\n    key: \"endCall\",\n    value: function endCall(_ref) {\n      var receiverUserId = _ref.receiverUserId,\n        videoSessionId = _ref.videoSessionId,\n        video = _ref.video;\n      var params = {\n        capability: 'VoipCapability',\n        capabilityFileName: 'voipCapability',\n        action: 'sendVoipPushNotification',\n        callAction: 'CallEnd',\n        callerUserId: this._state.user.userId,\n        receiverUserId: receiverUserId,\n        videoSessionId: videoSessionId,\n        video: video\n      };\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"ringMultipleUsers\",\n    value: function () {\n      var _ringMultipleUsers = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(conversations, alertMessage, data) {\n        var _, D, callerId, receivers, i, conversation;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              _ = this._state._;\n              D = this._state.developer;\n              callerId = this._state.user.userId;\n              receivers = [];\n              i = 0;\n            case 5:\n              if (!(i < conversations.length)) {\n                _context7.next = 12;\n                break;\n              }\n              conversation = conversations[i];\n              _context7.next = 9;\n              return this.sendVoipCallPushNotifications(conversation, alertMessage, data);\n            case 9:\n              i++;\n              _context7.next = 5;\n              break;\n            case 12:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function ringMultipleUsers(_x26, _x27, _x28) {\n        return _ringMultipleUsers.apply(this, arguments);\n      }\n      return ringMultipleUsers;\n    }()\n  }, {\n    key: \"ringSingleUser\",\n    value: function ringSingleUser(receiverUserId, alertMessage, data) {\n      var _ = this._state._;\n      var D = this._state.developer;\n      var callerId = this._state.user.userId;\n      var params = {\n        capability: 'VoipCapability',\n        capabilityFileName: 'voipCapability',\n        action: 'sendVoipPushNotification',\n        callAction: 'CallStart',\n        callerUserId: callerId,\n        receiverUserId: receiverUserId,\n        videoSessionId: data.videoSessionId,\n        video: data.video || false,\n        alertMessage: alertMessage\n      };\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"handleCallConnected\",\n    value: function handleCallConnected(_ref2) {\n      var callerUserId = _ref2.callerUserId,\n        receiverUserId = _ref2.receiverUserId;\n      var params = {\n        capability: 'VoipCapability',\n        capabilityFileName: 'voipCapability',\n        action: 'handleMultiUserCalls',\n        callAction: 'CallConnected',\n        callerUserId: callerUserId,\n        receiverUserId: receiverUserId\n      };\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"inviteUsers\",\n    value: function inviteUsers(emailIds) {\n      var params = {\n        capability: 'InviteUsers',\n        capabilityFileName: 'userInvitation',\n        emailIds: emailIds,\n        sync: true,\n        userId: this._state.user.userId,\n        conversation: this._state.conversation\n      };\n      var capabilities = this._state.context.capabilities.capabilities;\n      var capFileName = params.capabilityFileName;\n      var capabilityModule = capabilities[capFileName];\n      if (capabilityModule) {\n        //console.log('Executing the capability module');\n        return capabilityModule.execute(params, this._state.context.capabilities);\n      } else {\n        return this._state.callLambda('EmailLambda', params, 'RequestResponse').then(function (response) {\n          //console.log('Back from email lambda ' + JSON.stringify(response));\n          return JSON.parse(response.Payload);\n        });\n      }\n    }\n  }, {\n    key: \"isDeviceRegisteredForPush\",\n    value: function isDeviceRegisteredForPush() {\n      var _this5 = this;\n      return this.notification.deviceInfo().then(function (deviceInfo) {\n        if (_this5._state._.isEmpty(deviceInfo)) {\n          return false;\n        }\n        return deviceInfo.isRegistered;\n      });\n    }\n  }, {\n    key: \"registerDeviceForPushOnEdge\",\n    value: function registerDeviceForPushOnEdge() {\n      if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n        this.notification.requestPermission();\n      }\n    }\n  }, {\n    key: \"deregisterDeviceForPushOnEdge\",\n    value: function deregisterDeviceForPushOnEdge() {\n      var _this6 = this;\n      if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n        return this.notification.deregister().then(function (notificationDeviceInfo) {\n          return notificationDeviceInfo;\n        })[\"catch\"](function (error) {\n          _this6._state.addSystemErrorToStack(19, JSON.stringify(error));\n        });\n      } else {\n        this._state.addSystemErrorToStack(18);\n      }\n    }\n  }, {\n    key: \"registerDeviceForPushOnBackend\",\n    value: function registerDeviceForPushOnBackend(notificationDeviceInfo) {\n      try {\n        var conversation = this._state.conversation;\n        var userId = this._state.user.userId;\n        var params = {\n          capability: 'RegisterDevice',\n          capabilityFileName: 'deviceRegistration',\n          deviceToken: notificationDeviceInfo.deviceId,\n          deviceType: notificationDeviceInfo.deviceType,\n          sync: true,\n          userId: userId,\n          conversation: conversation\n        };\n        return this._state.callCapability(params);\n      } catch (error) {\n        this._state.addSystemErrorToStack(16, null, error.message);\n      }\n    }\n  }, {\n    key: \"deregisterDeviceForPushOnBackend\",\n    value: function deregisterDeviceForPushOnBackend(notificationDeviceInfo) {\n      try {\n        var conversation = this._state.conversation;\n        var userId = this._state.user.userId;\n        var params = {\n          capability: 'DeregisterDevice',\n          capabilityFileName: 'deviceRegistration',\n          deviceToken: notificationDeviceInfo.deviceId,\n          deviceType: notificationDeviceInfo.deviceType,\n          sync: true,\n          userId: userId,\n          conversation: conversation\n        };\n        return this._state.callCapability(params);\n      } catch (error) {\n        this._state.addSystemErrorToStack(16, null, error.message);\n      }\n    }\n  }, {\n    key: \"sendDelayedNotification\",\n    value: function sendDelayedNotification(params) {\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"generateFullMessageForMessage\",\n    value: function generateFullMessageForMessage(msg, target, type, realTimeMessage, v1Compatibility) {\n      var _ = this._state._;\n      var D = this._state.developer;\n      var requestId = this._state.getUniqueId();\n      var messageToSend = msg;\n      if (!realTimeMessage) {\n        var _state = _.get(target, 'bot') === this._state.botId ? this._state.stateToBackEnd() : {\n          state: {}\n        };\n        _state.state.messageFromUser = msg;\n        _state.state.messageTypeFromUser = 'object';\n        _state.state.fromGreeting = false;\n        _state.state.responsesArray = [];\n        _state.state._syncToCloud = {};\n        _state.state._syncToEdge = {};\n        // state.state._delayedNotification = [];\n        _state.state._activeIntent = '';\n        _state.state.responseToClient = _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT;\n        //D.log({message: 'Setting v1Compatibility'});\n        if (!realTimeMessage && v1Compatibility) {\n          //v1Compatibility generates simple responses in case of bot to bot messages\n          _state.state.v1Compatibility = true;\n        }\n        messageToSend = _state;\n      }\n      //D.log({message: 'Bot to bot message content', data: messageToSend});\n      var size = this._state.sizeOfObject(JSON.stringify(messageToSend));\n      if (size >= 200000) {\n        D.log({\n          message: '********** Danger danger danger!! Your PARAMS is too big!! **********',\n          data: size\n        });\n      }\n      return {\n        content: [messageToSend],\n        contentType: type,\n        requestUuid: requestId,\n        createdBy: this._state.user.userId,\n        createdOn: Date.now(),\n        messageId: this._state.getUniqueId()\n      };\n    }\n  }, {\n    key: \"sendNotification\",\n    value: function sendNotification(target, type, message, realTimeMessage, v1Compatibility) {\n      var _this7 = this;\n      try {\n        var _2 = this._state._;\n        var messages = [];\n        if (Array.isArray(message)) {\n          _2.forEach(message, function (msg) {\n            messages.push(_this7.generateFullMessageForMessage(msg, target, type, realTimeMessage, v1Compatibility));\n          });\n        } else {\n          messages.push(this.generateFullMessageForMessage(message, target, type, realTimeMessage, v1Compatibility));\n        }\n        //this._state.addRequestId(requestId);\n        var requestUuid = this._state.getUniqueId();\n        var params = {\n          target: target,\n          capability: 'BroadCastMessageCapability',\n          capabilityFileName: 'broadCastMessage',\n          action: 'get',\n          bot: this._state.conversation.bot || _2.get(this._state.context, 'botManifest.botId'),\n          userDomain: this._state.conversation.userDomain,\n          requestUuid: requestUuid,\n          sync: true,\n          email: this._state.user.userEmail,\n          conversation: this._state.conversation,\n          realTimeMessage: realTimeMessage,\n          messages: messages\n        };\n        return this._state.online().then(function (online) {\n          if (online) {\n            return _this7._state.callLambda('CapabilityExecutorLambda', params, 'Event');\n          } else {\n            _this7._state.addDelayedNotification(params);\n            return Promise.resolve();\n          }\n        });\n      } catch (error) {\n        this._state.addSystemErrorToStack(16, null, error.message);\n      }\n    }\n  }, {\n    key: \"sendMessageToUserInBot\",\n    value: function sendMessageToUserInBot(type, message, userIds, botId, userDomain, realTimeMessage, delay, v1Compatibility) {\n      var _this8 = this;\n      var _ = this._state._;\n      var D = this._state.developer;\n      if (!userIds || _.isEmpty(userIds)) {\n        D.warning({\n          message: \"The userIds array is empty. This request acts as a broadcast and could duplicate messages\"\n        });\n      }\n      var target = {\n        bot: botId || this._state.botId,\n        userDomain: userDomain || this._state.currentUserDomain,\n        users: userIds\n      };\n      D.debug({\n        message: \"Sending bot to bot to\",\n        data: target\n      });\n      D.debug({\n        message: \"Sending bot to bot with message\",\n        data: message\n      });\n      if (delay) {\n        //Delay in milliseconds\n        setTimeout(function () {\n          return _this8.sendNotification(target, type, message, realTimeMessage, v1Compatibility);\n        }, delay);\n      } else {\n        return this.sendNotification(target, type, message, realTimeMessage, v1Compatibility);\n      }\n    }\n  }, {\n    key: \"sendQueueMessageToUserInBot\",\n    value: function () {\n      var _sendQueueMessageToUserInBot = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(_ref3) {\n        var _this9 = this;\n        var type, message, userIds, botId, userDomain, _ref3$realTimeMessage, realTimeMessage, queue, _, D, target, messages, queuePayload, _iterator2, _step2, msg;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              type = _ref3.type, message = _ref3.message, userIds = _ref3.userIds, botId = _ref3.botId, userDomain = _ref3.userDomain, _ref3$realTimeMessage = _ref3.realTimeMessage, realTimeMessage = _ref3$realTimeMessage === void 0 ? false : _ref3$realTimeMessage, queue = _ref3.queue;\n              _ = this._state._;\n              D = this._state.developer;\n              if (queue) {\n                _context8.next = 6;\n                break;\n              }\n              D.systemError({\n                message: \"Missing queue url, not sending the message\"\n              });\n              return _context8.abrupt(\"return\");\n            case 6:\n              if (!userIds || _.isEmpty(userIds)) {\n                D.warning({\n                  message: \"The userIds array is empty. This request acts as a broadcast and could duplicate messages\"\n                });\n              }\n              target = {\n                bot: botId || this._state.botId,\n                userDomain: userDomain || this._state.currentUserDomain,\n                users: userIds\n              };\n              if (!Array.isArray(message)) {\n                message = [message];\n              }\n              messages = _.map(message, function (msg) {\n                return _this9.generateFullMessageForMessage(msg, target, type, realTimeMessage, false);\n              });\n              queuePayload = {\n                target: target,\n                botId: this._state.conversation.bot || _.get(this._state.context, 'botManifest.botId'),\n                userDomain: this._state.conversation.userDomain,\n                email: this._state.user.userEmail,\n                conversation: this._state.conversation,\n                realTimeMessage: realTimeMessage\n              };\n              _iterator2 = _createForOfIteratorHelper(messages);\n              _context8.prev = 12;\n              _iterator2.s();\n            case 14:\n              if ((_step2 = _iterator2.n()).done) {\n                _context8.next = 21;\n                break;\n              }\n              msg = _step2.value;\n              queuePayload.messages = [msg];\n              _context8.next = 19;\n              return this._state.sendMessageToQueue(queue, queuePayload);\n            case 19:\n              _context8.next = 14;\n              break;\n            case 21:\n              _context8.next = 26;\n              break;\n            case 23:\n              _context8.prev = 23;\n              _context8.t0 = _context8[\"catch\"](12);\n              _iterator2.e(_context8.t0);\n            case 26:\n              _context8.prev = 26;\n              _iterator2.f();\n              return _context8.finish(26);\n            case 29:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this, [[12, 23, 26, 29]]);\n      }));\n      function sendQueueMessageToUserInBot(_x29) {\n        return _sendQueueMessageToUserInBot.apply(this, arguments);\n      }\n      return sendQueueMessageToUserInBot;\n    }()\n  }, {\n    key: \"sendBroadcastNotificationToBot\",\n    value: function sendBroadcastNotificationToBot(botId, userDomain, type, message, realTimeMessage, delay, v1Compatibility) {\n      var _this10 = this;\n      var target = {\n        bot: botId || this._state.botId,\n        userDomain: userDomain || this._state.currentUserDomain\n      };\n      if (delay) {\n        //Delay in milliseconds\n        setTimeout(function () {\n          return _this10.sendNotification(target, type, message, realTimeMessage, v1Compatibility);\n        }, delay);\n      } else {\n        return this.sendNotification(target, type, message, realTimeMessage, v1Compatibility);\n      }\n    }\n  }]);\n  return Notification;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Notification.js?");

/***/ }),

/***/ "../../frontmjs/core/Orders.js":
/*!*************************************!*\
  !*** ../../frontmjs/core/Orders.js ***!
  \*************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Orders: function() { return /* binding */ Orders; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nvar Orders = /*#__PURE__*/function () {\n  function Orders(state) {\n    _classCallCheck(this, Orders);\n    this['_state'] = state;\n    this['context'] = state.context;\n    this['userId'] = state.user.userId;\n    this['conversation'] = state.conversation;\n    this['location'] = state.location;\n    this._state.developer.log({\n      message: 'Initialising Orders'\n    });\n    if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT && this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.EDGE) {\n      if (this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n        this._state.developer.log({\n          message: 'Initialising InAppPurchases'\n        });\n        this['inAppPurchaseCap'] = this.context.getCapability('InAppPurchase');\n        this['productTypes'] = this.inAppPurchaseCap.ProductTypes;\n      } else {\n        this['inAppPurchaseCap'] = 'false';\n        this['productTypes'] = [];\n      }\n    }\n  }\n  _createClass(Orders, [{\n    key: \"createNewStripeTransaction\",\n    value: function createNewStripeTransaction(amount, currency, description) {\n      var currentTransactions = this._state.getField(Orders.CURRENT_STRIPE_TRANSACTIONS()) || [];\n      var transactionId = this._state.UUID();\n      currentTransactions.push({\n        transactionId: transactionId,\n        amount: amount,\n        currency: currency,\n        description: description\n      });\n      this._state.setField(Orders.CURRENT_STRIPE_TRANSACTIONS(), currentTransactions);\n      return transactionId;\n    }\n  }, {\n    key: \"getStripeTransaction\",\n    value: function getStripeTransaction(transactionId) {\n      var currentTransactions = this._state.getField(Orders.CURRENT_STRIPE_TRANSACTIONS()) || [];\n      var index = this._state._.findIndex(currentTransactions, function (transaction) {\n        return transaction.transactionId === transactionId;\n      });\n      return index === -1 ? null : currentTransactions[index];\n    }\n  }, {\n    key: \"removeStripeTransaction\",\n    value: function removeStripeTransaction(transactionId) {\n      var currentTransactions = this._state.getField(Orders.CURRENT_STRIPE_TRANSACTIONS()) || [];\n      var index = this._state._.findIndex(currentTransactions, function (transaction) {\n        return transaction.transactionId === transactionId;\n      });\n      this._state._.pullAt(currentTransactions, [index]);\n      this._state.setField(Orders.CURRENT_STRIPE_TRANSACTIONS(), currentTransactions);\n    }\n  }, {\n    key: \"inAppPurchase\",\n    value: function inAppPurchase(product) {\n      if (this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.LOCATIONS.CLOUD || this._state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.CLIENTS.WEBCLIENT) {\n        this._state.addSystemErrorToStack(13);\n        return;\n      }\n      this._state.developer.log({\n        message: 'About to buy product ' + product + ' of type ' + this.productTypes.VOIP\n      });\n      return this.inAppPurchaseCap.buyProduct({\n        productCode: product,\n        productName: this.productTypes.VOIP\n      });\n    }\n  }, {\n    key: \"processStripePayment\",\n    value: function processStripePayment() {\n      var _this$_state$messageF = this._state.messageFromUser,\n        transactionId = _this$_state$messageF.transactionId,\n        currency = _this$_state$messageF.currency,\n        amount = _this$_state$messageF.amount,\n        paymentSuccessful = _this$_state$messageF.paymentSuccessful;\n      if (paymentSuccessful) {\n        var stateTransaction = this.getStripeTransaction(transactionId);\n        if (stateTransaction === null) {\n          return {\n            error: 'Invalid transaction id'\n          };\n        }\n        var stateTransactionId = stateTransaction.transactionId,\n          stateCurrency = stateTransaction.currency,\n          stateAmount = stateTransaction.amount;\n        if (stateTransactionId !== transactionId) {\n          return {\n            error: 'Invalid transaction id'\n          };\n        }\n        if (stateAmount !== amount) {\n          return {\n            error: 'There is a discrepancy in amounts. Please report to the support team'\n          };\n        }\n        if (stateCurrency !== currency) {\n          return {\n            error: 'There is a discrepancy in currencies. Please report to the support team'\n          };\n        }\n        this.removeStripeTransaction(transactionId);\n        return {\n          error: 0\n        };\n      } else {\n        this.removeStripeTransaction(transactionId);\n        return {\n          error: 'Your stripe payment was not successful'\n        };\n      }\n    }\n  }], [{\n    key: \"PAYMENT_CODES\",\n    value: function PAYMENT_CODES() {\n      return {\n        TOP_UP_WALLET: '100',\n        PURCHASE_PRODUCT: '101'\n      };\n    }\n  }, {\n    key: \"CURRENT_STRIPE_TRANSACTIONS\",\n    value: function CURRENT_STRIPE_TRANSACTIONS() {\n      return 'currentStripeTransactions';\n    }\n  }]);\n  return Orders;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Orders.js?");

/***/ }),

/***/ "../../frontmjs/core/SFTP.js":
/*!***********************************!*\
  !*** ../../frontmjs/core/SFTP.js ***!
  \***********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SFTP: function() { return /* binding */ SFTP; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar SFTP = /*#__PURE__*/function () {\n  function SFTP(state) {\n    _classCallCheck(this, SFTP);\n    this['_state'] = state;\n    this['_'] = state._;\n    var capabilities = state.context.capabilities.capabilities;\n    if (capabilities) {\n      this['_context'] = state.context.capabilities;\n      this['_sftpClient'] = state.context.capabilities.ssh2SftpClient;\n    } else {\n      this['_context'] = state.context;\n      this['_sftpClient'] = state.context.ssh2SftpClient;\n    }\n  }\n  _createClass(SFTP, [{\n    key: \"connect\",\n    value: function () {\n      var _connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(host, port, username, password) {\n        var sftpClient;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              sftpClient = new this._sftpClient();\n              _context.next = 4;\n              return sftpClient.connect({\n                host: host,\n                port: port,\n                username: username,\n                password: password\n              });\n            case 4:\n              return _context.abrupt(\"return\", sftpClient);\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              throw _context.t0;\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n      function connect(_x, _x2, _x3, _x4) {\n        return _connect.apply(this, arguments);\n      }\n      return connect;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(sftpClient) {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return sftpClient.end();\n            case 3:\n              _context2.next = 8;\n              break;\n            case 5:\n              _context2.prev = 5;\n              _context2.t0 = _context2[\"catch\"](0);\n              throw _context2.t0;\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 5]]);\n      }));\n      function disconnect(_x5) {\n        return _disconnect.apply(this, arguments);\n      }\n      return disconnect;\n    }()\n  }, {\n    key: \"getFilesList\",\n    value: function () {\n      var _getFilesList = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(sftpClient, path) {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return sftpClient.list(path);\n            case 3:\n              return _context3.abrupt(\"return\", _context3.sent);\n            case 6:\n              _context3.prev = 6;\n              _context3.t0 = _context3[\"catch\"](0);\n              throw _context3.t0;\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[0, 6]]);\n      }));\n      function getFilesList(_x6, _x7) {\n        return _getFilesList.apply(this, arguments);\n      }\n      return getFilesList;\n    }()\n  }, {\n    key: \"downloadFileToS3\",\n    value: function () {\n      var _downloadFileToS = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(sftpClient, S3, fromPath, toPath, fileName) {\n        var config, env, stream, putParams;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              config = this._.get(this._context, 'capabilities.config');\n              env = this._.get(this._context, 'capabilities.env');\n              if (!config) {\n                config = this._.get(this._context, 'config');\n                env = this._.get(this._context, 'env');\n              }\n              _context4.next = 6;\n              return sftpClient.get(\"\".concat(fromPath, \"/\").concat(fileName));\n            case 6:\n              stream = _context4.sent;\n              putParams = {\n                Bucket: config[env].CONVERSATIONS_BUCKET,\n                Key: \"\".concat(toPath, \"/\").concat(fileName),\n                Body: stream\n              };\n              _context4.next = 10;\n              return S3.putObject(putParams).promise();\n            case 10:\n              _context4.next = 15;\n              break;\n            case 12:\n              _context4.prev = 12;\n              _context4.t0 = _context4[\"catch\"](0);\n              throw _context4.t0;\n            case 15:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[0, 12]]);\n      }));\n      function downloadFileToS3(_x8, _x9, _x10, _x11, _x12) {\n        return _downloadFileToS.apply(this, arguments);\n      }\n      return downloadFileToS3;\n    }()\n  }, {\n    key: \"putFileToFTPServer\",\n    value: function () {\n      var _putFileToFTPServer = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(sftpConnection, readStream, remotePath) {\n        var _D;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              _D = this._state.developer;\n              _context5.next = 4;\n              return sftpConnection.put(readStream, remotePath);\n            case 4:\n              _context5.next = 10;\n              break;\n            case 6:\n              _context5.prev = 6;\n              _context5.t0 = _context5[\"catch\"](0);\n              D.systemError({\n                message: 'putFileToFTPServer:Error occurred while putting the file to the server',\n                errorCode: _context5.t0.message,\n                data: _context5.t0\n              });\n              throw _context5.t0;\n            case 10:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this, [[0, 6]]);\n      }));\n      function putFileToFTPServer(_x13, _x14, _x15) {\n        return _putFileToFTPServer.apply(this, arguments);\n      }\n      return putFileToFTPServer;\n    }()\n  }]);\n  return SFTP;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/SFTP.js?");

/***/ }),

/***/ "../../frontmjs/core/Schedules.js":
/*!****************************************!*\
  !*** ../../frontmjs/core/Schedules.js ***!
  \****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Schedules: function() { return /* binding */ Schedules; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Schedules = /*#__PURE__*/function () {\n  function Schedules(state) {\n    _classCallCheck(this, Schedules);\n    this['_state'] = state;\n    this['_'] = state._;\n    // this['_context'] = state.context;\n    var capabilities = state.context.capabilities.capabilities;\n    var context = null;\n    if (capabilities) {\n      context = state.context.capabilities;\n    } else {\n      context = state.context;\n    }\n    this['_context'] = context;\n    this['userId'] = state.user.userId;\n    this['conversation'] = state.conversation;\n    this['location'] = state.location;\n  }\n  _createClass(Schedules, [{\n    key: \"_validateResources\",\n    value: function _validateResources(resourceData) {\n      var domain = resourceData.domain,\n        resourceName = resourceData.resourceName,\n        resourceId = resourceData.resourceId,\n        resourceType = resourceData.resourceType,\n        resourceSubType = resourceData.resourceSubType,\n        availStartTime = resourceData.availStartTime,\n        availEndTime = resourceData.availEndTime,\n        dailyStartTime = resourceData.dailyStartTime,\n        dailyEndTime = resourceData.dailyEndTime,\n        weeklyOffDays = resourceData.weeklyOffDays,\n        adhocOffTime = resourceData.adhocOffTime;\n      if (!domain || !resourceName || !resourceId || !resourceType || !resourceSubType ||\n      // !multiTask || !availableStatus ||\n      !availStartTime || !availEndTime) return false;\n      if (availStartTime >= availEndTime) return false;\n      if (dailyStartTime && dailyStartTime < 0) return false;\n      if (dailyEndTime && dailyEndTime > 24) return false;\n      // we will have to handle the below condition in the bot.\n      // We have to consider 2 days worth of booking\n      //eg: 4 PM to 2PM (4PM on 19th - 2PM 20th)\n      // if (dailyStartTime >= dailyEndTime) return false;\n\n      if (weeklyOffDays && !Array.isArray(weeklyOffDays)) return false;\n      if (adhocOffTime && !Array.isArray(adhocOffTime)) return false;\n      return true;\n\n      // #TODO Add more validations\n    }\n  }, {\n    key: \"_getWeekdaysBetweenDates\",\n    value: function _getWeekdaysBetweenDates(inReqStartTime, inReqEndTime, tz) {\n      var momentTimeZone = this._context.momentTimeZone;\n      var momentStart = momentTimeZone.tz(inReqStartTime, tz);\n      var momentFinal = momentTimeZone.tz(inReqEndTime, tz);\n      var diff = momentFinal.diff(momentStart, \"days\");\n      if (diff >= 7) {\n        return momentTimeZone.weekdays();\n      }\n      var firstDay = momentStart.day();\n      var weekdaysBetween = [];\n      for (var i = 0; i <= diff; i++) {\n        // use % to loop to beginning again (e.g: start at friday and have +4)\n        weekdaysBetween.push(momentTimeZone.weekdays((firstDay + i) % 7));\n      }\n      return weekdaysBetween;\n    }\n  }, {\n    key: \"_extractTimeDetails\",\n    value: function _extractTimeDetails(inReqStartTime, inReqEndTime, resourceTimezone) {\n      var enteredTz = resourceTimezone || \"GMT +00:00 (Etc/GMT)\";\n      var timezoneString = enteredTz ? enteredTz.split(\"(\")[1].substring(0, enteredTz.split(\"(\")[1].length - 1) : \"Etc/GMT\";\n      var _this$_context = this._context,\n        moment = _this$_context.moment,\n        momentTimeZone = _this$_context.momentTimeZone;\n      //TODO:\n      // use timezone here to get the exact hours start\n      var reqStartHrs = momentTimeZone.tz(inReqStartTime, timezoneString).hours();\n      var reqEndHrs = momentTimeZone.tz(inReqEndTime, timezoneString).hours();\n      var reqIsMultiDay = !momentTimeZone.tz(inReqStartTime, timezoneString).isSame(momentTimeZone.tz(inReqEndTime, timezoneString), 'day');\n      var reqWeekDays = this._getWeekdaysBetweenDates(inReqStartTime, inReqEndTime, timezoneString);\n      return {\n        reqStartHrs: reqStartHrs,\n        reqEndHrs: reqEndHrs,\n        reqIsMultiDay: reqIsMultiDay,\n        reqWeekDays: reqWeekDays\n      };\n    }\n  }, {\n    key: \"_checkAdhocOffTime\",\n    value: function _checkAdhocOffTime(adhocSlots, inReqStartTime, inReqEndTime) {\n      var _ = this._;\n      var offTimeConflict = false;\n      if (!adhocSlots || !Array.isArray(adhocSlots) || adhocSlots.length < 1) return offTimeConflict;\n      _.forEach(adhocSlots, function (slot) {\n        // this._state.developer.log({ message: 'From Schedules, current adhoc slot ', data: slot });\n        if (inReqStartTime > slot.endTime || inReqEndTime < slot.startTime) {\n          // no conflict\n          // this._state.developer.log({ message: 'From Schedules, current adhoc slot ', data: 'return true' });\n          return true; // continue with next offline slot\n        } else {\n          offTimeConflict = true; // conflict\n          // this._state.developer.log({ message: 'From Schedules, current adhoc slot ', data: 'return false' });\n          return false; // break forEach\n        }\n      });\n      // this._state.developer.log({ message: 'From Schedules, offTimeConflict ', data: offTimeConflict });\n      return offTimeConflict;\n    }\n  }, {\n    key: \"_checkConflictingBookings\",\n    value: function () {\n      var _checkConflictingBookings2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(id, inReqStartTime, inReqEndTime, scheduleIdArr) {\n        var _, bookingConflict, finalScheduleDataArr, additionalQuery, _iterator, _step, schedule, scheduleData, initialOrQuery, query, responsesArray, allResponses, finalAllresponses;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _ = this._;\n              bookingConflict = false;\n              if (!(!id || !inReqStartTime || !inReqEndTime)) {\n                _context.next = 4;\n                break;\n              }\n              return _context.abrupt(\"return\", bookingConflict);\n            case 4:\n              finalScheduleDataArr = [];\n              additionalQuery = [];\n              if (!(scheduleIdArr && scheduleIdArr.length)) {\n                _context.next = 27;\n                break;\n              }\n              _iterator = _createForOfIteratorHelper(scheduleIdArr);\n              _context.prev = 8;\n              _iterator.s();\n            case 10:\n              if ((_step = _iterator.n()).done) {\n                _context.next = 18;\n                break;\n              }\n              schedule = _step.value;\n              _context.next = 14;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_DETAIL_DB(),\n                action: 'query',\n                query: {\n                  _id: schedule\n                },\n                projection: {},\n                sort: {},\n                skip: 0,\n                limit: 1,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 14:\n              scheduleData = _context.sent;\n              if (scheduleData && scheduleData.statusCode === 200 && scheduleData.body && scheduleData.body.length) {\n                finalScheduleDataArr.push(scheduleData.body[0]);\n              }\n            case 16:\n              _context.next = 10;\n              break;\n            case 18:\n              _context.next = 23;\n              break;\n            case 20:\n              _context.prev = 20;\n              _context.t0 = _context[\"catch\"](8);\n              _iterator.e(_context.t0);\n            case 23:\n              _context.prev = 23;\n              _iterator.f();\n              return _context.finish(23);\n            case 26:\n              additionalQuery = finalScheduleDataArr.map(function (entry) {\n                return {\n                  $and: [{\n                    bookedStartTime: {\n                      $eq: entry.bookedStartTime\n                    }\n                  }, {\n                    bookedEndTime: {\n                      $eq: entry.bookedEndTime\n                    }\n                  }]\n                };\n              });\n            case 27:\n              initialOrQuery = [{\n                \"$and\": [{\n                  \"bookedStartTime\": {\n                    \"$lte\": inReqStartTime\n                  }\n                }, {\n                  \"bookedEndTime\": {\n                    \"$gt\": inReqStartTime\n                  }\n                }]\n              }, {\n                \"$and\": [{\n                  \"bookedStartTime\": {\n                    \"$lt\": inReqEndTime\n                  }\n                }, {\n                  \"bookedEndTime\": {\n                    \"$gt\": inReqEndTime\n                  }\n                }]\n              }, {\n                \"$and\": [{\n                  \"bookedStartTime\": {\n                    \"$gt\": inReqStartTime\n                  }\n                }, {\n                  \"bookedEndTime\": {\n                    \"$lte\": inReqEndTime\n                  }\n                }]\n              }];\n              query = {\n                \"$and\": [{\n                  \"origId\": id\n                }, {\n                  \"$or\": [].concat(_toConsumableArray(additionalQuery), initialOrQuery)\n                }]\n              };\n              _context.next = 31;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_DETAIL_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: {},\n                skip: 0,\n                limit: 1,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 31:\n              responsesArray = _context.sent;\n              if (responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body)) {\n                allResponses = responsesArray.body;\n                finalAllresponses = [];\n                allResponses.map(function (sch) {\n                  if (scheduleIdArr.indexOf(sch._id) === -1) {\n                    finalAllresponses.push(sch);\n                  }\n                });\n                bookingConflict = _.size(finalAllresponses) > 0 ? true : false;\n              } else {\n                bookingConflict = true; // Database error, avoid overbooking, try booking again\n              }\n              return _context.abrupt(\"return\", bookingConflict);\n            case 34:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[8, 20, 23, 26]]);\n      }));\n      function _checkConflictingBookings(_x, _x2, _x3, _x4) {\n        return _checkConflictingBookings2.apply(this, arguments);\n      }\n      return _checkConflictingBookings;\n    }()\n  }, {\n    key: \"_filterQueriedResources\",\n    value: function () {\n      var _filterQueriedResources2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(inpResourceArray, inReqStartTime, inReqEndTime, scheduleIdArr) {\n        var _, outResourceArray, _this$_extractTimeDet, reqStartHrs, reqEndHrs, reqIsMultiDay, reqWeekDays, _iterator2, _step2, currRes, id, dailyStartTime, dailyEndTime, weeklyOffDays, adhocOffTime, t1, t2, t3, t4, existingBooking;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _ = this._;\n              outResourceArray = [];\n              if (!(!inpResourceArray || !Array.isArray(inpResourceArray) || inpResourceArray.length < 1)) {\n                _context2.next = 4;\n                break;\n              }\n              return _context2.abrupt(\"return\", outResourceArray);\n            case 4:\n              if (!(inReqStartTime >= inReqEndTime)) {\n                _context2.next = 6;\n                break;\n              }\n              return _context2.abrupt(\"return\", outResourceArray);\n            case 6:\n              _this$_extractTimeDet = this._extractTimeDetails(inReqStartTime, inReqEndTime, inpResourceArray[0].resourceTimezone), reqStartHrs = _this$_extractTimeDet.reqStartHrs, reqEndHrs = _this$_extractTimeDet.reqEndHrs, reqIsMultiDay = _this$_extractTimeDet.reqIsMultiDay, reqWeekDays = _this$_extractTimeDet.reqWeekDays;\n              this._state.developer.log({\n                message: 'From Schedules, extractTimeDetails resp',\n                data: {\n                  reqStartHrs: reqStartHrs,\n                  reqEndHrs: reqEndHrs,\n                  reqIsMultiDay: reqIsMultiDay,\n                  reqWeekDays: reqWeekDays\n                }\n              });\n              _iterator2 = _createForOfIteratorHelper(inpResourceArray);\n              _context2.prev = 9;\n              _iterator2.s();\n            case 11:\n              if ((_step2 = _iterator2.n()).done) {\n                _context2.next = 36;\n                break;\n              }\n              currRes = _step2.value;\n              id = currRes.id, dailyStartTime = currRes.dailyStartTime, dailyEndTime = currRes.dailyEndTime, weeklyOffDays = currRes.weeklyOffDays, adhocOffTime = currRes.adhocOffTime;\n              t1 = reqStartHrs >= dailyStartTime;\n              if (reqStartHrs >= dailyStartTime) {\n                _context2.next = 17;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 17:\n              t2 = reqEndHrs <= dailyEndTime;\n              if (reqEndHrs <= dailyEndTime) {\n                _context2.next = 20;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 20:\n              t3 = _.intersection(reqWeekDays, weeklyOffDays);\n              if (!(_.size(_.intersection(reqWeekDays, weeklyOffDays)) > 0)) {\n                _context2.next = 23;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 23:\n              t4 = reqIsMultiDay && (dailyStartTime !== 0 || dailyEndTime !== 24);\n              if (!(reqIsMultiDay && (dailyStartTime !== 0 || dailyEndTime !== 24))) {\n                _context2.next = 26;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 26:\n              if (!this._checkAdhocOffTime(adhocOffTime, inReqStartTime, inReqEndTime)) {\n                _context2.next = 28;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 28:\n              _context2.next = 30;\n              return this._checkConflictingBookings(id, inReqStartTime, inReqEndTime, scheduleIdArr);\n            case 30:\n              existingBooking = _context2.sent;\n              if (!existingBooking) {\n                _context2.next = 33;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 33:\n              outResourceArray.push(currRes);\n            case 34:\n              _context2.next = 11;\n              break;\n            case 36:\n              _context2.next = 41;\n              break;\n            case 38:\n              _context2.prev = 38;\n              _context2.t0 = _context2[\"catch\"](9);\n              _iterator2.e(_context2.t0);\n            case 41:\n              _context2.prev = 41;\n              _iterator2.f();\n              return _context2.finish(41);\n            case 44:\n              return _context2.abrupt(\"return\", outResourceArray);\n            case 45:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[9, 38, 41, 44]]);\n      }));\n      function _filterQueriedResources(_x5, _x6, _x7, _x8) {\n        return _filterQueriedResources2.apply(this, arguments);\n      }\n      return _filterQueriedResources;\n    }()\n  }, {\n    key: \"createSingleResource\",\n    value: function () {\n      var _createSingleResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(resource) {\n        var newResource, isValid, writeResp;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, createSingleRes with',\n                data: resource\n              });\n              newResource = {};\n              isValid = this._validateResources(resource);\n              if (!isValid) {\n                _context3.next = 30;\n                break;\n              }\n              newResource.id = this._state.getUniqueId(); // <--------------------------- Should we allow bot to set this?\n              // newResource.origId = resource.origId || this._state.getUniqueId();     // <----------------- What to do with this?\n              newResource.domain = resource.domain; // replace by this._state.currentUserDomain\n              newResource.resourceId = resource.resourceId;\n              newResource.resourceName = resource.resourceName;\n              newResource.resourceType = resource.resourceType;\n              newResource.resourceSubType = resource.resourceSubType;\n              newResource.availStartTime = resource.availStartTime;\n              newResource.availEndTime = resource.availEndTime;\n              newResource.dailyStartTime = parseInt(resource.dailyStartTime) || 0;\n              newResource.dailyEndTime = parseInt(resource.dailyEndTime) || 24;\n              newResource.weeklyOffDays = resource.weeklyOffDays || [];\n              newResource.adhocOffTime = resource.adhocOffTime || [];\n              newResource.resourceTimezone = resource.resourceTimezone || \"GMT +00:00 (Etc/GMT)\";\n              newResource.multiTask = resource.multiTask; // bool, cannot set default\n              newResource.availableStatus = resource.availableStatus; // bool, cannot set default\n              _context3.next = 21;\n              return this._state.db.insertDocumentInCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                document: newResource,\n                audit: false,\n                sync: false\n              });\n            case 21:\n              writeResp = _context3.sent;\n              if (!(writeResp.statusCode === 200 && writeResp.body === 'success')) {\n                _context3.next = 26;\n                break;\n              }\n              return _context3.abrupt(\"return\", {\n                'status': 'success',\n                newId: newResource.id\n              });\n            case 26:\n              this._state.developer.log({\n                message: 'From Schedules Class Create ERROR',\n                data: writeResp\n              });\n              return _context3.abrupt(\"return\", {\n                'status': 'error',\n                newId: undefined\n              });\n            case 28:\n              _context3.next = 32;\n              break;\n            case 30:\n              this._state.developer.log({\n                message: 'From Schedules Class Create ERROR',\n                data: \"Incomplete details\"\n              });\n              return _context3.abrupt(\"return\", {\n                'status': 'error',\n                newId: undefined\n              });\n            case 32:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function createSingleResource(_x9) {\n        return _createSingleResource.apply(this, arguments);\n      }\n      return createSingleResource;\n    }()\n  }, {\n    key: \"updateSingleResource\",\n    value: function () {\n      var _updateSingleResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(resource) {\n        var updResource, isValid, query, options, writeResp;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              // this._state.developer.log({ message: 'From Schedules, updateSingleRes with', data: resource });\n              updResource = {};\n              isValid = this._validateResources(resource);\n              if (!(isValid && resource.id)) {\n                _context4.next = 31;\n                break;\n              }\n              updResource.id = resource.id; // possibility of edit #TODO\n              // updResource.origId = resource.origId;                     // <----------------- What to do with this?\n              updResource.domain = resource.domain;\n              updResource.resourceId = resource.resourceId;\n              updResource.resourceName = resource.resourceName;\n              updResource.resourceType = resource.resourceType;\n              updResource.resourceSubType = resource.resourceSubType;\n              updResource.availStartTime = resource.availStartTime;\n              updResource.availEndTime = resource.availEndTime;\n              updResource.dailyStartTime = parseInt(resource.dailyStartTime) || 0;\n              updResource.dailyEndTime = parseInt(resource.dailyEndTime) || 24;\n              updResource.weeklyOffDays = resource.weeklyOffDays || [];\n              updResource.adhocOffTime = resource.adhocOffTime || [];\n              updResource.multiTask = resource.multiTask;\n              updResource.availableStatus = resource.availableStatus;\n              updResource.resourceTimezone = resource.resourceTimezone;\n              query = {\n                id: resource.id\n              };\n              options = {\n                upsert: true\n              };\n              _context4.next = 22;\n              return this._state.db.updateDataInCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                document: updResource,\n                query: query,\n                options: options,\n                audit: false,\n                sync: false\n              });\n            case 22:\n              writeResp = _context4.sent;\n              if (!(writeResp.statusCode === 200 && writeResp.body === 'success')) {\n                _context4.next = 27;\n                break;\n              }\n              return _context4.abrupt(\"return\", true);\n            case 27:\n              this._state.developer.log({\n                message: 'From Schedules Class Update ERROR',\n                data: writeResp\n              });\n              return _context4.abrupt(\"return\", false);\n            case 29:\n              _context4.next = 33;\n              break;\n            case 31:\n              this._state.developer.log({\n                message: 'From Schedules Class Update ERROR',\n                data: \"Incomplete details\"\n              });\n              return _context4.abrupt(\"return\", false);\n            case 33:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function updateSingleResource(_x10) {\n        return _updateSingleResource.apply(this, arguments);\n      }\n      return updateSingleResource;\n    }()\n  }, {\n    key: \"deleteSingleResource\",\n    value: function () {\n      var _deleteSingleResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(resourceId) {\n        var query, delResp;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              if (resourceId) {\n                _context5.next = 2;\n                break;\n              }\n              return _context5.abrupt(\"return\", false);\n            case 2:\n              query = {\n                id: resourceId\n              }; // TODO - Check if we have to delete from DETAIL\n              // let delResp = await this._state.db.deleteDataFromIndexByID(Schedules.SCHD_INDEX(), '_doc', resourceId);\n              _context5.next = 5;\n              return this._state.db.deleteDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                query: query,\n                audit: false,\n                sync: false\n              });\n            case 5:\n              delResp = _context5.sent;\n              if (!(delResp.statusCode === 200 && delResp.body === 'success')) {\n                _context5.next = 10;\n                break;\n              }\n              return _context5.abrupt(\"return\", true);\n            case 10:\n              this._state.developer.log({\n                message: 'From Schedules Class Delete ERROR',\n                data: delResp\n              });\n              return _context5.abrupt(\"return\", false);\n            case 12:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function deleteSingleResource(_x11) {\n        return _deleteSingleResource.apply(this, arguments);\n      }\n      return deleteSingleResource;\n    }()\n  }, {\n    key: \"createRecurringResource\",\n    value: function () {\n      var _createRecurringResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6);\n      }));\n      function createRecurringResource() {\n        return _createRecurringResource.apply(this, arguments);\n      }\n      return createRecurringResource;\n    }()\n  }, {\n    key: \"updateRecurringResource\",\n    value: function () {\n      var _updateRecurringResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7);\n      }));\n      function updateRecurringResource() {\n        return _updateRecurringResource.apply(this, arguments);\n      }\n      return updateRecurringResource;\n    }()\n  }, {\n    key: \"deleteRecurringResource\",\n    value: function () {\n      var _deleteRecurringResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8);\n      }));\n      function deleteRecurringResource() {\n        return _deleteRecurringResource.apply(this, arguments);\n      }\n      return deleteRecurringResource;\n    }()\n  }, {\n    key: \"searchResourcesByInterval\",\n    value: function () {\n      var _searchResourcesByInterval = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(startTime, endTime) {\n        var query, sort, responsesArray, filterResp;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, searchResourcesByInterval with',\n                data: {\n                  startTime: startTime,\n                  endTime: endTime\n                }\n              });\n              if (!(startTime >= endTime)) {\n                _context9.next = 3;\n                break;\n              }\n              return _context9.abrupt(\"return\", []);\n            case 3:\n              query = {\n                \"availStartTime\": {\n                  \"$lte\": startTime\n                },\n                \"availEndTime\": {\n                  \"$gte\": endTime\n                },\n                \"availableStatus\": true\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByInterval QUERY',\n                data: query\n              });\n              // let responsesArray = await this._state.db.getDataFromIndexWithQueryObject(Schedules.SCHD_INDEX(), queryObj);\n              _context9.next = 8;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 8:\n              responsesArray = _context9.sent;\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByInterval RESP',\n                data: responsesArray\n              });\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context9.next = 17;\n                break;\n              }\n              _context9.next = 13;\n              return this._filterQueriedResources(responsesArray.body, startTime, endTime);\n            case 13:\n              filterResp = _context9.sent;\n              return _context9.abrupt(\"return\", filterResp);\n            case 17:\n              return _context9.abrupt(\"return\", []);\n            case 18:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this);\n      }));\n      function searchResourcesByInterval(_x12, _x13) {\n        return _searchResourcesByInterval.apply(this, arguments);\n      }\n      return searchResourcesByInterval;\n    }()\n  }, {\n    key: \"searchResourcesByIntervalByType\",\n    value: function () {\n      var _searchResourcesByIntervalByType = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(resType, startTime, endTime) {\n        var query, sort, responsesArray, filterResp;\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, searchResourcesByIntervalByType with',\n                data: {\n                  resType: resType,\n                  startTime: startTime,\n                  endTime: endTime\n                }\n              });\n              if (!(startTime >= endTime || !resType)) {\n                _context10.next = 3;\n                break;\n              }\n              return _context10.abrupt(\"return\", []);\n            case 3:\n              query = {\n                \"resourceType\": resType,\n                \"availStartTime\": {\n                  \"$lte\": startTime\n                },\n                \"availEndTime\": {\n                  \"$gte\": endTime\n                },\n                \"availableStatus\": true\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByIntervalByType QUERY',\n                data: query\n              });\n              // let responsesArray = await this._state.db.getDataFromIndexWithQueryObject(Schedules.SCHD_INDEX(), queryObj);\n              _context10.next = 8;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 8:\n              responsesArray = _context10.sent;\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context10.next = 16;\n                break;\n              }\n              _context10.next = 12;\n              return this._filterQueriedResources(responsesArray.body, startTime, endTime);\n            case 12:\n              filterResp = _context10.sent;\n              return _context10.abrupt(\"return\", filterResp);\n            case 16:\n              return _context10.abrupt(\"return\", []);\n            case 17:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function searchResourcesByIntervalByType(_x14, _x15, _x16) {\n        return _searchResourcesByIntervalByType.apply(this, arguments);\n      }\n      return searchResourcesByIntervalByType;\n    }()\n  }, {\n    key: \"searchResourcesByIntervalBySubType\",\n    value: function () {\n      var _searchResourcesByIntervalBySubType = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(resSubType, startTime, endTime) {\n        var query, sort, responsesArray, filterResp;\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) switch (_context11.prev = _context11.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, searchResourcesByIntervalBySubType with',\n                data: {\n                  resSubType: resSubType,\n                  startTime: startTime,\n                  endTime: endTime\n                }\n              });\n              if (!(startTime >= endTime || !resSubType)) {\n                _context11.next = 3;\n                break;\n              }\n              return _context11.abrupt(\"return\", []);\n            case 3:\n              query = {\n                \"resourceSubType\": resSubType,\n                \"availStartTime\": {\n                  \"$lte\": startTime\n                },\n                \"availEndTime\": {\n                  \"$gte\": endTime\n                },\n                \"availableStatus\": true\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              _context11.next = 7;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 7:\n              responsesArray = _context11.sent;\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByIntervalBySubType RESP',\n                data: responsesArray\n              });\n              // let responsesArray = await this._state.db.getDataFromIndexWithQueryObject(Schedules.SCHD_INDEX(), query);\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context11.next = 16;\n                break;\n              }\n              _context11.next = 12;\n              return this._filterQueriedResources(responsesArray.body, startTime, endTime);\n            case 12:\n              filterResp = _context11.sent;\n              return _context11.abrupt(\"return\", filterResp);\n            case 16:\n              return _context11.abrupt(\"return\", []);\n            case 17:\n            case \"end\":\n              return _context11.stop();\n          }\n        }, _callee11, this);\n      }));\n      function searchResourcesByIntervalBySubType(_x17, _x18, _x19) {\n        return _searchResourcesByIntervalBySubType.apply(this, arguments);\n      }\n      return searchResourcesByIntervalBySubType;\n    }()\n  }, {\n    key: \"searchResourcesByIntervalByResId\",\n    value: function () {\n      var _searchResourcesByIntervalByResId = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(resId, startTime, endTime, scheduleIdArr) {\n        var gotConflict, query, sort, responsesArray, filterResp;\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              if (!(startTime >= endTime || !resId)) {\n                _context12.next = 2;\n                break;\n              }\n              return _context12.abrupt(\"return\", []);\n            case 2:\n              _context12.next = 4;\n              return this._checkConflictingBookings(resId, startTime, endTime, scheduleIdArr);\n            case 4:\n              gotConflict = _context12.sent;\n              if (!gotConflict) {\n                _context12.next = 7;\n                break;\n              }\n              return _context12.abrupt(\"return\", null);\n            case 7:\n              query = {\n                \"resourceId\": resId,\n                \"availStartTime\": {\n                  \"$lte\": startTime\n                },\n                \"availEndTime\": {\n                  \"$gte\": endTime\n                },\n                \"availableStatus\": true\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              _context12.next = 11;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 11:\n              responsesArray = _context12.sent;\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context12.next = 19;\n                break;\n              }\n              _context12.next = 15;\n              return this._filterQueriedResources(responsesArray.body, startTime, endTime, scheduleIdArr);\n            case 15:\n              filterResp = _context12.sent;\n              return _context12.abrupt(\"return\", filterResp);\n            case 19:\n              return _context12.abrupt(\"return\", []);\n            case 20:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this);\n      }));\n      function searchResourcesByIntervalByResId(_x20, _x21, _x22, _x23) {\n        return _searchResourcesByIntervalByResId.apply(this, arguments);\n      }\n      return searchResourcesByIntervalByResId;\n    }()\n  }, {\n    key: \"searchResourcesByIntervalByTypeSubType\",\n    value: function () {\n      var _searchResourcesByIntervalByTypeSubType = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(resType, resSubType, startTime, endTime) {\n        var query, sort, responsesArray, filterResp;\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, searchResourcesByIntervalByTypeSubType with',\n                data: {\n                  resType: resType,\n                  resSubType: resSubType,\n                  startTime: startTime,\n                  endTime: endTime\n                }\n              });\n              if (!(startTime >= endTime || !resType || !resSubType)) {\n                _context13.next = 3;\n                break;\n              }\n              return _context13.abrupt(\"return\", []);\n            case 3:\n              query = {\n                \"resourceType\": resType,\n                \"resourceSubType\": resSubType,\n                \"availStartTime\": {\n                  \"$lte\": startTime\n                },\n                \"availEndTime\": {\n                  \"$gte\": endTime\n                },\n                \"availableStatus\": true\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByIntervalByTypeSubType QUERY',\n                data: query\n              });\n              _context13.next = 8;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 8:\n              responsesArray = _context13.sent;\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByIntervalByTypeSubType RESP',\n                data: responsesArray\n              });\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context13.next = 17;\n                break;\n              }\n              _context13.next = 13;\n              return this._filterQueriedResources(responsesArray.body, startTime, endTime);\n            case 13:\n              filterResp = _context13.sent;\n              return _context13.abrupt(\"return\", filterResp);\n            case 17:\n              return _context13.abrupt(\"return\", []);\n            case 18:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this);\n      }));\n      function searchResourcesByIntervalByTypeSubType(_x24, _x25, _x26, _x27) {\n        return _searchResourcesByIntervalByTypeSubType.apply(this, arguments);\n      }\n      return searchResourcesByIntervalByTypeSubType;\n    }()\n  }, {\n    key: \"searchResourcesByIntervalByTypeSubTypeResId\",\n    value: function () {\n      var _searchResourcesByIntervalByTypeSubTypeResId = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(resType, resSubType, resId, startTime, endTime) {\n        var query, sort, responsesArray, filterResp;\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) switch (_context14.prev = _context14.next) {\n            case 0:\n              if (!(startTime >= endTime || !resType || !resSubType || !resId)) {\n                _context14.next = 2;\n                break;\n              }\n              return _context14.abrupt(\"return\", []);\n            case 2:\n              query = {\n                \"resourceType\": resType,\n                \"resourceSubType\": resSubType,\n                \"resourceId\": resId,\n                \"availStartTime\": {\n                  \"$lte\": startTime\n                },\n                \"availEndTime\": {\n                  \"$gte\": endTime\n                },\n                \"availableStatus\": true\n              };\n              sort = {\n                \"availStartTime\": 1\n              }; // this._state.developer.log({ message: 'From Schedules Class searchResourcesByInterval QUERY', data: query });\n              // let responsesArray = await this._state.db.getDataFromIndexWithQueryObject(Schedules.SCHD_INDEX(), queryObj);\n              _context14.next = 6;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 6:\n              responsesArray = _context14.sent;\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context14.next = 14;\n                break;\n              }\n              _context14.next = 10;\n              return this._filterQueriedResources(responsesArray.body, startTime, endTime);\n            case 10:\n              filterResp = _context14.sent;\n              return _context14.abrupt(\"return\", filterResp);\n            case 14:\n              return _context14.abrupt(\"return\", []);\n            case 15:\n            case \"end\":\n              return _context14.stop();\n          }\n        }, _callee14, this);\n      }));\n      function searchResourcesByIntervalByTypeSubTypeResId(_x28, _x29, _x30, _x31, _x32) {\n        return _searchResourcesByIntervalByTypeSubTypeResId.apply(this, arguments);\n      }\n      return searchResourcesByIntervalByTypeSubTypeResId;\n    }()\n  }, {\n    key: \"searchResourcesByEventId\",\n    value: function () {\n      var _searchResourcesByEventId = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(eventId) {\n        var query, sort, responsesArray;\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) switch (_context15.prev = _context15.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, searchResourcesByEventId with',\n                data: eventId\n              });\n              if (!(!eventId || eventId === '')) {\n                _context15.next = 3;\n                break;\n              }\n              return _context15.abrupt(\"return\", []);\n            case 3:\n              query = {\n                \"eventId\": eventId\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByEventId QUERY',\n                data: query\n              });\n\n              // let responsesArray = await this._state.db.getDataFromIndexWithQueryObject(Schedules.SCHD_INDEX(), queryObj);\n              _context15.next = 8;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_DETAIL_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 8:\n              responsesArray = _context15.sent;\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByEventId RESP',\n                data: responsesArray\n              });\n              // if (responsesArray && responsesArray.length > 0)\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context15.next = 14;\n                break;\n              }\n              return _context15.abrupt(\"return\", responsesArray.body);\n            case 14:\n              return _context15.abrupt(\"return\", []);\n            case 15:\n            case \"end\":\n              return _context15.stop();\n          }\n        }, _callee15, this);\n      }));\n      function searchResourcesByEventId(_x33) {\n        return _searchResourcesByEventId.apply(this, arguments);\n      }\n      return searchResourcesByEventId;\n    }()\n  }, {\n    key: \"searchResourcesByIds\",\n    value: function () {\n      var _searchResourcesByIds = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16(idArrayIn) {\n        var idArray, query, sort, responsesArray;\n        return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n          while (1) switch (_context16.prev = _context16.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, searchResourcesByIds with',\n                data: idArrayIn\n              });\n              if (idArrayIn) {\n                _context16.next = 3;\n                break;\n              }\n              return _context16.abrupt(\"return\", []);\n            case 3:\n              if (Array.isArray(idArrayIn)) {\n                idArray = idArrayIn;\n              } else {\n                idArray = [idArrayIn];\n              }\n              if (!(idArray.length < 1)) {\n                _context16.next = 6;\n                break;\n              }\n              return _context16.abrupt(\"return\", []);\n            case 6:\n              query = {\n                \"resourceId\": {\n                  \"$in\": idArrayIn\n                },\n                \"availableStatus\": true\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByInterval QUERY',\n                data: query\n              });\n\n              // let responsesArray = await this._state.db.getDataFromIndexWithQueryObject(Schedules.SCHD_INDEX(), queryObj);\n              _context16.next = 11;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_MASTER_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 11:\n              responsesArray = _context16.sent;\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByIds RESP',\n                data: responsesArray\n              });\n              // if (responsesArray && responsesArray.length > 0)\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context16.next = 17;\n                break;\n              }\n              return _context16.abrupt(\"return\", responsesArray.body);\n            case 17:\n              return _context16.abrupt(\"return\", []);\n            case 18:\n            case \"end\":\n              return _context16.stop();\n          }\n        }, _callee16, this);\n      }));\n      function searchResourcesByIds(_x34) {\n        return _searchResourcesByIds.apply(this, arguments);\n      }\n      return searchResourcesByIds;\n    }()\n  }, {\n    key: \"searchResourcesByResIdEventId\",\n    value: function () {\n      var _searchResourcesByResIdEventId = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17(eventId, resId) {\n        var query, sort, responsesArray;\n        return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n          while (1) switch (_context17.prev = _context17.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, searchResourcesByResIdEventId with',\n                data: {\n                  eventId: eventId,\n                  resId: resId\n                }\n              });\n              if (!(!eventId || eventId === '' || !resId || resId === '')) {\n                _context17.next = 3;\n                break;\n              }\n              return _context17.abrupt(\"return\", []);\n            case 3:\n              query = {\n                \"origId\": resId,\n                \"eventId\": eventId\n              };\n              sort = {\n                \"availStartTime\": 1\n              };\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByResIdEventId QUERY',\n                data: query\n              });\n\n              // let responsesArray = await this._state.db.getDataFromIndexWithQueryObject(Schedules.SCHD_INDEX(), queryObj);\n              _context17.next = 8;\n              return this._state.db.getDataFromCollection({\n                collection: Schedules.SCHD_DETAIL_DB(),\n                action: 'query',\n                query: query,\n                projection: {},\n                sort: sort,\n                skip: 0,\n                limit: 999,\n                collation: {},\n                expectOneResult: false,\n                cache: false\n              });\n            case 8:\n              responsesArray = _context17.sent;\n              this._state.developer.log({\n                message: 'From Schedules Class searchResourcesByResIdEventId RESP',\n                data: responsesArray\n              });\n              // if (responsesArray && responsesArray.length > 0)\n              //     return responsesArray;\n              if (!(responsesArray.statusCode === 200 && responsesArray.body && Array.isArray(responsesArray.body) && responsesArray.body.length > 0)) {\n                _context17.next = 14;\n                break;\n              }\n              return _context17.abrupt(\"return\", responsesArray.body);\n            case 14:\n              return _context17.abrupt(\"return\", []);\n            case 15:\n            case \"end\":\n              return _context17.stop();\n          }\n        }, _callee17, this);\n      }));\n      function searchResourcesByResIdEventId(_x35, _x36) {\n        return _searchResourcesByResIdEventId.apply(this, arguments);\n      }\n      return searchResourcesByResIdEventId;\n    }()\n  }, {\n    key: \"getAvailableTimeSlots\",\n    value: function () {\n      var _getAvailableTimeSlots = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18(resourceId, slotTime, startEpoch, endEpoch, scheduleIdArr) {\n        var state, _, takenSlots, timeSlots, _loop;\n        return _regeneratorRuntime().wrap(function _callee18$(_context19) {\n          while (1) switch (_context19.prev = _context19.next) {\n            case 0:\n              state = this._state;\n              _ = state._;\n              if (!(!resourceId || !slotTime || !startEpoch || !endEpoch)) {\n                _context19.next = 4;\n                break;\n              }\n              return _context19.abrupt(\"return\", []);\n            case 4:\n              _context19.next = 6;\n              return state.db.getDataFromCollection({\n                collection: Schedules.SCHD_DETAIL_DB(),\n                query: {\n                  origId: resourceId,\n                  bookedStartTime: {\n                    $gte: startEpoch\n                  },\n                  bookedEndTime: {\n                    $lte: endEpoch\n                  }\n                },\n                projection: {\n                  projection: {\n                    bookedStartTime: 1,\n                    bookedEndTime: 1\n                  }\n                }\n              });\n            case 6:\n              takenSlots = _context19.sent;\n              takenSlots = _.get(takenSlots, 'body', []);\n              timeSlots = [];\n              _loop = /*#__PURE__*/_regeneratorRuntime().mark(function _loop() {\n                var taken, endTime;\n                return _regeneratorRuntime().wrap(function _loop$(_context18) {\n                  while (1) switch (_context18.prev = _context18.next) {\n                    case 0:\n                      taken = false;\n                      endTime = startEpoch + slotTime;\n                      _.forEach(takenSlots, function (e) {\n                        // start time between a booked slot\n                        var cantStart = e.bookedStartTime <= startEpoch && e.bookedEndTime > startEpoch;\n                        // end time between a booked slot\n                        var cantEnd = e.bookedStartTime < endTime && e.bookedEndTime > endTime;\n                        // booked slot is included in new slot\n                        var cantIncludes = startEpoch < e.bookedStartTime && endTime >= e.bookedEndTime;\n                        if (cantStart || cantEnd || cantIncludes) {\n                          taken = true;\n                          return;\n                        }\n                      });\n                      if (!taken) {\n                        timeSlots.push({\n                          start: startEpoch,\n                          end: startEpoch + slotTime\n                        });\n                      }\n                      startEpoch += slotTime;\n                    case 5:\n                    case \"end\":\n                      return _context18.stop();\n                  }\n                }, _loop);\n              });\n            case 10:\n              if (!(endEpoch - startEpoch >= slotTime)) {\n                _context19.next = 14;\n                break;\n              }\n              return _context19.delegateYield(_loop(), \"t0\", 12);\n            case 12:\n              _context19.next = 10;\n              break;\n            case 14:\n              return _context19.abrupt(\"return\", timeSlots);\n            case 15:\n            case \"end\":\n              return _context19.stop();\n          }\n        }, _callee18, this);\n      }));\n      function getAvailableTimeSlots(_x37, _x38, _x39, _x40, _x41) {\n        return _getAvailableTimeSlots.apply(this, arguments);\n      }\n      return getAvailableTimeSlots;\n    }()\n  }, {\n    key: \"blockResource\",\n    value: function () {\n      var _blockResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19(resIdArrayIn, startTime, endTime, eventId) {\n        var resIdArray, resultsArray, i, currentID, resp, gotConflict, newBooking, writeResp;\n        return _regeneratorRuntime().wrap(function _callee19$(_context20) {\n          while (1) switch (_context20.prev = _context20.next) {\n            case 0:\n              if (Array.isArray(resIdArrayIn)) {\n                resIdArray = resIdArrayIn;\n              } else {\n                resIdArray = [resIdArrayIn];\n              }\n              resIdArray = _toConsumableArray(new Set(resIdArray)); // get unique entries\n              if (!(startTime >= endTime || resIdArray.length < 1)) {\n                _context20.next = 4;\n                break;\n              }\n              return _context20.abrupt(\"return\", false);\n            case 4:\n              resultsArray = [];\n              i = 0;\n            case 6:\n              if (!(i < resIdArray.length)) {\n                _context20.next = 28;\n                break;\n              }\n              currentID = resIdArray[i];\n              resp = {}; // check once again for conflict before booking\n              _context20.next = 11;\n              return this._checkConflictingBookings(currentID, startTime, endTime);\n            case 11:\n              gotConflict = _context20.sent;\n              if (!gotConflict) {\n                _context20.next = 16;\n                break;\n              }\n              resp[currentID] = undefined;\n              resultsArray.push(resp);\n              return _context20.abrupt(\"continue\", 25);\n            case 16:\n              newBooking = {};\n              newBooking._id = this._state.getUniqueId(); // this will be returned\n              newBooking.origId = currentID;\n              newBooking.bookedStartTime = startTime, newBooking.bookedEndTime = endTime, newBooking.eventId = eventId;\n              // this._state.developer.log({ message: 'From Schedules Class new bookings object result', data: newBooking });\n              _context20.next = 22;\n              return this._state.db.insertDocumentInCollection({\n                collection: Schedules.SCHD_DETAIL_DB(),\n                document: newBooking,\n                audit: false,\n                sync: false\n              });\n            case 22:\n              writeResp = _context20.sent;\n              // this._state.developer.log({ message: 'From Schedules Class new writeResp result', data: writeResp });\n              if (writeResp.statusCode === 200 && writeResp.body === 'success') {\n                // this._state.developer.log({ message: 'From Schedules Class blockResource success', data: writeResp });\n                resp[currentID] = newBooking._id;\n              } else {\n                // this._state.developer.log({ message: 'From Schedules Class blockResource ERROR', data: writeResp });\n                resp[currentID] = undefined;\n              }\n              resultsArray.push(resp);\n            case 25:\n              i++;\n              _context20.next = 6;\n              break;\n            case 28:\n              return _context20.abrupt(\"return\", resultsArray);\n            case 29:\n            case \"end\":\n              return _context20.stop();\n          }\n        }, _callee19, this);\n      }));\n      function blockResource(_x42, _x43, _x44, _x45) {\n        return _blockResource.apply(this, arguments);\n      }\n      return blockResource;\n    }()\n  }, {\n    key: \"_internalUnblocker\",\n    value: function () {\n      var _internalUnblocker2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20(resId) {\n        var query, delResp;\n        return _regeneratorRuntime().wrap(function _callee20$(_context21) {\n          while (1) switch (_context21.prev = _context21.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, _internalUnblocker with',\n                data: resId\n              });\n              query = {\n                _id: resId\n              };\n              _context21.next = 4;\n              return this._state.db.deleteDataFromCollection({\n                collection: Schedules.SCHD_DETAIL_DB(),\n                query: query,\n                audit: false,\n                sync: false\n              });\n            case 4:\n              delResp = _context21.sent;\n              if (!(delResp.statusCode === 200 && delResp.body === 'success')) {\n                _context21.next = 10;\n                break;\n              }\n              this._state.developer.log({\n                message: 'From Schedules Class _internalUnblocker success',\n                data: delResp\n              });\n              return _context21.abrupt(\"return\", {\n                'result': 'success',\n                'msg': 'Resource released'\n              });\n            case 10:\n              this._state.developer.log({\n                message: 'From Schedules Class _internalUnblocker ERROR',\n                data: delResp\n              });\n              return _context21.abrupt(\"return\", {\n                'result': 'error',\n                'msg': 'Resource was not released'\n              });\n            case 12:\n            case \"end\":\n              return _context21.stop();\n          }\n        }, _callee20, this);\n      }));\n      function _internalUnblocker(_x46) {\n        return _internalUnblocker2.apply(this, arguments);\n      }\n      return _internalUnblocker;\n    }()\n  }, {\n    key: \"unBlockResource\",\n    value: function () {\n      var _unBlockResource = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee21(resIdArrayIn) {\n        var resultsArray, resIdArray, i, currentID, resp;\n        return _regeneratorRuntime().wrap(function _callee21$(_context22) {\n          while (1) switch (_context22.prev = _context22.next) {\n            case 0:\n              this._state.developer.log({\n                message: 'From Schedules, unBlockResource with',\n                data: {\n                  resIdArrayIn: resIdArrayIn\n                }\n              });\n              resultsArray = [];\n              if (Array.isArray(resIdArrayIn)) {\n                resIdArray = resIdArrayIn;\n              } else {\n                resIdArray = [resIdArrayIn];\n              }\n              resIdArray = _toConsumableArray(new Set(resIdArray)); // get unique entries\n              if (!(resIdArray.length < 1)) {\n                _context22.next = 6;\n                break;\n              }\n              return _context22.abrupt(\"return\", false);\n            case 6:\n              i = 0;\n            case 7:\n              if (!(i < resIdArray.length)) {\n                _context22.next = 17;\n                break;\n              }\n              currentID = resIdArray[i];\n              resp = {}; // resp[currentID] = await this._deleteAndStitch(currentID);\n              _context22.next = 12;\n              return this._internalUnblocker(currentID);\n            case 12:\n              resp[currentID] = _context22.sent;\n              resultsArray.push(resp);\n            case 14:\n              i++;\n              _context22.next = 7;\n              break;\n            case 17:\n              this._state.developer.log({\n                message: 'From Schedules, unBlockResource final',\n                data: resultsArray\n              });\n              return _context22.abrupt(\"return\", resultsArray);\n            case 19:\n            case \"end\":\n              return _context22.stop();\n          }\n        }, _callee21, this);\n      }));\n      function unBlockResource(_x47) {\n        return _unBlockResource.apply(this, arguments);\n      }\n      return unBlockResource;\n    }()\n  }], [{\n    key: \"SCHD_INDEX\",\n    value: function SCHD_INDEX() {\n      return 'scheduler';\n    }\n  }, {\n    key: \"SCHD_MASTER_DB\",\n    value: function SCHD_MASTER_DB() {\n      return 'schedulerMaster';\n    }\n  }, {\n    key: \"SCHD_DETAIL_DB\",\n    value: function SCHD_DETAIL_DB() {\n      return 'schedulerDetail';\n    }\n  }]);\n  return Schedules;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Schedules.js?");

/***/ }),

/***/ "../../frontmjs/core/Section.js":
/*!**************************************!*\
  !*** ../../frontmjs/core/Section.js ***!
  \**************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Section: function() { return /* binding */ Section; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar Section = /*#__PURE__*/function (_Intent) {\n  _inherits(Section, _Intent);\n  var _super = _createSuper(Section);\n  function Section(intentId, _ref) {\n    var _this;\n    var state = _ref.state,\n      label = _ref.label,\n      _ref$collapsable = _ref.collapsable,\n      collapsable = _ref$collapsable === void 0 ? false : _ref$collapsable,\n      _ref$defaultCollapsab = _ref.defaultCollapsableState,\n      defaultCollapsableState = _ref$defaultCollapsab === void 0 ? false : _ref$defaultCollapsab,\n      columns = _ref.columns,\n      doc = _ref.doc,\n      _ref$hidden = _ref.hidden,\n      hidden = _ref$hidden === void 0 ? false : _ref$hidden,\n      _ref$forCollection = _ref.forCollection,\n      forCollection = _ref$forCollection === void 0 ? false : _ref$forCollection;\n    _classCallCheck(this, Section);\n    _this = _super.call(this, intentId, state);\n    _this.state = state;\n    _this.label = label;\n    _this.collapsable = collapsable;\n    _this.defaultCollapsableState = defaultCollapsableState;\n    _this.columns = columns;\n    _this.doc = doc;\n    _this.hidden = hidden;\n    _this.forCollection = forCollection;\n    _this.doc.addSection(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(Section, [{\n    key: \"sectionId\",\n    get: function get() {\n      return this.intentId;\n    }\n  }, {\n    key: \"addCollection\",\n    value: function addCollection(collection) {\n      this.doc.addCollectionToSection(collection, this);\n    }\n  }, {\n    key: \"message\",\n    value: function message() {\n      return {\n        label: this.label,\n        collapsable: this.collapsable,\n        hidden: this._hidden,\n        defaultCollapsableState: this.defaultCollapsableState,\n        columns: this.columns,\n        forCollection: this.forCollection,\n        sectionId: this.sectionId\n      };\n    }\n  }, {\n    key: \"hidden\",\n    get: function get() {\n      return this._hidden;\n    },\n    set: function set(hidden) {\n      this._hidden = hidden;\n      this.doc.addSection(this);\n    }\n  }]);\n  return Section;\n}(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Section.js?");

/***/ }),

/***/ "../../frontmjs/core/Security.js":
/*!***************************************!*\
  !*** ../../frontmjs/core/Security.js ***!
  \***************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Security: function() { return /* binding */ Security; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Security = /*#__PURE__*/function () {\n  function Security(state) {\n    _classCallCheck(this, Security);\n    this._state = state;\n    this._ = state._;\n    this._frontmlib = state.frontmlib;\n  }\n  _createClass(Security, [{\n    key: \"createNewVerificationCode\",\n    value: function () {\n      var _createNewVerificationCode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(role, customAction, numberOfLicenses, autoInstallBotIds) {\n        var addCurrentConversationBot,\n          allowAnonValidation,\n          verificationCode,\n          newCode,\n          _args = arguments;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              addCurrentConversationBot = _args.length > 4 && _args[4] !== undefined ? _args[4] : true;\n              allowAnonValidation = _args.length > 5 && _args[5] !== undefined ? _args[5] : false;\n              verificationCode = this._state.UUID().substr(0, 10);\n              if (this._.isUndefined(autoInstallBotIds)) {\n                autoInstallBotIds = [];\n              }\n              if (!Array.isArray(autoInstallBotIds)) {\n                autoInstallBotIds = [autoInstallBotIds];\n              }\n              if (addCurrentConversationBot) autoInstallBotIds.push(this._state.conversation.bot);\n              newCode = {\n                codeUsage: {\n                  existing: 0\n                },\n                domain: this._state.conversation.userDomain,\n                role: role,\n                verificationCode: verificationCode,\n                customAction: customAction,\n                botsToInstall: autoInstallBotIds,\n                allowAnonValidation: allowAnonValidation\n              };\n              if (numberOfLicenses > 0) {\n                newCode.codeUsage.maximum = numberOfLicenses;\n              }\n              //console.log('New verification code being created', newCode);\n              _context.prev = 8;\n              _context.next = 11;\n              return this._frontmlib.dbPutItem('DomainVerification', newCode);\n            case 11:\n              return _context.abrupt(\"return\", verificationCode);\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](8);\n              return _context.abrupt(\"return\", null);\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[8, 14]]);\n      }));\n      function createNewVerificationCode(_x, _x2, _x3, _x4) {\n        return _createNewVerificationCode.apply(this, arguments);\n      }\n      return createNewVerificationCode;\n    }()\n  }, {\n    key: \"getVerificationCode\",\n    value: function () {\n      var _getVerificationCode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(role) {\n        var verificationCodeRow;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return this._frontmlib.dbGetWithIndex('DomainVerification', 'domain-role-index', '#domain = :domain AND #role = :role', {\n                ':domain': this._state.conversation.userDomain,\n                ':role': role\n              }, null, {\n                '#domain': 'domain',\n                '#role': 'role'\n              });\n            case 3:\n              verificationCodeRow = _context2.sent;\n              return _context2.abrupt(\"return\", verificationCodeRow.Items[0].verificationCode);\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              return _context2.abrupt(\"return\", null);\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[0, 7]]);\n      }));\n      function getVerificationCode(_x5) {\n        return _getVerificationCode.apply(this, arguments);\n      }\n      return getVerificationCode;\n    }()\n  }, {\n    key: \"encryptData\",\n    value: function () {\n      var _encryptData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(data) {\n        var key;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return this._state.cc.getConfigurationForKey('encryptionKey');\n            case 3:\n              key = _context3.sent;\n              return _context3.abrupt(\"return\", this._frontmlib.encryptData(key, data));\n            case 7:\n              _context3.prev = 7;\n              _context3.t0 = _context3[\"catch\"](0);\n              this._state.addSystemErrorToStack(31, _context3.t0.message);\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[0, 7]]);\n      }));\n      function encryptData(_x6) {\n        return _encryptData.apply(this, arguments);\n      }\n      return encryptData;\n    }()\n  }, {\n    key: \"decryptData\",\n    value: function () {\n      var _decryptData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(data) {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              return _context4.abrupt(\"return\", this._frontmlib.decryptData(data));\n            case 4:\n              _context4.prev = 4;\n              _context4.t0 = _context4[\"catch\"](0);\n              this._state.addSystemErrorToStack(32, _context4.t0.message);\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[0, 4]]);\n      }));\n      function decryptData(_x7) {\n        return _decryptData.apply(this, arguments);\n      }\n      return decryptData;\n    }()\n  }]);\n  return Security;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Security.js?");

/***/ }),

/***/ "../../frontmjs/core/Sensors.js":
/*!**************************************!*\
  !*** ../../frontmjs/core/Sensors.js ***!
  \**************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Sensors: function() { return /* binding */ Sensors; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Sensors = /*#__PURE__*/function () {\n  function Sensors(state) {\n    _classCallCheck(this, Sensors);\n    this._state = state;\n    this._ = state._;\n    this.R = state.R;\n  }\n  _createClass(Sensors, [{\n    key: \"startMotionDetection\",\n    value: function startMotionDetection(frequency) {\n      this._state.context.getCapability('Accelerometer').startUpdates(this._state.context.botManifest.botId, this._state.conversationId, frequency);\n    }\n  }, {\n    key: \"stopMotionDetection\",\n    value: function stopMotionDetection() {\n      this._state.context.getCapability('Accelerometer').stopUpdates(this._state.context.botManifest.botId, this._state.conversationId);\n    }\n  }]);\n  return Sensors;\n}();\nvar TrackingServices = /*#__PURE__*/function () {\n  function TrackingServices(state) {\n    _classCallCheck(this, TrackingServices);\n    this._state = state;\n    this._ = state._;\n  }\n  _createClass(TrackingServices, [{\n    key: \"startTracking\",\n    value: function startTracking() {\n      return this._state.context.getCapability('LocationTracker').start_tracking({\n        botId: this._state.context.botManifest.botId,\n        conversationId: this._state.conversationId\n      });\n    }\n  }, {\n    key: \"stopTracking\",\n    value: function stopTracking() {\n      return this._state.context.getCapability('LocationTracker').stop_tracking({\n        botId: this._state.context.botManifest.botId,\n        conversationId: this._state.conversationId\n      });\n    }\n  }]);\n  return TrackingServices;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Sensors.js?");

/***/ }),

/***/ "../../frontmjs/core/Sites.js":
/*!************************************!*\
  !*** ../../frontmjs/core/Sites.js ***!
  \************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Sites: function() { return /* binding */ Sites; }\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Sites = /*#__PURE__*/function () {\n  function Sites(state) {\n    _classCallCheck(this, Sites);\n    this['_state'] = state;\n    this['context'] = state.context;\n    this['userId'] = state.user.userId;\n    this['conversation'] = state.conversation;\n    this['_'] = state._;\n  }\n  _createClass(Sites, [{\n    key: \"getBaseParams\",\n    value: function getBaseParams() {\n      return {\n        capability: 'SitesCapability',\n        capabilityFileName: 'sitesCapability',\n        sync: true,\n        userId: this.userId,\n        conversation: this.conversation\n      };\n    }\n  }, {\n    key: \"getSites\",\n    value: function getSites() {\n      var params = this.getBaseParams();\n      params.action = 'GetUserSites';\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"searchLocalSites\",\n    value: function searchLocalSites(searchTerm, type) {\n      var params = this.getBaseParams();\n      params.action = 'SearchSites';\n      params.searchTerm = searchTerm;\n      params.siteType = type;\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"searchGlobalSites\",\n    value: function searchGlobalSites(searchTerm, type) {\n      var searchFields = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ['IMO', 'MMSI'];\n      var params = this.getBaseParams();\n      params.action = 'SearchGlobalSites';\n      params.searchTerm = searchTerm;\n      params.siteType = type;\n      params.searchFields = searchFields;\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"deleteSite\",\n    value: function deleteSite(site) {\n      var params = this.getBaseParams();\n      params.action = 'DeleteSite';\n      params.siteId = site.siteId;\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"updateSite\",\n    value: function updateSite(site) {\n      var params = this.getBaseParams();\n      params.action = 'UpdateSite';\n      params.site = site;\n      return this._state.callCapability(params);\n    }\n  }, {\n    key: \"createSites\",\n    value: function createSites(sites, type) {\n      var params = this.getBaseParams();\n      params.action = 'CreateSites';\n      params.sites = sites;\n      params.siteType = type;\n      return this._state.callCapability(params);\n    }\n  }]);\n  return Sites;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Sites.js?");

/***/ }),

/***/ "../../frontmjs/core/State.js":
/*!************************************!*\
  !*** ../../frontmjs/core/State.js ***!
  \************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   D: function() { return /* binding */ D; },\n/* harmony export */   State: function() { return /* binding */ State; },\n/* harmony export */   _: function() { return /* binding */ _; },\n/* harmony export */   state: function() { return /* binding */ state; }\n/* harmony export */ });\n/* harmony import */ var _Developer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Developer */ \"../../frontmjs/core/Developer.js\");\n/* harmony import */ var _Accounts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Accounts */ \"../../frontmjs/core/Accounts.js\");\n/* harmony import */ var _Orders__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Orders */ \"../../frontmjs/core/Orders.js\");\n/* harmony import */ var _SFTP__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SFTP */ \"../../frontmjs/core/SFTP.js\");\n/* harmony import */ var _Notification__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Notification */ \"../../frontmjs/core/Notification.js\");\n/* harmony import */ var _Marketplace__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Marketplace */ \"../../frontmjs/core/Marketplace.js\");\n/* harmony import */ var _JobScheduler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./JobScheduler */ \"../../frontmjs/core/JobScheduler.js\");\n/* harmony import */ var _Contacts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Contacts */ \"../../frontmjs/core/Contacts.js\");\n/* harmony import */ var _API__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./API */ \"../../frontmjs/core/API.js\");\n/* harmony import */ var _DB__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./DB */ \"../../frontmjs/core/DB.js\");\n/* harmony import */ var _File__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./File */ \"../../frontmjs/core/File.js\");\n/* harmony import */ var _Sites__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Sites */ \"../../frontmjs/core/Sites.js\");\n/* harmony import */ var _Sensors__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Sensors */ \"../../frontmjs/core/Sensors.js\");\n/* harmony import */ var _LocationServices__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./LocationServices */ \"../../frontmjs/core/LocationServices.js\");\n/* harmony import */ var _Security__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Security */ \"../../frontmjs/core/Security.js\");\n/* harmony import */ var _NLP__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./NLP */ \"../../frontmjs/core/NLP.js\");\n/* harmony import */ var _ContactCentre__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./ContactCentre */ \"../../frontmjs/core/ContactCentre.js\");\n/* harmony import */ var _Companies__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Companies */ \"../../frontmjs/core/Companies.js\");\n/* harmony import */ var _Schedules__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Schedules */ \"../../frontmjs/core/Schedules.js\");\n/* harmony import */ var _DeviceStorage__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./DeviceStorage */ \"../../frontmjs/core/DeviceStorage.js\");\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _MessageTypes__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./MessageTypes */ \"../../frontmjs/core/MessageTypes.js\");\n/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./Error */ \"../../frontmjs/core/Error.js\");\n/* harmony import */ var _Collection__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./Collection */ \"../../frontmjs/core/Collection.js\");\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./Utils */ \"../../frontmjs/core/Utils.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// import {Surveys} from \"./Surveys\";\n\n\n\n\n\n\n\nvar State = /*#__PURE__*/function () {\n  function State() {\n    _classCallCheck(this, State);\n    this.initStateProperties();\n    this.user = {};\n    this.conversationId = \"\";\n    this.conversation = {};\n    this.lang = 'en';\n    this._conversational = true;\n    this._version = 4;\n    this._background = {\n      type: 0\n    };\n    this._sidebar = {\n      hidden: false,\n      frozen: false\n    };\n    this._navbar = {\n      hidden: false,\n      frozen: false\n    };\n    this.onlineRequired = false;\n    this._intents = {};\n    this['messageTypes'] = {};\n    this['logoutInProcess'] = false;\n    this['compatibilityMode'] = false;\n    this['waitingIcon'] = {};\n    this['_suggestionsLayout'] = 'horizontal';\n    this['chatButtonHidden'] = false;\n    this['_unitTestMode'] = false;\n    this['_cssFilePath'] = null;\n    this['_modal'] = false;\n    this.v1Compatibility = false;\n    this.appVersion = '';\n    this.autoResponse = false;\n    this.isRunning = false;\n    this._persistentState = true;\n    this._persistentOfflineData = true;\n    this._systemId = null;\n    if (!this.developer) this.developer = new _Developer__WEBPACK_IMPORTED_MODULE_0__.Developer(this);\n  }\n  _createClass(State, [{\n    key: \"initStateProperties\",\n    value: function initStateProperties() {\n      this['_activeIntent'] = '';\n      this['_intentHistory'] = [];\n      this['_intentStats'] = {};\n      this['error'] = false;\n      this['errorStack'] = [];\n      this['responsesArray'] = [];\n      this['smartSuggestionsArray'] = [];\n      this.client = \"\";\n      this['_blockSuggestions'] = false;\n      this['toCustomCap'] = false;\n      this['_silentIntent'] = false;\n      this['intentResolved'] = false;\n      this['waitingCustomCap'] = 0;\n      this['location'] = {};\n      this['requestIdsArray'] = [];\n      this['context'] = null;\n      this['_'] = null;\n      this['R'] = null;\n      this['Immutable'] = null;\n      this['moment'] = null;\n      this['momentTimezone'] = null;\n      this['lastGreetingTime'] = 0;\n      this['lastUserActivity'] = 0;\n      this['MessageCapability'] = null;\n      this['fields'] = {};\n      this['sessionFields'] = {};\n      this['fieldsChanged'] = {};\n      this['fieldsCleared'] = [];\n      this['_oldFields'] = {};\n      this['currentWorkspace'] = '';\n      this['botId'] = \"\";\n      this['botName'] = \"\";\n      this['botDescription'] = \"\";\n      this['lastSession'] = Date.now();\n      this['amIOnline'] = true;\n      this['sendMessageParam'] = null;\n      this['disambiguate'] = false;\n      this['disambiguationNLPId'] = '';\n      this['_nlpResults'] = {};\n      this['_lastNLPResults'] = {};\n      this['_inputHistory'] = [];\n      this['_currentControlId'] = null;\n      this['fromGreeting'] = false;\n      this['_inSilence'] = false;\n      this['_routesQueue'] = {};\n      this['_dynamicIntents'] = {};\n      this._autoSavePresent = false;\n      this._syncToEdge = {};\n      this._syncToCloud = {};\n      this.autoSaveBuffer = {};\n      this.autoSaveBufferChanges = {};\n      this.duringBuild = false;\n      this._delayedNotification = [];\n      this.apiResponse = false;\n      this.messageTypeFromUser = \"\";\n      this.messageFromUser = \"\";\n      this.stateInitialized = false;\n      this.initializationErrorMessages = [];\n      this.osVersion = \"\";\n      this.brand = \"\";\n      this.phoneModel = \"\";\n      this.platform = \"\";\n      this.timeSensitiveMode = false;\n      this.userAgent = \"\";\n      this.reportActivityOnMain = false;\n    }\n  }, {\n    key: \"init\",\n    value: function init(message, conversation, user, location, stateFromStorage, context, args) {\n      var _this$conversation,\n        _this$context,\n        _this$context2,\n        _this$context3,\n        _this = this;\n      this.initStateProperties();\n      this.ipDetails = conversation.ipDetails;\n      this.conversationId = conversation.conversationId;\n      this.conversation = conversation;\n      this.client = this.conversation.client;\n      this.responseToClient = this.client;\n      this.messageId = this.getUniqueId();\n      if (this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n        this.osVersion = conversation === null || conversation === void 0 ? void 0 : conversation.OSVersion;\n        this.brand = conversation === null || conversation === void 0 ? void 0 : conversation.brand;\n        this.phoneModel = conversation === null || conversation === void 0 ? void 0 : conversation.model;\n        this.platform = conversation === null || conversation === void 0 ? void 0 : conversation.platform;\n      } else {\n        this.userAgent = conversation === null || conversation === void 0 ? void 0 : conversation.userAgent;\n      }\n      this.user = user;\n      this['location'] = location;\n      this.developer.init(this);\n      this.setContext(context);\n      if (!this['notification']) {\n        this['notification'] = new _Notification__WEBPACK_IMPORTED_MODULE_4__.Notification(this);\n        this['accounts'] = new _Accounts__WEBPACK_IMPORTED_MODULE_1__.Accounts(this);\n        this['orders'] = new _Orders__WEBPACK_IMPORTED_MODULE_2__.Orders(this);\n        this['sftp'] = location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD ? new _SFTP__WEBPACK_IMPORTED_MODULE_3__.SFTP(this) : {};\n        this['marketplace'] = new _Marketplace__WEBPACK_IMPORTED_MODULE_5__.Marketplace(this);\n        this['jobScheduler'] = new _JobScheduler__WEBPACK_IMPORTED_MODULE_6__.JobScheduler(this);\n        this['contacts'] = new _Contacts__WEBPACK_IMPORTED_MODULE_7__.Contacts(this);\n        this['api'] = new _API__WEBPACK_IMPORTED_MODULE_8__.API(this);\n        this['db'] = new _DB__WEBPACK_IMPORTED_MODULE_9__.DB(this);\n        this['file'] = location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD ? new _File__WEBPACK_IMPORTED_MODULE_10__.File(this) : {};\n        this['sites'] = new _Sites__WEBPACK_IMPORTED_MODULE_11__.Sites(this);\n        this['sensors'] = new _Sensors__WEBPACK_IMPORTED_MODULE_12__.Sensors(this);\n        this['locationServices'] = new _LocationServices__WEBPACK_IMPORTED_MODULE_13__.LocationServices(this);\n        this['security'] = new _Security__WEBPACK_IMPORTED_MODULE_14__.Security(this);\n        this['nlp'] = new _NLP__WEBPACK_IMPORTED_MODULE_15__.NLP(this);\n        this['cc'] = new _ContactCentre__WEBPACK_IMPORTED_MODULE_16__.ContactCentre(this);\n        this['companies'] = new _Companies__WEBPACK_IMPORTED_MODULE_17__.Companies(this);\n        this['schedules'] = new _Schedules__WEBPACK_IMPORTED_MODULE_18__.Schedules(this);\n        // this['surveys'] = new Surveys(this);\n      }\n\n      this.backendResponseType = 0; //1 -> State, 2 -> Sync, 0 -> Process as normal\n      // this['botId'] = this.conversation.bot || this._.get(this.context, 'botManifest.botId');\n      this.botId = ((_this$conversation = this.conversation) === null || _this$conversation === void 0 ? void 0 : _this$conversation.bot) || ((_this$context = this.context) === null || _this$context === void 0 || (_this$context = _this$context.botManifest) === null || _this$context === void 0 ? void 0 : _this$context.botId);\n      this.botName = (_this$context2 = this.context) === null || _this$context2 === void 0 || (_this$context2 = _this$context2.botManifest) === null || _this$context2 === void 0 ? void 0 : _this$context2.botName;\n      this.botDescription = (_this$context3 = this.context) === null || _this$context3 === void 0 || (_this$context3 = _this$context3.botManifest) === null || _this$context3 === void 0 ? void 0 : _this$context3.description;\n      if ((this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT || this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.EDGE_WEBCLIENT) && this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE) {\n        this['deviceStorage'] = new _DeviceStorage__WEBPACK_IMPORTED_MODULE_19__.DeviceStorage(this);\n      }\n      if (stateFromStorage) {\n        for (var propertyName in stateFromStorage) {\n          this[propertyName] = stateFromStorage[propertyName];\n        }\n      }\n      if (message) {\n        if (message.messageType) {\n          this['messageTypeFromUser'] = message.messageType;\n          this['messageFromUser'] = message.messageFromUser || '';\n        } else {\n          this['messageTypeFromUser'] = message.getMessageType();\n          this['messageFromUser'] = message.getMessage() || {};\n          if (this.messageTypeFromUser === this.messageTypes.MESSAGE_TYPE_STRING) {\n            var getMessageContentType = function getMessageContentType(message) {\n              var MessageTypeConstantsToInt = _this.context.getCapability('MessageTypeConstantsToInt');\n              return MessageTypeConstantsToInt[message.getMessageType()] || 0;\n            };\n            this['messageTypeIntFromUser'] = getMessageContentType(message);\n            this['messageCreatedOnFromUser'] = message.getMessageDate().valueOf();\n            this['messageCreatedByFromUser'] = message.getCreatedBy();\n            var msgContent = message.getMessage();\n            var temp = JSON.stringify(msgContent);\n            temp = temp.replace(/\\\"\\\"/g, '\" \"');\n            msgContent = JSON.parse(temp);\n            this['messageContentFromUser'] = Array.isArray(msgContent) ? msgContent : [msgContent];\n            this['messageOptionsFromUser'] = message.getMessageOptions();\n          }\n        }\n        this._inputHistory.push({\n          type: JSON.stringify(this.messageTypeFromUser),\n          content: JSON.stringify(this.messageFromUser)\n        });\n        this._oldFields = this.fields;\n        if (this._inputHistory.length > 5) {\n          this._inputHistory.splice(0, 1);\n        }\n      }\n      this.autoResponse = this.messageTypeFromUser === State.SOCKET_RECONNECTION_EVENT();\n      if (this.messageFromUser && !this.messageFromUser.intentId) {\n        this.lastUserActivity = Date.now();\n      }\n      this.currentTabId = this._.get(this.messageFromUser, 'tabId');\n      if (this.onStart === undefined) {\n        this.onStart = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n      }\n      this.defaultOnError = function () {\n        if (_this.developer.runProfile !== _Developer__WEBPACK_IMPORTED_MODULE_0__.Developer.PROD()) {\n          _this._.forEach(_this.errorStack, function (error) {\n            if (error.errorCode === 40) {\n              _this.addCriticalNotificationResponse(error.errorMessage);\n            } else {\n              _this.addStringResponse(error.errorMessage);\n            }\n          });\n        } else {\n          _this.addStringResponse('Requested information is currently unavailable. Please check back later');\n        }\n      };\n      this.stateInitialized = true;\n      this.resetOnErrorMethod();\n    }\n  }, {\n    key: \"runAllOnInits\",\n    value: function runAllOnInits() {\n      this.developer.info({\n        message: \"Running onInits events\"\n      });\n      this.initializationErrorMessages.forEach(function (message) {\n        D.warning({\n          message: message\n        });\n      });\n      var allClosures = [];\n      Object.values(this._intents).forEach(function (intent) {\n        intent.resetProperties();\n        allClosures.push(intent.onInit(intent));\n      });\n      return Promise.all(allClosures);\n    }\n  }, {\n    key: \"version\",\n    set: function set(version) {\n      this._version = version;\n    }\n  }, {\n    key: \"callCapability\",\n    value: function callCapability(params) {\n      try {\n        var capabilities = this.context.capabilities.capabilities;\n        var capabilityDependencies = this.context.capabilities;\n        if (!capabilities) {\n          capabilities = this.context.capabilities;\n          capabilityDependencies = this.context;\n        }\n        var capFileName = params.capabilityFileName;\n        var capabilityModule = capabilities[capFileName];\n        if (capabilityModule) {\n          return capabilityModule.execute(params, capabilityDependencies);\n        }\n      } catch (err) {\n        this.addSystemErrorToStack(26, '4 ' + err.name + ': ' + err.message);\n      }\n    }\n  }, {\n    key: \"callLambda\",\n    value: function () {\n      var _callLambda = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(functionName, params) {\n        var invocationType,\n          _args2 = arguments;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              invocationType = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : 'RequestResponse';\n              if (!(this.location !== _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD)) {\n                _context2.next = 5;\n                break;\n              }\n              this.developer.warning({\n                message: \"\".concat(functionName, \" cannot be called from \").concat(this.location)\n              });\n              this.addSystemErrorToStack(26, '');\n              return _context2.abrupt(\"return\");\n            case 5:\n              return _context2.abrupt(\"return\", this.frontmlib.invokeLambda(functionName, invocationType, params));\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function callLambda(_x, _x2) {\n        return _callLambda.apply(this, arguments);\n      }\n      return callLambda;\n    }()\n  }, {\n    key: \"resetOnErrorMethod\",\n    value: function resetOnErrorMethod() {\n      this.clearError();\n      this._onError = this.defaultOnError;\n    }\n  }, {\n    key: \"lastMainTimeStamp\",\n    get: function get() {\n      return this.getField(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.COMMON_FIELDS.LAST_MAIN_TIMESTAMP);\n    }\n  }, {\n    key: \"onError\",\n    get: function get() {\n      return this._onError;\n    },\n    set: function set(onErrorBlock) {\n      this._onError = onErrorBlock;\n    }\n  }, {\n    key: \"silentIntent\",\n    get: function get() {\n      return this._silentIntent;\n    }\n  }, {\n    key: \"activeIntent\",\n    get: function get() {\n      return this._activeIntent;\n    }\n  }, {\n    key: \"getNlpResultsForId\",\n    value: function getNlpResultsForId(nlpId) {\n      if (this._nlpResults) {\n        if (this._nlpResults[nlpId]) {\n          return this._nlpResults[nlpId];\n        }\n      }\n      return {};\n    }\n  }, {\n    key: \"getMultipleStaticDataKeys\",\n    value: function () {\n      var _getMultipleStaticDataKeys = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(keys, system) {\n        var _this2 = this;\n        var KEY_VALUES, orQuery, query, data, response;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!(Array.isArray(keys) && keys.length === 1)) {\n                _context3.next = 4;\n                break;\n              }\n              return _context3.abrupt(\"return\", this.getStaticData(keys[0], system));\n            case 4:\n              if (Array.isArray(keys)) {\n                _context3.next = 7;\n                break;\n              }\n              this.developer.warning(_Error__WEBPACK_IMPORTED_MODULE_23__.Error.getErrorMessageforCodeAndLang(62));\n              return _context3.abrupt(\"return\");\n            case 7:\n              KEY_VALUES = '_keyValues';\n              orQuery = [];\n              keys.forEach(function (key) {\n                orQuery.push({\n                  key: key\n                });\n              });\n              query = {\n                \"$or\": orQuery\n              };\n              _context3.next = 13;\n              return this.db.getDataFromCollection({\n                collection: KEY_VALUES,\n                query: query,\n                cache: true,\n                system: system\n              });\n            case 13:\n              data = _context3.sent;\n              response = {};\n              if (data !== null && data !== void 0 && data.body && Array.isArray(data.body)) {\n                data.body.forEach(function (entry) {\n                  response[entry.key] = entry.value;\n                });\n              }\n              if (Object.keys(response).length === 0) {\n                this.developer.warning({\n                  message: \"Missing static data for all keys\"\n                });\n              } else {\n                keys.forEach(function (key) {\n                  if (!response[key]) {\n                    _this2.developer.warning({\n                      message: \"Missing static data for key \",\n                      data: key\n                    });\n                  }\n                });\n              }\n              return _context3.abrupt(\"return\", response);\n            case 18:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function getMultipleStaticDataKeys(_x3, _x4) {\n        return _getMultipleStaticDataKeys.apply(this, arguments);\n      }\n      return getMultipleStaticDataKeys;\n    }()\n  }, {\n    key: \"getStaticData\",\n    value: function () {\n      var _getStaticData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(key, system) {\n        var shared,\n          encryptedValue,\n          KEY_VALUES,\n          query,\n          data,\n          response,\n          _args4 = arguments;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              shared = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : false;\n              encryptedValue = _args4.length > 3 && _args4[3] !== undefined ? _args4[3] : false;\n              KEY_VALUES = '_keyValues';\n              if (shared) {\n                key = \"\".concat(key, \"_\").concat(this._systemId);\n              }\n              query = {\n                key: key\n              };\n              _context4.next = 7;\n              return this.db.getDataFromCollection({\n                collection: KEY_VALUES,\n                query: query,\n                cache: true,\n                system: system,\n                securedFields: encryptedValue ? ['value'] : null\n              });\n            case 7:\n              data = _context4.sent;\n              response = this._.get(data, 'body[0].value');\n              if (!response) {\n                this.developer.warning({\n                  message: \"Missing static data for key\",\n                  data: key\n                });\n              }\n              return _context4.abrupt(\"return\", response);\n            case 11:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function getStaticData(_x5, _x6) {\n        return _getStaticData.apply(this, arguments);\n      }\n      return getStaticData;\n    }()\n  }, {\n    key: \"getEncryptedStaticData\",\n    value: function () {\n      var _getEncryptedStaticData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(key, system) {\n        var shared,\n          _args5 = arguments;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              shared = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : false;\n              return _context5.abrupt(\"return\", this.getStaticData(key, system, shared, true));\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function getEncryptedStaticData(_x7, _x8) {\n        return _getEncryptedStaticData.apply(this, arguments);\n      }\n      return getEncryptedStaticData;\n    }()\n  }, {\n    key: \"getSystemStaticData\",\n    value: function () {\n      var _getSystemStaticData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(key) {\n        var shared,\n          _args6 = arguments;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              shared = _args6.length > 1 && _args6[1] !== undefined ? _args6[1] : false;\n              return _context6.abrupt(\"return\", this.getStaticData(key, true, shared));\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function getSystemStaticData(_x9) {\n        return _getSystemStaticData.apply(this, arguments);\n      }\n      return getSystemStaticData;\n    }()\n  }, {\n    key: \"saveStaticData\",\n    value: function () {\n      var _saveStaticData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(key, value) {\n        var KEY_VALUES, query, document;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              KEY_VALUES = '_keyValues';\n              query = {\n                key: key\n              };\n              document = {\n                value: value\n              };\n              _context7.next = 5;\n              return this.db.updateDataInCollection({\n                collection: KEY_VALUES,\n                document: document,\n                query: query,\n                cache: true\n              });\n            case 5:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function saveStaticData(_x10, _x11) {\n        return _saveStaticData.apply(this, arguments);\n      }\n      return saveStaticData;\n    }()\n  }, {\n    key: \"recordActivity\",\n    value: function () {\n      var _recordActivity = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(_ref2) {\n        var _ref2$onMatching, onMatching, stamp, _this$messageFromUser, _this$messageFromUser2, _this$messageFromUser3, _this$messageFromUser4, _this$messageFromUser5, _this$messageFromUser6, intentResolved, direction, messageFromUser, document, responseMetadataArray, query, options;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              _ref2$onMatching = _ref2.onMatching, onMatching = _ref2$onMatching === void 0 ? false : _ref2$onMatching, stamp = _ref2.stamp;\n              _context8.next = 3;\n              return this.developer.debug({\n                message: \"Logging activity\",\n                data: {\n                  activeIntent: this.activeIntent,\n                  toCustomCap: this.toCustomCap\n                }\n              });\n            case 3:\n              if (!(this.activeIntent !== '' && !this.toCustomCap)) {\n                _context8.next = 17;\n                break;\n              }\n              intentResolved = Object.keys(this.responsesArray).length > 0;\n              direction = intentResolved || onMatching ? 0 : 1; //0 = inbound message, 1 = outbound message\n              messageFromUser = {\n                controlId: (_this$messageFromUser = this.messageFromUser) === null || _this$messageFromUser === void 0 ? void 0 : _this$messageFromUser.controlId,\n                formId: (_this$messageFromUser2 = this.messageFromUser) === null || _this$messageFromUser2 === void 0 ? void 0 : _this$messageFromUser2.formId,\n                action: (_this$messageFromUser3 = this.messageFromUser) === null || _this$messageFromUser3 === void 0 ? void 0 : _this$messageFromUser3.action,\n                tableId: (_this$messageFromUser4 = this.messageFromUser) === null || _this$messageFromUser4 === void 0 ? void 0 : _this$messageFromUser4.tableId,\n                currentField: (_this$messageFromUser5 = this.messageFromUser) === null || _this$messageFromUser5 === void 0 ? void 0 : _this$messageFromUser5.currentField,\n                selectedEntry: (_this$messageFromUser6 = this.messageFromUser) === null || _this$messageFromUser6 === void 0 ? void 0 : _this$messageFromUser6.selectedEntry,\n                messageTypeFromUser: this.messageTypeFromUser\n              };\n              document = {\n                botId: this.botId,\n                userId: this.user.userId,\n                botName: this.botName,\n                userEmail: this.user.userEmail,\n                timestamp: Date.now(),\n                intent: this.activeIntent,\n                migrated: false,\n                messageId: this.messageId,\n                domain: this.currentUserDomain,\n                messageFromUserMetadata: messageFromUser,\n                location: this.location,\n                client: this.client,\n                appVersion: this.appVersion,\n                //Add here the platform and all\n                osVersion: this.osVersion,\n                brand: this.brand,\n                phoneModel: this.phoneModel,\n                platform: this.platform,\n                userAgent: this.userAgent,\n                direction: direction,\n                stamp: stamp\n                //Analyse to have an object that can be added to the activity. This object can be handled only in backend and by a general definition\n              };\n\n              if (intentResolved && !onMatching) {\n                responseMetadataArray = [];\n                this.responsesArray.forEach(function (response) {\n                  var _response$message, _response$message2;\n                  var responseMetadata = {\n                    type: response === null || response === void 0 ? void 0 : response.type,\n                    controlId: response === null || response === void 0 || (_response$message = response.message) === null || _response$message === void 0 || (_response$message = _response$message.options) === null || _response$message === void 0 ? void 0 : _response$message.controlId,\n                    action: response === null || response === void 0 || (_response$message2 = response.message) === null || _response$message2 === void 0 || (_response$message2 = _response$message2.options) === null || _response$message2 === void 0 ? void 0 : _response$message2.action\n                  };\n                  responseMetadataArray.push(responseMetadata);\n                });\n                document.responsesArray = responseMetadataArray;\n              }\n              query = {\n                messageId: document.messageId,\n                direction: direction\n              };\n              options = {\n                upsert: true // or 1\n              };\n              _context8.next = 13;\n              return this.developer.debug({\n                message: \"Storing activity\",\n                data: document\n              });\n            case 13:\n              _context8.next = 15;\n              return this.db.updateDataInCollection({\n                collection: _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.ACTIVITY_COLLECTION,\n                document: document,\n                query: query,\n                options: options,\n                audit: false,\n                cache: false,\n                system: true,\n                asyncCall: true\n              });\n            case 15:\n              _context8.next = 17;\n              return this.db.updateDataInCollection({\n                collection: _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.ACTIVITY_COLLECTION,\n                document: document,\n                query: query,\n                options: options,\n                audit: true,\n                cache: true,\n                asyncCall: true\n              });\n            case 17:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function recordActivity(_x12) {\n        return _recordActivity.apply(this, arguments);\n      }\n      return recordActivity;\n    }()\n  }, {\n    key: \"nlpResults\",\n    get: function get() {\n      return this._nlpResults;\n    },\n    set: function set(nlpResults) {\n      this._nlpResults = nlpResults;\n    }\n  }, {\n    key: \"previousActiveIntent\",\n    get: function get() {\n      var l = this._intentHistory.length;\n      var r = '';\n      if (l > 1) {\n        if (this._activeIntent === '') {\n          r = this._intentHistory[l - 1];\n        } else {\n          r = this._intentHistory[l - 2];\n        }\n      } else {\n        if (l === 1) {\n          if (this._activeIntent === '') {\n            r = this._intentHistory[0];\n          }\n        }\n      }\n      return r;\n    }\n  }, {\n    key: \"online\",\n    value: function online() {\n      if ((this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT || this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.EDGE_WEBCLIENT) && this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE && !this.v1Compatibility) {\n        try {\n          var _this$context$getCapa;\n          if (typeof ((_this$context$getCapa = this.context.getCapability('Network')) === null || _this$context$getCapa === void 0 ? void 0 : _this$context$getCapa.isOnline) === \"function\") {\n            return Promise.resolve(this.context.getCapability('Network').isOnline());\n          }\n          var network = this.context.getCapability('Network');\n          return network.isConnected().then(function (connected) {\n            return connected;\n          })[\"catch\"](function () {\n            return false;\n          });\n        } catch (error) {\n          console.log('Error checking for online status ' + error.message);\n        }\n      } else {\n        return Promise.resolve(true);\n      }\n    }\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(appType) {\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              this['logoutInProcess'] = true;\n              _context9.prev = 1;\n              _context9.next = 4;\n              return this.context.getCapability('authContext').logout(this.context);\n            case 4:\n              console.log(\"Logout executed\");\n              this.addResponse('silent', {});\n              _context9.next = 12;\n              break;\n            case 8:\n              _context9.prev = 8;\n              _context9.t0 = _context9[\"catch\"](1);\n              console.log(\"Error during logout\");\n              console.log(JSON.stringify(_context9.t0));\n            case 12:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this, [[1, 8]]);\n      }));\n      function logout(_x13) {\n        return _logout.apply(this, arguments);\n      }\n      return logout;\n    }()\n  }, {\n    key: \"runLocationVerification\",\n    value: function runLocationVerification(method, location) {\n      var locationPassed = location === this.location;\n      if (!locationPassed) {\n        this.addErrorToStack(1, 'Method ' + method + ' cannot run on the ' + this.location);\n      }\n      return locationPassed;\n    }\n  }, {\n    key: \"getUserRolesForDomain\",\n    value: function getUserRolesForDomain(domain) {\n      var _iterator = _createForOfIteratorHelper(this.userDomains),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var domainObject = _step.value;\n          if (domainObject.domain === domain) {\n            return domainObject.roles;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }, {\n    key: \"setContext\",\n    value: function setContext(context) {\n      var _this$context4, _this$context5;\n      this.context = context;\n      if (this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE) {\n        var _this$user$info, _this$user$info2, _this$user$info3, _this$user$info4;\n        this['userName'] = (_this$user$info = this.user.info) === null || _this$user$info === void 0 ? void 0 : _this$user$info.userName;\n        this.user.userName = (_this$user$info2 = this.user.info) === null || _this$user$info2 === void 0 ? void 0 : _this$user$info2.userName;\n        var utils = this.context.getCapability('Utils');\n        this._ = utils.Lodash;\n        this.R = this.context.getCapability('R') || {};\n        this.immutable = this.context.getCapability('Immutable') || {};\n        //this.UUID = utils.UUID;\n        this.messageTypes = this.context.getCapability('MessageTypeConstants');\n        this.MessageCapability = this.context.getCapability('Message');\n        this.userDomains = (_this$user$info3 = this.user.info) === null || _this$user$info3 === void 0 ? void 0 : _this$user$info3.domains;\n        this.moment = this.context.getCapability('Moment');\n        this.momentTimezone = this.context.getCapability('MomentTimezone');\n        if (this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT) {\n          this.aws = this.context.getCapability('aws');\n          this.frontmlib = this.context.getCapability('frontmlib');\n          var capabilities = this.context.capabilities.capabilities;\n          if (capabilities) {\n            this.sha1 = this.context.capabilities.sha1;\n          } else {\n            this.sha1 = this.context.sha1;\n          }\n        } else {\n          this.sha1 = this.context.getCapability('sha1');\n        }\n        this.currentWorkspace = (_this$user$info4 = this.user.info) === null || _this$user$info4 === void 0 ? void 0 : _this$user$info4.lastLoggedInDomain;\n      } else {\n        this._ = this.context._;\n        this.R = this.context.R || {};\n        this.immutable = this.context.immutable || {};\n        this.userDomains = this.user.userDomains;\n        this.moment = this.context.moment;\n        this.momentTimezone = this.context['momentTimeZone'];\n        this.aws = this.context['aws'];\n        this.frontmlib = this.context['frontmlib'];\n        this.sha1 = this.context['sha1'];\n        this.marked = this.context[\"marked\"];\n      }\n      this.user.roles = this.getUserRolesForDomain(this.currentUserDomain);\n      this.systemId = ((_this$context4 = this.context) === null || _this$context4 === void 0 || (_this$context4 = _this$context4.botManifest) === null || _this$context4 === void 0 ? void 0 : _this$context4.systemId) || null;\n      this.developer.runProfile = ((_this$context5 = this.context) === null || _this$context5 === void 0 || (_this$context5 = _this$context5.botManifest) === null || _this$context5 === void 0 ? void 0 : _this$context5.buildType) || _Developer__WEBPACK_IMPORTED_MODULE_0__.Developer.DEV();\n    }\n  }, {\n    key: \"syncWithBackendState\",\n    value: function syncWithBackendState(state) {\n      var _this3 = this;\n      var _ = this._;\n      if (this.messageTypeFromUser === _MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.BACKEND_RESPONSE()) {\n        //console.log(JSON.stringify(state));\n        if (state.intentResolved) {\n          this.intentResolved = state.intentResolved;\n        }\n        if (state.responsesArray) {\n          _.each(state.responsesArray, function (response) {\n            if (response.type === 'form2') {\n              var form = {};\n              form.options = response.message.options;\n              form.fields = response.message.fields;\n              _this3.addResponse('form2', form);\n            } else {\n              _this3.responsesArray.push(response);\n            }\n          });\n        }\n        if (state._activeIntent) {\n          this.addActiveIntent(state._activeIntent);\n        }\n        if (state._silentIntent) {\n          this._silentIntent = true;\n        }\n        if (state.nlpResponse) {\n          this.nlpResponse = state.nlpResponse;\n        }\n        if (state._nlpResults) {\n          this._nlpResults = state._nlpResults;\n          this._lastNLPResults = state._nlpResults;\n        }\n        if (state.errorStack) {\n          _.each(state.errorStack, function (error) {\n            _this3.addErrorToStack(error._errorCode, error._errorMessage);\n          });\n        }\n        if (state.smartSuggestionsArray) {\n          this.smartSuggestionsArray = state.smartSuggestionsArray;\n        }\n        if (_.size(state.fieldsChanged)) {\n          this.fields = this.R.merge(this.fields, state.fieldsChanged);\n        }\n        if (state.fieldsCleared && Array.isArray(state.fieldsCleared) && state.fieldsCleared.length > 0) {\n          _.forEach(state.fieldsCleared, function (field) {\n            delete _this3.fields[field];\n          });\n        }\n        //this.fields = state.fields;\n        if (state.sendMessageParam) {\n          this.sendMessageParam = state.sendMessageParam;\n        }\n        if (state._blockSuggestions) {\n          this.blockSuggestions = true;\n        }\n        if (Array.isArray(state.requestIdsArray)) {\n          this.requestIdsArray = this.requestIdsArray.concat(state.requestIdsArray);\n        }\n        if (state._intentDurations) {\n          this._intentDurations = state._intentDurations;\n        }\n        if (typeof state._conversational === 'boolean') {\n          this._conversational = state._conversational;\n        }\n        if (state._background) {\n          this._background = state._background;\n        }\n        if (state._sidebar) {\n          this._sidebar = state._sidebar;\n        }\n        if (state._navbar) {\n          this._navbar = state._navbar;\n        }\n        if (state.fromGreeting) {\n          this.fromGreeting = state.fromGreeting;\n        }\n        if (state._inSilence) {\n          this._inSilence = state._inSilence;\n        }\n        if (state.currentTabId) {\n          this.currentTabId = state.currentTabId;\n        }\n        if (_.size(state._dynamicIntents) > 0) {\n          this._dynamicIntents = state._dynamicIntents;\n        }\n        this._syncToEdge = state._syncToEdge;\n        this.autoSaveBufferChanges = state.autoSaveBufferChanges;\n        if (state.backendResponseType) {\n          this.backendResponseType = state.backendResponseType;\n        }\n        this.responseToClient = state.responseToClient;\n      }\n    }\n  }, {\n    key: \"getNewRequestId\",\n    value: function getNewRequestId() {\n      return this.getUniqueId;\n    }\n  }, {\n    key: \"getAllProperties\",\n    value: function getAllProperties() {\n      var _ = this._;\n      var response = {\n        conversationId: this['conversationId'],\n        toCustomCap: this['toCustomCap'],\n        intentResolved: this['intentResolved'],\n        waitingCustomCap: this['waitingCustomCap'],\n        lastGreetingTime: this['lastGreetingTime'],\n        lastUserActivity: this['lastUserActivity'],\n        _intentDurations: this['_intentDurations']\n      };\n      response.errorStack = this['errorStack'];\n      response.requestIdsArray = this['requestIdsArray'];\n      response.fields = this.fields;\n      response._silentIntent = this._silentIntent;\n      response._lastNLPResults = this._lastNLPResults;\n      response._background = this._background;\n      response._conversational = this._conversational;\n      response._sidebar = this._sidebar;\n      response._inputHistory = this._inputHistory;\n      response._routesQueue = this._routesQueue;\n      if (this.developer._debugMode) {\n        response._debugMode = true;\n      }\n      response._intentHistory = this._intentHistory;\n      response.fromGreeting = this.fromGreeting;\n      response._inSilence = this._inSilence;\n      if (_.size(this._dynamicIntents) > 0) {\n        response._dynamicIntents = this._dynamicIntents;\n      }\n      response._delayedNotification = _.clone(this._delayedNotification) || [];\n      response._syncToCloud = _.clone(this._syncToCloud);\n      response.autoSaveBufferChanges = this.autoSaveBufferChanges;\n      return response;\n    }\n  }, {\n    key: \"autoSaveBufferKey\",\n    get: function get() {\n      if (this.currentTabId) {\n        return \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.AUTO_SAVE_BUFFER_FIELD, \"_\").concat(this.currentTabId);\n      } else {\n        return _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.AUTO_SAVE_BUFFER_FIELD;\n      }\n    }\n  }, {\n    key: \"loadAutoSaveBuffer\",\n    value: function loadAutoSaveBuffer() {\n      var _this4 = this;\n      var _ = this._;\n      var D = this.developer;\n      return this.getPersistedField(this.autoSaveBufferKey).then(function (value) {\n        if (value) {\n          _.forEach(_.keys(value), function (key) {\n            _this4.autoSaveBuffer[key] = value[key];\n          });\n        }\n      });\n    }\n  }, {\n    key: \"storeAutoSaveBuffer\",\n    value: function storeAutoSaveBuffer() {\n      if (this.autoSaveBuffer) {\n        return this.setPersistedField(this.autoSaveBufferKey, this.autoSaveBuffer);\n      }\n    }\n  }, {\n    key: \"clearAutoSaveBuffer\",\n    value: function clearAutoSaveBuffer() {\n      this.autoSaveBuffer = {};\n    }\n  }, {\n    key: \"clearAutoSaveBufferChanges\",\n    value: function clearAutoSaveBufferChanges() {\n      this.autoSaveBufferChanges = {};\n    }\n  }, {\n    key: \"resetAutoSaveBuffer\",\n    value: function () {\n      var _resetAutoSaveBuffer = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return this.clearPersistedField(this.autoSaveBufferKey);\n            case 2:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function resetAutoSaveBuffer() {\n        return _resetAutoSaveBuffer.apply(this, arguments);\n      }\n      return resetAutoSaveBuffer;\n    }()\n  }, {\n    key: \"addObjectToSyncMessage\",\n    value: function addObjectToSyncMessage(collection, primaryKey, object) {\n      var key = this.sha1(primaryKey);\n      if (this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD) {\n        var doc = this._syncToEdge[collection] || {};\n        doc[key] = object;\n        this._syncToEdge[collection] = doc;\n      } else {\n        var _doc = this._syncToCloud[collection] || {};\n        _doc[key] = object;\n        this._syncToCloud[collection] = _doc;\n      }\n    }\n  }, {\n    key: \"addDelayedNotification\",\n    value: function addDelayedNotification(notificationParams) {\n      if (Array.isArray(this._delayedNotification)) {\n        this._delayedNotification.push(notificationParams);\n      } else {\n        this._delayedNotification = [notificationParams];\n      }\n    }\n  }, {\n    key: \"syncDataToDB\",\n    value: function syncDataToDB() {\n      var _this5 = this;\n      var _ = this._;\n      if (this.client !== _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT) {\n        var allPromises = [];\n        _.forEach(this._syncToCloud, function (document, collection) {\n          //D.log({message: 'Found document for', data: collection});\n          var collectionObject = _this5._intents[collection];\n          if (collectionObject || collection === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_STORAGE) {\n            _.forEach(document, function (record, key) {\n              if (collection === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_STORAGE) {\n                allPromises.push(_this5.db.setOneValueInCacheWithExpiry(key, record, 3600 * 24 * 7)[\"catch\"](function (error) {\n                  _this5.addSystemErrorToStack(42, '', error);\n                }));\n              } else {\n                var docArray = _.get(record, 'body');\n                _.forEach(docArray, function (doc) {\n                  var newDoc = collectionObject.document;\n                  if (newDoc.hasSubDocs) {\n                    newDoc.buildDocumentFromContainer(doc);\n                  } else {\n                    newDoc.buildDocument(doc);\n                  }\n                  allPromises.push(newDoc.save(true)[\"catch\"](function (error) {\n                    _this5.addSystemErrorToStack(42, '', error);\n                  }));\n                });\n              }\n            });\n          }\n        });\n        if (allPromises.length > 0) {\n          return Promise.all(allPromises).then(function () {\n            //D.log({message: 'All saved'});\n            _this5._syncToCloud = {};\n          })[\"catch\"](function (error) {\n            _this5.addSystemErrorToStack(42, '', error);\n          });\n        } else {\n          //D.log({message: 'Nothing to sync'});\n          return Promise.resolve();\n        }\n      }\n    }\n  }, {\n    key: \"sendDelayedNotifications\",\n    value: function sendDelayedNotifications() {\n      var _this6 = this;\n      if (this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD && !(this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT)) {\n        var promisesArray = [];\n        this._.forEach(this._delayedNotification, function (notification) {\n          //console.log('Notifications ' + JSON.stringify(notification));\n          if (notification.userDomain === 'aagehempel' || notification.userDomain === 'aagehempeltest') {\n            //console.log('AHG sendDelayedNotifications ' + JSON.stringify(notification));\n            _this6.developer.log({\n              message: 'AHG sendDelayedNotifications',\n              data: JSON.stringify(notification)\n            });\n          }\n          promisesArray.push(_this6.notification.sendDelayedNotification(notification));\n        });\n        this._delayedNotification = [];\n        if (promisesArray.length > 0) {\n          return Promise.all(promisesArray);\n        } else {\n          return Promise.resolve();\n        }\n      } else {\n        return Promise.resolve();\n      }\n    }\n  }, {\n    key: \"removeObjectFromSyncMessage\",\n    value: function removeObjectFromSyncMessage(collection, primaryKey) {\n      var key = this.sha1(primaryKey);\n      //let key = primaryKey;\n      if (this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD) {\n        delete this._syncToEdge[collection][key];\n      } else {\n        delete this._syncToCloud[collection][key];\n      }\n    }\n  }, {\n    key: \"runFunctionOnceAnHour\",\n    value: function runFunctionOnceAnHour(functionBlock) {\n      var _ = this._;\n      var latestTime = _.now();\n      if (_.toNumber(latestTime) - _.toNumber(this.lastGreetingTime) > 3600000) {\n        this.lastGreetingTime = latestTime;\n        return functionBlock();\n      }\n    }\n  }, {\n    key: \"runFunctionOnceADay\",\n    value: function runFunctionOnceADay(functionBlock) {\n      var _ = this._;\n      var latestTime = _.now();\n      if (_.toNumber(latestTime) - _.toNumber(this.lastGreetingTime) > 86400000) {\n        this.lastGreetingTime = latestTime;\n        return functionBlock();\n      }\n    }\n  }, {\n    key: \"getDeviceLocation\",\n    value: function getDeviceLocation() {\n      return this.context.getCapability('DeviceLocation').getDeviceLocation();\n    }\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage(message) {\n      ////console.log('============> setting send  message param');\n      this.developer.log({\n        message: 'User sending message with ' + JSON.stringify(message)\n      });\n      this.sendMessageParam = message;\n    }\n  }, {\n    key: \"continueInIntentWithIdAndMessage\",\n    value: function continueInIntentWithIdAndMessage(intentId, message) {\n      var object = {\n        intentId: intentId\n      };\n      this.sendMessage(_objectSpread(_objectSpread({}, object), message));\n    }\n  }, {\n    key: \"processIntentWithIdAndMessage\",\n    value: function processIntentWithIdAndMessage(intentId, message) {\n      this.continueInIntentWithIdAndMessage(intentId, message);\n    }\n  }, {\n    key: \"processIntentWithId\",\n    value: function processIntentWithId(intentId) {\n      var object = {\n        intentId: intentId\n      };\n      this.sendMessage(object);\n    }\n  }, {\n    key: \"cleanFieldsForSave\",\n    value: function cleanFieldsForSave(fields) {\n      var _this7 = this;\n      var _ = this._;\n      var cleanFields = {};\n      if (typeof fields === 'string') {\n        if (fields === '') {\n          fields = ' '; //Before it was null. Testing a space\n        }\n\n        return fields;\n      } else if (_typeof(fields) === 'object') {\n        if (Array.isArray(fields)) {\n          var newArray = [];\n          _.each(fields, function (entry) {\n            var newEntry = _this7.cleanFieldsForSave(entry);\n            newArray.push(newEntry);\n          });\n          return newArray;\n        } else {\n          for (var properyName in fields) {\n            var theField = fields[properyName];\n            switch (_typeof(theField)) {\n              case 'string':\n                {\n                  cleanFields[properyName] = this.cleanFieldsForSave(theField);\n                  break;\n                }\n              case 'object':\n                {\n                  cleanFields[properyName] = this.cleanFieldsForSave(theField);\n                  break;\n                }\n              default:\n                {\n                  cleanFields[properyName] = theField;\n                  break;\n                }\n            }\n          }\n        }\n      } else {\n        return fields;\n      }\n      return cleanFields;\n    }\n  }, {\n    key: \"save\",\n    value: function save(deviceStorageUtil) {\n      var _this8 = this;\n      if (this._persistentState) {\n        this.fields = this.cleanFieldsForSave(this.fields);\n        this._lastNLPResults = this.cleanFieldsForSave(this._lastNLPResults);\n        return deviceStorageUtil.setInContext(this.getAllProperties(), this.context).then(function () {\n          //console.log('State Saved');\n          _this8.developer.info({\n            message: 'State saved'\n          });\n          _this8.error = false;\n        })[\"catch\"](function (err) {\n          //console.log('State not Saved ' + err.message);\n          _this8.developer.info({\n            message: \"Error saving the state: \".concat(err.message)\n          });\n          _this8.error = true;\n        });\n      }\n    }\n  }, {\n    key: \"getUniqueId\",\n    value: function getUniqueId() {\n      try {\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (match) {\n          var randomNibble = Math.random() * 16 | 0;\n          var nibble = match === 'y' ? randomNibble & 0x3 | 0x8 : randomNibble;\n          return nibble.toString(16);\n        });\n      } catch (error) {\n        console.log(\"Error generating UUID\");\n        console.log(JSON.stringify(error));\n      }\n    }\n  }, {\n    key: \"setField\",\n    value: function setField(fieldName, fieldValue) {\n      this.fields[fieldName] = fieldValue;\n      this.fieldsChanged[fieldName] = fieldValue;\n      var index = this.fieldsCleared.indexOf(fieldName);\n      if (index > -1) {\n        this.fieldsCleared.splice(index, 1);\n      }\n    }\n  }, {\n    key: \"commonSetFieldLogic\",\n    value: function commonSetFieldLogic(key, fieldValue, expire) {\n      this.addObjectToSyncMessage(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_STORAGE, key, fieldValue);\n      var redisKey = this.sha1(key);\n      if (this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD || this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT || this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE && this.v1Compatibility) {\n        var redisExpire = expire || 3600 * 24 * 7;\n        return this.db.setOneValueInCacheWithExpiry(redisKey, fieldValue, redisExpire);\n      } else {\n        //console.log('Storing locally 2nd layer ' + key);\n        return this.deviceStorage.saveKeyInStorage(redisKey, fieldValue);\n      }\n    }\n  }, {\n    key: \"commonGetFieldLogic\",\n    value: function () {\n      var _commonGetFieldLogic = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(key) {\n        var _, result, response;\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) switch (_context11.prev = _context11.next) {\n            case 0:\n              //console.log('Reading encrypted key ' + key);\n              _ = this._;\n              if (!(this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD || this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT || this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE && this.v1Compatibility)) {\n                _context11.next = 15;\n                break;\n              }\n              _context11.next = 4;\n              return this.db.getValueFromCache(key);\n            case 4:\n              result = _context11.sent;\n              if (!result) {\n                _context11.next = 13;\n                break;\n              }\n              _context11.prev = 6;\n              return _context11.abrupt(\"return\", JSON.parse(_.get(result, 'content')));\n            case 10:\n              _context11.prev = 10;\n              _context11.t0 = _context11[\"catch\"](6);\n              return _context11.abrupt(\"return\", _.get(result, 'content'));\n            case 13:\n              _context11.next = 19;\n              break;\n            case 15:\n              _context11.next = 17;\n              return this.deviceStorage.getKeyFromStorage(key);\n            case 17:\n              response = _context11.sent;\n              return _context11.abrupt(\"return\", response);\n            case 19:\n            case \"end\":\n              return _context11.stop();\n          }\n        }, _callee11, this, [[6, 10]]);\n      }));\n      function commonGetFieldLogic(_x14) {\n        return _commonGetFieldLogic.apply(this, arguments);\n      }\n      return commonGetFieldLogic;\n    }()\n  }, {\n    key: \"commonClearFieldLogic\",\n    value: function () {\n      var _commonClearFieldLogic = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(key) {\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              if (!(this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD || this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT || this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE && this.v1Compatibility)) {\n                _context12.next = 5;\n                break;\n              }\n              _context12.next = 3;\n              return this.db.deleteOneKeyInCache(key);\n            case 3:\n              _context12.next = 7;\n              break;\n            case 5:\n              _context12.next = 7;\n              return this.deviceStorage.removeKeyFromStorage(key);\n            case 7:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this);\n      }));\n      function commonClearFieldLogic(_x15) {\n        return _commonClearFieldLogic.apply(this, arguments);\n      }\n      return commonClearFieldLogic;\n    }()\n  }, {\n    key: \"setSharedField\",\n    value: function setSharedField(fieldName, fieldValue, expire) {\n      var key = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX, \"_\").concat(fieldName);\n      return this.commonSetFieldLogic(key, fieldValue, expire);\n    }\n  }, {\n    key: \"getSharedField\",\n    value: function getSharedField(fieldName) {\n      var key = this.sha1(\"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX, \"_\").concat(fieldName));\n      return this.commonGetFieldLogic(key);\n    }\n  }, {\n    key: \"clearSharedField\",\n    value: function clearSharedField(fieldName) {\n      var key = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX, \"_\").concat(fieldName);\n      return this.commonClearFieldLogic(this.sha1(key));\n    }\n  }, {\n    key: \"setPersistedField\",\n    value: function setPersistedField(fieldName, fieldValue) {\n      var key = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX).concat(this.conversationId, \"_\").concat(fieldName);\n      var expire = 3600 * 24 * 7;\n      return this.commonSetFieldLogic(key, fieldValue, expire);\n    }\n  }, {\n    key: \"getPersistedField\",\n    value: function getPersistedField(fieldName) {\n      var key = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX).concat(this.conversationId, \"_\").concat(fieldName);\n      return this.commonGetFieldLogic(this.sha1(key));\n    }\n  }, {\n    key: \"clearPersistedField\",\n    value: function clearPersistedField(fieldName) {\n      var key = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX).concat(this.conversationId, \"_\").concat(fieldName);\n      return this.commonClearFieldLogic(this.sha1(key));\n    }\n  }, {\n    key: \"getPersistedFields\",\n    value: function () {\n      var _getPersistedFields = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(fieldNames) {\n        var _this9 = this;\n        var _, keysArray, response, i, redisKey, responseFromCache, _i2, _redisKey, value;\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              _ = this._;\n              if (!Array.isArray(fieldNames)) {\n                _context13.next = 26;\n                break;\n              }\n              keysArray = [];\n              response = {};\n              if (!(this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD || this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT || this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE && this.v1Compatibility)) {\n                _context13.next = 13;\n                break;\n              }\n              for (i = 0; i < fieldNames.length; i++) {\n                redisKey = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX).concat(this.conversationId, \"_\").concat(fieldNames[i]);\n                keysArray.push(this.sha1(redisKey));\n              }\n              _context13.next = 8;\n              return this.db.getMultipleValuesFromCache(keysArray);\n            case 8:\n              responseFromCache = _context13.sent;\n              this.developer.log({\n                message: 'Content from Redis',\n                data: responseFromCache\n              });\n              if (responseFromCache) {\n                _.forEach(keysArray, function (key) {\n                  var payload = responseFromCache[key];\n                  if (payload) {\n                    try {\n                      var field = '';\n                      var _i = _.findIndex(fieldNames, function (fieldName) {\n                        var redisKey = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX).concat(_this9.conversationId, \"_\").concat(fieldName);\n                        field = fieldName;\n                        return key === _this9.sha1(redisKey);\n                      });\n                      if (_i !== -1) {\n                        response[field] = JSON.parse(_.get(payload, 'content'));\n                      }\n                    } catch (error) {\n                      _this9.addSystemErrorToStack(39, null, error.message);\n                      _this9.developer.log({\n                        message: 'Data from Redis',\n                        data: _.get(payload, 'content')\n                      });\n                    }\n                  }\n                });\n              }\n              _context13.next = 23;\n              break;\n            case 13:\n              _i2 = 0;\n            case 14:\n              if (!(_i2 < fieldNames.length)) {\n                _context13.next = 23;\n                break;\n              }\n              _redisKey = \"\".concat(_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.PERSISTED_FIELD_PREFIX).concat(this.conversationId, \"_\").concat(fieldNames[_i2]);\n              _context13.next = 18;\n              return this.deviceStorage.getKeyFromStorage(this.sha1(_redisKey));\n            case 18:\n              value = _context13.sent;\n              if (value) response[fieldNames[_i2]] = value;\n            case 20:\n              _i2++;\n              _context13.next = 14;\n              break;\n            case 23:\n              return _context13.abrupt(\"return\", response);\n            case 26:\n              this.addSystemErrorToStack(7, 'getPersistedFields: fieldNames parameter must be an array');\n              return _context13.abrupt(\"return\", null);\n            case 28:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this);\n      }));\n      function getPersistedFields(_x16) {\n        return _getPersistedFields.apply(this, arguments);\n      }\n      return getPersistedFields;\n    }()\n  }, {\n    key: \"clearField\",\n    value: function clearField(fieldName) {\n      delete this.fields[fieldName];\n      this.fieldsCleared.push(fieldName);\n    }\n  }, {\n    key: \"getField\",\n    value: function getField(fieldName) {\n      var field = this.fields[fieldName];\n      if (typeof field !== 'undefined') {\n        return field;\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"hasFieldInPath\",\n    value: function hasFieldInPath(path) {\n      return !!this.R.path(path, this.fields);\n    }\n  }, {\n    key: \"addSmartSuggestions\",\n    value: function addSmartSuggestions(newSmartSuggestion) {\n      this.smartSuggestionsArray.push(newSmartSuggestion);\n    }\n  }, {\n    key: \"addSmartSuggestionsArray\",\n    value: function addSmartSuggestionsArray(newSmartSuggestions) {\n      var _this10 = this;\n      this.developer.log({\n        message: 'Adding smart suggestions',\n        data: newSmartSuggestions\n      });\n      var _ = this._;\n      _.each(newSmartSuggestions, function (suggestionObject) {\n        if (suggestionObject.lang === _this10.lang) {\n          _this10.smartSuggestionsArray = _this10.smartSuggestionsArray.concat(suggestionObject.list);\n        }\n      });\n    }\n  }, {\n    key: \"addEnglishSmartSuggestions\",\n    value: function addEnglishSmartSuggestions(newSmartSuggestions) {\n      var smartSuggestionsArray = [{\n        lang: 'en',\n        list: newSmartSuggestions\n      }];\n      this.addSmartSuggestionsArray(smartSuggestionsArray);\n    }\n  }, {\n    key: \"blockSuggestions\",\n    get: function get() {\n      return this._blockSuggestions;\n    },\n    set: function set(flag) {\n      this._blockSuggestions = flag;\n    }\n  }, {\n    key: \"clearSmartSuggestionsArray\",\n    value: function clearSmartSuggestionsArray() {\n      //console.log('Clearing Suggestions');\n      this.smartSuggestionsArray = [];\n      this._blockSuggestions = false;\n    }\n  }, {\n    key: \"addActiveIntent\",\n    value: function addActiveIntent(intentId) {\n      var _this11 = this;\n      var logHistory = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var silent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      this._silentIntent = silent;\n      var cutIn10 = function cutIn10() {\n        if (_this11._intentHistory.length > 10) {\n          _this11._intentHistory.splice(0, 1);\n          cutIn10();\n        }\n      };\n      this._activeIntent = intentId;\n      if (logHistory) {\n        this._intentHistory.push(intentId);\n      }\n      cutIn10();\n    }\n  }, {\n    key: \"removeActiveIntent\",\n    value: function removeActiveIntent() {\n      if (this._activeIntent !== '') {\n        this._activeIntent = '';\n      }\n    }\n  }, {\n    key: \"addSystemErrorToStack\",\n    value: function addSystemErrorToStack(code, message, data) {\n      var errorObject = new _Error__WEBPACK_IMPORTED_MODULE_23__.Error(this, code, message);\n      // console.log(\"######### Search for this\");\n      // console.log(\"######### message from code: \" + errorObject.errorMessage);\n      // console.log(\"######### message: \" + message);\n      // console.log(\"######### data: \" + JSON.stringify(data));\n      //this.developer.log(errorObject.errorMessage, LogEntrytype.SYSTEM_ERROR());\n      this.developer.systemError({\n        message: errorObject.errorMessage,\n        errorCode: code,\n        data: data\n      });\n      this.errorStack.push(errorObject);\n    }\n  }, {\n    key: \"addErrorToStack\",\n    value: function addErrorToStack(code, message, data) {\n      var errorObject = {};\n      if (code < 999) {\n        errorObject = new _Error__WEBPACK_IMPORTED_MODULE_23__.Error(this, 1000, message);\n      } else {\n        errorObject = new _Error__WEBPACK_IMPORTED_MODULE_23__.Error(this, code, message);\n      }\n      //this.developer.log(errorObject.errorMessage, LogEntrytype.USER_ERROR());\n      this.developer.userError({\n        message: errorObject.errorMessage,\n        errorCode: code,\n        data: data\n      });\n      this.errorStack.push(errorObject);\n    }\n  }, {\n    key: \"inError\",\n    get: function get() {\n      return this._.size(this.errorStack) > 0;\n    }\n  }, {\n    key: \"clearError\",\n    value: function clearError() {\n      this.errorStack = [];\n    }\n  }, {\n    key: \"addStringResponse\",\n    value: function addStringResponse(message) {\n      this.addResponse('string', message);\n    }\n  }, {\n    key: \"addStandardNotificationResponse\",\n    value: function addStandardNotificationResponse(message) {\n      this.addResponse('standard_notification', message);\n    }\n  }, {\n    key: \"addCriticalNotificationResponse\",\n    value: function addCriticalNotificationResponse(message) {\n      this.addResponse('critical_notification', message);\n    }\n  }, {\n    key: \"addAuthorizationRequestResponse\",\n    value: function addAuthorizationRequestResponse(message) {\n      this.addResponse('authorization_request', message);\n    }\n  }, {\n    key: \"addFormResponse\",\n    value: function addFormResponse(message) {\n      this.addResponse('form2', message);\n    }\n  }, {\n    key: \"addShortFormResponse\",\n    value: function addShortFormResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.SHORT_FORM_RESPONSE(), message);\n    }\n  }, {\n    key: \"addFormChangeResponse\",\n    value: function addFormChangeResponse(message) {\n      this.addResponse('form_live_changes', message);\n    }\n  }, {\n    key: \"addInLineFormChangeResponse\",\n    value: function addInLineFormChangeResponse(message) {\n      this.addResponse('table_live_changes', message);\n    }\n  }, {\n    key: \"addMapResponse\",\n    value: function addMapResponse(message) {\n      this.addResponse('map', message);\n    }\n  }, {\n    key: \"addChartResponse\",\n    value: function addChartResponse(message) {\n      this.addResponse('chart', message);\n    }\n  }, {\n    key: \"addTableResponse\",\n    value: function addTableResponse(message) {\n      this.addResponse('table', message);\n    }\n  }, {\n    key: \"addShortTableResponse\",\n    value: function addShortTableResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.SHORT_TABLE_RESPONSE(), message);\n    }\n  }, {\n    key: \"addTrackingViewResponse\",\n    value: function addTrackingViewResponse(message) {\n      this.addResponse('trackerForm', message);\n    }\n  }, {\n    key: \"addCardsResponse\",\n    value: function addCardsResponse(message) {\n      this.addResponse('cards', message);\n    }\n  }, {\n    key: \"addHTMLResponse\",\n    value: function addHTMLResponse(message) {\n      this.addResponse('html', {\n        message: {},\n        options: message\n      });\n    }\n  }, {\n    key: \"addContainerResponse\",\n    value: function addContainerResponse(message) {\n      this.addResponse('container', message);\n    }\n  }, {\n    key: \"addVideoCallResponse\",\n    value: function addVideoCallResponse(message) {\n      this.addResponse('videoCall', message);\n    }\n  }, {\n    key: \"addVoiceCallResponse\",\n    value: function addVoiceCallResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.MESSAGE_VOICE_CALL(), message);\n    }\n  }, {\n    key: \"addMenuResponse\",\n    value: function addMenuResponse(message) {\n      this.addResponse('menuMessage', message);\n    }\n  }, {\n    key: \"addTimelinesResponse\",\n    value: function addTimelinesResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.MESSAGE_TYPE_TIMELINE_LIST(), message);\n    }\n  }, {\n    key: \"addTimelinePostResponse\",\n    value: function addTimelinePostResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.MESSAGE_TYPE_TIMELINE_POST(), message);\n    }\n  }, {\n    key: \"addSoundResponse\",\n    value: function addSoundResponse(message) {\n      var soundMessage = message;\n      if (!message) {\n        soundMessage = {\n          sound: 'FrontM_Ring.mp3'\n        };\n      }\n      this.addResponse('sound', soundMessage);\n    }\n  }, {\n    key: \"addCsvResponse\",\n    value: function addCsvResponse(message) {\n      this.addResponse('csv', message);\n    }\n  }, {\n    key: \"addSurveyResponse\",\n    value: function addSurveyResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.MESSAGE_TYPE_SURVEY(), message);\n    }\n  }, {\n    key: \"addDashboardResponse\",\n    value: function addDashboardResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.DASHBOARD(), message);\n    }\n  }, {\n    key: \"addTCPResponse\",\n    value: function addTCPResponse(message, targetIp, targetPort) {\n      // targetIp and targetPort must be deleted after testing with terminal\n      if (this.client !== _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT) {\n        var msg = 'Message type not supported on this client';\n        this.addSystemErrorToStack(5, msg);\n        return;\n      }\n      var tcpCapability = this.context.getCapability('TCP');\n      var payload = {\n        dest_ip: targetIp,\n        dest_port: targetPort,\n        msg: message\n      };\n      tcpCapability.sendMessage(payload);\n    }\n  }, {\n    key: \"addAiccResponse\",\n    value: function addAiccResponse(message) {\n      this.addResponse(_MessageTypes__WEBPACK_IMPORTED_MODULE_22__.MessageTypes.MESSAGE_TYPE_AICC_STRING(), message);\n    }\n  }, {\n    key: \"addRunModeResponse\",\n    value: function () {\n      var _addRunModeResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14() {\n        var runModeMessage, Message, message;\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) switch (_context14.prev = _context14.next) {\n            case 0:\n              if (!(this.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT && !this.v1Compatibility)) {\n                _context14.next = 2;\n                break;\n              }\n              return _context14.abrupt(\"return\");\n            case 2:\n              runModeMessage = {\n                background: this.background,\n                sidebar: this.sidebar,\n                navbar: this.navbar,\n                chatButtonHidden: this.chatButtonHidden,\n                waitingIcon: this._waitingIcon,\n                cssFilePath: this._cssFilePath,\n                suggestionsLayout: this._suggestionsLayout,\n                modal: this._modal\n              };\n              Message = this.context.getCapability('Message');\n              message = new Message();\n              message.runMode(runModeMessage);\n              _context14.next = 8;\n              return this.context.tell(message);\n            case 8:\n            case \"end\":\n              return _context14.stop();\n          }\n        }, _callee14, this);\n      }));\n      function addRunModeResponse() {\n        return _addRunModeResponse.apply(this, arguments);\n      }\n      return addRunModeResponse;\n    }()\n  }, {\n    key: \"addStringResponseFromArray\",\n    value: function addStringResponseFromArray(messages) {\n      var error = false;\n      if (Array.isArray(messages)) {\n        var index = Math.round(Math.random() * (messages.length - 1));\n        var message = messages[index];\n        if (typeof message === 'string') {\n          this.addResponse('string', message);\n        } else {\n          error = true;\n        }\n      } else {\n        error = true;\n      }\n      if (error) {\n        this.addErrorToStack(23, _Error__WEBPACK_IMPORTED_MODULE_23__.Error.getErrorMessageforCodeAndLang(23, this.lang));\n      }\n    }\n  }, {\n    key: \"addSilentResponse\",\n    value: function addSilentResponse() {\n      this.developer.info({\n        message: 'Adding Silent response'\n      });\n      this.addResponse('silent', {});\n    }\n  }, {\n    key: \"addResponse\",\n    value: function addResponse(type, message) {\n      //this.developer.debug({message: 'Will add response ', data: message});\n      if (this.developer.runProfile) {\n        if (type === 'string') {\n          this.developer.info({\n            message: 'Added response ' + message\n          });\n        } else {\n          this.developer.info({\n            message: 'Added message type ' + type\n          });\n        }\n      }\n      //this.developer.debug({message: 'Will add response 2', data: type});\n      if (message) {\n        if (message.options) {\n          if (this.currentControlId !== null) {\n            message.options['parentControlId'] = this.currentControlId;\n          }\n          if (this.currentTabId) {\n            message.options.tabId = this.currentTabId;\n          }\n          if (!message.options.controlId) {\n            message.options.controlId = this.getUniqueId();\n          }\n        } else {\n          if (message.tabId && this.currentTabId) {\n            message.tabId = this.currentTabId;\n          }\n        }\n        this.responsesArray.push({\n          type: type,\n          message: message,\n          messageId: this.getUniqueId()\n        });\n        //this.developer.debug({message: 'Added response'});\n      } else {\n        this.addSystemErrorToStack(14, type);\n      }\n    }\n  }, {\n    key: \"clearRoutesQueue\",\n    value: function clearRoutesQueue() {\n      this._routesQueue = {};\n    }\n  }, {\n    key: \"clearResponseArray\",\n    value: function clearResponseArray() {\n      this.responsesArray = [];\n    }\n  }, {\n    key: \"setWaitingCustomCap\",\n    value: function setWaitingCustomCap() {\n      if (!this.silentIntent) {\n        this.waitingCustomCap += 1;\n      }\n    }\n  }, {\n    key: \"resetWaitingForCustomCapCounter\",\n    value: function resetWaitingForCustomCapCounter() {\n      this.waitingCustomCap = 0;\n    }\n  }, {\n    key: \"addRequestId\",\n    value: function addRequestId(requestId) {\n      this.requestIdsArray.unshift(requestId);\n      if (this.requestIdsArray.length > 10) {\n        this.requestIdsArray.pop();\n      }\n    }\n  }, {\n    key: \"markRequestIdProcessed\",\n    value: function markRequestIdProcessed(requestId) {\n      var indexOfRequestId = this.requestIdsArray.indexOf(requestId);\n      if (indexOfRequestId === -1) {\n        this.addRequestId(requestId);\n        if (this.waitingCustomCap > 0) {\n          this.waitingCustomCap -= 1;\n        }\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"stateToBackEnd\",\n    value: function stateToBackEnd() {\n      var _ = this._;\n      var stateToBackend = {\n        lang: this.lang,\n        intentResolved: this.intentResolved,\n        messageTypeFromUser: this.messageTypeFromUser,\n        messageFromUser: this.messageFromUser,\n        messageIdFromUser: this.messageIdFromUser,\n        messageTypeIntFromUser: this.messageTypeIntFromUser,\n        messageCreatedOnFromUser: this.messageCreatedOnFromUser,\n        messageCreatedByFromUser: this.messageCreatedByFromUser,\n        messageContentFromUser: this.messageContentFromUser,\n        messageOptionsFromUser: this.messageOptionsFromUser,\n        userName: this.userName,\n        tz: this.user.tz,\n        fields: this.fields,\n        _intentHistory: this._intentHistory\n      };\n      if (this.fromGreeting) {\n        stateToBackend.fromGreeting = this.fromGreeting;\n      }\n      if (this._activeIntent !== '') {\n        stateToBackend._activeIntent = this._activeIntent;\n      }\n      if (this._intentDurations !== '') {\n        stateToBackend._intentDurations = this._intentDurations;\n      }\n      if (this.developer._debugMode) {\n        stateToBackend._debugMode = true;\n      }\n      stateToBackend.client = this.client;\n      stateToBackend.client = this.client;\n      stateToBackend.currentWorkspace = this.currentWorkspace;\n      stateToBackend._inSilence = this._inSilence;\n      if (_.size(this._dynamicIntents) > 0) {\n        stateToBackend._dynamicIntents = this._dynamicIntents;\n      }\n      stateToBackend._syncToCloud = this._syncToCloud;\n      if (Array.isArray(this._delayedNotification) && this._delayedNotification.length > 0) {\n        stateToBackend._delayedNotification = _.clone(this._delayedNotification);\n        this._delayedNotification = [];\n      }\n      stateToBackend.autoSaveBufferChanges = this.autoSaveBufferChanges;\n      stateToBackend.osVersion = this.osVersion;\n      stateToBackend.brand = this.brand;\n      stateToBackend.phoneModel = this.phoneModel;\n      stateToBackend.platform = this.platform;\n      stateToBackend.userAgent = this.userAgent;\n      stateToBackend.reportActivityOnMain = this.reportActivityOnMain;\n      return {\n        state: stateToBackend\n      };\n    }\n  }, {\n    key: \"getFinalResponsesArray\",\n    value: function getFinalResponsesArray() {\n      var _ = this._;\n      var finalResponse = {};\n      if (this.nlpResponse) {\n        finalResponse.nlpResponse = this.nlpResponse;\n      }\n      if (this._nlpResults) {\n        finalResponse._nlpResults = this._nlpResults;\n      }\n      if (_.size(this['errorStack']) > 0) {\n        finalResponse.errorStack = this['errorStack'];\n      }\n      if (_.size(this['responsesArray']) > 0) {\n        finalResponse.responsesArray = this['responsesArray'];\n      }\n      if (this['smartSuggestionsArray'] && _.size(this['smartSuggestionsArray']) > 0) {\n        finalResponse.smartSuggestionsArray = this['smartSuggestionsArray'];\n      }\n      if (this['intentResolved']) {\n        finalResponse.intentResolved = this['intentResolved'];\n      }\n      finalResponse.responseToClient = this.client;\n      if (this.sendMessageParam) {\n        finalResponse.sendMessageParam = this.sendMessageParam;\n      }\n      return finalResponse;\n    }\n  }, {\n    key: \"getFinalResponseState\",\n    value: function getFinalResponseState() {\n      var _ = this._;\n      var finalResponse = {};\n      if (this['_activeIntent'] !== '') {\n        finalResponse._activeIntent = this['_activeIntent'];\n      }\n      finalResponse.fieldsChanged = this.fieldsChanged;\n      finalResponse.fieldsCleared = this.fieldsCleared;\n      if (this.developer._debugMode) {\n        finalResponse._debugMode = true;\n      }\n      if (this.blockSuggestions) {\n        finalResponse._blockSuggestions = true;\n      }\n      if (this.silentIntent) {\n        finalResponse._silentIntent = true;\n      }\n      if (this.clearPrompt) {\n        finalResponse.clearPrompt = true;\n      }\n      if (this.requestIdsArray.length > 0) {\n        finalResponse.requestIdsArray = this.requestIdsArray;\n      }\n      if (this._intentDurations) {\n        finalResponse._intentDurations = this._intentDurations;\n      }\n      if (this._autoSavePresent) {\n        finalResponse._autoSavePresent = this._autoSavePresent;\n      }\n      if (this.fromGreeting) {\n        finalResponse._conversational = this._conversational;\n        finalResponse._background = this._background;\n        finalResponse._sidebar = this._sidebar;\n        finalResponse.fromGreeting = this.fromGreeting;\n      }\n      if (this._inSilence) {\n        finalResponse._inSilence = this._inSilence;\n      }\n      if (_.size(this._dynamicIntents) > 0) {\n        finalResponse._dynamicIntents = this._dynamicIntents;\n      }\n      if (this.currentTabId) {\n        finalResponse.currentTabId = this.currentTabId;\n      }\n      finalResponse.backendResponseType = 1;\n      finalResponse.responseToClient = this.client;\n      return finalResponse;\n    }\n  }, {\n    key: \"getFinalResponseSync\",\n    value: function getFinalResponseSync() {\n      var _ = this._;\n      var finalResponse = {};\n      finalResponse._syncToEdge = this._syncToEdge;\n      finalResponse.autoSaveBufferChanges = this.autoSaveBufferChanges;\n      finalResponse.backendResponseType = 2;\n      finalResponse.responseToClient = this.client;\n      return finalResponse;\n    }\n  }, {\n    key: \"sizeOfObject\",\n    value: function sizeOfObject(object) {\n      try {\n        var typeSizes = {\n          symbol: function symbol() {\n            return 0;\n          },\n          \"function\": function _function() {\n            return 0;\n          },\n          undefined: function undefined() {\n            return 0;\n          },\n          \"boolean\": function boolean() {\n            return 4;\n          },\n          number: function number() {\n            return 8;\n          },\n          string: function string(item) {\n            return 2 * item.length;\n          },\n          object: function object(item) {\n            return !item ? 0 : Object.keys(item).reduce(function (total, key) {\n              return sizeOf(key) + sizeOf(item[key]) + total;\n            }, 0);\n          }\n        };\n        var sizeOf = function sizeOf(object) {\n          return typeSizes[_typeof(object)](object);\n        };\n        return sizeOf(object);\n      } catch (error) {\n        //console.log('ERROR IN LAMBDA LOGIC: Data type not found checking state size ' + typeof object);\n        //console.log('ERROR IN LAMBDA LOGIC: Error: ' + error.message);\n        return 0;\n      }\n    }\n  }, {\n    key: \"conversational\",\n    get: function get() {\n      return this._conversational;\n    },\n    set: function set(flag) {\n      this._conversational = flag;\n    }\n  }, {\n    key: \"waitingIcon\",\n    get: function get() {\n      return this._waitingIcon;\n    },\n    set: function set(waitingIcon) {\n      this._waitingIcon = waitingIcon;\n    }\n  }, {\n    key: \"background\",\n    get: function get() {\n      return this._background;\n    },\n    set: function set(message) {\n      this._background = message;\n    }\n  }, {\n    key: \"sidebar\",\n    get: function get() {\n      return this._sidebar;\n    },\n    set: function set(message) {\n      this._sidebar = message;\n    }\n  }, {\n    key: \"navbar\",\n    get: function get() {\n      return this._navbar;\n    },\n    set: function set(message) {\n      this._navbar = message;\n    }\n  }, {\n    key: \"systemId\",\n    get: function get() {\n      return this._systemId;\n    },\n    set: function set(systemId) {\n      this._systemId = systemId;\n    }\n  }, {\n    key: \"cssFilePath\",\n    get: function get() {\n      return this._cssFilePath;\n    },\n    set: function set(message) {\n      this._cssFilePath = message;\n    }\n  }, {\n    key: \"intentHistory\",\n    get: function get() {\n      return this.intentHistory;\n    }\n  }, {\n    key: \"getGreetingIntent\",\n    value: function getGreetingIntent() {\n      if (this._intents[_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.SYSTEM_INTENTS.MAIN]) {\n        return this._intents[_ALLConstants__WEBPACK_IMPORTED_MODULE_21__.SYSTEM_INTENTS.MAIN];\n      }\n    }\n  }, {\n    key: \"currentUserDomain\",\n    get: function get() {\n      return this.conversation.userDomain;\n    }\n  }, {\n    key: \"isPublic\",\n    get: function get() {\n      if (this.user.userName.substring(0, 5) === 'Anon_') {\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: \"unitTestMode\",\n    get: function get() {\n      return this._unitTestMode;\n    },\n    set: function set(mode) {\n      this._unitTestMode = true;\n    }\n  }, {\n    key: \"silenceBot\",\n    value: function silenceBot() {\n      this._inSilence = true;\n    }\n  }, {\n    key: \"wakeUpBot\",\n    value: function wakeUpBot() {\n      this._inSilence = false;\n    }\n  }, {\n    key: \"resumeBot\",\n    value: function resumeBot() {\n      this._inSilence = false;\n    }\n  }, {\n    key: \"setVerticalSuggestions\",\n    value: function setVerticalSuggestions() {\n      this._suggestionsLayout = 'vertical';\n    }\n  }, {\n    key: \"inSilence\",\n    get: function get() {\n      return this._inSilence;\n    }\n  }, {\n    key: \"modal\",\n    get: function get() {\n      return this._modal;\n    },\n    set: function set(modal) {\n      this._modal = modal;\n    }\n  }, {\n    key: \"currentControlId\",\n    get: function get() {\n      return this._currentControlId;\n    },\n    set: function set(currentControlId) {\n      this._currentControlId = currentControlId;\n    }\n  }, {\n    key: \"addUserToConversation\",\n    value: function () {\n      var _addUserToConversation = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(_ref3) {\n        var _ref3$conversationId, conversationId, userEmail, user;\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) switch (_context15.prev = _context15.next) {\n            case 0:\n              _ref3$conversationId = _ref3.conversationId, conversationId = _ref3$conversationId === void 0 ? this.conversationId : _ref3$conversationId, userEmail = _ref3.userEmail;\n              _context15.next = 3;\n              return this.frontmlib.getUserByEmail(userEmail);\n            case 3:\n              user = _context15.sent;\n              if (!(user !== null && user !== void 0 && user.userId)) {\n                _context15.next = 9;\n                break;\n              }\n              _context15.next = 7;\n              return this.addMeToTheConversation(conversationId, user.userId);\n            case 7:\n              _context15.next = 10;\n              break;\n            case 9:\n              D.warning({\n                message: \"User \".concat(userEmail, \" doesn't exist\")\n              });\n            case 10:\n            case \"end\":\n              return _context15.stop();\n          }\n        }, _callee15, this);\n      }));\n      function addUserToConversation(_x17) {\n        return _addUserToConversation.apply(this, arguments);\n      }\n      return addUserToConversation;\n    }()\n  }, {\n    key: \"addMeToTheConversation\",\n    value: function () {\n      var _addMeToTheConversation = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16(conversationId, userId) {\n        var _, CONVERSATIONS_TABLE, query, conversationObject, participants, userToAdd, doc, key, cachedConversation, parsedCacheConversation;\n        return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n          while (1) switch (_context16.prev = _context16.next) {\n            case 0:\n              _ = this._;\n              CONVERSATIONS_TABLE = 'Conversations';\n              query = [{\n                operand: 'conversationId',\n                value: conversationId,\n                operator: 'eq'\n              }, {\n                operand: 'userDomain',\n                value: this.currentUserDomain,\n                operator: 'eq'\n              }];\n              _context16.next = 5;\n              return this.db.getData(CONVERSATIONS_TABLE, query);\n            case 5:\n              conversationObject = _context16.sent;\n              if (!conversationObject.items) {\n                _context16.next = 22;\n                break;\n              }\n              participants = _.get(conversationObject.items[0], 'participants');\n              userToAdd = userId || this.user.userId;\n              if (!(participants.indexOf(userToAdd) === -1)) {\n                _context16.next = 22;\n                break;\n              }\n              participants.push(userToAdd);\n              doc = [{\n                key: {\n                  conversationId: conversationId,\n                  userDomain: this.currentUserDomain\n                },\n                document: {\n                  participants: participants\n                }\n              }];\n              _context16.next = 14;\n              return this.db.writeData(CONVERSATIONS_TABLE, doc);\n            case 14:\n              key = 'Conversations_' + conversationId + '_' + this.currentUserDomain;\n              _context16.next = 17;\n              return this.db.getValueFromCache(key);\n            case 17:\n              cachedConversation = _context16.sent;\n              parsedCacheConversation = JSON.parse(cachedConversation.content);\n              parsedCacheConversation.participants = participants;\n              _context16.next = 22;\n              return this.db.setOneValueInCache(key, parsedCacheConversation);\n            case 22:\n            case \"end\":\n              return _context16.stop();\n          }\n        }, _callee16, this);\n      }));\n      function addMeToTheConversation(_x18, _x19) {\n        return _addMeToTheConversation.apply(this, arguments);\n      }\n      return addMeToTheConversation;\n    }()\n  }, {\n    key: \"setIntentWithId\",\n    value: function setIntentWithId(id, intent) {\n      if (this._intents[id]) return;\n      this._intents[id] = intent;\n    }\n  }, {\n    key: \"addDynamicIntent\",\n    value: function addDynamicIntent(intent) {\n      this._dynamicIntents[intent.id] = intent;\n    }\n  }, {\n    key: \"clearDynamicIntents\",\n    value: function clearDynamicIntents() {\n      this._dynamicIntents = {};\n    }\n  }, {\n    key: \"dynamicIntents\",\n    get: function get() {\n      return this._dynamicIntents;\n    }\n  }, {\n    key: \"intents\",\n    get: function get() {\n      return this._intents;\n    }\n  }, {\n    key: \"createAutoSaveIntent\",\n    value: function createAutoSaveIntent(intentName, location) {\n      var _this12 = this;\n      var _ = this._;\n      var autoSaveIntent = new _Intent__WEBPACK_IMPORTED_MODULE_20__.Intent(intentName);\n      if (location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.EDGE) {\n        autoSaveIntent.onMatching = function () {\n          return _this12.client !== _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT && _.get(_this12.messageFromUser, 'intentId') === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.AUTO_SAVE_INTENT_EDGE;\n        };\n      } else {\n        autoSaveIntent.runOnCloud();\n        autoSaveIntent.onMatching = function () {\n          return _this12.client !== _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.CLIENTS.WEBCLIENT && _.get(_this12.messageFromUser, 'intentId') === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.AUTO_SAVE_INTENT_CLOUD;\n        };\n      }\n      autoSaveIntent.onResolution = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17() {\n        var _, tabId, value, field, autoSaveBuffer, autoSavedDoc;\n        return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n          while (1) switch (_context17.prev = _context17.next) {\n            case 0:\n              _ = _this12._;\n              tabId = _.get(_this12.messageFromUser, 'tabId');\n              value = _.get(_this12.messageFromUser, 'value');\n              field = _.get(_this12.messageFromUser, 'field');\n              autoSaveBuffer = _this12.autoSaveBuffer;\n              if (tabId) {\n                autoSavedDoc = _.get(autoSaveBuffer, tabId, {});\n                if (value) {\n                  autoSavedDoc[field] = value;\n                } else {\n                  if (autoSavedDoc[field]) {\n                    delete autoSavedDoc[field];\n                  }\n                }\n                autoSaveBuffer[tabId] = autoSavedDoc;\n              }\n            case 6:\n            case \"end\":\n              return _context17.stop();\n          }\n        }, _callee17);\n      }));\n      this.setIntentWithId(autoSaveIntent.intentId, autoSaveIntent);\n      this.addSilentResponse();\n    }\n  }, {\n    key: \"bot\",\n    value: function bot(BOT) {\n      var _this13 = this;\n      var _ = this._;\n      var D = this.developer;\n      var createDynamicIntents = function createDynamicIntents() {\n        //First processing dynamic Docs\n        var dynamicIntentsObject = {};\n        _.forEach(_this13._dynamicIntents, function (dynamicIntent) {\n          if (_.get(dynamicIntent, 'type') === 'Doc') {\n            var id = dynamicIntent.id;\n            var options = dynamicIntent.options;\n            var doc = new Doc(id, _this13, {\n              title: options.title,\n              description: options.description,\n              confirm: options.confirm,\n              cancel: options.cancel\n            });\n            doc.onSubmit = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18() {\n              return _regeneratorRuntime().wrap(function _callee18$(_context18) {\n                while (1) switch (_context18.prev = _context18.next) {\n                  case 0:\n                    _context18.next = 2;\n                    return doc.save();\n                  case 2:\n                  case \"end\":\n                    return _context18.stop();\n                }\n              }, _callee18);\n            }));\n            dynamicIntentsObject[id] = doc;\n          }\n        });\n        //Then fields and collections\n        var c;\n        _.forEach(_this13._dynamicIntents, function (dynamicIntent) {\n          if (_.get(dynamicIntent, 'type') === 'Field') {\n            var doc = _.get(dynamicIntent, 'options.doc');\n            var dynamicDocument = _this13._intents[doc];\n            if (dynamicDocument) {\n              var f = _Utils__WEBPACK_IMPORTED_MODULE_25__.Utils.createNewDynamicField(_.get(dynamicIntent, 'options'), dynamicDocument, _this13);\n              dynamicIntentsObject[_.get(dynamicIntent, 'id')] = f;\n            }\n          } else if (_.get(dynamicIntent, 'type') === 'Collection') {\n            var id = _.get(dynamicIntent, 'id');\n            var title = _.get(dynamicIntent, 'options.title');\n            var description = _.get(dynamicIntent, 'options.description');\n            var document = _.get(dynamicIntent, 'options.document');\n            var _dynamicDocument = _this13._intents[document];\n            if (_dynamicDocument) {\n              c = new _Collection__WEBPACK_IMPORTED_MODULE_24__.Collection(id, {\n                document: _this13._intents[document],\n                title: title,\n                description: description,\n                state: _this13\n              });\n              dynamicIntentsObject[id] = c;\n            }\n          }\n        });\n        /* if (c) {\n          c.onAction = async () => {\n            let surveyInstanceIdFromSelection = this.messageFromUser.content[Surveys.SURVEY_INSTANCE_ID_TITLE()];\n            let surveyInstanceId = c.document.f[Surveys.SURVEY_BASIC_FIELDS().SURVEY_INSTANCE_ID];\n            surveyInstanceId.value = surveyInstanceIdFromSelection;\n            c.document.readOnly = true;\n            c.document.confirm = 'Ok';\n            delete c.document.cancel;\n            await c.document.loadDocument();\n            this.surveys.hideNonRequiredFieldFromSurvey(c.document);\n            c.document.sendResponse();\n          };\n        } */\n        return dynamicIntentsObject;\n      };\n      var botArray = BOT(this);\n      // this.createAutoSaveIntent(ALL_CONSTANTS.AUTO_SAVE_INTENT_EDGE, ALL_CONSTANTS.LOCATIONS.EDGE);\n      // this.createAutoSaveIntent(ALL_CONSTANTS.AUTO_SAVE_INTENT_CLOUD, ALL_CONSTANTS.LOCATIONS.CLOUD);\n      if (Array.isArray(botArray) && botArray.length > 0) {\n        _.forEach(botArray, function (intent) {\n          _this13.setIntentWithId(intent.intentId, intent);\n        });\n        return botArray; //This will be deprecated\n      } else {\n        var newIntentsObject = createDynamicIntents();\n        var valueToReturn = _objectSpread(_objectSpread({}, this._intents), newIntentsObject);\n        return _.values(valueToReturn);\n      }\n    }\n  }, {\n    key: \"sendMessageToQueue\",\n    value: function () {\n      var _sendMessageToQueue = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19(queue, message) {\n        var params;\n        return _regeneratorRuntime().wrap(function _callee19$(_context19) {\n          while (1) switch (_context19.prev = _context19.next) {\n            case 0:\n              if (!(this.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_21__.ALL_CONSTANTS.LOCATIONS.CLOUD)) {\n                _context19.next = 12;\n                break;\n              }\n              _context19.prev = 1;\n              params = {\n                message: JSON.stringify(message),\n                sqsQueue: queue\n              };\n              _context19.next = 5;\n              return this.frontmlib.invokeLambda(\"SendSQSMessages\", \"Event\", params);\n            case 5:\n              _context19.next = 10;\n              break;\n            case 7:\n              _context19.prev = 7;\n              _context19.t0 = _context19[\"catch\"](1);\n              this.addSystemErrorToStack(7, \"Error sending SQS message\", _context19.t0);\n            case 10:\n              _context19.next = 13;\n              break;\n            case 12:\n              this.addSystemErrorToStack(55);\n            case 13:\n            case \"end\":\n              return _context19.stop();\n          }\n        }, _callee19, this, [[1, 7]]);\n      }));\n      function sendMessageToQueue(_x20, _x21) {\n        return _sendMessageToQueue.apply(this, arguments);\n      }\n      return sendMessageToQueue;\n    }()\n  }, {\n    key: \"sendResponseToClient\",\n    value: function sendResponseToClient(content) {\n      try {\n        if (this.reportActivityOnMain) {\n          return;\n        }\n        var createdOn = Date.now();\n        var createdBy = 'AgentM';\n        var contentType = 150;\n        var messageId = this.getUniqueId();\n        var message = {\n          createdOn: createdOn,\n          createdBy: createdBy,\n          contentType: contentType,\n          //messageId: this.messageIdFromUser,\n          messageId: messageId,\n          message: content\n        };\n        var data = {\n          queueMsgs: [{\n            userId: this.user.userId,\n            //recipient\n            userEmail: this.user.userEmail,\n            conversation: this.conversationId,\n            bot: this.botId,\n            requestUuid: this.getUniqueId(),\n            createdOn: createdOn,\n            createdBy: createdBy,\n            contentType: contentType,\n            messageId: messageId,\n            conversational: this.conversational,\n            timeSensitiveMessage: this.timeSensitiveMode,\n            details: [message]\n          }]\n        };\n        return this.frontmlib.invokeLambda(\"RedisWriteQueue\", \"RequestResponse\", data);\n      } catch (error) {\n        this.addSystemErrorToStack(7, \"Error responding to backend\", JSON.stringify(error));\n      }\n    }\n  }, {\n    key: \"persistentState\",\n    get: function get() {\n      return this._persistentState;\n    },\n    set: function set(persistentState) {\n      this._persistentState = persistentState;\n    }\n  }, {\n    key: \"persistentOfflineData\",\n    get: function get() {\n      return this._persistentOfflineData;\n    },\n    set: function set(persistentOfflineData) {\n      this._persistentOfflineData = persistentOfflineData;\n    }\n  }], [{\n    key: \"SOCKET_RECONNECTION_EVENT\",\n    value: function SOCKET_RECONNECTION_EVENT() {\n      return 'onSocketReconnection';\n    }\n  }]);\n  return State;\n}();\nvar state = new State();\nvar D = state.developer;\nvar _ = state._;\nString.prototype.sendResponse = function () {\n  state.addStringResponse(this.toString());\n};\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/State.js?");

/***/ }),

/***/ "../../frontmjs/core/UnitTest.js":
/*!***************************************!*\
  !*** ../../frontmjs/core/UnitTest.js ***!
  \***************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UnitTest: function() { return /* binding */ UnitTest; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar UnitTest = /*#__PURE__*/function (_Intent) {\n  _inherits(UnitTest, _Intent);\n  var _super = _createSuper(UnitTest);\n  function UnitTest(intentId, state) {\n    var _this;\n    _classCallCheck(this, UnitTest);\n    _this = _super.call(this, intentId, state);\n    _this.onTest = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    _this.onVerification = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }));\n    return _this;\n  }\n  _createClass(UnitTest, [{\n    key: \"unitTestIntent\",\n    get: function get() {\n      return true;\n    }\n  }, {\n    key: \"onMatching\",\n    get: function get() {\n      var _this2 = this;\n      return function (state) {\n        return state.messageTypeFromUser === 'string' && state.messageFromUser.substring(0, 5) === UnitTest.RUN_COMMAND() && state.R.toLower(state.messageFromUser.substring(6, state.messageFromUser.length)) === state.R.toLower(_this2.intentId);\n      };\n    }\n  }, {\n    key: \"onResolution\",\n    get: function get() {\n      var _this3 = this;\n      return /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(state) {\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return _this3.onTest();\n              case 2:\n                if (state.responsesArray.length === 0) {\n                  state.addStringResponse(UnitTest.TEST_RUN_MSG());\n                }\n              case 3:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3);\n        }));\n        return function (_x) {\n          return _ref3.apply(this, arguments);\n        };\n      }();\n    }\n  }], [{\n    key: \"RUN_COMMAND\",\n    value: function RUN_COMMAND() {\n      return '@@run';\n    }\n  }, {\n    key: \"TEST_RUN_MSG\",\n    value: function TEST_RUN_MSG() {\n      return 'Test request submitted successfully';\n    }\n  }, {\n    key: \"VERIFICATION_RUN_MSG\",\n    value: function VERIFICATION_RUN_MSG() {\n      return 'Verification process finished';\n    }\n  }, {\n    key: \"TEST_CASES_FIELD\",\n    value: function TEST_CASES_FIELD() {\n      return 'testCases';\n    }\n  }, {\n    key: \"CURRENT_TEST_FIELD\",\n    value: function CURRENT_TEST_FIELD() {\n      return 'currentTest';\n    }\n  }]);\n  return UnitTest;\n}(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent);\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/UnitTest.js?");

/***/ }),

/***/ "../../frontmjs/core/Utils.js":
/*!************************************!*\
  !*** ../../frontmjs/core/Utils.js ***!
  \************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Utils: function() { return /* binding */ Utils; }\n/* harmony export */ });\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _Field__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Field */ \"../../frontmjs/core/Field.js\");\n/* harmony import */ var _State__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./State */ \"../../frontmjs/core/State.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\n\n\nvar Utils = /*#__PURE__*/function () {\n  function Utils() {\n    _classCallCheck(this, Utils);\n  }\n  _createClass(Utils, null, [{\n    key: \"IsFieldAction\",\n    value: function IsFieldAction(action) {\n      return action === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.ACTIONS.MOVE || action === _ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.ACTIONS.CLICK;\n    }\n  }, {\n    key: \"createNewDynamicField\",\n    value: function createNewDynamicField(field, doc, state) {\n      var newField = new _Field__WEBPACK_IMPORTED_MODULE_1__.Field(field.id, {\n        title: field.title,\n        tabId: field.tabId,\n        type: field.type,\n        doc: doc,\n        state: state,\n        primaryKey: field.primaryKey,\n        value: field.value,\n        hidden: field.hidden\n      });\n      field.doc = doc.intentId;\n      var f = {\n        id: field.id,\n        type: 'Field',\n        options: field\n      };\n      state.addDynamicIntent(f);\n      return newField;\n    }\n  }, {\n    key: \"BuildRowsFromArrayOfArrays\",\n    value: function BuildRowsFromArrayOfArrays(rowsArr, newOptions) {\n      var _ = _State__WEBPACK_IMPORTED_MODULE_2__.state._;\n      var rows = [];\n      // building the rows back from array of arrays\n      _.forEach(rowsArr, function (rowArr) {\n        var row = {};\n        _.forEach(newOptions.keysForShortMessage, function (key, i) {\n          if (rowArr[0][i]) row[key] = rowArr[0][i]; // conditional added to filter out null values: importantly \"allowDelete\": null\n        });\n\n        row.docId = rowArr[1][0];\n        row.allowEdit = rowArr[1][1];\n        row.allowDelete = rowArr[1][2];\n        row.rowMenu = rowArr[1][3];\n        rows.push(row);\n      });\n      return rows;\n    }\n  }, {\n    key: \"BuildCollection\",\n    value: function BuildCollection(collection, rows, rowsArr) {\n      collection.clearRows();\n      collection.buildRowsFromArray(rows);\n      var preserveFieldDataFields = Object.keys(collection._preserveFieldData);\n      collection._rows.map(function (row, rowIdx) {\n        preserveFieldDataFields.map(function (field, fieldIdx) {\n          collection._preserveFieldData[field].map(function (fieldProp, fieldPropIdx) {\n            row.f[field][fieldProp] = rowsArr[rowIdx][2][fieldIdx][fieldPropIdx];\n          });\n        });\n      });\n    }\n  }, {\n    key: \"ExpandShortTableResponse\",\n    value: function () {\n      var _ExpandShortTableResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(shortResponse, state) {\n        var _, toSyncMessages, collectionId, TEMP_ROWS, collection, newOptions, totalExpectedRows, asyncPages, rowsArr, rows, columnTemplateRefactored, tempRows, newTempRows, _loop, i;\n        return _regeneratorRuntime().wrap(function _callee$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _ = state._;\n              _context2.next = 3;\n              return state.deviceStorage.getKeyFromStorage(_ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.TO_SYNC_WITH_BACKEND);\n            case 3:\n              toSyncMessages = _context2.sent;\n              collectionId = _.get(shortResponse, 'options.controlId');\n              if (!collectionId) {\n                _context2.next = 43;\n                break;\n              }\n              TEMP_ROWS = \"TEMP_ROWS\";\n              collection = state._intents[collectionId];\n              newOptions = _.get(shortResponse, 'options');\n              totalExpectedRows = _.get(shortResponse, 'totalExpectedRows');\n              asyncPages = _.get(shortResponse, 'asyncPages');\n              collection.overrideOptions(newOptions);\n              rowsArr = _.get(shortResponse, 'rows');\n              rows = Utils.BuildRowsFromArrayOfArrays(rowsArr, newOptions); // updating the fields from columnTemplate\n              columnTemplateRefactored = {};\n              _.forEach(newOptions.columnTemplate, function (message) {\n                columnTemplateRefactored[message.id] = message;\n              });\n              collection.document._fields.map(function (field) {\n                if (columnTemplateRefactored.hasOwnProperty(field.id)) {\n                  field.updateFieldFromMessage(columnTemplateRefactored[field.id]);\n                }\n              });\n              if (!totalExpectedRows) {\n                _context2.next = 34;\n                break;\n              }\n              _context2.next = 20;\n              return state.deviceStorage.loadDocument(collectionId, TEMP_ROWS);\n            case 20:\n              _context2.t0 = _context2.sent;\n              if (_context2.t0) {\n                _context2.next = 23;\n                break;\n              }\n              _context2.t0 = [];\n            case 23:\n              tempRows = _context2.t0;\n              newTempRows = _.union(tempRows, rows);\n              if (!(newTempRows.length < totalExpectedRows)) {\n                _context2.next = 31;\n                break;\n              }\n              _context2.next = 28;\n              return state.deviceStorage.saveDocument(collectionId, TEMP_ROWS, newTempRows);\n            case 28:\n              return _context2.abrupt(\"return\");\n            case 31:\n              rows = newTempRows;\n              _context2.next = 34;\n              return state.deviceStorage.deleteDocument(collectionId, TEMP_ROWS);\n            case 34:\n              Utils.BuildCollection(collection, rows, rowsArr);\n              _loop = /*#__PURE__*/_regeneratorRuntime().mark(function _loop() {\n                var row, primaryKey, hashedKey, fromStorage, flag;\n                return _regeneratorRuntime().wrap(function _loop$(_context) {\n                  while (1) switch (_context.prev = _context.next) {\n                    case 0:\n                      row = collection.rows[i];\n                      primaryKey = row.getPrimaryKey();\n                      hashedKey = state.sha1(JSON.stringify(primaryKey));\n                      _context.next = 5;\n                      return state.deviceStorage.loadDocument(collectionId, hashedKey);\n                    case 5:\n                      fromStorage = _context.sent;\n                      flag = 0;\n                      if (fromStorage) {\n                        flag = 1;\n                        _.forEach(toSyncMessages, function (document, collection) {\n                          if (collection === collectionId) {\n                            var toSyncCollection = state._intents[collection];\n                            _.forEach(document, function (record) {\n                              var doc = toSyncCollection.document;\n                              doc.buildDocument(record);\n                              if (_.isEqual(primaryKey, doc.getPrimaryKey())) {\n                                flag = 2;\n                                return false;\n                              }\n                            });\n                            return false;\n                          }\n                        });\n                        if (flag !== 0) {\n                          _.forEach(row.fields, function (field) {\n                            if (field.primaryKey) {\n                              field.onlineStatus = flag;\n                            }\n                          });\n                        }\n                      }\n                    case 8:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }, _loop);\n              });\n              i = 0;\n            case 37:\n              if (!(i < collection.rows.length)) {\n                _context2.next = 42;\n                break;\n              }\n              return _context2.delegateYield(_loop(), \"t1\", 39);\n            case 39:\n              i++;\n              _context2.next = 37;\n              break;\n            case 42:\n              return _context2.abrupt(\"return\", collection.message(asyncPages, true));\n            case 43:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee);\n      }));\n      function ExpandShortTableResponse(_x, _x2) {\n        return _ExpandShortTableResponse.apply(this, arguments);\n      }\n      return ExpandShortTableResponse;\n    }()\n  }, {\n    key: \"getGenericKeys\",\n    value: function getGenericKeys() {\n      return ['id', 'tabId', 'title', 'type', 'info', 'mandatory', 'validation', 'readOnly', 'primaryKey', 'value', 'fileName', 'maxLength', 'minLength', 'section', 'column', 'options', 'search', 'hidden', 'index', 'onlineStatus', 'pointType', 'iconType', 'fileScope', 'quickView ', 'maxSelectionOptions', 'height'];\n    }\n  }, {\n    key: \"getTermQueryForObject\",\n    value: function getTermQueryForObject(object, state) {\n      var _ = state._;\n      var termsArray = [];\n      _.forEach(object, function (value, key) {\n        var termObject = {};\n        termObject[key] = value;\n        var term = {\n          term: termObject\n        };\n        termsArray.push(term);\n      });\n      var queryObject = {\n        query: {\n          bool: {\n            must: termsArray\n          }\n        }\n      };\n      return queryObject;\n    }\n  }, {\n    key: \"formResponseAsObject\",\n    value: function formResponseAsObject(message) {\n      var fields = {};\n      if (message.fields) {\n        message.fields.forEach(function (field) {\n          if (field.fileName) {\n            fields[field.id] = {\n              value: field.value,\n              fileName: field.fileName\n            };\n          } else {\n            fields[field.id] = field.value;\n          }\n        });\n      } else {\n        if (message.currentField) {\n          fields[message.currentField] = message.currentFieldValue;\n        }\n      }\n      return fields;\n    }\n  }, {\n    key: \"ExpandShortFormResponse\",\n    value: function () {\n      var _ExpandShortFormResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(shortResponse, state) {\n        var _this = this;\n        var _, D, fieldKeys, fieldData, collectionData, fields, promises, results;\n        return _regeneratorRuntime().wrap(function _callee2$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _ = state._;\n              D = state.developer;\n              fieldKeys = _.get(shortResponse, \"fields.fieldKeys\", []);\n              fieldData = _.get(shortResponse, \"fields.fieldData\", []);\n              collectionData = _.get(shortResponse, \"collectionData\", {});\n              fields = [];\n              _.forEach(fieldData, function (fieldArray) {\n                var fieldObj = {};\n                _.forEach(fieldKeys, function (fieldParam, index) {\n                  if (fieldArray[index] !== null) {\n                    fieldObj[fieldParam] = fieldArray[index];\n                  }\n                });\n                fields.push(fieldObj);\n              });\n              if (!(_.get(shortResponse, 'options.version', 3) < 4)) {\n                _context3.next = 9;\n                break;\n              }\n              return _context3.abrupt(\"return\", fields);\n            case 9:\n              promises = _.map(collectionData, function (collectionResponse) {\n                return _this.ExpandShortTableResponse(collectionResponse, state);\n              });\n              _context3.next = 12;\n              return Promise.all(promises);\n            case 12:\n              results = _context3.sent;\n              _.forEach(results, function (result) {\n                var section = _.get(result, 'options.sectionId');\n                collectionData[section] = result;\n              });\n              return _context3.abrupt(\"return\", {\n                fields: fields,\n                collectionData: collectionData\n              });\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee2);\n      }));\n      function ExpandShortFormResponse(_x3, _x4) {\n        return _ExpandShortFormResponse.apply(this, arguments);\n      }\n      return ExpandShortFormResponse;\n    }()\n  }, {\n    key: \"_ProcessShortContainerResponse\",\n    value: function () {\n      var _ProcessShortContainerResponse2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(entry, state) {\n        var _, newOptions, key, rowsArr, rows, collection, options, formResponse;\n        return _regeneratorRuntime().wrap(function _callee3$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _ = state._;\n              if (!(_.get(entry, 'type') === 'table' || _.get(entry, 'type') === 'calendar' || _.get(entry, 'type') === 'map')) {\n                _context4.next = 13;\n                break;\n              }\n              newOptions = _.get(entry, 'message.options');\n              key = _.get(newOptions, 'controlId');\n              rowsArr = _.get(entry, 'message.rows');\n              rows = Utils.BuildRowsFromArrayOfArrays(rowsArr, newOptions);\n              collection = state._intents[key];\n              collection.overrideOptions(newOptions);\n              Utils.BuildCollection(collection, rows, rowsArr);\n              entry.message.options = collection.options;\n              entry.message.rows = collection.message(false, false).rows;\n              _context4.next = 21;\n              break;\n            case 13:\n              if (!(_.get(entry, 'type') === 'form2')) {\n                _context4.next = 21;\n                break;\n              }\n              options = entry.message.options;\n              _context4.next = 17;\n              return this.ExpandShortFormResponse(entry.message, state);\n            case 17:\n              formResponse = _context4.sent;\n              if (Array.isArray(formResponse)) {\n                formResponse = {\n                  fields: formResponse\n                };\n              }\n              entry.message = formResponse;\n              entry.message.options = options;\n            case 21:\n              return _context4.abrupt(\"return\", entry);\n            case 22:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee3, this);\n      }));\n      function _ProcessShortContainerResponse(_x5, _x6) {\n        return _ProcessShortContainerResponse2.apply(this, arguments);\n      }\n      return _ProcessShortContainerResponse;\n    }()\n  }, {\n    key: \"ExpandShortContainerResponse\",\n    value: function () {\n      var _ExpandShortContainerResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(shortResponse, state) {\n        var _this2 = this;\n        var _, D, promises;\n        return _regeneratorRuntime().wrap(function _callee4$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              _ = state._;\n              D = state.developer;\n              promises = _.map(shortResponse, function (entry) {\n                return _this2._ProcessShortContainerResponse(entry, state);\n              });\n              _context5.next = 5;\n              return Promise.all(promises);\n            case 5:\n              return _context5.abrupt(\"return\", _context5.sent);\n            case 6:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee4);\n      }));\n      function ExpandShortContainerResponse(_x7, _x8) {\n        return _ExpandShortContainerResponse.apply(this, arguments);\n      }\n      return ExpandShortContainerResponse;\n    }()\n  }]);\n  return Utils;\n}();\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/Utils.js?");

/***/ }),

/***/ "../../frontmjs/core/index.js":
/*!************************************!*\
  !*** ../../frontmjs/core/index.js ***!
  \************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   asyncRequest: function() { return /* binding */ asyncRequest; },\n/* harmony export */   asyncResult: function() { return /* binding */ processAsyncResult; },\n/* harmony export */   done: function() { return /* binding */ farewell; },\n/* harmony export */   init: function() { return /* binding */ greeting; },\n/* harmony export */   isActiveWithMessage: function() { return /* binding */ isActiveWithMessage; },\n/* harmony export */   next: function() { return /* binding */ processNext; },\n/* harmony export */   open: function() { return /* binding */ open; },\n/* harmony export */   version: function() { return /* binding */ version; }\n/* harmony export */ });\n/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _State__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./State */ \"../../frontmjs/core/State.js\");\n/* harmony import */ var _MessageTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MessageTypes */ \"../../frontmjs/core/MessageTypes.js\");\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Utils */ \"../../frontmjs/core/Utils.js\");\n/* harmony import */ var _ALLConstants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var _UnitTest__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./UnitTest */ \"../../frontmjs/core/UnitTest.js\");\n/* harmony import */ var _Orders__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Orders */ \"../../frontmjs/core/Orders.js\");\n/* harmony import */ var _Geofence__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Geofence */ \"../../frontmjs/core/Geofence.js\");\n/* harmony import */ var _InputQueue__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./InputQueue */ \"../../frontmjs/core/InputQueue.js\");\n/* harmony import */ var _NLP__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./NLP */ \"../../frontmjs/core/NLP.js\");\n/* harmony import */ var main_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! main.js */ \"./src/main.js\");\n/* harmony import */ var _Developer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Developer */ \"../../frontmjs/core/Developer.js\");\n/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Error */ \"../../frontmjs/core/Error.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar version = '4.0.0';\nvar ACTIONS = {\n  ASYNC_RESULT: 'asyncResult',\n  NEXT: 'next'\n};\nvar SYNC = false;\nvar iAmTheOne = null;\nvar inputQueue = new _InputQueue__WEBPACK_IMPORTED_MODULE_8__[\"default\"]();\nvar waitForRunmode = 500;\nvar timeout = function timeout(ms) {\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, ms);\n  });\n};\nvar runAction = function runAction(message, action) {\n  _State__WEBPACK_IMPORTED_MODULE_1__.state.isRunning = true;\n  switch (action) {\n    case ACTIONS.NEXT:\n      {\n        return next(message.msg, message.stateParam, message.previousMessages, message.botContext);\n      }\n    case ACTIONS.ASYNC_RESULT:\n      {\n        return asyncResult(message.result, message.stateParam, message.previousMessages, message.botContext);\n      }\n  }\n};\nvar addToQueueOrProcess = function addToQueueOrProcess(message, action) {\n  return _State__WEBPACK_IMPORTED_MODULE_1__.state.isRunning ? inputQueue.addMessage(message, action) : runAction(message, action);\n};\nvar pollAndProcess = function pollAndProcess() {\n  var nextMessage = inputQueue.pollMessage();\n  if (!nextMessage) {\n    _State__WEBPACK_IMPORTED_MODULE_1__.state.isRunning = false;\n    return {\n      status: 200\n    };\n  }\n  return runAction(nextMessage.message, nextMessage.action);\n};\nvar processNext = function processNext(msg, stateParam, previousMessages, botContext) {\n  return addToQueueOrProcess({\n    msg: msg,\n    stateParam: stateParam,\n    previousMessages: previousMessages,\n    botContext: botContext\n  }, ACTIONS.NEXT);\n};\nvar processAsyncResult = function processAsyncResult(result, stateParam, previousMessages, botContext) {\n  return addToQueueOrProcess({\n    result: result,\n    stateParam: stateParam,\n    previousMessages: previousMessages,\n    botContext: botContext\n  }, ACTIONS.ASYNC_RESULT);\n};\nvar logMessageFromUser = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          console.log('*************** message type: ' + _State__WEBPACK_IMPORTED_MODULE_1__.state.messageTypeFromUser);\n          _context.next = 3;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.info({\n            message: '*************** message type: ',\n            data: _State__WEBPACK_IMPORTED_MODULE_1__.state.messageTypeFromUser\n          });\n        case 3:\n          console.log('*************** message from user: ' + JSON.stringify(_State__WEBPACK_IMPORTED_MODULE_1__.state.messageFromUser));\n          _context.next = 6;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.info({\n            message: '*************** message from user: ',\n            data: _State__WEBPACK_IMPORTED_MODULE_1__.state.messageFromUser\n          });\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function logMessageFromUser() {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar deviceStorageUtil = {\n  conversation: '',\n  getContext: function getContext(botContext, DeviceStorage) {\n    DeviceStorage = DeviceStorage || botContext.getCapability('DeviceStorage');\n    return DeviceStorage.get(deviceStorageUtil.conversation);\n  },\n  setInContext: function setInContext(state, botContext) {\n    var DeviceStorage = botContext.getCapability('DeviceStorage');\n    return DeviceStorage.save(state.conversationId, state);\n  },\n  resetContext: function resetContext(conversationId, botContext) {\n    var DeviceStorage = botContext.getCapability('DeviceStorage');\n    return DeviceStorage.save(conversationId, {});\n  },\n  removeFromContext: function removeFromContext(key, botContext) {\n    var DeviceStorage = botContext.getCapability('DeviceStorage');\n    return deviceStorageUtil.getContext(botContext, DeviceStorage).then(function (state) {\n      delete state[key];\n      return DeviceStorage.save(deviceStorageUtil.conversation, state);\n    });\n  }\n};\nvar runMatchers = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(state) {\n    var _, start, promiseProcessed, devIntent, allIntents, _loop, _ret, i, online;\n    return _regeneratorRuntime().wrap(function _callee3$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          _ = state._;\n          _context4.next = 3;\n          return state.developer.info({\n            message: 'Starting matching event'\n          });\n        case 3:\n          start = Date.now();\n          promiseProcessed = false;\n          if (!(state.messageTypeFromUser === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.BACKEND_RESPONSE() || state.activeIntent !== '')) {\n            _context4.next = 9;\n            break;\n          }\n          promiseProcessed = true;\n          _context4.next = 26;\n          break;\n        case 9:\n          if (!state.developer.isDeveloperIntent()) {\n            _context4.next = 15;\n            break;\n          }\n          devIntent = state.developer.identifyDeveloperIntent();\n          if (devIntent) {\n            state.addActiveIntent(devIntent, false);\n          } else {\n            state.addSystemErrorToStack(12);\n            state.addActiveIntent(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT);\n          }\n          promiseProcessed = true;\n          _context4.next = 26;\n          break;\n        case 15:\n          allIntents = Object.values(state.intents);\n          _loop = /*#__PURE__*/_regeneratorRuntime().mark(function _loop() {\n            var intent, _state$messageFromUse, matchIntent;\n            return _regeneratorRuntime().wrap(function _loop$(_context3) {\n              while (1) switch (_context3.prev = _context3.next) {\n                case 0:\n                  intent = allIntents[i];\n                  if (!intent.intentId) {\n                    _context3.next = 32;\n                    break;\n                  }\n                  if (!intent.runLocation) {\n                    _context3.next = 27;\n                    break;\n                  }\n                  if (!(intent.runLocation !== _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE && intent.runLocation !== _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.CLOUD)) {\n                    _context3.next = 7;\n                    break;\n                  }\n                  state.addSystemErrorToStack(1);\n                  promiseProcessed = true;\n                  return _context3.abrupt(\"return\", {\n                    v: false\n                  });\n                case 7:\n                  matchIntent = /*#__PURE__*/function () {\n                    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n                      var action;\n                      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n                        while (1) switch (_context2.prev = _context2.next) {\n                          case 0:\n                            console.log(\"Matched intent \".concat(intent.intentId));\n                            _context2.next = 3;\n                            return state.developer.info({\n                              message: 'Intent matched to ' + intent.intentId\n                            });\n                          case 3:\n                            state.addActiveIntent(intent.intentId, intent.logHistory, intent.silentIntent);\n                            promiseProcessed = true;\n                            action = _.get(state.messageFromUser, 'action');\n                            if (action) {\n                              intent._presentEvent = action;\n                            }\n                            if (intent.runLocation === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.CLOUD && (state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT || state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.EDGE_WEBCLIENT)) state.toCustomCap = true;\n                          case 8:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }, _callee2);\n                    }));\n                    return function matchIntent() {\n                      return _ref3.apply(this, arguments);\n                    };\n                  }();\n                  if (!(intent.intentId === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.SYSTEM_INTENTS.MAIN && ((_state$messageFromUse = state.messageFromUser) === null || _state$messageFromUse === void 0 ? void 0 : _state$messageFromUse.intentId) === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.SYSTEM_INTENTS.MAIN)) {\n                    _context3.next = 13;\n                    break;\n                  }\n                  _context3.next = 11;\n                  return matchIntent();\n                case 11:\n                  _context3.next = 25;\n                  break;\n                case 13:\n                  if (!(typeof intent.onMatching === 'function')) {\n                    _context3.next = 25;\n                    break;\n                  }\n                  if (!intent.onMatching(state)) {\n                    _context3.next = 25;\n                    break;\n                  }\n                  if (!promiseProcessed) {\n                    _context3.next = 23;\n                    break;\n                  }\n                  _context3.next = 18;\n                  return state.developer.info({\n                    message: 'Second intent matched to ' + intent.intentId\n                  });\n                case 18:\n                  if (state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.RESPONSES.FORM_RESPONSE || state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.RESPONSES.TABLE_RESPONSE || state.messageTypeFromUser === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.RESPONSES.CONTAINER_RESPONSE) {\n                    state.addSystemErrorToStack(34);\n                  } else {\n                    state.addSystemErrorToStack(35);\n                  }\n                  state.removeActiveIntent();\n                  return _context3.abrupt(\"return\", {\n                    v: false\n                  });\n                case 23:\n                  _context3.next = 25;\n                  return matchIntent();\n                case 25:\n                  _context3.next = 30;\n                  break;\n                case 27:\n                  state.addSystemErrorToStack(2);\n                  promiseProcessed = true;\n                  return _context3.abrupt(\"return\", {\n                    v: false\n                  });\n                case 30:\n                  _context3.next = 35;\n                  break;\n                case 32:\n                  state.addSystemErrorToStack(21);\n                  promiseProcessed = true;\n                  return _context3.abrupt(\"return\", {\n                    v: false\n                  });\n                case 35:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }, _loop);\n          });\n          i = 0;\n        case 18:\n          if (!(i < allIntents.length)) {\n            _context4.next = 26;\n            break;\n          }\n          return _context4.delegateYield(_loop(), \"t0\", 20);\n        case 20:\n          _ret = _context4.t0;\n          if (!_ret) {\n            _context4.next = 23;\n            break;\n          }\n          return _context4.abrupt(\"return\", _ret.v);\n        case 23:\n          i++;\n          _context4.next = 18;\n          break;\n        case 26:\n          _context4.next = 28;\n          return state.online();\n        case 28:\n          online = _context4.sent;\n          if (!promiseProcessed) {\n            if (online && state.messageTypeFromUser === state.messageTypes.MESSAGE_TYPE_STRING && (state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT || state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.EDGE_WEBCLIENT)) {\n              state.toCustomCap = true;\n            }\n          } else {\n            if (!online && state.toCustomCap) {\n              state.toCustomCap = false;\n            }\n          }\n          _context4.next = 32;\n          return state.developer.logCurrentEventDurationWithStartTime('runMatchers', start, Date.now());\n        case 32:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee3);\n  }));\n  return function runMatchers(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nvar callThisIfOnError = function callThisIfOnError(response) {\n  var responseAsString = JSON.stringify(response);\n  _State__WEBPACK_IMPORTED_MODULE_1__.state.addSystemErrorToStack(5, responseAsString);\n};\nvar callCustomCap = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(state) {\n    var _start, agentGuard, requestId, stateToBackend, networkCall, response, isRequestQueued;\n    return _regeneratorRuntime().wrap(function _callee4$(_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.prev = 0;\n          console.log('************* Calling custom cap ****************');\n          _context5.next = 4;\n          return state.developer.info({\n            message: 'Calling cloud capabilities'\n          });\n        case 4:\n          state.context.wait(true);\n          _start = Date.now();\n          agentGuard = state.context.getCapability('AgentGuard');\n          requestId = state.getNewRequestId();\n          stateToBackend = state.stateToBackEnd(); //Build the call\n          networkCall = {\n            capability: 'BackendBotCap',\n            parametersObject: {\n              botId: state.context.botManifest.botId,\n              botVersion: state.context.botManifest.version,\n              command: 'asyncRequest',\n              data: stateToBackend\n            },\n            requestUuid: requestId,\n            sync: SYNC,\n            conversation: {\n              conversationId: state.conversationId,\n              bot: state.context.botManifest.botId\n            }\n          };\n          if (state.conversation.created === undefined) {\n            networkCall.conversation.participants = state.conversation.participants;\n            networkCall.conversation.onChannels = state.conversation.onChannels;\n            networkCall.conversation.closed = false;\n          }\n          networkCall.parameters = JSON.stringify(networkCall.parametersObject);\n          delete networkCall.parametersObject;\n          //Do the call\n          _context5.next = 15;\n          return agentGuard.execute(networkCall);\n        case 15:\n          response = _context5.sent;\n          isRequestQueued = (response === null || response === void 0 ? void 0 : response.queued) || false;\n          if (!isRequestQueued) {\n            _context5.next = 27;\n            break;\n          }\n          _context5.next = 20;\n          return state.online();\n        case 20:\n          if (!_context5.sent) {\n            _context5.next = 24;\n            break;\n          }\n          callThisIfOnError(response);\n          _context5.next = 25;\n          break;\n        case 24:\n          state.addStringResponse(\"Your device appears to be offline, but don't worry, I will process your message as soon as the connection is back and I will let you know.\");\n        case 25:\n          _context5.next = 35;\n          break;\n        case 27:\n          state.setWaitingCustomCap();\n          _context5.next = 30;\n          return state.developer.logCurrentEventDurationWithStartTime('callCustomCap', _start, Date.now());\n        case 30:\n          state._delayedNotification = {};\n          state._syncToCloud = {};\n          if (!state._persistentOfflineData) {\n            _context5.next = 35;\n            break;\n          }\n          _context5.next = 35;\n          return state.deviceStorage.removeKeyFromStorage(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.TO_SYNC_WITH_BACKEND);\n        case 35:\n          _context5.next = 44;\n          break;\n        case 37:\n          _context5.prev = 37;\n          _context5.t0 = _context5[\"catch\"](0);\n          console.log(\"************* Some sort of problem \".concat(JSON.stringify(_context5.t0)));\n          state.addSystemErrorToStack(5, _context5.t0);\n          _context5.next = 43;\n          return state.developer.logCurrentEventDurationWithStartTime('callCustomCap', start, Date.now());\n        case 43:\n          callThisIfOnError(_context5.t0);\n        case 44:\n        case \"end\":\n          return _context5.stop();\n      }\n    }, _callee4, null, [[0, 37]]);\n  }));\n  return function callCustomCap(_x2) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nvar runValidators = /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(state) {\n    var start, _, activeIntent, validationResult, allIntents, i, intent, errorCode;\n    return _regeneratorRuntime().wrap(function _callee5$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          start = Date.now();\n          _ = state._;\n          activeIntent = state.activeIntent;\n          validationResult = true;\n          if (activeIntent !== _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT) {\n            allIntents = Object.values(state.intents);\n            for (i = 0; i < allIntents.length; i++) {\n              intent = allIntents[i];\n              if (intent.intentId === activeIntent) {\n                if (intent.onError) {\n                  state.onError = intent.onError;\n                }\n                try {\n                  if (intent.onValidation) {\n                    intent.onValidation(state);\n                    if (_.size(state.errorStack) > 0) {}\n                  }\n                } catch (error) {\n                  errorCode = state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE ? 5 : 7;\n                  state.addSystemErrorToStack(errorCode, error.message);\n                }\n              }\n            }\n          }\n          return _context6.abrupt(\"return\", validationResult);\n        case 6:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee5);\n  }));\n  return function runValidators(_x3) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nvar runResolvers = /*#__PURE__*/function () {\n  var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(state) {\n    var EDGE_ERROR, RESOLVER_BACKEND_ERROR, start, _, activeIntent, _state$intents, intent, errorCode;\n    return _regeneratorRuntime().wrap(function _callee6$(_context7) {\n      while (1) switch (_context7.prev = _context7.next) {\n        case 0:\n          console.log('************* Resolvers method ****************');\n          _context7.next = 3;\n          return state.developer.info({\n            message: 'Starting resolution event'\n          });\n        case 3:\n          EDGE_ERROR = 5;\n          RESOLVER_BACKEND_ERROR = 7;\n          start = Date.now();\n          _ = state._;\n          activeIntent = state.activeIntent;\n          if (!(activeIntent === '')) {\n            _context7.next = 12;\n            break;\n          }\n          state.addActiveIntent(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT);\n          _context7.next = 36;\n          break;\n        case 12:\n          if (!(activeIntent === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS)) {\n            _context7.next = 15;\n            break;\n          }\n          _context7.next = 36;\n          break;\n        case 15:\n          if (!(activeIntent !== _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT)) {\n            _context7.next = 36;\n            break;\n          }\n          intent = (_state$intents = state.intents) === null || _state$intents === void 0 ? void 0 : _state$intents[activeIntent];\n          if (!(!intent || !intent.onResolution)) {\n            _context7.next = 22;\n            break;\n          }\n          state.addSystemErrorToStack(3);\n          _context7.next = 21;\n          return state.developer.logCurrentEventDurationWithStartTime('runResolvers', start, Date.now());\n        case 21:\n          return _context7.abrupt(\"return\");\n        case 22:\n          _context7.prev = 22;\n          _context7.next = 25;\n          return intent.onResolution(state);\n        case 25:\n          _context7.next = 27;\n          return state.developer.logCurrentEventDurationWithStartTime('runResolvers', start, Date.now());\n        case 27:\n          return _context7.abrupt(\"return\", state.recordActivity({\n            stamp: 1\n          }));\n        case 30:\n          _context7.prev = 30;\n          _context7.t0 = _context7[\"catch\"](22);\n          errorCode = state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE ? EDGE_ERROR : RESOLVER_BACKEND_ERROR;\n          state.addSystemErrorToStack(errorCode, 'Error processing resolution ' + _context7.t0.message);\n          _context7.next = 36;\n          return state.developer.logCurrentEventDurationWithStartTime('runResolvers', start, Date.now());\n        case 36:\n        case \"end\":\n          return _context7.stop();\n      }\n    }, _callee6, null, [[22, 30]]);\n  }));\n  return function runResolvers(_x4) {\n    return _ref6.apply(this, arguments);\n  };\n}();\nvar msgState = {\n  msgList: []\n};\nvar tellOrTest = function tellOrTest(state, msg, botContext) {\n  if (state.unitTestMode) {\n    var currentUnitTest;\n    Object.values(state.intents).forEach(function (intent) {\n      if (intent.intentId === state.activeIntent && intent.runLocation === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE) {\n        currentUnitTest = intent;\n        return false;\n      }\n    });\n    if (currentUnitTest) {\n      return currentUnitTest.onVerification().then(function () {\n        tell(_UnitTest__WEBPACK_IMPORTED_MODULE_5__.UnitTest.VERIFICATION_RUN_MSG(), botContext);\n      });\n    }\n  } else {\n    tell(msg, botContext);\n  }\n};\nvar tell = function tell(msg, botContext) {\n  return botContext.tell(msg);\n};\nvar syncData = /*#__PURE__*/function () {\n  var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(state) {\n    var _, promisesArray, dataToSync;\n    return _regeneratorRuntime().wrap(function _callee7$(_context8) {\n      while (1) switch (_context8.prev = _context8.next) {\n        case 0:\n          if (state.persistentOfflineData) {\n            _context8.next = 2;\n            break;\n          }\n          return _context8.abrupt(\"return\");\n        case 2:\n          _ = state._;\n          promisesArray = [];\n          if (!(state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE && !(state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.WEBCLIENT))) {\n            _context8.next = 20;\n            break;\n          }\n          _.forEach(state._syncToEdge, function (documents, collection) {\n            _.forEach(documents, function (value, key) {\n              if (collection === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.PERSISTED_STORAGE) {\n                promisesArray.push(state.deviceStorage.saveKeyInStorage(key, value));\n              } else {\n                promisesArray.push(state.deviceStorage.saveDocument(collection, key, value));\n              }\n            });\n          });\n          if (!(promisesArray.length > 0)) {\n            _context8.next = 20;\n            break;\n          }\n          _context8.next = 9;\n          return Promise.all(promisesArray);\n        case 9:\n          _context8.next = 11;\n          return state.online();\n        case 11:\n          if (!_context8.sent) {\n            _context8.next = 15;\n            break;\n          }\n          state._syncToEdge = {};\n          _context8.next = 20;\n          break;\n        case 15:\n          dataToSync = state.deviceStorage.getKeyFromStorage(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.TO_SYNC_WITH_BACKEND);\n          _.forEach(state._syncToCloud, function (documents, collection) {\n            var collectionObject = dataToSync[collection] || {};\n            _.forEach(documents, function (value, key) {\n              collectionObject[key] = value;\n            });\n            dataToSync[collection] = collectionObject;\n          });\n          if (!(_.size(dataToSync) > 0)) {\n            _context8.next = 20;\n            break;\n          }\n          _context8.next = 20;\n          return state.deviceStorage.saveKeyInStorage(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.TO_SYNC_WITH_BACKEND, dataToSync);\n        case 20:\n        case \"end\":\n          return _context8.stop();\n      }\n    }, _callee7);\n  }));\n  return function syncData(_x5) {\n    return _ref7.apply(this, arguments);\n  };\n}();\nvar processShortResponse = /*#__PURE__*/function () {\n  var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(state) {\n    var _, D, promisesArray;\n    return _regeneratorRuntime().wrap(function _callee11$(_context12) {\n      while (1) switch (_context12.prev = _context12.next) {\n        case 0:\n          _ = state._;\n          D = state.developer;\n          if (!(state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE && state.client !== _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.WEBCLIENT)) {\n            _context12.next = 7;\n            break;\n          }\n          promisesArray = [];\n          _.forEach(state.responsesArray, function (response) {\n            if (response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.SHORT_TABLE_RESPONSE()) {\n              var processShortTableResponse = /*#__PURE__*/function () {\n                var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(response) {\n                  var tableMessage;\n                  return _regeneratorRuntime().wrap(function _callee8$(_context9) {\n                    while (1) switch (_context9.prev = _context9.next) {\n                      case 0:\n                        D.log({\n                          message: 'Calling expand table'\n                        });\n                        _context9.next = 3;\n                        return _Utils__WEBPACK_IMPORTED_MODULE_3__.Utils.ExpandShortTableResponse(response.message, state);\n                      case 3:\n                        tableMessage = _context9.sent;\n                        if (tableMessage) {\n                          response.message = tableMessage;\n                          response.type = 'table';\n                        } else {\n                          delete response.message;\n                          response.type = 'silent';\n                        }\n                      case 5:\n                      case \"end\":\n                        return _context9.stop();\n                    }\n                  }, _callee8);\n                }));\n                return function processShortTableResponse(_x7) {\n                  return _ref9.apply(this, arguments);\n                };\n              }();\n              promisesArray.push(processShortTableResponse(response));\n            } else if (response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.SHORT_CONTAINER_RESPONSE()) {\n              var _processShortTableResponse = /*#__PURE__*/function () {\n                var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(response) {\n                  var containerData, containerMessage;\n                  return _regeneratorRuntime().wrap(function _callee9$(_context10) {\n                    while (1) switch (_context10.prev = _context10.next) {\n                      case 0:\n                        containerData = _.get(response, 'message.fields');\n                        if (!containerData) {\n                          _context10.next = 6;\n                          break;\n                        }\n                        _context10.next = 4;\n                        return _Utils__WEBPACK_IMPORTED_MODULE_3__.Utils.ExpandShortContainerResponse(containerData, state);\n                      case 4:\n                        containerMessage = _context10.sent;\n                        if (containerMessage) {\n                          response.message.fields = containerMessage;\n                          response.type = 'container';\n                        }\n                      case 6:\n                      case \"end\":\n                        return _context10.stop();\n                    }\n                  }, _callee9);\n                }));\n                return function _processShortTableResponse(_x8) {\n                  return _ref10.apply(this, arguments);\n                };\n              }();\n              promisesArray.push(_processShortTableResponse(response));\n            } else if (response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.SHORT_FORM_RESPONSE()) {\n              var processShortFormResponse = /*#__PURE__*/function () {\n                var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(response) {\n                  var formData, formMessage;\n                  return _regeneratorRuntime().wrap(function _callee10$(_context11) {\n                    while (1) switch (_context11.prev = _context11.next) {\n                      case 0:\n                        formData = _.get(response, 'message', {});\n                        if (!formData.fields) {\n                          _context11.next = 6;\n                          break;\n                        }\n                        _context11.next = 4;\n                        return _Utils__WEBPACK_IMPORTED_MODULE_3__.Utils.ExpandShortFormResponse(formData, state);\n                      case 4:\n                        formMessage = _context11.sent;\n                        if (formMessage) {\n                          response.message.fields = formMessage;\n                          response.type = 'form2';\n                        }\n                      case 6:\n                      case \"end\":\n                        return _context11.stop();\n                    }\n                  }, _callee10);\n                }));\n                return function processShortFormResponse(_x9) {\n                  return _ref11.apply(this, arguments);\n                };\n              }();\n              promisesArray.push(processShortFormResponse(response));\n            }\n          });\n          _context12.next = 7;\n          return Promise.all(promisesArray);\n        case 7:\n        case \"end\":\n          return _context12.stop();\n      }\n    }, _callee11);\n  }));\n  return function processShortResponse(_x6) {\n    return _ref8.apply(this, arguments);\n  };\n}();\nvar startInfoLogs = /*#__PURE__*/function () {\n  var _ref12 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(state, event, stateFromStorage) {\n    return _regeneratorRuntime().wrap(function _callee12$(_context13) {\n      while (1) switch (_context13.prev = _context13.next) {\n        case 0:\n          _context13.next = 2;\n          return state.developer.info({\n            message: 'State initialised (Next)'\n          });\n        case 2:\n          _context13.next = 4;\n          return state.developer.info({\n            message: 'State from storage: ',\n            data: stateFromStorage\n          });\n        case 4:\n        case \"end\":\n          return _context13.stop();\n      }\n    }, _callee12);\n  }));\n  return function startInfoLogs(_x10, _x11, _x12) {\n    return _ref12.apply(this, arguments);\n  };\n}();\nvar logErrorWithMessage = /*#__PURE__*/function () {\n  var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(error) {\n    return _regeneratorRuntime().wrap(function _callee13$(_context14) {\n      while (1) switch (_context14.prev = _context14.next) {\n        case 0:\n        case \"end\":\n          return _context14.stop();\n      }\n    }, _callee13);\n  }));\n  return function logErrorWithMessage(_x13) {\n    return _ref13.apply(this, arguments);\n  };\n}();\nvar greeting = function greeting(state, previousMessages, botContext) {\n  iAmTheOne = 'Initialised';\n  console.log(\"Starting init\");\n  var message = {\n    messageType: _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.MESSAGE_TYPES.OBJECT,\n    messageFromUser: {\n      intentId: _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.SYSTEM_INTENTS.MAIN\n    }\n  };\n  return next(message, state, previousMessages, botContext);\n};\nvar runPredictors = /*#__PURE__*/function () {\n  var _ref14 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(state) {\n    var start, _, predictors, sortedPredictions, allKeys, index, intent, predictionObject, predictor, _index;\n    return _regeneratorRuntime().wrap(function _callee14$(_context15) {\n      while (1) switch (_context15.prev = _context15.next) {\n        case 0:\n          start = Date.now();\n          _ = state._;\n          if (!(_.size(state.smartSuggestionsArray) === 0 && !state.blockSuggestions)) {\n            _context15.next = 32;\n            break;\n          }\n          predictors = false;\n          sortedPredictions = [];\n          allKeys = Object.keys(state.intents);\n          index = 0;\n        case 7:\n          if (!(index < allKeys.length)) {\n            _context15.next = 31;\n            break;\n          }\n          intent = state.intents[allKeys[index]];\n          predictionObject = {};\n          if (!(_.size(intent.suggestionsArray) > 0)) {\n            _context15.next = 28;\n            break;\n          }\n          predictor = intent.onPrediction;\n          if (!predictor) {\n            _context15.next = 25;\n            break;\n          }\n          _context15.prev = 13;\n          predictors = true;\n          _context15.next = 17;\n          return predictor();\n        case 17:\n          predictionObject.weight = _context15.sent;\n          _context15.next = 23;\n          break;\n        case 20:\n          _context15.prev = 20;\n          _context15.t0 = _context15[\"catch\"](13);\n          state.addSystemErrorToStack(27, _context15.t0.errorMessage);\n        case 23:\n          _context15.next = 26;\n          break;\n        case 25:\n          predictionObject.weight = 1;\n        case 26:\n          predictionObject.suggestionsArray = intent.suggestionsArray;\n          if (predictionObject.weight > 0) {\n            _index = _.sortedIndexBy(sortedPredictions, predictionObject, 'weight');\n            sortedPredictions.splice(_index, 0, predictionObject);\n          }\n        case 28:\n          index++;\n          _context15.next = 7;\n          break;\n        case 31:\n          if (predictors) {\n            _.each(sortedPredictions, function (predictionObject) {\n              state.addSmartSuggestionsArray(predictionObject.suggestionsArray);\n            });\n            state.smartSuggestionsArray = _.reverse(state.smartSuggestionsArray);\n          }\n        case 32:\n          _context15.next = 34;\n          return state.developer.logCurrentEventDurationWithStartTime('runPredictors', start, Date.now());\n        case 34:\n        case \"end\":\n          return _context15.stop();\n      }\n    }, _callee14, null, [[13, 20]]);\n  }));\n  return function runPredictors(_x14) {\n    return _ref14.apply(this, arguments);\n  };\n}();\nvar controller = /*#__PURE__*/function () {\n  var _ref15 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(state) {\n    var _start2, _, intentLocation, errorCode;\n    return _regeneratorRuntime().wrap(function _callee15$(_context16) {\n      while (1) switch (_context16.prev = _context16.next) {\n        case 0:\n          _context16.prev = 0;\n          _start2 = Date.now();\n          _ = state._;\n          _context16.next = 5;\n          return state.developer.info({\n            message: 'Starting controller event'\n          });\n        case 5:\n          _context16.next = 7;\n          return state.online();\n        case 7:\n          state.amIOnline = _context16.sent;\n          _context16.next = 10;\n          return matchingLogic(state);\n        case 10:\n          if (!(state.activeIntent !== _Intent__WEBPACK_IMPORTED_MODULE_0__.Intent.SPEECH() && state.activeIntent !== _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT)) {\n            _context16.next = 45;\n            break;\n          }\n          _context16.next = 13;\n          return state.onStart();\n        case 13:\n          if (!(state.activeIntent === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.SYSTEM_INTENTS.MAIN)) {\n            _context16.next = 16;\n            break;\n          }\n          _context16.next = 16;\n          return state.addRunModeResponse();\n        case 16:\n          if (!state.toCustomCap) {\n            _context16.next = 23;\n            break;\n          }\n          _context16.next = 19;\n          return callCustomCap(state);\n        case 19:\n          _context16.next = 21;\n          return state.developer.logCurrentEventDurationWithStartTime('controller', _start2, Date.now());\n        case 21:\n          _context16.next = 45;\n          break;\n        case 23:\n          if (!(state.onlineRequired && !state.amIOnline)) {\n            _context16.next = 26;\n            break;\n          }\n          state.addSystemErrorToStack(56);\n          return _context16.abrupt(\"return\");\n        case 26:\n          _context16.next = 28;\n          return state.runAllOnInits();\n        case 28:\n          _context16.next = 30;\n          return logMessageFromUser();\n        case 30:\n          _context16.next = 32;\n          return runValidators(state);\n        case 32:\n          if (!_context16.sent) {\n            _context16.next = 45;\n            break;\n          }\n          intentLocation = _.get(state, \"intents.\".concat(state.activeIntent, \".runLocation\"), _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE);\n          if (!(state.location === intentLocation || state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE)) {\n            _context16.next = 43;\n            break;\n          }\n          _context16.next = 37;\n          return runResolvers(state);\n        case 37:\n          _context16.next = 39;\n          return state.developer.logCurrentEventDurationWithStartTime('controller', _start2, Date.now());\n        case 39:\n          _context16.next = 41;\n          return state.storeAutoSaveBuffer();\n        case 41:\n          _context16.next = 45;\n          break;\n        case 43:\n          _context16.next = 45;\n          return state.developer.warning({\n            message: \"Bot tried to run a \".concat(intentLocation, \" intent in \").concat(state.location),\n            data: state.activeIntent\n          });\n        case 45:\n          _context16.next = 52;\n          break;\n        case 47:\n          _context16.prev = 47;\n          _context16.t0 = _context16[\"catch\"](0);\n          console.log('Error in controller');\n          errorCode = state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE ? 5 : 7;\n          state.addSystemErrorToStack(errorCode, _context16.t0.message);\n        case 52:\n        case \"end\":\n          return _context16.stop();\n      }\n    }, _callee15, null, [[0, 47]]);\n  }));\n  return function controller(_x15) {\n    return _ref15.apply(this, arguments);\n  };\n}();\nvar view = /*#__PURE__*/function () {\n  var _ref16 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17(state, botContext) {\n    var _, start;\n    return _regeneratorRuntime().wrap(function _callee17$(_context18) {\n      while (1) switch (_context18.prev = _context18.next) {\n        case 0:\n          _context18.next = 2;\n          return state.developer.info({\n            message: 'Starting view event'\n          });\n        case 2:\n          _ = state._;\n          start = Date.now();\n          return _context18.abrupt(\"return\", new Promise( /*#__PURE__*/function () {\n            var _ref17 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16(resolve, reject) {\n              var noResponse, smartSuggestions, i, response, Message, message, cards, previews, form, table, list, msg, _list, options, map, mapObject, _msg, _response$message, amount, currency, description, paymentCode, transactionId, payments, chart, _response$message2, _response$message3, _response$message4, _response$message5, _msg2, MessageForSuggestions, messageForSuggestions;\n              return _regeneratorRuntime().wrap(function _callee16$(_context17) {\n                while (1) switch (_context17.prev = _context17.next) {\n                  case 0:\n                    if (!(!state.conversational && !state.inError && state.waitingCustomCap > 0 && _.get(state.responsesArray, 'length', 0) === 0)) {\n                      _context17.next = 5;\n                      break;\n                    }\n                    _context17.next = 3;\n                    return state.developer.info({\n                      message: 'Ending here',\n                      data: {\n                        conversational: state.conversational,\n                        waitingForCustomCap: state.waitingCustomCap,\n                        responsesArrayLength: _.get(state.responsesArray, 'length', 0)\n                      }\n                    });\n                  case 3:\n                    resolve();\n                    return _context17.abrupt(\"return\");\n                  case 5:\n                    if (!(state.conversational && !state.inSilence)) {\n                      _context17.next = 8;\n                      break;\n                    }\n                    _context17.next = 8;\n                    return runPredictors(state);\n                  case 8:\n                    if (!state.inError) {\n                      _context17.next = 12;\n                      break;\n                    }\n                    state.onError(state);\n                    _context17.next = 16;\n                    break;\n                  case 12:\n                    if (!(state.responsesArray.length === 0 && state.smartSuggestionsArray.length === 0 && !state.sendMessageParam && !state.toCustomCap && !state.autoResponse)) {\n                      _context17.next = 16;\n                      break;\n                    }\n                    noResponse = {\n                      responsesQ: state.responsesArray.length,\n                      suggestionsQ: state.smartSuggestionsArray.length,\n                      sendMSG: state.sendMessageParam,\n                      toCustomCap: state.toCustomCap,\n                      activeIntent: state.activeIntent,\n                      messageTypeFromUser: state.messageTypeFromUser,\n                      messageFromUser: state.messageFromUser\n                    };\n                    _context17.next = 16;\n                    return state.developer.warning({\n                      message: _Error__WEBPACK_IMPORTED_MODULE_12__.Error.getErrorMessageforCodeAndLang(63),\n                      errorCode: 63,\n                      data: noResponse\n                    });\n                  case 16:\n                    state.removeActiveIntent();\n                    if (!state.silentIntent) {\n                      _context17.next = 22;\n                      break;\n                    }\n                    state.clearResponseArray();\n                    state.clearError();\n                    resolve();\n                    return _context17.abrupt(\"return\");\n                  case 22:\n                    smartSuggestions = state.smartSuggestionsArray;\n                    if (!(_.size(state.responsesArray) > 0)) {\n                      _context17.next = 274;\n                      break;\n                    }\n                    state.intentResolved = true;\n                    i = 0;\n                  case 26:\n                    if (!(i < state.responsesArray.length)) {\n                      _context17.next = 273;\n                      break;\n                    }\n                    response = state.responsesArray[i];\n                    Message = state.context.getCapability('Message');\n                    message = new Message({\n                      uuid: response.messageId\n                    });\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_STRING)) {\n                      _context17.next = 36;\n                      break;\n                    }\n                    message.stringMessage(response.message);\n                    _context17.next = 34;\n                    return tellOrTest(state, message, state.context);\n                  case 34:\n                    _context17.next = 270;\n                    break;\n                  case 36:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_WEB_CARD)) {\n                      _context17.next = 44;\n                      break;\n                    }\n                    cards = response.message.cards;\n                    previews = response.message.previews;\n                    message.webCard(cards, previews);\n                    //tell(message, state.context);\n                    _context17.next = 42;\n                    return tellOrTest(state, message, state.context);\n                  case 42:\n                    _context17.next = 270;\n                    break;\n                  case 44:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_FORM2)) {\n                      _context17.next = 51;\n                      break;\n                    }\n                    form = response.message;\n                    message.form2Message(form.fields, form.options);\n                    _context17.next = 49;\n                    return tellOrTest(state, message, state.context);\n                  case 49:\n                    _context17.next = 270;\n                    break;\n                  case 51:\n                    if (!(response.type === 'form_live_changes')) {\n                      _context17.next = 57;\n                      break;\n                    }\n                    if (response.message.result) {\n                      message.form2Message(response.message.result, response.message.options);\n                    } else {\n                      message.form2Message(response.message.options);\n                    }\n                    _context17.next = 55;\n                    return tellOrTest(state, message, state.context);\n                  case 55:\n                    _context17.next = 270;\n                    break;\n                  case 57:\n                    if (!(response.type === 'table_live_changes')) {\n                      _context17.next = 63;\n                      break;\n                    }\n                    //state.developer.debug({message: 'Live form change ', data:response.message});\n                    message.tableMessage(response.message.result, response.message.options);\n                    _context17.next = 61;\n                    return tellOrTest(state, message, state.context);\n                  case 61:\n                    _context17.next = 270;\n                    break;\n                  case 63:\n                    if (!(response.type === 'form_close')) {\n                      _context17.next = 70;\n                      break;\n                    }\n                    if (!message.closeFormMessage) {\n                      _context17.next = 68;\n                      break;\n                    }\n                    message.closeFormMessage(response.message);\n                    _context17.next = 68;\n                    return tellOrTest(state, message, state.context);\n                  case 68:\n                    _context17.next = 270;\n                    break;\n                  case 70:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_SMART_SUGGESTIONS)) {\n                      _context17.next = 74;\n                      break;\n                    }\n                    smartSuggestions = response.message;\n                    _context17.next = 270;\n                    break;\n                  case 74:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_TABLE)) {\n                      _context17.next = 81;\n                      break;\n                    }\n                    table = response.message;\n                    if (table.options && table.options.style === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.COLLECTION_TYPES.CALENDAR) {\n                      message.calendarMessage(table.rows, table.options);\n                    } else if (table.options && table.options.style === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.COLLECTION_TYPES.MAP) {\n                      message.mapMessage(table.rows, table.options);\n                    } else {\n                      message.tableMessage(table.rows, table.options);\n                    }\n                    _context17.next = 79;\n                    return tellOrTest(state, message, state.context);\n                  case 79:\n                    _context17.next = 270;\n                    break;\n                  case 81:\n                    if (!(response.type === 'data_card')) {\n                      _context17.next = 95;\n                      break;\n                    }\n                    if (!(state.conversation.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT)) {\n                      _context17.next = 89;\n                      break;\n                    }\n                    list = response.message;\n                    message.dataCard(list);\n                    _context17.next = 87;\n                    return tellOrTest(state, message, state.context);\n                  case 87:\n                    _context17.next = 93;\n                    break;\n                  case 89:\n                    msg = 'Data cards are not yet available in your client';\n                    state.addSystemErrorToStack(5, msg);\n                    _context17.next = 93;\n                    return tellOrTest(state, msg, state.context);\n                  case 93:\n                    _context17.next = 270;\n                    break;\n                  case 95:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_CARDS)) {\n                      _context17.next = 103;\n                      break;\n                    }\n                    _list = response.message.cards;\n                    options = response.message.options;\n                    message.cards(_list, options);\n                    _context17.next = 101;\n                    return tellOrTest(state, message, state.context);\n                  case 101:\n                    _context17.next = 270;\n                    break;\n                  case 103:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_MAP)) {\n                      _context17.next = 111;\n                      break;\n                    }\n                    map = response.message;\n                    mapObject = {\n                      region: map.region,\n                      markers: _.get(map, 'markers'),\n                      polylines: _.get(map, 'polylines'),\n                      planeRoutes: _.get(map, 'planeRoutes'),\n                      cards: _.get(map, 'cards'),\n                      geoJsonUrl: _.get(map, 'geoJsonUrl', '')\n                    };\n                    message.mapMessage(mapObject, map.options);\n                    _context17.next = 109;\n                    return tellOrTest(state, message, state.context);\n                  case 109:\n                    _context17.next = 270;\n                    break;\n                  case 111:\n                    if (!(response.type === 'standard_notification')) {\n                      _context17.next = 117;\n                      break;\n                    }\n                    message.standardNotification(response.message);\n                    _context17.next = 115;\n                    return tellOrTest(state, message, state.context);\n                  case 115:\n                    _context17.next = 270;\n                    break;\n                  case 117:\n                    if (!(response.type === 'critical_notification')) {\n                      _context17.next = 123;\n                      break;\n                    }\n                    message.criticalNotification(response.message);\n                    _context17.next = 121;\n                    return tellOrTest(state, message, state.context);\n                  case 121:\n                    _context17.next = 270;\n                    break;\n                  case 123:\n                    if (!(response.type === 'authorization_request')) {\n                      _context17.next = 129;\n                      break;\n                    }\n                    message.authorizationRequest(response.message);\n                    _context17.next = 127;\n                    return tellOrTest(state, message, state.context);\n                  case 127:\n                    _context17.next = 270;\n                    break;\n                  case 129:\n                    if (!(response.type === 'stripe')) {\n                      _context17.next = 144;\n                      break;\n                    }\n                    if (!(state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.MOBILECLIENT || state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.EDGE_WEBCLIENT)) {\n                      _context17.next = 137;\n                      break;\n                    }\n                    _msg = 'Message type not supported on this client';\n                    state.addSystemErrorToStack(5, _msg);\n                    _context17.next = 135;\n                    return tellOrTest(state, _msg, state.context);\n                  case 135:\n                    _context17.next = 142;\n                    break;\n                  case 137:\n                    _response$message = response.message, amount = _response$message.amount, currency = _response$message.currency, description = _response$message.description, paymentCode = _response$message.paymentCode;\n                    if (_.isUndefined(paymentCode) || _.isEmpty(paymentCode)) {\n                      paymentCode = _Orders__WEBPACK_IMPORTED_MODULE_6__.Orders.PAYMENT_CODES().TOP_UP_WALLET;\n                    }\n                    transactionId = state.orders.createNewStripeTransaction(amount, currency, description);\n                    payments = state.context.getCapability('Stripe');\n                    payments.startPayment(transactionId, amount, currency, description, state.context, paymentCode);\n                  case 142:\n                    _context17.next = 270;\n                    break;\n                  case 144:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_CHART)) {\n                      _context17.next = 151;\n                      break;\n                    }\n                    chart = response.message;\n                    message.chartMessage(chart.data, chart.options);\n                    _context17.next = 149;\n                    return tellOrTest(state, message, state.context);\n                  case 149:\n                    _context17.next = 270;\n                    break;\n                  case 151:\n                    if (!(response.type === 'slider')) {\n                      _context17.next = 157;\n                      break;\n                    }\n                    message.sliderMessage(response.message.list, response.message.options);\n                    _context17.next = 155;\n                    return tellOrTest(state, message, state.context);\n                  case 155:\n                    _context17.next = 270;\n                    break;\n                  case 157:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_VIDEO)) {\n                      _context17.next = 163;\n                      break;\n                    }\n                    message.videoMessage(response.message);\n                    _context17.next = 161;\n                    return tellOrTest(state, message, state.context);\n                  case 161:\n                    _context17.next = 270;\n                    break;\n                  case 163:\n                    if (!(response.type === 'trackerForm')) {\n                      _context17.next = 169;\n                      break;\n                    }\n                    message.trackingViewMessage(response.message.data, response.message.options);\n                    _context17.next = 167;\n                    return tellOrTest(state, message, state.context);\n                  case 167:\n                    _context17.next = 270;\n                    break;\n                  case 169:\n                    if (!(response.type === 'html')) {\n                      _context17.next = 175;\n                      break;\n                    }\n                    message.htmlMessage(response.message.message, response.message.options);\n                    _context17.next = 173;\n                    return tellOrTest(state, message, state.context);\n                  case 173:\n                    _context17.next = 270;\n                    break;\n                  case 175:\n                    if (!(response.type === 'container')) {\n                      _context17.next = 181;\n                      break;\n                    }\n                    message.containerMessage(response.message.fields, response.message.options);\n                    _context17.next = 179;\n                    return tellOrTest(state, message, state.context);\n                  case 179:\n                    _context17.next = 270;\n                    break;\n                  case 181:\n                    if (!(response.type === 'close_control')) {\n                      _context17.next = 185;\n                      break;\n                    }\n                    message.closeControlMessage(response.message);\n                    _context17.next = 270;\n                    break;\n                  case 185:\n                    if (!(response.type === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.RESPONSES.VIDEO_CALL)) {\n                      _context17.next = 191;\n                      break;\n                    }\n                    message.videoCallMessage((_response$message2 = response.message) === null || _response$message2 === void 0 ? void 0 : _response$message2.data, (_response$message3 = response.message) === null || _response$message3 === void 0 ? void 0 : _response$message3.options);\n                    _context17.next = 189;\n                    return tellOrTest(state, message, state.context);\n                  case 189:\n                    _context17.next = 270;\n                    break;\n                  case 191:\n                    if (!(response.type === 'menuMessage')) {\n                      _context17.next = 197;\n                      break;\n                    }\n                    message.menuMessage(response.message);\n                    _context17.next = 195;\n                    return tellOrTest(state, message, state.context);\n                  case 195:\n                    _context17.next = 270;\n                    break;\n                  case 197:\n                    if (!(response.type === 'sound')) {\n                      _context17.next = 203;\n                      break;\n                    }\n                    message.soundResponse(response.message);\n                    _context17.next = 201;\n                    return tellOrTest(state, message, state.context);\n                  case 201:\n                    _context17.next = 270;\n                    break;\n                  case 203:\n                    if (!(response.type === 'image')) {\n                      _context17.next = 209;\n                      break;\n                    }\n                    message.imageMessage(response.message);\n                    _context17.next = 207;\n                    return tellOrTest(state, message, state.context);\n                  case 207:\n                    _context17.next = 270;\n                    break;\n                  case 209:\n                    if (!(response.type === state.messageTypes.MESSAGE_TYPE_CSV)) {\n                      _context17.next = 217;\n                      break;\n                    }\n                    message.csvMessage(response.message);\n                    _context17.next = 213;\n                    return tellOrTest(state, message, state.context);\n                  case 213:\n                    _context17.next = 215;\n                    return tellOrTest(state, message, state.context);\n                  case 215:\n                    _context17.next = 270;\n                    break;\n                  case 217:\n                    if (!(response.type === _Geofence__WEBPACK_IMPORTED_MODULE_7__.Geofence.GEOFENCE_MESSAGE())) {\n                      _context17.next = 223;\n                      break;\n                    }\n                    message.geofenceMessage(response.message.coordinates, response.message.options);\n                    _context17.next = 221;\n                    return tellOrTest(state, message, state.context);\n                  case 221:\n                    _context17.next = 270;\n                    break;\n                  case 223:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.SHORT_TABLE_RESPONSE())) {\n                      _context17.next = 226;\n                      break;\n                    }\n                    _context17.next = 270;\n                    break;\n                  case 226:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.SHORT_CONTAINER_RESPONSE())) {\n                      _context17.next = 229;\n                      break;\n                    }\n                    _context17.next = 270;\n                    break;\n                  case 229:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.MESSAGE_TYPE_SURVEY())) {\n                      _context17.next = 235;\n                      break;\n                    }\n                    message.surveyMessage(response.message.data, response.message.options);\n                    _context17.next = 233;\n                    return tellOrTest(state, message, state.context);\n                  case 233:\n                    _context17.next = 270;\n                    break;\n                  case 235:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.MESSAGE_VOICE_CALL())) {\n                      _context17.next = 241;\n                      break;\n                    }\n                    message.voiceCall(response.message);\n                    _context17.next = 239;\n                    return tellOrTest(state, message, state.context);\n                  case 239:\n                    _context17.next = 270;\n                    break;\n                  case 241:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.MESSAGE_TYPE_TIMELINE_LIST())) {\n                      _context17.next = 247;\n                      break;\n                    }\n                    message.timelinesListMessage(response.message, response.message.options);\n                    _context17.next = 245;\n                    return tellOrTest(state, message, state.context);\n                  case 245:\n                    _context17.next = 270;\n                    break;\n                  case 247:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.MESSAGE_TYPE_TIMELINE_POST())) {\n                      _context17.next = 253;\n                      break;\n                    }\n                    message.timelinesPostMessage(response.message);\n                    _context17.next = 251;\n                    return tellOrTest(state, message, state.context);\n                  case 251:\n                    _context17.next = 270;\n                    break;\n                  case 253:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.DASHBOARD())) {\n                      _context17.next = 259;\n                      break;\n                    }\n                    message.dashboardMessage({}, response.message.options);\n                    _context17.next = 257;\n                    return tellOrTest(state, message, state.context);\n                  case 257:\n                    _context17.next = 270;\n                    break;\n                  case 259:\n                    if (!(response.type === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.MESSAGE_TYPE_AICC_STRING())) {\n                      _context17.next = 265;\n                      break;\n                    }\n                    message.aiccPlayer((_response$message4 = response.message) === null || _response$message4 === void 0 ? void 0 : _response$message4.data, (_response$message5 = response.message) === null || _response$message5 === void 0 ? void 0 : _response$message5.options);\n                    _context17.next = 263;\n                    return tellOrTest(state, message, state.context);\n                  case 263:\n                    _context17.next = 270;\n                    break;\n                  case 265:\n                    if (!(response.type !== 'silent')) {\n                      _context17.next = 270;\n                      break;\n                    }\n                    _msg2 = 'Message type not supported';\n                    state.addSystemErrorToStack(5, _msg2);\n                    _context17.next = 270;\n                    return tellOrTest(state, _msg2, state.context);\n                  case 270:\n                    i++;\n                    _context17.next = 26;\n                    break;\n                  case 273:\n                    state.waitingCustomCap = 0;\n                  case 274:\n                    state.clearResponseArray();\n                    state.clearError();\n                    MessageForSuggestions = state.context.getCapability('Message');\n                    messageForSuggestions = new MessageForSuggestions();\n                    if (!(_.size(state.smartSuggestionsArray) > 0)) {\n                      _context17.next = 284;\n                      break;\n                    }\n                    messageForSuggestions.smartSuggestions(smartSuggestions);\n                    _context17.next = 282;\n                    return tellOrTest(state, messageForSuggestions, state.context);\n                  case 282:\n                    _context17.next = 288;\n                    break;\n                  case 284:\n                    if (!(state.blockSuggestions || state.inSilence)) {\n                      _context17.next = 288;\n                      break;\n                    }\n                    messageForSuggestions.smartSuggestions([]);\n                    _context17.next = 288;\n                    return tellOrTest(state, messageForSuggestions, state.context);\n                  case 288:\n                    state.clearSmartSuggestionsArray();\n                    state.resetOnErrorMethod();\n                    state.toCustomCap = false;\n                    resolve();\n                    _context17.next = 294;\n                    return state.developer.logCurrentEventDurationWithStartTime('view', start, Date.now());\n                  case 294:\n                  case \"end\":\n                    return _context17.stop();\n                }\n              }, _callee16);\n            }));\n            return function (_x18, _x19) {\n              return _ref17.apply(this, arguments);\n            };\n          }()));\n        case 5:\n        case \"end\":\n          return _context18.stop();\n      }\n    }, _callee17);\n  }));\n  return function view(_x16, _x17) {\n    return _ref16.apply(this, arguments);\n  };\n}();\nvar initUser = /*#__PURE__*/function () {\n  var _ref18 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18(botContext) {\n    var user, authContext;\n    return _regeneratorRuntime().wrap(function _callee18$(_context19) {\n      while (1) switch (_context19.prev = _context19.next) {\n        case 0:\n          user = {};\n          authContext = botContext.getCapability('authContext');\n          if (!(Object.keys(_State__WEBPACK_IMPORTED_MODULE_1__.state.user).length === 0)) {\n            _context19.next = 10;\n            break;\n          }\n          user = typeof authContext.getUserData === \"function\" ? authContext.getUserData() : {};\n          if (!(Object.keys(user).length === 0)) {\n            _context19.next = 8;\n            break;\n          }\n          _context19.next = 7;\n          return authContext.getAuthUser(botContext);\n        case 7:\n          user = _context19.sent;\n        case 8:\n          _context19.next = 11;\n          break;\n        case 10:\n          user = _State__WEBPACK_IMPORTED_MODULE_1__.state.user;\n        case 11:\n          return _context19.abrupt(\"return\", user);\n        case 12:\n        case \"end\":\n          return _context19.stop();\n      }\n    }, _callee18);\n  }));\n  return function initUser(_x20) {\n    return _ref18.apply(this, arguments);\n  };\n}();\nvar initConversationContext = /*#__PURE__*/function () {\n  var _ref19 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19(botContext, user) {\n    var conversationContext;\n    return _regeneratorRuntime().wrap(function _callee19$(_context20) {\n      while (1) switch (_context20.prev = _context20.next) {\n        case 0:\n          conversationContext = botContext.getCapability('ConversationContext');\n          if (!(Object.keys(_State__WEBPACK_IMPORTED_MODULE_1__.state.conversation).length === 0)) {\n            _context20.next = 7;\n            break;\n          }\n          _context20.next = 4;\n          return conversationContext.getConversationContext(botContext, user);\n        case 4:\n          _context20.t0 = _context20.sent;\n          _context20.next = 8;\n          break;\n        case 7:\n          _context20.t0 = _State__WEBPACK_IMPORTED_MODULE_1__.state.conversation;\n        case 8:\n          return _context20.abrupt(\"return\", _context20.t0);\n        case 9:\n        case \"end\":\n          return _context20.stop();\n      }\n    }, _callee19);\n  }));\n  return function initConversationContext(_x21, _x22) {\n    return _ref19.apply(this, arguments);\n  };\n}();\nvar logTransactionStart = /*#__PURE__*/function () {\n  var _ref20 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20(state, start) {\n    return _regeneratorRuntime().wrap(function _callee20$(_context21) {\n      while (1) switch (_context21.prev = _context21.next) {\n        case 0:\n          if (state.messageTypeFromUser !== _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.BACKEND_RESPONSE()) {\n            state.setField(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.SYSTEM_FIELDS.MESSAGE_PROCESSING_START, start);\n          }\n        case 1:\n        case \"end\":\n          return _context21.stop();\n      }\n    }, _callee20);\n  }));\n  return function logTransactionStart(_x23, _x24) {\n    return _ref20.apply(this, arguments);\n  };\n}();\nvar logFinalPerformance = /*#__PURE__*/function () {\n  var _ref21 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee21(state) {\n    var messageProcessingStart, finalTime;\n    return _regeneratorRuntime().wrap(function _callee21$(_context22) {\n      while (1) switch (_context22.prev = _context22.next) {\n        case 0:\n          messageProcessingStart = state.getField(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.SYSTEM_FIELDS.MESSAGE_PROCESSING_START);\n          if (!(messageProcessingStart !== null && state.backendResponseType === 0 && state.waitingCustomCap === 0)) {\n            _context22.next = 10;\n            break;\n          }\n          state.developer._performanceLogs = true;\n          finalTime = Date.now();\n          _context22.next = 6;\n          return state.developer.logCurrentEventDurationWithStartTime(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.SYSTEM_FIELDS.MESSAGE_PROCESSING_START, messageProcessingStart, finalTime, \"Final performance\", (finalTime - messageProcessingStart) / 1000);\n        case 6:\n          if (!(finalTime - finalTime > 3000)) {\n            _context22.next = 9;\n            break;\n          }\n          _context22.next = 9;\n          return state.developer.warning({\n            message: \"PERFORMANCE WARNING\",\n            data: finalTime - finalTime\n          });\n        case 9:\n          state.clearField(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.SYSTEM_FIELDS.MESSAGE_PROCESSING_START);\n        case 10:\n        case \"end\":\n          return _context22.stop();\n      }\n    }, _callee21);\n  }));\n  return function logFinalPerformance(_x25) {\n    return _ref21.apply(this, arguments);\n  };\n}();\nvar next = /*#__PURE__*/function () {\n  var _ref22 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee22(msg, stateParam, previousMessages, botContext) {\n    var _user$info, _user$info2, _user$info3, _user$info4, _start3, startStorageCap, endStorageCap, startConvCap, endConvCap, startAuthCap, endAuthCap, user, sendMessageParam, _, conversation, stateFromStorage, startState, message, toGreeting;\n    return _regeneratorRuntime().wrap(function _callee22$(_context23) {\n      while (1) switch (_context23.prev = _context23.next) {\n        case 0:\n          _context23.prev = 0;\n          console.log('************* Next method ****************');\n          _start3 = Date.now();\n          startStorageCap = 0;\n          endStorageCap = 0;\n          startConvCap = 0;\n          endConvCap = 0;\n          startAuthCap = Date.now();\n          endAuthCap = 0;\n          _context23.next = 11;\n          return initUser(botContext);\n        case 11:\n          user = _context23.sent;\n          sendMessageParam = null;\n          _ = null; //Read authContext capability\n          endAuthCap = Date.now();\n          //Read conversation context capability\n          startConvCap = Date.now();\n          _context23.next = 18;\n          return initConversationContext(botContext, user);\n        case 18:\n          conversation = _context23.sent;\n          endConvCap = Date.now();\n          //Read state from storage\n          deviceStorageUtil.conversation = conversation.conversationId;\n          startStorageCap = Date.now();\n          if (!_State__WEBPACK_IMPORTED_MODULE_1__.state._persistentState) {\n            _context23.next = 28;\n            break;\n          }\n          _context23.next = 25;\n          return deviceStorageUtil.getContext(botContext);\n        case 25:\n          _context23.t0 = _context23.sent;\n          _context23.next = 29;\n          break;\n        case 28:\n          _context23.t0 = {};\n        case 29:\n          stateFromStorage = _context23.t0;\n          //Initialise state\n          startState = Date.now();\n          endStorageCap = Date.now();\n          user.userName = (_user$info = user.info) === null || _user$info === void 0 ? void 0 : _user$info.name;\n          user.userId = (_user$info2 = user.info) === null || _user$info2 === void 0 ? void 0 : _user$info2.userId;\n          user.userEmail = (_user$info3 = user.info) === null || _user$info3 === void 0 ? void 0 : _user$info3.emailAddress;\n          user.tz = (_user$info4 = user.info) === null || _user$info4 === void 0 ? void 0 : _user$info4.userTimezone;\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.init(msg, conversation, user, _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE, stateFromStorage, botContext);\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.removeActiveIntent();\n          _context23.next = 40;\n          return startInfoLogs(_State__WEBPACK_IMPORTED_MODULE_1__.state, 'Next', stateFromStorage);\n        case 40:\n          _context23.next = 42;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('loadAuthCap', startAuthCap, endAuthCap);\n        case 42:\n          _context23.next = 44;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('loadConversationCap', startConvCap, endConvCap);\n        case 44:\n          _context23.next = 46;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('loadStorageCap', startStorageCap, endStorageCap);\n        case 46:\n          _context23.next = 48;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('initialiseState', startState, Date.now());\n        case 48:\n          _context23.next = 50;\n          return logTransactionStart(_State__WEBPACK_IMPORTED_MODULE_1__.state, _start3);\n        case 50:\n          _ = _State__WEBPACK_IMPORTED_MODULE_1__.state._;\n          //Start processing bot\n          _context23.next = 53;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.loadAutoSaveBuffer();\n        case 53:\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.syncWithBackendState(stateParam);\n          if (!(_State__WEBPACK_IMPORTED_MODULE_1__.state.client === _State__WEBPACK_IMPORTED_MODULE_1__.state.responseToClient || _State__WEBPACK_IMPORTED_MODULE_1__.state.responseToClient === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.WEBCLIENT)) {\n            _context23.next = 102;\n            break;\n          }\n          if (!(_State__WEBPACK_IMPORTED_MODULE_1__.state.backendResponseType === 0)) {\n            _context23.next = 92;\n            break;\n          }\n          if (!msg.requestId) {\n            _context23.next = 59;\n            break;\n          }\n          if (_State__WEBPACK_IMPORTED_MODULE_1__.state.markRequestIdProcessed(msg.requestId)) {\n            _context23.next = 59;\n            break;\n          }\n          return _context23.abrupt(\"return\");\n        case 59:\n          if (!(!_State__WEBPACK_IMPORTED_MODULE_1__.state.intentResolved && _.size(_State__WEBPACK_IMPORTED_MODULE_1__.state.errorStack) === 0)) {\n            _context23.next = 62;\n            break;\n          }\n          _context23.next = 62;\n          return controller(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n        case 62:\n          _context23.next = 64;\n          return processShortResponse(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n        case 64:\n          _context23.next = 66;\n          return view(_State__WEBPACK_IMPORTED_MODULE_1__.state, botContext);\n        case 66:\n          _context23.next = 68;\n          return botContext.wait(false);\n        case 68:\n          if (!(!_State__WEBPACK_IMPORTED_MODULE_1__.state.silentIntent && !_State__WEBPACK_IMPORTED_MODULE_1__.state.intentResolved && (_State__WEBPACK_IMPORTED_MODULE_1__.state.waitingCustomCap > 0 && _State__WEBPACK_IMPORTED_MODULE_1__.state.messageFromUser.action !== 'close' && _State__WEBPACK_IMPORTED_MODULE_1__.state.messageFromUser.action !== 'move' && _State__WEBPACK_IMPORTED_MODULE_1__.state.messageFromUser.action !== 'cancel' && _State__WEBPACK_IMPORTED_MODULE_1__.state.messageTypeFromUser !== _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.BOT_TO_BOT() || _State__WEBPACK_IMPORTED_MODULE_1__.state.sendMessageParam))) {\n            _context23.next = 71;\n            break;\n          }\n          _context23.next = 71;\n          return botContext.wait(true);\n        case 71:\n          if (_State__WEBPACK_IMPORTED_MODULE_1__.state.intentResolved) {\n            _State__WEBPACK_IMPORTED_MODULE_1__.state.intentResolved = false;\n          }\n          if (_State__WEBPACK_IMPORTED_MODULE_1__.state.sendMessageParam) {\n            sendMessageParam = _State__WEBPACK_IMPORTED_MODULE_1__.state.sendMessageParam;\n            _State__WEBPACK_IMPORTED_MODULE_1__.state.sendMessageParam = null;\n          }\n          _context23.next = 75;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('totalNextMethod', _start3, Date.now());\n        case 75:\n          _context23.next = 77;\n          return logFinalPerformance(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n        case 77:\n          _context23.next = 79;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.save(deviceStorageUtil);\n        case 79:\n          if (!sendMessageParam) {\n            _context23.next = 90;\n            break;\n          }\n          message = {\n            messageFromUser: sendMessageParam\n          };\n          toGreeting = false;\n          if (typeof sendMessageParam === 'string') {\n            message.messageType = 'string';\n          } else {\n            message.messageType = 'object';\n            if (sendMessageParam.intentId && sendMessageParam.intentId === '@@reset') {\n              toGreeting = true;\n            }\n          }\n          if (!toGreeting) {\n            _context23.next = 88;\n            break;\n          }\n          _context23.next = 86;\n          return greeting(undefined, {\n            reset: true\n          }, botContext);\n        case 86:\n          _context23.next = 90;\n          break;\n        case 88:\n          _context23.next = 90;\n          return next(message, undefined, {}, botContext);\n        case 90:\n          _context23.next = 102;\n          break;\n        case 92:\n          if (!(_State__WEBPACK_IMPORTED_MODULE_1__.state.backendResponseType === 1)) {\n            _context23.next = 97;\n            break;\n          }\n          _context23.next = 95;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.save(deviceStorageUtil);\n        case 95:\n          _context23.next = 102;\n          break;\n        case 97:\n          if (!(_State__WEBPACK_IMPORTED_MODULE_1__.state.backendResponseType === 2)) {\n            _context23.next = 102;\n            break;\n          }\n          _context23.next = 100;\n          return syncData(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n        case 100:\n          _context23.next = 102;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.save(deviceStorageUtil);\n        case 102:\n          _context23.next = 104;\n          return pollAndProcess();\n        case 104:\n          _context23.next = 120;\n          break;\n        case 106:\n          _context23.prev = 106;\n          _context23.t1 = _context23[\"catch\"](0);\n          if (!(_State__WEBPACK_IMPORTED_MODULE_1__.state instanceof _State__WEBPACK_IMPORTED_MODULE_1__.State)) {\n            _context23.next = 119;\n            break;\n          }\n          if (!(_State__WEBPACK_IMPORTED_MODULE_1__.state.backendResponseType === 0)) {\n            _context23.next = 115;\n            break;\n          }\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.addSystemErrorToStack(5, _context23.t1.message);\n          _context23.next = 113;\n          return view(_State__WEBPACK_IMPORTED_MODULE_1__.state, botContext);\n        case 113:\n          _context23.next = 115;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.save(deviceStorageUtil);\n        case 115:\n          _context23.next = 117;\n          return pollAndProcess();\n        case 117:\n          _context23.next = 120;\n          break;\n        case 119:\n          console.log('Something very wrong ' + _context23.t1.message);\n        case 120:\n          return _context23.abrupt(\"return\", {\n            status: 200\n          });\n        case 121:\n        case \"end\":\n          return _context23.stop();\n      }\n    }, _callee22, null, [[0, 106]]);\n  }));\n  return function next(_x26, _x27, _x28, _x29) {\n    return _ref22.apply(this, arguments);\n  };\n}();\nvar asyncResult = function asyncResult(result, stateParam, previousMessages, botContext) {\n  var utils = botContext.getCapability('Utils');\n  var _ = utils.Lodash;\n  var state = _.get(result, 'details[0].message');\n  if (_.get(state, 'success') || _.get(state, 'StatusCode')) {\n    return pollAndProcess();\n  }\n  var data = {\n    state: state,\n    messageId: _.get(result, 'messageId'),\n    requestId: _.get(result, 'requestUuid')\n  };\n  var params = {\n    type: 'USER',\n    entry: {\n      userDomain: 'unknown',\n      userId: 'unknown',\n      userEmail: 'unknown',\n      botId: _.get(result, 'messageId'),\n      conversationId: _.get(result, 'requestUuid'),\n      entity: 'Micro-App',\n      intent: 'unknown',\n      client: 'unknown',\n      location: _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.EDGE,\n      timestamp: Date.now(),\n      level: 'LOG',\n      message: 'Started async_result in mobile',\n      data: result\n    }\n  };\n  botContext.log(params);\n  var requestId = _.get(result, 'requestUuid');\n  console.log('************* Data Received ****************');\n  console.log(JSON.stringify(state));\n  console.log('************* Data Received ****************');\n  if (state && requestId && requestId !== '') {\n    var contentType = _.get(result, 'contentType');\n    var createdOn = _.get(result, 'createdOn');\n    var createdBy = _.get(result, 'createdBy');\n    var messageId = _.get(result, 'messageId');\n    var message = {\n      messageDate: createdOn,\n      createdBy: createdBy,\n      uuid: messageId,\n      requestId: requestId,\n      contentType: contentType\n    };\n    if (contentType === _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.BACKEND_RESPONSE()) {\n      message.messageType = _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.BACKEND_RESPONSE();\n    } else {\n      message.messageType = _MessageTypes__WEBPACK_IMPORTED_MODULE_2__.MessageTypes.BOT_TO_BOT();\n      message.messageFromUser = state;\n    }\n    return next(message, state, previousMessages, botContext);\n  }\n};\nvar runNlp = /*#__PURE__*/function () {\n  var _ref23 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee23(state) {\n    var _state$messageFromUse2;\n    var D, nlpBotsList, params;\n    return _regeneratorRuntime().wrap(function _callee23$(_context24) {\n      while (1) switch (_context24.prev = _context24.next) {\n        case 0:\n          D = state.developer;\n          nlpBotsList = state.nlp.nlpIds;\n          _context24.next = 4;\n          return state.developer.info({\n            message: 'Starting NLP event',\n            data: nlpBotsList\n          });\n        case 4:\n          if (!(!state.inSilence && (state.messageTypeFromUser === 'string' || ((_state$messageFromUse2 = state.messageFromUser) === null || _state$messageFromUse2 === void 0 ? void 0 : _state$messageFromUse2.intentId) === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS))) {\n            _context24.next = 21;\n            break;\n          }\n          if (!(state.nlp.nlpEngine === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.NLP.ENGINES.DIALOGFLOW)) {\n            _context24.next = 16;\n            break;\n          }\n          if (!(nlpBotsList.length > 0)) {\n            _context24.next = 11;\n            break;\n          }\n          params = {\n            capability: 'NLP2',\n            capabilityFileName: 'nlpv2',\n            queryString: state.messageFromUser,\n            nlpIds: nlpBotsList,\n            sync: true,\n            userId: state.user.userId,\n            conversation: state.conversation\n          };\n          return _context24.abrupt(\"return\", state.callCapability(params));\n        case 11:\n          _context24.next = 13;\n          return state.developer.warning({\n            message: 'No NLP Engine added to the bot'\n          });\n        case 13:\n          return _context24.abrupt(\"return\", []);\n        case 16:\n          if (!(state.nlp.nlpEngine === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.NLP.ENGINES.OPEN_AI)) {\n            _context24.next = 20;\n            break;\n          }\n          return _context24.abrupt(\"return\", state.nlp.callOpenAIWithMessageFromUser({\n            service: _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.LLM_SERVICE.CHAT\n          }));\n        case 20:\n          return _context24.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var params = {\n              botAlias: state.nlp.nlpAlias,\n              botName: state.nlp.nlpIds[0],\n              inputText: state.messageFromUser,\n              userId: state.conversationId,\n              sessionAttributes: {}\n            };\n            var lexRuntime = new state.aws.LexRuntime();\n            lexRuntime.postText(params, function (err, data) {\n              if (err) resolve(err);else resolve(data);\n            });\n          }));\n        case 21:\n        case \"end\":\n          return _context24.stop();\n      }\n    }, _callee23);\n  }));\n  return function runNlp(_x30) {\n    return _ref23.apply(this, arguments);\n  };\n}();\nvar processNLPResponse = /*#__PURE__*/function () {\n  var _ref24 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee24(state, dataArray) {\n    var _, _loop2, _ret2, i, nlpId;\n    return _regeneratorRuntime().wrap(function _callee24$(_context26) {\n      while (1) switch (_context26.prev = _context26.next) {\n        case 0:\n          _ = state._;\n          if (!(state.nlp.nlpEngine === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.NLP.ENGINES.DIALOGFLOW)) {\n            _context26.next = 14;\n            break;\n          }\n          _loop2 = /*#__PURE__*/_regeneratorRuntime().mark(function _loop2() {\n            var nlpResponse, nlpParameters, action, nlpId, suggestions;\n            return _regeneratorRuntime().wrap(function _loop2$(_context25) {\n              while (1) switch (_context25.prev = _context25.next) {\n                case 0:\n                  nlpResponse = dataArray[i];\n                  _context25.next = 3;\n                  return state.developer.info({\n                    message: 'Response from NLP',\n                    data: nlpResponse\n                  });\n                case 3:\n                  if (!(nlpResponse.error === 'Invalid NLP ID')) {\n                    _context25.next = 6;\n                    break;\n                  }\n                  state.addSystemErrorToStack(24, nlpResponse.nlpId);\n                  return _context25.abrupt(\"return\", {\n                    v: void 0\n                  });\n                case 6:\n                  nlpParameters = '';\n                  action = nlpResponse.action;\n                  nlpId = nlpResponse.nlpId;\n                  if (nlpResponse.parameters && _.size(nlpResponse.parameters) > 0) {\n                    nlpParameters = nlpResponse.parameters;\n                  }\n                  suggestions = [];\n                  if (nlpResponse.messages) {\n                    _.forEach(nlpResponse.messages, function (entry) {\n                      if (entry.type === 4) {\n                        if (entry.payload.messages) {\n                          state.addSmartSuggestionsArray([{\n                            lang: state.lang,\n                            list: entry.payload.messages\n                          }]);\n                          suggestions = entry.payload.messages;\n                        }\n                      }\n                    });\n                  }\n                  state.nlpResults[nlpId] = {\n                    speech: ''\n                  };\n                  if (nlpResponse.speech && nlpResponse.speech !== '') {\n                    state.nlpResults[nlpId].speech = nlpResponse.speech;\n                  }\n                  state.nlpResults[nlpId].action = action;\n                  //state.nlpResults[nlpId].nlpResponse = nlpResponse;\n                  state.nlpResults[nlpId].nlpParameters = state.nlp.getNlpParameters(nlpParameters);\n                  state.nlpResults[nlpId].nlpSuggestions = suggestions;\n                case 17:\n                case \"end\":\n                  return _context25.stop();\n              }\n            }, _loop2);\n          });\n          i = 0;\n        case 4:\n          if (!(i < dataArray.length)) {\n            _context26.next = 12;\n            break;\n          }\n          return _context26.delegateYield(_loop2(), \"t0\", 6);\n        case 6:\n          _ret2 = _context26.t0;\n          if (!_ret2) {\n            _context26.next = 9;\n            break;\n          }\n          return _context26.abrupt(\"return\", _ret2.v);\n        case 9:\n          i++;\n          _context26.next = 4;\n          break;\n        case 12:\n          _context26.next = 17;\n          break;\n        case 14:\n          nlpId = state.nlp.nlpIds[0];\n          state.nlpResults[nlpId] = {\n            action: dataArray.intentName,\n            nlpParameters: dataArray.slots\n          };\n          if (dataArray.message !== '') {\n            state.nlpResults[nlpId].speech = dataArray.message;\n          }\n        case 17:\n        case \"end\":\n          return _context26.stop();\n      }\n    }, _callee24);\n  }));\n  return function processNLPResponse(_x31, _x32) {\n    return _ref24.apply(this, arguments);\n  };\n}();\nvar matchingLogic = /*#__PURE__*/function () {\n  var _ref25 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee25(state) {\n    var _, R, D, devIntent, startNLP, data, unambiguousResults, latestNoIntentSpeech, _state$messageFromUse3, _state$nlpResults$sta, smartSuggestionsArray;\n    return _regeneratorRuntime().wrap(function _callee25$(_context27) {\n      while (1) switch (_context27.prev = _context27.next) {\n        case 0:\n          state.nlpResults = {};\n          _ = state._;\n          R = state.R;\n          D = state.developer;\n          if (!state.developer.isDeveloperIntent()) {\n            _context27.next = 9;\n            break;\n          }\n          devIntent = state.developer.identifyDeveloperIntent();\n          if (!devIntent) {\n            _context27.next = 9;\n            break;\n          }\n          state.addActiveIntent(devIntent, false);\n          return _context27.abrupt(\"return\");\n        case 9:\n          _context27.next = 11;\n          return state.developer.info({\n            message: 'Starting matching logic'\n          });\n        case 11:\n          if (!(state.activeIntent === '')) {\n            _context27.next = 32;\n            break;\n          }\n          _context27.next = 14;\n          return runMatchers(state);\n        case 14:\n          if (!(state.activeIntent === '')) {\n            _context27.next = 29;\n            break;\n          }\n          startNLP = Date.now();\n          if (!(state.location === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.CLOUD || state.client === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.CLIENTS.WEBCLIENT)) {\n            _context27.next = 22;\n            break;\n          }\n          _context27.next = 19;\n          return runNlp(state);\n        case 19:\n          _context27.t0 = _context27.sent;\n          _context27.next = 23;\n          break;\n        case 22:\n          _context27.t0 = [];\n        case 23:\n          data = _context27.t0;\n          D.logCurrentEventDurationWithStartTime('nlpCalls', startNLP, Date.now());\n          D.debug({\n            message: 'Before processing NLP',\n            data: data\n          });\n          if (Array.isArray(data)) {\n            if (data.length > 0) {\n              processNLPResponse(state, data);\n            }\n          } else if (data && typeof data === \"string\") {\n            state.nlpResults[state.nlp.assistantName] = {\n              speech: data\n            };\n          } else if (data && _typeof(data) === \"object\") {\n            state.nlpResults[state.nlp.assistantName] = data;\n          }\n          _context27.next = 29;\n          return runMatchers(state);\n        case 29:\n          if (state.activeIntent === '') {\n            if (_.size(state.nlpResults) > 0) {\n              unambiguousResults = true;\n              latestNoIntentSpeech = \"Sorry, I didn't get that\";\n              Object.values(state.nlpResults).forEach(function (result) {\n                if (result.speech !== '') {\n                  if (result.action === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT) {\n                    latestNoIntentSpeech = result.speech;\n                    state.addActiveIntent(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT);\n                  } else {\n                    if (unambiguousResults) {\n                      state.addActiveIntent(_Intent__WEBPACK_IMPORTED_MODULE_0__.Intent.SPEECH());\n                      state.addStringResponse(result.speech);\n                      unambiguousResults = false;\n                    } else {\n                      if (!state.disambiguate) {\n                        state.addSystemErrorToStack(22);\n                      }\n                    }\n                  }\n                }\n              });\n              if (state.responsesArray.length === 0) {\n                state.addStringResponse(latestNoIntentSpeech);\n              }\n            }\n          } else {\n            if (((_state$messageFromUse3 = state.messageFromUser) === null || _state$messageFromUse3 === void 0 ? void 0 : _state$messageFromUse3.intentId) === _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.SYSTEM_INTENTS.GET_RELEVANT_QUESTIONS) {\n              smartSuggestionsArray = ((_state$nlpResults$sta = state.nlpResults[state.nlp.assistantName]) === null || _state$nlpResults$sta === void 0 ? void 0 : _state$nlpResults$sta.q) || [];\n              if (smartSuggestionsArray.length > 0) {\n                state.addEnglishSmartSuggestions(smartSuggestionsArray);\n              } else {\n                state.addSilentResponse();\n              }\n            }\n          }\n          _context27.next = 34;\n          break;\n        case 32:\n          _context27.next = 34;\n          return state.developer.info({\n            message: 'Intent already matched ',\n            data: state.activeIntent\n          });\n        case 34:\n          _context27.next = 36;\n          return state.recordActivity({\n            onMatching: true,\n            stamp: 4\n          });\n        case 36:\n        case \"end\":\n          return _context27.stop();\n      }\n    }, _callee25);\n  }));\n  return function matchingLogic(_x33) {\n    return _ref25.apply(this, arguments);\n  };\n}();\nvar asyncRequest = /*#__PURE__*/function () {\n  var _ref26 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee26(params, dependencies, botContext) {\n    var _params$state, _Promise, _, R, _start4, startAutoSaveBuffer, stateFromEdge, conversationFromEdge, userFromEdge, emptyMessage, greetingIntent, onInitCloud, startController, content, response, responseArray;\n    return _regeneratorRuntime().wrap(function _callee26$(_context28) {\n      while (1) switch (_context28.prev = _context28.next) {\n        case 0:\n          _context28.prev = 0;\n          _Promise = dependencies.promise;\n          _ = dependencies._;\n          R = dependencies.R;\n          _start4 = Date.now();\n          startAutoSaveBuffer = 0;\n          stateFromEdge = params.state;\n          conversationFromEdge = params.conversation;\n          userFromEdge = {\n            userId: params.userId,\n            userEmail: params.userEmail,\n            userDomains: params.userDomains,\n            userName: (_params$state = params.state) === null || _params$state === void 0 ? void 0 : _params$state.userName,\n            tz: params.userTimezone\n          };\n          emptyMessage = null;\n          dependencies.botManifest = botContext.botManifest;\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.init(emptyMessage, conversationFromEdge, userFromEdge, _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.LOCATIONS.CLOUD, stateFromEdge, dependencies);\n          _context28.next = 14;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.debug({\n            message: \"Full params\",\n            data: params\n          });\n        case 14:\n          if (!_State__WEBPACK_IMPORTED_MODULE_1__.state.reportActivityOnMain) {\n            _context28.next = 20;\n            break;\n          }\n          //This code runs only on edge bots, and it is full async with no response expected\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.addSilentResponse();\n          _context28.next = 18;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.recordActivity({\n            onMatching: true,\n            stamp: 5\n          });\n        case 18:\n          _context28.next = 20;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.recordActivity({\n            stamp: 6\n          });\n        case 20:\n          greetingIntent = _State__WEBPACK_IMPORTED_MODULE_1__.state.getGreetingIntent();\n          _context28.next = 23;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.onStart();\n        case 23:\n          _context28.next = 25;\n          return logMessageFromUser();\n        case 25:\n          _context28.next = 27;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.runAllOnInits();\n        case 27:\n          _context28.next = 29;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.syncDataToDB();\n        case 29:\n          _context28.next = 31;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.sendDelayedNotifications();\n        case 31:\n          _context28.next = 33;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.loadAutoSaveBuffer();\n        case 33:\n          _context28.next = 35;\n          return matchingLogic(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n        case 35:\n          onInitCloud = greetingIntent.onInitCloud;\n          if (!onInitCloud) {\n            _context28.next = 39;\n            break;\n          }\n          _context28.next = 39;\n          return onInitCloud();\n        case 39:\n          if (_State__WEBPACK_IMPORTED_MODULE_1__.state.inError) {\n            _context28.next = 58;\n            break;\n          }\n          startController = Date.now();\n          if (!(_State__WEBPACK_IMPORTED_MODULE_1__.state.activeIntent !== '' && _State__WEBPACK_IMPORTED_MODULE_1__.state.activeIntent !== _Intent__WEBPACK_IMPORTED_MODULE_0__.Intent.SPEECH() && _State__WEBPACK_IMPORTED_MODULE_1__.state.activeIntent !== _ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT)) {\n            _context28.next = 58;\n            break;\n          }\n          _context28.prev = 42;\n          _context28.next = 45;\n          return runValidators(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n        case 45:\n          if (!(_.size(_State__WEBPACK_IMPORTED_MODULE_1__.state.errorStack) === 0)) {\n            _context28.next = 53;\n            break;\n          }\n          _context28.next = 48;\n          return runResolvers(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n        case 48:\n          _context28.next = 50;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('backendController', startController, Date.now());\n        case 50:\n          startAutoSaveBuffer = Date.now();\n          _context28.next = 53;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.storeAutoSaveBuffer();\n        case 53:\n          _context28.next = 58;\n          break;\n        case 55:\n          _context28.prev = 55;\n          _context28.t0 = _context28[\"catch\"](42);\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.addSystemErrorToStack(7, \"Event caught by try/catch\", JSON.stringify(_context28.t0));\n        case 58:\n          _context28.next = 60;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('startAutoSaveBuffer', startAutoSaveBuffer, Date.now());\n        case 60:\n          if (!(_.size(_State__WEBPACK_IMPORTED_MODULE_1__.state.responsesArray) > 0 || _.size(_State__WEBPACK_IMPORTED_MODULE_1__.state.smartSuggestionsArray) > 0 || _State__WEBPACK_IMPORTED_MODULE_1__.state.inError || _State__WEBPACK_IMPORTED_MODULE_1__.state.sendMessageParam)) {\n            _context28.next = 65;\n            break;\n          }\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.intentResolved = true;\n          if (_State__WEBPACK_IMPORTED_MODULE_1__.state.activeIntent.substring(0, 5) === '_dev_') {\n            _State__WEBPACK_IMPORTED_MODULE_1__.state.removeActiveIntent();\n          }\n          _context28.next = 70;\n          break;\n        case 65:\n          if (!_State__WEBPACK_IMPORTED_MODULE_1__.state.cloudIntent) {\n            _context28.next = 70;\n            break;\n          }\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.intentResolved = false;\n          _context28.next = 69;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.info({\n            message: 'Found No intent'\n          });\n        case 69:\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.addActiveIntent(_ALLConstants__WEBPACK_IMPORTED_MODULE_4__.ALL_CONSTANTS.INTENTS.NO_INTENT);\n        case 70:\n          try {\n            if (_.size(_State__WEBPACK_IMPORTED_MODULE_1__.state.errorStack) > 0) {\n              _State__WEBPACK_IMPORTED_MODULE_1__.state.onError(_State__WEBPACK_IMPORTED_MODULE_1__.state);\n              _State__WEBPACK_IMPORTED_MODULE_1__.state.resetOnErrorMethod();\n            }\n          } catch (err) {\n            _State__WEBPACK_IMPORTED_MODULE_1__.state.addSystemErrorToStack(11, err.message);\n          }\n          _context28.next = 73;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.logCurrentEventDurationWithStartTime('fullCustomCap', _start4, Date.now());\n        case 73:\n          content = _State__WEBPACK_IMPORTED_MODULE_1__.state.getFinalResponseState();\n          _context28.next = 76;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.info({\n            message: 'Sending state to queue',\n            data: content\n          });\n        case 76:\n          _context28.next = 78;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.sendResponseToClient(content);\n        case 78:\n          content = _State__WEBPACK_IMPORTED_MODULE_1__.state.getFinalResponseSync();\n          _context28.next = 81;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.info({\n            message: 'Sending data sync to queue',\n            data: content\n          });\n        case 81:\n          _context28.next = 83;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.sendResponseToClient(content);\n        case 83:\n          response = _State__WEBPACK_IMPORTED_MODULE_1__.state.getFinalResponsesArray();\n          _context28.next = 86;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.info({\n            message: 'Sending responses to queue',\n            data: response\n          });\n        case 86:\n          if (!_State__WEBPACK_IMPORTED_MODULE_1__.state.apiResponse) {\n            _context28.next = 90;\n            break;\n          }\n          _context28.t1 = response;\n          _context28.next = 93;\n          break;\n        case 90:\n          _context28.next = 92;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.sendResponseToClient(response);\n        case 92:\n          _context28.t1 = _context28.sent;\n        case 93:\n          responseArray = _context28.t1;\n          _context28.next = 96;\n          return _State__WEBPACK_IMPORTED_MODULE_1__.state.developer.info({\n            message: 'Ending'\n          });\n        case 96:\n          return _context28.abrupt(\"return\", responseArray);\n        case 99:\n          _context28.prev = 99;\n          _context28.t2 = _context28[\"catch\"](0);\n          _State__WEBPACK_IMPORTED_MODULE_1__.state.addSystemErrorToStack(8, _context28.t2);\n          return _context28.abrupt(\"return\", _State__WEBPACK_IMPORTED_MODULE_1__.state.getFinalResponseState());\n        case 103:\n        case \"end\":\n          return _context28.stop();\n      }\n    }, _callee26, null, [[0, 99], [42, 55]]);\n  }));\n  return function asyncRequest(_x34, _x35, _x36) {\n    return _ref26.apply(this, arguments);\n  };\n}();\nvar farewell = function farewell(msg, state, botContext) {};\nvar open = function open(msg, state, previousMessages, botContext) {\n  if (msg && botContext) {\n    return next(msg, state, previousMessages, botContext);\n  }\n};\nvar isActiveWithMessage = function isActiveWithMessage() {\n  return _State__WEBPACK_IMPORTED_MODULE_1__.state.actyiveWithMessage;\n};\n\n\n//# sourceURL=webpack://botModule/../../frontmjs/core/index.js?");

/***/ }),

/***/ "./src/aiccPlayer/index.js":
/*!*********************************!*\
  !*** ./src/aiccPlayer/index.js ***!
  \*********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   player: function() { return /* binding */ player; }\n/* harmony export */ });\n/* harmony import */ var frontm_js_core_AiccPlayer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! frontm.js/core/AiccPlayer */ \"../../frontmjs/core/AiccPlayer.js\");\n/* harmony import */ var frontm_js_core_State__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! frontm.js/core/State */ \"../../frontmjs/core/State.js\");\n/* harmony import */ var _userCourses__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../userCourses */ \"./src/userCourses/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n\n\nvar player = new frontm_js_core_AiccPlayer__WEBPACK_IMPORTED_MODULE_0__.AiccPlayer('coursePlayer', frontm_js_core_State__WEBPACK_IMPORTED_MODULE_1__.state);\nplayer.onCourseStart = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(courseId) {\n    var _state$context, _config$COURSE_STATUS;\n    var config;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          config = (_state$context = frontm_js_core_State__WEBPACK_IMPORTED_MODULE_1__.state.context) === null || _state$context === void 0 ? void 0 : _state$context.config;\n          _context.next = 3;\n          return (0,_userCourses__WEBPACK_IMPORTED_MODULE_2__.updateState)(courseId, config === null || config === void 0 || (_config$COURSE_STATUS = config.COURSE_STATUS) === null || _config$COURSE_STATUS === void 0 ? void 0 : _config$COURSE_STATUS.STARTED);\n        case 3:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nplayer.onCourseEnd = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(courseId) {\n    var _state$context2, _config$COURSE_STATUS2;\n    var config;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          config = (_state$context2 = frontm_js_core_State__WEBPACK_IMPORTED_MODULE_1__.state.context) === null || _state$context2 === void 0 ? void 0 : _state$context2.config;\n          _context2.next = 3;\n          return (0,_userCourses__WEBPACK_IMPORTED_MODULE_2__.updateState)(courseId, config === null || config === void 0 || (_config$COURSE_STATUS2 = config.COURSE_STATUS) === null || _config$COURSE_STATUS2 === void 0 ? void 0 : _config$COURSE_STATUS2.COMPLETED);\n        case 3:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return function (_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\n//# sourceURL=webpack://botModule/./src/aiccPlayer/index.js?");

/***/ }),

/***/ "./src/courses/index.js":
/*!******************************!*\
  !*** ./src/courses/index.js ***!
  \******************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   openCourseCollection: function() { return /* binding */ openCourseCollection; },\n/* harmony export */   openCourseDoc: function() { return /* binding */ openCourseDoc; }\n/* harmony export */ });\n/* harmony import */ var frontm_js_core_ALLConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! frontm.js/core/ALLConstants */ \"../../frontmjs/core/ALLConstants.js\");\n/* harmony import */ var frontm_js_core_Collection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! frontm.js/core/Collection */ \"../../frontmjs/core/Collection.js\");\n/* harmony import */ var frontm_js_core_Doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! frontm.js/core/Doc */ \"../../frontmjs/core/Doc.js\");\n/* harmony import */ var frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! frontm.js/core/Field */ \"../../frontmjs/core/Field.js\");\n/* harmony import */ var frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! frontm.js/core/FormFieldTypes */ \"../../frontmjs/core/FormFieldTypes.js\");\n/* harmony import */ var frontm_js_core_Section__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! frontm.js/core/Section */ \"../../frontmjs/core/Section.js\");\n/* harmony import */ var frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! frontm.js/core/State */ \"../../frontmjs/core/State.js\");\n/* harmony import */ var _aiccPlayer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../aiccPlayer */ \"./src/aiccPlayer/index.js\");\n/* harmony import */ var _userCourses__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../userCourses */ \"./src/userCourses/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n\n\n\n\n\n\n\n\nvar COURSE_STATUS = 'courseStatusField';\nvar courseDoc = new frontm_js_core_Doc__WEBPACK_IMPORTED_MODULE_2__.Doc('courseDoc', frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state, {\n  title: 'Course information',\n  allowClose: true,\n  minimizeOnConfirm: true,\n  autoSave: true\n});\ncourseDoc.runOnCloud();\ncourseDoc.onPostBuild = function (self) {\n  var _self$f$courseId$id, _self$f$localizedMeta, _metadata$, _metadata$2;\n  var course = (_self$f$courseId$id = self.f[courseId.id]) === null || _self$f$courseId$id === void 0 ? void 0 : _self$f$courseId$id.value;\n  var coursesStatus = frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.getField(COURSE_STATUS) || {};\n  var metadata = ((_self$f$localizedMeta = self.f[localizedMetadata.id]) === null || _self$f$localizedMeta === void 0 ? void 0 : _self$f$localizedMeta.value) || [];\n  self.f[courseName.id].value = (_metadata$ = metadata[0]) === null || _metadata$ === void 0 ? void 0 : _metadata$.name;\n  self.f[courseDescription.id].value = (_metadata$2 = metadata[0]) === null || _metadata$2 === void 0 ? void 0 : _metadata$2.overview;\n  self.f[courseStatus.id].value = coursesStatus[course];\n};\ncourseDoc.onSubmit = function () {\n  var _state$messageFromUse;\n  var path = courseUrl.value;\n  var baseUrl = (_state$messageFromUse = frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.messageFromUser) === null || _state$messageFromUse === void 0 || (_state$messageFromUse = _state$messageFromUse.environment) === null || _state$messageFromUse === void 0 ? void 0 : _state$messageFromUse.origin;\n  var url = \"\".concat(baseUrl).concat(path);\n  var id = courseId.value;\n  if (!path || !baseUrl) {\n    frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.addStringResponse(\"Missing course url for \".concat(courseName.value));\n    return;\n  }\n  _aiccPlayer__WEBPACK_IMPORTED_MODULE_7__.player.sendResponse(id, url);\n};\nvar courseInformationSection = new frontm_js_core_Section__WEBPACK_IMPORTED_MODULE_5__.Section('section', {\n  label: 'Course Information',\n  doc: courseDoc,\n  columns: 1,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseId = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseId', {\n  title: 'Sl No',\n  dbName: 'courseId',\n  primaryKey: true,\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  readOnly: true,\n  column: 0,\n  doc: courseDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseUrl = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseUrl', {\n  title: 'Course Url',\n  dbName: 'cdhUrl',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  readOnly: true,\n  column: 0,\n  doc: courseDoc,\n  hidden: true,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar localizedMetadata = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('localizedMetadata', {\n  title: 'Course metadata',\n  dbName: 'localizedMetadata',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  readOnly: true,\n  column: 0,\n  doc: courseDoc,\n  hidden: true,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseName = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseName', {\n  title: 'Course Name',\n  dbName: 'courseName',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  temp: true,\n  readOnly: true,\n  column: 0,\n  doc: courseDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseDescription = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseDescription', {\n  title: 'Description',\n  dbName: 'courseDescription',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_AREA,\n  section: courseInformationSection,\n  readOnly: true,\n  temp: true,\n  column: 0,\n  doc: courseDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseCatalog = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseCatalog', {\n  title: 'Catalog',\n  dbName: 'courseCatalog',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  readOnly: true,\n  column: 0,\n  doc: courseDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseSkill = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseSkill', {\n  title: 'Skill',\n  dbName: 'courseSkill',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  readOnly: true,\n  column: 0,\n  doc: courseDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseStatus = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseStatus', {\n  title: 'Status',\n  dbName: 'state',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  readOnly: true,\n  temp: true,\n  column: 0,\n  doc: courseDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseDuration = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_3__.Field('courseDuration', {\n  title: 'Duration',\n  dbName: 'duration',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_4__.FormFieldTypes.TEXT_FIELD,\n  section: courseInformationSection,\n  readOnly: true,\n  column: 0,\n  doc: courseDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\nvar courseCollection = new frontm_js_core_Collection__WEBPACK_IMPORTED_MODULE_1__.Collection('courseCollection', {\n  name: 'courses',\n  document: courseDoc,\n  shared: true,\n  title: 'Courses',\n  style: frontm_js_core_ALLConstants__WEBPACK_IMPORTED_MODULE_0__.ALL_CONSTANTS.COLLECTION_TYPES.TABLE,\n  version: 4,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state\n});\ncourseCollection.runOnCloud();\ncourseCollection.onQuickAction = function () {\n  openCourseDoc();\n};\nfunction openCourseDoc() {\n  var _state$messageFromUse2, _state$context;\n  var rawDocToRestore = (_state$messageFromUse2 = frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.messageFromUser) === null || _state$messageFromUse2 === void 0 ? void 0 : _state$messageFromUse2.content;\n  courseDoc.buildDocument(rawDocToRestore, true);\n  frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.currentTabId = courseId.value;\n  var status = (_state$context = frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.context) === null || _state$context === void 0 || (_state$context = _state$context.config) === null || _state$context === void 0 ? void 0 : _state$context.COURSE_STATUS;\n  courseDoc.confirm = courseStatus.value === (status === null || status === void 0 ? void 0 : status.COMPLETED) ? '' : 'Play';\n  courseDoc.sendShortResponse();\n}\nfunction openCourseCollection() {\n  return _openCourseCollection.apply(this, arguments);\n}\nfunction _openCourseCollection() {\n  _openCourseCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var userCourses, courseIds, status;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.currentTabId = courseCollection.id;\n          _context.next = 3;\n          return (0,_userCourses__WEBPACK_IMPORTED_MODULE_8__.getCoursesForUser)();\n        case 3:\n          userCourses = _context.sent;\n          courseIds = [];\n          status = {};\n          userCourses === null || userCourses === void 0 || userCourses.forEach(function (course) {\n            status[course.courseId] = course.state;\n            courseIds.push(course.courseId);\n          });\n          frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.setField(COURSE_STATUS, status);\n          _context.next = 10;\n          return courseCollection.loadCollectionWithQuery({\n            query: {\n              courseId: {\n                $in: courseIds\n              }\n            }\n          });\n        case 10:\n          frontm_js_core_State__WEBPACK_IMPORTED_MODULE_6__.state.clearField(COURSE_STATUS);\n          courseCollection.sendShortResponse();\n        case 12:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _openCourseCollection.apply(this, arguments);\n}\n\n\n//# sourceURL=webpack://botModule/./src/courses/index.js?");

/***/ }),

/***/ "./src/main.js":
/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   main: function() { return /* binding */ main; }\n/* harmony export */ });\n/* harmony import */ var frontm_js_core_State__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! frontm.js/core/State */ \"../../frontmjs/core/State.js\");\n/* harmony import */ var frontm_js_core_Intent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! frontm.js/core/Intent */ \"../../frontmjs/core/Intent.js\");\n/* harmony import */ var _courses__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./courses */ \"./src/courses/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n\n\nfrontm_js_core_State__WEBPACK_IMPORTED_MODULE_0__.state.onStart = function () {\n  frontm_js_core_State__WEBPACK_IMPORTED_MODULE_0__.state.systemId = 'olg';\n};\nvar main = new frontm_js_core_Intent__WEBPACK_IMPORTED_MODULE_1__.Intent('main', frontm_js_core_State__WEBPACK_IMPORTED_MODULE_0__.state);\nmain.runOnCloud();\nmain.onResolution = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n  return _regeneratorRuntime().wrap(function _callee$(_context) {\n    while (1) switch (_context.prev = _context.next) {\n      case 0:\n        _context.next = 2;\n        return (0,_courses__WEBPACK_IMPORTED_MODULE_2__.openCourseCollection)();\n      case 2:\n      case \"end\":\n        return _context.stop();\n    }\n  }, _callee);\n}));\n\n//# sourceURL=webpack://botModule/./src/main.js?");

/***/ }),

/***/ "./src/userCourses/index.js":
/*!**********************************!*\
  !*** ./src/userCourses/index.js ***!
  \**********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCoursesForUser: function() { return /* binding */ getCoursesForUser; },\n/* harmony export */   updateState: function() { return /* binding */ updateState; },\n/* harmony export */   userCoursesCollection: function() { return /* binding */ userCoursesCollection; }\n/* harmony export */ });\n/* harmony import */ var frontm_js_core_Collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! frontm.js/core/Collection */ \"../../frontmjs/core/Collection.js\");\n/* harmony import */ var frontm_js_core_Doc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! frontm.js/core/Doc */ \"../../frontmjs/core/Doc.js\");\n/* harmony import */ var frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! frontm.js/core/Field */ \"../../frontmjs/core/Field.js\");\n/* harmony import */ var frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! frontm.js/core/FormFieldTypes */ \"../../frontmjs/core/FormFieldTypes.js\");\n/* harmony import */ var frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! frontm.js/core/State */ \"../../frontmjs/core/State.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n\n\n\n\nvar userCoursesDoc = new frontm_js_core_Doc__WEBPACK_IMPORTED_MODULE_1__.Doc('userCoursesDoc', frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state, {\n  title: 'userCourses'\n});\nvar courseId = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_2__.Field('userCourseId', {\n  title: 'Course Id',\n  dbName: 'courseId',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_3__.FormFieldTypes.TEXT_FIELD,\n  primaryKey: true,\n  doc: userCoursesDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state\n});\nvar userId = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_2__.Field('userCoursesUserId', {\n  title: 'User Id',\n  dbName: 'userId',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_3__.FormFieldTypes.TEXT_FIELD,\n  primaryKey: true,\n  doc: userCoursesDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state\n});\nvar courseState = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_2__.Field('courseState', {\n  title: 'Course State',\n  dbName: 'state',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_3__.FormFieldTypes.TEXT_FIELD,\n  doc: userCoursesDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state\n});\nvar courseEdgeUpdatedOn = new frontm_js_core_Field__WEBPACK_IMPORTED_MODULE_2__.Field('courseEdgeUpdatedOn', {\n  title: 'Course Edge Updated On',\n  dbName: 'edgeUpdatedOn',\n  type: frontm_js_core_FormFieldTypes__WEBPACK_IMPORTED_MODULE_3__.FormFieldTypes.DATETIME,\n  doc: userCoursesDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state\n});\nvar userCoursesCollection = new frontm_js_core_Collection__WEBPACK_IMPORTED_MODULE_0__.Collection('userCoursesCollection', {\n  title: 'User Courses',\n  name: 'userCourses',\n  shared: true,\n  document: userCoursesDoc,\n  state: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state\n});\nfunction updateState(_x, _x2) {\n  return _updateState.apply(this, arguments);\n}\nfunction _updateState() {\n  _updateState = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(courseIdFromAction, newState) {\n    var response;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          courseId.value = courseIdFromAction;\n          userId.value = frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state.user.userId;\n          _context.next = 4;\n          return userCoursesDoc.loadDocument();\n        case 4:\n          response = _context.sent;\n          if (frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state._.isEmpty(response)) {\n            _context.next = 10;\n            break;\n          }\n          courseState.value = newState;\n          courseEdgeUpdatedOn.value = Date.now();\n          _context.next = 10;\n          return userCoursesDoc.save();\n        case 10:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _updateState.apply(this, arguments);\n}\nfunction getCoursesForUser() {\n  return _getCoursesForUser.apply(this, arguments);\n}\nfunction _getCoursesForUser() {\n  _getCoursesForUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n    var skip,\n      limit,\n      _args2 = arguments;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          skip = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : 0;\n          limit = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : 20;\n          return _context2.abrupt(\"return\", userCoursesCollection.loadCollectionWithQuery({\n            query: {\n              userId: frontm_js_core_State__WEBPACK_IMPORTED_MODULE_4__.state.user.userId\n            },\n            projection: {\n              projection: {\n                courseId: 1,\n                state: 1\n              }\n            },\n            skip: skip,\n            limit: limit\n          }));\n        case 3:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return _getCoursesForUser.apply(this, arguments);\n}\n\n\n//# sourceURL=webpack://botModule/./src/userCourses/index.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	!function() {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = function(exports, definition) {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	!function() {
/******/ 		__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("../../frontmjs/core/index.js");
/******/ 	botModule = __webpack_exports__;
/******/ 	
/******/ })()
; 
    return botModule;
})()
